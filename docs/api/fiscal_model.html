<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 16.0.0"/>
    <title>fiscal_model API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:27px;vertical-align:bottom;width:50px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Policy">Policy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Policy.__init__">Policy</a>
                        </li>
                        <li>
                                <a class="variable" href="#Policy.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Policy.description">description</a>
                        </li>
                        <li>
                                <a class="variable" href="#Policy.policy_type">policy_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Policy.start_year">start_year</a>
                        </li>
                        <li>
                                <a class="variable" href="#Policy.duration_years">duration_years</a>
                        </li>
                        <li>
                                <a class="variable" href="#Policy.phase_in_years">phase_in_years</a>
                        </li>
                        <li>
                                <a class="variable" href="#Policy.sunset">sunset</a>
                        </li>
                        <li>
                                <a class="function" href="#Policy.get_phase_in_factor">get_phase_in_factor</a>
                        </li>
                        <li>
                                <a class="function" href="#Policy.is_active">is_active</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TaxPolicy">TaxPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TaxPolicy.__init__">TaxPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.rate_change">rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.new_rate">new_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.affected_income_threshold">affected_income_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.affected_income_cap">affected_income_cap</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.credit_amount">credit_amount</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.credit_refundable">credit_refundable</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.deduction_amount">deduction_amount</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.affected_taxpayers_millions">affected_taxpayers_millions</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.taxable_income_elasticity">taxable_income_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.labor_supply_elasticity">labor_supply_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.annual_revenue_change_billions">annual_revenue_change_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.avg_taxable_income_in_bracket">avg_taxable_income_in_bracket</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.marginal_rate_before">marginal_rate_before</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxPolicy.data_year">data_year</a>
                        </li>
                        <li>
                                <a class="function" href="#TaxPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#TaxPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CapitalGainsPolicy">CapitalGainsPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CapitalGainsPolicy.__init__">CapitalGainsPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.baseline_capital_gains_rate">baseline_capital_gains_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.baseline_realizations_billions">baseline_realizations_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.short_run_elasticity">short_run_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.long_run_elasticity">long_run_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.transition_years">transition_years</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.realization_elasticity">realization_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.use_time_varying_elasticity">use_time_varying_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.step_up_at_death">step_up_at_death</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.eliminate_step_up">eliminate_step_up</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.step_up_exemption">step_up_exemption</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.gains_at_death_billions">gains_at_death_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#CapitalGainsPolicy.step_up_lock_in_multiplier">step_up_lock_in_multiplier</a>
                        </li>
                        <li>
                                <a class="function" href="#CapitalGainsPolicy.get_elasticity_for_year">get_elasticity_for_year</a>
                        </li>
                        <li>
                                <a class="function" href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue">estimate_step_up_elimination_revenue</a>
                        </li>
                        <li>
                                <a class="function" href="#CapitalGainsPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#CapitalGainsPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpendingPolicy">SpendingPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpendingPolicy.__init__">SpendingPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpendingPolicy.annual_spending_change_billions">annual_spending_change_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpendingPolicy.annual_growth_rate">annual_growth_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpendingPolicy.gdp_multiplier">gdp_multiplier</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpendingPolicy.employment_per_billion">employment_per_billion</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpendingPolicy.is_one_time">is_one_time</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpendingPolicy.category">category</a>
                        </li>
                        <li>
                                <a class="function" href="#SpendingPolicy.get_spending_in_year">get_spending_in_year</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TransferPolicy">TransferPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TransferPolicy.__init__">TransferPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#TransferPolicy.benefit_change_percent">benefit_change_percent</a>
                        </li>
                        <li>
                                <a class="variable" href="#TransferPolicy.benefit_change_dollars">benefit_change_dollars</a>
                        </li>
                        <li>
                                <a class="variable" href="#TransferPolicy.eligibility_age_change">eligibility_age_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#TransferPolicy.new_beneficiaries_millions">new_beneficiaries_millions</a>
                        </li>
                        <li>
                                <a class="variable" href="#TransferPolicy.annual_cost_change_billions">annual_cost_change_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#TransferPolicy.labor_force_participation_effect">labor_force_participation_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#TransferPolicy.estimate_cost_effect">estimate_cost_effect</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PolicyPackage">PolicyPackage</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PolicyPackage.__init__">PolicyPackage</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyPackage.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyPackage.description">description</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyPackage.policies">policies</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyPackage.interaction_factor">interaction_factor</a>
                        </li>
                        <li>
                                <a class="function" href="#PolicyPackage.add_policy">add_policy</a>
                        </li>
                        <li>
                                <a class="function" href="#PolicyPackage.get_all_years">get_all_years</a>
                        </li>
                        <li>
                                <a class="function" href="#PolicyPackage.get_active_policies">get_active_policies</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PolicyType">PolicyType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#PolicyType.INCOME_TAX">INCOME_TAX</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.CORPORATE_TAX">CORPORATE_TAX</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.PAYROLL_TAX">PAYROLL_TAX</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.CAPITAL_GAINS_TAX">CAPITAL_GAINS_TAX</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.ESTATE_TAX">ESTATE_TAX</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.EXCISE_TAX">EXCISE_TAX</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.TAX_CREDIT">TAX_CREDIT</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.TAX_DEDUCTION">TAX_DEDUCTION</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.DISCRETIONARY_DEFENSE">DISCRETIONARY_DEFENSE</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.DISCRETIONARY_NONDEFENSE">DISCRETIONARY_NONDEFENSE</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.MANDATORY_SPENDING">MANDATORY_SPENDING</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.INFRASTRUCTURE">INFRASTRUCTURE</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.SOCIAL_SECURITY">SOCIAL_SECURITY</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.MEDICARE">MEDICARE</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.MEDICAID">MEDICAID</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.UNEMPLOYMENT">UNEMPLOYMENT</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.SNAP">SNAP</a>
                        </li>
                        <li>
                                <a class="variable" href="#PolicyType.OTHER_TRANSFER">OTHER_TRANSFER</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#create_income_tax_cut">create_income_tax_cut</a>
            </li>
            <li>
                    <a class="function" href="#create_new_tax_credit">create_new_tax_credit</a>
            </li>
            <li>
                    <a class="function" href="#create_spending_increase">create_spending_increase</a>
            </li>
            <li>
                    <a class="class" href="#BaselineProjection">BaselineProjection</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BaselineProjection.__init__">BaselineProjection</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.start_year">start_year</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.years">years</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.nominal_gdp">nominal_gdp</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.real_gdp">real_gdp</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.individual_income_tax">individual_income_tax</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.corporate_income_tax">corporate_income_tax</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.payroll_taxes">payroll_taxes</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.other_revenues">other_revenues</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.social_security">social_security</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.medicare">medicare</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.medicaid">medicaid</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.other_mandatory">other_mandatory</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.defense_discretionary">defense_discretionary</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.nondefense_discretionary">nondefense_discretionary</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.net_interest">net_interest</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.debt_held_by_public">debt_held_by_public</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.total_revenues">total_revenues</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.total_outlays">total_outlays</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.deficit">deficit</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.primary_deficit">primary_deficit</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.deficit_to_gdp">deficit_to_gdp</a>
                        </li>
                        <li>
                                <a class="variable" href="#BaselineProjection.debt_to_gdp">debt_to_gdp</a>
                        </li>
                        <li>
                                <a class="function" href="#BaselineProjection.get_year_index">get_year_index</a>
                        </li>
                        <li>
                                <a class="function" href="#BaselineProjection.get_value">get_value</a>
                        </li>
                        <li>
                                <a class="function" href="#BaselineProjection.get_cumulative_deficit">get_cumulative_deficit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CBOBaseline">CBOBaseline</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CBOBaseline.__init__">CBOBaseline</a>
                        </li>
                        <li>
                                <a class="variable" href="#CBOBaseline.start_year">start_year</a>
                        </li>
                        <li>
                                <a class="variable" href="#CBOBaseline.years">years</a>
                        </li>
                        <li>
                                <a class="variable" href="#CBOBaseline.assumptions">assumptions</a>
                        </li>
                        <li>
                                <a class="function" href="#CBOBaseline.generate">generate</a>
                        </li>
                        <li>
                                <a class="function" href="#CBOBaseline.adjust_for_policy">adjust_for_policy</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FiscalPolicyScorer">FiscalPolicyScorer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FiscalPolicyScorer.__init__">FiscalPolicyScorer</a>
                        </li>
                        <li>
                                <a class="variable" href="#FiscalPolicyScorer.start_year">start_year</a>
                        </li>
                        <li>
                                <a class="variable" href="#FiscalPolicyScorer.use_real_data">use_real_data</a>
                        </li>
                        <li>
                                <a class="variable" href="#FiscalPolicyScorer.economic_model">economic_model</a>
                        </li>
                        <li>
                                <a class="function" href="#FiscalPolicyScorer.score_policy">score_policy</a>
                        </li>
                        <li>
                                <a class="function" href="#FiscalPolicyScorer.score_package">score_package</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ScoringResult">ScoringResult</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ScoringResult.__init__">ScoringResult</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.policy">policy</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.baseline">baseline</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.years">years</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.static_revenue_effect">static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.static_spending_effect">static_spending_effect</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.static_deficit_effect">static_deficit_effect</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.behavioral_offset">behavioral_offset</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.dynamic_effects">dynamic_effects</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.final_deficit_effect">final_deficit_effect</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.low_estimate">low_estimate</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.high_estimate">high_estimate</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.is_dynamic">is_dynamic</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.total_10_year_cost">total_10_year_cost</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.total_static_cost">total_static_cost</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.revenue_feedback_10yr">revenue_feedback_10yr</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScoringResult.average_annual_cost">average_annual_cost</a>
                        </li>
                        <li>
                                <a class="function" href="#ScoringResult.get_year_effect">get_year_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#ScoringResult.to_dataframe">to_dataframe</a>
                        </li>
                        <li>
                                <a class="function" href="#ScoringResult.display_summary">display_summary</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EconomicModel">EconomicModel</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#EconomicModel.__init__">EconomicModel</a>
                        </li>
                        <li>
                                <a class="variable" href="#EconomicModel.baseline">baseline</a>
                        </li>
                        <li>
                                <a class="variable" href="#EconomicModel.years">years</a>
                        </li>
                        <li>
                                <a class="variable" href="#EconomicModel.conditions">conditions</a>
                        </li>
                        <li>
                                <a class="variable" href="#EconomicModel.params">params</a>
                        </li>
                        <li>
                                <a class="function" href="#EconomicModel.update_conditions">update_conditions</a>
                        </li>
                        <li>
                                <a class="function" href="#EconomicModel.get_multiplier_summary">get_multiplier_summary</a>
                        </li>
                        <li>
                                <a class="function" href="#EconomicModel.calculate_effects">calculate_effects</a>
                        </li>
                        <li>
                                <a class="function" href="#EconomicModel.get_long_run_effects">get_long_run_effects</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EconomicConditions">EconomicConditions</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#EconomicConditions.__init__">EconomicConditions</a>
                        </li>
                        <li>
                                <a class="variable" href="#EconomicConditions.output_gap">output_gap</a>
                        </li>
                        <li>
                                <a class="variable" href="#EconomicConditions.at_zlb">at_zlb</a>
                        </li>
                        <li>
                                <a class="variable" href="#EconomicConditions.debt_to_gdp">debt_to_gdp</a>
                        </li>
                        <li>
                                <a class="variable" href="#EconomicConditions.unemployment_rate">unemployment_rate</a>
                        </li>
                        <li>
                                <a class="function" href="#EconomicConditions.normal_times">normal_times</a>
                        </li>
                        <li>
                                <a class="function" href="#EconomicConditions.recession">recession</a>
                        </li>
                        <li>
                                <a class="function" href="#EconomicConditions.deep_recession">deep_recession</a>
                        </li>
                        <li>
                                <a class="function" href="#EconomicConditions.overheating">overheating</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DynamicEffects">DynamicEffects</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DynamicEffects.__init__">DynamicEffects</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.years">years</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.gdp_level_change">gdp_level_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.gdp_percent_change">gdp_percent_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.employment_change">employment_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.hours_worked_change">hours_worked_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.labor_force_change">labor_force_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.capital_stock_change">capital_stock_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.investment_change">investment_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.interest_rate_change">interest_rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.revenue_feedback">revenue_feedback</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.cumulative_gdp_effect">cumulative_gdp_effect</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.cumulative_revenue_feedback">cumulative_revenue_feedback</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicEffects.average_employment_effect">average_employment_effect</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#UncertaintyAnalysis">UncertaintyAnalysis</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#UncertaintyAnalysis.__init__">UncertaintyAnalysis</a>
                        </li>
                        <li>
                                <a class="variable" href="#UncertaintyAnalysis.factors">factors</a>
                        </li>
                        <li>
                                <a class="variable" href="#UncertaintyAnalysis.econ_correlation">econ_correlation</a>
                        </li>
                        <li>
                                <a class="function" href="#UncertaintyAnalysis.calculate_baseline_uncertainty">calculate_baseline_uncertainty</a>
                        </li>
                        <li>
                                <a class="function" href="#UncertaintyAnalysis.calculate_policy_uncertainty">calculate_policy_uncertainty</a>
                        </li>
                        <li>
                                <a class="function" href="#UncertaintyAnalysis.monte_carlo_simulation">monte_carlo_simulation</a>
                        </li>
                        <li>
                                <a class="function" href="#UncertaintyAnalysis.sensitivity_analysis">sensitivity_analysis</a>
                        </li>
                        <li>
                                <a class="function" href="#UncertaintyAnalysis.format_uncertainty_summary">format_uncertainty_summary</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#BudgetReport">BudgetReport</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BudgetReport.__init__">BudgetReport</a>
                        </li>
                        <li>
                                <a class="variable" href="#BudgetReport.result">result</a>
                        </li>
                        <li>
                                <a class="variable" href="#BudgetReport.years">years</a>
                        </li>
                        <li>
                                <a class="function" href="#BudgetReport.generate_text_report">generate_text_report</a>
                        </li>
                        <li>
                                <a class="function" href="#BudgetReport.plot_budget_effects">plot_budget_effects</a>
                        </li>
                        <li>
                                <a class="function" href="#BudgetReport.plot_comparison">plot_comparison</a>
                        </li>
                        <li>
                                <a class="function" href="#BudgetReport.export_to_csv">export_to_csv</a>
                        </li>
                        <li>
                                <a class="function" href="#BudgetReport.export_to_excel">export_to_excel</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TCJAExtensionPolicy">TCJAExtensionPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TCJAExtensionPolicy.__init__">TCJAExtensionPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.extend_rate_cuts">extend_rate_cuts</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.extend_standard_deduction">extend_standard_deduction</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.keep_exemption_elimination">keep_exemption_elimination</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.keep_salt_cap">keep_salt_cap</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.extend_ctc_expansion">extend_ctc_expansion</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.extend_passthrough_deduction">extend_passthrough_deduction</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.extend_estate_exemption">extend_estate_exemption</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.extend_amt_relief">extend_amt_relief</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.calibration_factor">calibration_factor</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAExtensionPolicy.dynamic_offset_pct">dynamic_offset_pct</a>
                        </li>
                        <li>
                                <a class="function" href="#TCJAExtensionPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#TCJAExtensionPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                        <li>
                                <a class="function" href="#TCJAExtensionPolicy.get_component_breakdown">get_component_breakdown</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TCJAComponent">TCJAComponent</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TCJAComponent.__init__">TCJAComponent</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAComponent.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAComponent.description">description</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAComponent.ten_year_cost_billions">ten_year_cost_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAComponent.annual_cost_billions">annual_cost_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAComponent.growth_rate">growth_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAComponent.source">source</a>
                        </li>
                        <li>
                                <a class="variable" href="#TCJAComponent.uncertainty_pct">uncertainty_pct</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#TCJA_COMPONENTS">TCJA_COMPONENTS</a>
            </li>
            <li>
                    <a class="function" href="#create_tcja_extension">create_tcja_extension</a>
            </li>
            <li>
                    <a class="function" href="#create_tcja_repeal_salt_cap">create_tcja_repeal_salt_cap</a>
            </li>
            <li>
                    <a class="function" href="#estimate_tcja_extension_cost">estimate_tcja_extension_cost</a>
            </li>
            <li>
                    <a class="function" href="#get_tcja_component_summary">get_tcja_component_summary</a>
            </li>
            <li>
                    <a class="class" href="#CorporateTaxPolicy">CorporateTaxPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CorporateTaxPolicy.__init__">CorporateTaxPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.rate_change">rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.baseline_rate">baseline_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.new_rate">new_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.corporate_elasticity">corporate_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.baseline_revenue_billions">baseline_revenue_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.baseline_profits_billions">baseline_profits_billions</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.include_passthrough_effects">include_passthrough_effects</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.passthrough_shift_elasticity">passthrough_shift_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.gilti_rate_change">gilti_rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.fdii_rate_change">fdii_rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.eliminate_fdii">eliminate_fdii</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.restore_rd_expensing">restore_rd_expensing</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.extend_bonus_depreciation">extend_bonus_depreciation</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.adjust_book_minimum">adjust_book_minimum</a>
                        </li>
                        <li>
                                <a class="variable" href="#CorporateTaxPolicy.book_minimum_rate_change">book_minimum_rate_change</a>
                        </li>
                        <li>
                                <a class="function" href="#CorporateTaxPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#CorporateTaxPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                        <li>
                                <a class="function" href="#CorporateTaxPolicy.get_component_breakdown">get_component_breakdown</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#create_corporate_rate_change">create_corporate_rate_change</a>
            </li>
            <li>
                    <a class="function" href="#create_biden_corporate_rate_only">create_biden_corporate_rate_only</a>
            </li>
            <li>
                    <a class="function" href="#create_biden_corporate_proposal">create_biden_corporate_proposal</a>
            </li>
            <li>
                    <a class="function" href="#create_tcja_corporate_repeal">create_tcja_corporate_repeal</a>
            </li>
            <li>
                    <a class="function" href="#create_republican_corporate_cut">create_republican_corporate_cut</a>
            </li>
            <li>
                    <a class="function" href="#estimate_corporate_rate_revenue">estimate_corporate_rate_revenue</a>
            </li>
            <li>
                    <a class="variable" href="#CURRENT_CORPORATE_RATE">CURRENT_CORPORATE_RATE</a>
            </li>
            <li>
                    <a class="variable" href="#BASELINE_CORPORATE_REVENUE_BILLIONS">BASELINE_CORPORATE_REVENUE_BILLIONS</a>
            </li>
            <li>
                    <a class="class" href="#TaxCreditPolicy">TaxCreditPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TaxCreditPolicy.__init__">TaxCreditPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.credit_type">credit_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.is_refundable">is_refundable</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.is_partially_refundable">is_partially_refundable</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.max_credit_per_unit">max_credit_per_unit</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.credit_change_per_unit">credit_change_per_unit</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.units_affected_millions">units_affected_millions</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.has_phase_in">has_phase_in</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.phase_in_rate">phase_in_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.phase_in_threshold">phase_in_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.phase_in_end">phase_in_end</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.has_phase_out">has_phase_out</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.phase_out_threshold_single">phase_out_threshold_single</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.phase_out_threshold_married">phase_out_threshold_married</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.phase_out_rate">phase_out_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.refundable_max">refundable_max</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.refund_rate">refund_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.refund_threshold">refund_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.make_fully_refundable">make_fully_refundable</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.remove_phase_out">remove_phase_out</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.expand_qualifying_age">expand_qualifying_age</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.include_childless_adults">include_childless_adults</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.labor_supply_elasticity">labor_supply_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.participation_rate">participation_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxCreditPolicy.take_up_rate_change">take_up_rate_change</a>
                        </li>
                        <li>
                                <a class="function" href="#TaxCreditPolicy.calculate_credit_for_income">calculate_credit_for_income</a>
                        </li>
                        <li>
                                <a class="function" href="#TaxCreditPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#TaxCreditPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CreditType">CreditType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CreditType.CHILD_TAX_CREDIT">CHILD_TAX_CREDIT</a>
                        </li>
                        <li>
                                <a class="variable" href="#CreditType.EARNED_INCOME_CREDIT">EARNED_INCOME_CREDIT</a>
                        </li>
                        <li>
                                <a class="variable" href="#CreditType.PREMIUM_TAX_CREDIT">PREMIUM_TAX_CREDIT</a>
                        </li>
                        <li>
                                <a class="variable" href="#CreditType.EDUCATION_CREDIT">EDUCATION_CREDIT</a>
                        </li>
                        <li>
                                <a class="variable" href="#CreditType.OTHER">OTHER</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#CTC_CURRENT_LAW">CTC_CURRENT_LAW</a>
            </li>
            <li>
                    <a class="variable" href="#EITC_CURRENT_LAW">EITC_CURRENT_LAW</a>
            </li>
            <li>
                    <a class="variable" href="#BASELINE_CREDIT_COSTS">BASELINE_CREDIT_COSTS</a>
            </li>
            <li>
                    <a class="function" href="#create_ctc_expansion">create_ctc_expansion</a>
            </li>
            <li>
                    <a class="function" href="#create_biden_ctc_2021">create_biden_ctc_2021</a>
            </li>
            <li>
                    <a class="function" href="#create_ctc_permanent_extension">create_ctc_permanent_extension</a>
            </li>
            <li>
                    <a class="function" href="#create_eitc_expansion">create_eitc_expansion</a>
            </li>
            <li>
                    <a class="function" href="#create_biden_eitc_childless">create_biden_eitc_childless</a>
            </li>
            <li>
                    <a class="function" href="#estimate_credit_cost">estimate_credit_cost</a>
            </li>
            <li>
                    <a class="variable" href="#CREDIT_VALIDATION_SCENARIOS">CREDIT_VALIDATION_SCENARIOS</a>
            </li>
            <li>
                    <a class="class" href="#EstateTaxPolicy">EstateTaxPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#EstateTaxPolicy.__init__">EstateTaxPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.exemption_change">exemption_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.new_exemption">new_exemption</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.extend_tcja_exemption">extend_tcja_exemption</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.rate_change">rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.new_rate">new_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.modify_portability">modify_portability</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.portability_cap">portability_cap</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.planning_elasticity">planning_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.gift_shifting_elasticity">gift_shifting_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.limit_valuation_discounts">limit_valuation_discounts</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.discount_limit_pct">discount_limit_pct</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.base_year">base_year</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxPolicy.annual_revenue_change_billions">annual_revenue_change_billions</a>
                        </li>
                        <li>
                                <a class="function" href="#EstateTaxPolicy.get_exemption_for_year">get_exemption_for_year</a>
                        </li>
                        <li>
                                <a class="function" href="#EstateTaxPolicy.get_rate_for_year">get_rate_for_year</a>
                        </li>
                        <li>
                                <a class="function" href="#EstateTaxPolicy.estimate_taxable_estates">estimate_taxable_estates</a>
                        </li>
                        <li>
                                <a class="function" href="#EstateTaxPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#EstateTaxPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EstateTaxScenario">EstateTaxScenario</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#EstateTaxScenario.CURRENT_LAW">CURRENT_LAW</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxScenario.EXTEND_TCJA">EXTEND_TCJA</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxScenario.LOWER_EXEMPTION">LOWER_EXEMPTION</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxScenario.INCREASE_RATE">INCREASE_RATE</a>
                        </li>
                        <li>
                                <a class="variable" href="#EstateTaxScenario.ELIMINATE">ELIMINATE</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#ESTATE_TAX_EXEMPTIONS">ESTATE_TAX_EXEMPTIONS</a>
            </li>
            <li>
                    <a class="variable" href="#CURRENT_ESTATE_TAX_RATE">CURRENT_ESTATE_TAX_RATE</a>
            </li>
            <li>
                    <a class="variable" href="#BASELINE_ESTATE_DATA">BASELINE_ESTATE_DATA</a>
            </li>
            <li>
                    <a class="variable" href="#CBO_ESTATE_ESTIMATES">CBO_ESTATE_ESTIMATES</a>
            </li>
            <li>
                    <a class="function" href="#create_tcja_estate_extension">create_tcja_estate_extension</a>
            </li>
            <li>
                    <a class="function" href="#create_biden_estate_proposal">create_biden_estate_proposal</a>
            </li>
            <li>
                    <a class="function" href="#create_warren_estate_proposal">create_warren_estate_proposal</a>
            </li>
            <li>
                    <a class="function" href="#create_estate_rate_change">create_estate_rate_change</a>
            </li>
            <li>
                    <a class="function" href="#create_estate_exemption_change">create_estate_exemption_change</a>
            </li>
            <li>
                    <a class="function" href="#create_eliminate_estate_tax">create_eliminate_estate_tax</a>
            </li>
            <li>
                    <a class="function" href="#estimate_estate_revenue">estimate_estate_revenue</a>
            </li>
            <li>
                    <a class="variable" href="#ESTATE_VALIDATION_SCENARIOS">ESTATE_VALIDATION_SCENARIOS</a>
            </li>
            <li>
                    <a class="class" href="#PayrollTaxPolicy">PayrollTaxPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PayrollTaxPolicy.__init__">PayrollTaxPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.payroll_tax_type">payroll_tax_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.ss_cap_change">ss_cap_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.ss_new_cap">ss_new_cap</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.ss_eliminate_cap">ss_eliminate_cap</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.ss_donut_hole_start">ss_donut_hole_start</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.ss_cover_90_pct">ss_cover_90_pct</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.ss_rate_change">ss_rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.medicare_rate_change">medicare_rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.additional_medicare_threshold_change">additional_medicare_threshold_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.additional_medicare_rate_change">additional_medicare_rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.expand_niit_to_passthrough">expand_niit_to_passthrough</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.niit_rate_change">niit_rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.labor_supply_elasticity">labor_supply_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.tax_avoidance_elasticity">tax_avoidance_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxPolicy.annual_revenue_change_billions">annual_revenue_change_billions</a>
                        </li>
                        <li>
                                <a class="function" href="#PayrollTaxPolicy.get_effective_ss_cap">get_effective_ss_cap</a>
                        </li>
                        <li>
                                <a class="function" href="#PayrollTaxPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#PayrollTaxPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PayrollTaxType">PayrollTaxType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#PayrollTaxType.SOCIAL_SECURITY">SOCIAL_SECURITY</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxType.MEDICARE">MEDICARE</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxType.ADDITIONAL_MEDICARE">ADDITIONAL_MEDICARE</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxType.NIIT">NIIT</a>
                        </li>
                        <li>
                                <a class="variable" href="#PayrollTaxType.COMBINED">COMBINED</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#SOCIAL_SECURITY_PARAMS">SOCIAL_SECURITY_PARAMS</a>
            </li>
            <li>
                    <a class="variable" href="#MEDICARE_PARAMS">MEDICARE_PARAMS</a>
            </li>
            <li>
                    <a class="variable" href="#NIIT_PARAMS">NIIT_PARAMS</a>
            </li>
            <li>
                    <a class="variable" href="#CBO_PAYROLL_ESTIMATES">CBO_PAYROLL_ESTIMATES</a>
            </li>
            <li>
                    <a class="function" href="#create_ss_cap_90_percent">create_ss_cap_90_percent</a>
            </li>
            <li>
                    <a class="function" href="#create_ss_donut_hole">create_ss_donut_hole</a>
            </li>
            <li>
                    <a class="function" href="#create_ss_eliminate_cap">create_ss_eliminate_cap</a>
            </li>
            <li>
                    <a class="function" href="#create_ss_rate_increase">create_ss_rate_increase</a>
            </li>
            <li>
                    <a class="function" href="#create_expand_niit">create_expand_niit</a>
            </li>
            <li>
                    <a class="function" href="#create_medicare_rate_increase">create_medicare_rate_increase</a>
            </li>
            <li>
                    <a class="function" href="#create_biden_payroll_proposal">create_biden_payroll_proposal</a>
            </li>
            <li>
                    <a class="function" href="#estimate_payroll_revenue">estimate_payroll_revenue</a>
            </li>
            <li>
                    <a class="variable" href="#PAYROLL_VALIDATION_SCENARIOS">PAYROLL_VALIDATION_SCENARIOS</a>
            </li>
            <li>
                    <a class="class" href="#AMTPolicy">AMTPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AMTPolicy.__init__">AMTPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.amt_type">amt_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.extend_tcja_relief">extend_tcja_relief</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.exemption_change">exemption_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.new_exemption_single">new_exemption_single</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.new_exemption_mfj">new_exemption_mfj</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.repeal_individual_amt">repeal_individual_amt</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.repeal_corporate_amt">repeal_corporate_amt</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.rate_change">rate_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.new_first_tier_rate">new_first_tier_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.new_second_tier_rate">new_second_tier_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.phase_out_threshold_change">phase_out_threshold_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.timing_elasticity">timing_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.avoidance_elasticity">avoidance_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.base_year">base_year</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTPolicy.annual_revenue_change_billions">annual_revenue_change_billions</a>
                        </li>
                        <li>
                                <a class="function" href="#AMTPolicy.get_exemption_for_year">get_exemption_for_year</a>
                        </li>
                        <li>
                                <a class="function" href="#AMTPolicy.get_rate_for_tier">get_rate_for_tier</a>
                        </li>
                        <li>
                                <a class="function" href="#AMTPolicy.estimate_affected_taxpayers">estimate_affected_taxpayers</a>
                        </li>
                        <li>
                                <a class="function" href="#AMTPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#AMTPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AMTType">AMTType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AMTType.INDIVIDUAL">INDIVIDUAL</a>
                        </li>
                        <li>
                                <a class="variable" href="#AMTType.CORPORATE">CORPORATE</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#AMT_EXEMPTIONS_TCJA">AMT_EXEMPTIONS_TCJA</a>
            </li>
            <li>
                    <a class="variable" href="#AMT_EXEMPTIONS_TCJA_EXTENDED">AMT_EXEMPTIONS_TCJA_EXTENDED</a>
            </li>
            <li>
                    <a class="variable" href="#AMT_RATES">AMT_RATES</a>
            </li>
            <li>
                    <a class="variable" href="#CORPORATE_AMT">CORPORATE_AMT</a>
            </li>
            <li>
                    <a class="variable" href="#BASELINE_AMT_DATA">BASELINE_AMT_DATA</a>
            </li>
            <li>
                    <a class="variable" href="#CBO_AMT_ESTIMATES">CBO_AMT_ESTIMATES</a>
            </li>
            <li>
                    <a class="function" href="#create_extend_tcja_amt_relief">create_extend_tcja_amt_relief</a>
            </li>
            <li>
                    <a class="function" href="#create_repeal_individual_amt">create_repeal_individual_amt</a>
            </li>
            <li>
                    <a class="function" href="#create_repeal_corporate_amt">create_repeal_corporate_amt</a>
            </li>
            <li>
                    <a class="function" href="#create_increase_amt_exemption">create_increase_amt_exemption</a>
            </li>
            <li>
                    <a class="function" href="#create_amt_rate_change">create_amt_rate_change</a>
            </li>
            <li>
                    <a class="function" href="#estimate_amt_revenue">estimate_amt_revenue</a>
            </li>
            <li>
                    <a class="variable" href="#AMT_VALIDATION_SCENARIOS">AMT_VALIDATION_SCENARIOS</a>
            </li>
            <li>
                    <a class="class" href="#PremiumTaxCreditPolicy">PremiumTaxCreditPolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PremiumTaxCreditPolicy.__init__">PremiumTaxCreditPolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.scenario">scenario</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.extend_enhanced">extend_enhanced</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.make_permanent">make_permanent</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.extension_years">extension_years</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.repeal_ptc">repeal_ptc</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.modify_premium_cap">modify_premium_cap</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.new_premium_cap_max">new_premium_cap_max</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.premium_cap_change">premium_cap_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.modify_income_limit">modify_income_limit</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.new_upper_fpl_limit">new_upper_fpl_limit</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.new_lower_fpl_limit">new_lower_fpl_limit</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.coverage_elasticity">coverage_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.take_up_rate">take_up_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.adverse_selection_factor">adverse_selection_factor</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.healthcare_growth_rate">healthcare_growth_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#PremiumTaxCreditPolicy.annual_revenue_change_billions">annual_revenue_change_billions</a>
                        </li>
                        <li>
                                <a class="function" href="#PremiumTaxCreditPolicy.get_premium_cap">get_premium_cap</a>
                        </li>
                        <li>
                                <a class="function" href="#PremiumTaxCreditPolicy.calculate_subsidy">calculate_subsidy</a>
                        </li>
                        <li>
                                <a class="function" href="#PremiumTaxCreditPolicy.estimate_coverage_effect">estimate_coverage_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#PremiumTaxCreditPolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PTCScenario">PTCScenario</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#PTCScenario.EXTEND_ENHANCED">EXTEND_ENHANCED</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTCScenario.ORIGINAL_ACA">ORIGINAL_ACA</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTCScenario.PERMANENT_ENHANCED">PERMANENT_ENHANCED</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTCScenario.REPEAL_PTC">REPEAL_PTC</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#FPL_2025">FPL_2025</a>
            </li>
            <li>
                    <a class="variable" href="#ENHANCED_PTC_CAPS">ENHANCED_PTC_CAPS</a>
            </li>
            <li>
                    <a class="variable" href="#ORIGINAL_ACA_CAPS">ORIGINAL_ACA_CAPS</a>
            </li>
            <li>
                    <a class="variable" href="#MARKETPLACE_DATA">MARKETPLACE_DATA</a>
            </li>
            <li>
                    <a class="variable" href="#BASELINE_PTC_COSTS">BASELINE_PTC_COSTS</a>
            </li>
            <li>
                    <a class="variable" href="#CBO_PTC_ESTIMATES">CBO_PTC_ESTIMATES</a>
            </li>
            <li>
                    <a class="function" href="#get_fpl">get_fpl</a>
            </li>
            <li>
                    <a class="function" href="#create_extend_enhanced_ptc">create_extend_enhanced_ptc</a>
            </li>
            <li>
                    <a class="function" href="#create_let_enhanced_expire">create_let_enhanced_expire</a>
            </li>
            <li>
                    <a class="function" href="#create_repeal_ptc">create_repeal_ptc</a>
            </li>
            <li>
                    <a class="function" href="#create_expand_ptc_eligibility">create_expand_ptc_eligibility</a>
            </li>
            <li>
                    <a class="function" href="#create_lower_premium_cap">create_lower_premium_cap</a>
            </li>
            <li>
                    <a class="function" href="#estimate_ptc_cost">estimate_ptc_cost</a>
            </li>
            <li>
                    <a class="variable" href="#PTC_VALIDATION_SCENARIOS">PTC_VALIDATION_SCENARIOS</a>
            </li>
            <li>
                    <a class="class" href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TaxExpenditurePolicy.__init__">TaxExpenditurePolicy</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.expenditure_type">expenditure_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.action">action</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.cap_amount">cap_amount</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.cap_rate">cap_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.phase_out_start">phase_out_start</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.phase_out_end">phase_out_end</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.phase_out_rate">phase_out_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.convert_to_credit">convert_to_credit</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.credit_rate">credit_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.expand_limit">expand_limit</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.behavioral_elasticity">behavioral_elasticity</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.participation_change">participation_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditurePolicy.annual_revenue_change_billions">annual_revenue_change_billions</a>
                        </li>
                        <li>
                                <a class="function" href="#TaxExpenditurePolicy.get_expenditure_data">get_expenditure_data</a>
                        </li>
                        <li>
                                <a class="function" href="#TaxExpenditurePolicy.estimate_static_revenue_effect">estimate_static_revenue_effect</a>
                        </li>
                        <li>
                                <a class="function" href="#TaxExpenditurePolicy.estimate_behavioral_offset">estimate_behavioral_offset</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TaxExpenditureType">TaxExpenditureType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#TaxExpenditureType.EMPLOYER_HEALTH">EMPLOYER_HEALTH</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.RETIREMENT_CONTRIBUTIONS">RETIREMENT_CONTRIBUTIONS</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.RETIREMENT_EARNINGS">RETIREMENT_EARNINGS</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.MORTGAGE_INTEREST">MORTGAGE_INTEREST</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.SALT">SALT</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.CHARITABLE">CHARITABLE</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.MEDICAL_EXPENSES">MEDICAL_EXPENSES</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.CAPITAL_GAINS">CAPITAL_GAINS</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.DIVIDENDS">DIVIDENDS</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.CHILD_TAX_CREDIT">CHILD_TAX_CREDIT</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.EITC">EITC</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.STEP_UP_BASIS">STEP_UP_BASIS</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.LIKE_KIND_EXCHANGE">LIKE_KIND_EXCHANGE</a>
                        </li>
                        <li>
                                <a class="variable" href="#TaxExpenditureType.PASS_THROUGH_DEDUCTION">PASS_THROUGH_DEDUCTION</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#JCT_TAX_EXPENDITURES">JCT_TAX_EXPENDITURES</a>
            </li>
            <li>
                    <a class="variable" href="#REFORM_ESTIMATES">REFORM_ESTIMATES</a>
            </li>
            <li>
                    <a class="function" href="#create_cap_employer_health_exclusion">create_cap_employer_health_exclusion</a>
            </li>
            <li>
                    <a class="function" href="#create_eliminate_mortgage_deduction">create_eliminate_mortgage_deduction</a>
            </li>
            <li>
                    <a class="function" href="#create_repeal_salt_cap">create_repeal_salt_cap</a>
            </li>
            <li>
                    <a class="function" href="#create_eliminate_salt_deduction">create_eliminate_salt_deduction</a>
            </li>
            <li>
                    <a class="function" href="#create_cap_charitable_deduction">create_cap_charitable_deduction</a>
            </li>
            <li>
                    <a class="function" href="#create_eliminate_step_up_basis">create_eliminate_step_up_basis</a>
            </li>
            <li>
                    <a class="function" href="#create_eliminate_like_kind_exchange">create_eliminate_like_kind_exchange</a>
            </li>
            <li>
                    <a class="function" href="#create_cap_retirement_contributions">create_cap_retirement_contributions</a>
            </li>
            <li>
                    <a class="function" href="#estimate_expenditure_revenue">estimate_expenditure_revenue</a>
            </li>
            <li>
                    <a class="function" href="#get_all_expenditure_estimates">get_all_expenditure_estimates</a>
            </li>
            <li>
                    <a class="variable" href="#TAX_EXPENDITURE_VALIDATION_SCENARIOS">TAX_EXPENDITURE_VALIDATION_SCENARIOS</a>
            </li>
            <li>
                    <a class="class" href="#DistributionalEngine">DistributionalEngine</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DistributionalEngine.__init__">DistributionalEngine</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalEngine.data_year">data_year</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalEngine.irs_data">irs_data</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalEngine.brackets">brackets</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalEngine.total_returns">total_returns</a>
                        </li>
                        <li>
                                <a class="function" href="#DistributionalEngine.create_income_groups">create_income_groups</a>
                        </li>
                        <li>
                                <a class="function" href="#DistributionalEngine.analyze_policy">analyze_policy</a>
                        </li>
                        <li>
                                <a class="function" href="#DistributionalEngine.create_top_income_breakout">create_top_income_breakout</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DistributionalAnalysis">DistributionalAnalysis</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DistributionalAnalysis.__init__">DistributionalAnalysis</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalAnalysis.policy">policy</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalAnalysis.year">year</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalAnalysis.group_type">group_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalAnalysis.results">results</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalAnalysis.total_tax_change">total_tax_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalAnalysis.total_affected_returns">total_affected_returns</a>
                        </li>
                        <li>
                                <a class="function" href="#DistributionalAnalysis.get_winners">get_winners</a>
                        </li>
                        <li>
                                <a class="function" href="#DistributionalAnalysis.get_losers">get_losers</a>
                        </li>
                        <li>
                                <a class="function" href="#DistributionalAnalysis.to_dataframe">to_dataframe</a>
                        </li>
                        <li>
                                <a class="function" href="#DistributionalAnalysis.summary">summary</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DistributionalResult">DistributionalResult</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DistributionalResult.__init__">DistributionalResult</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.income_group">income_group</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.tax_change_total">tax_change_total</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.tax_change_avg">tax_change_avg</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.tax_change_pct_income">tax_change_pct_income</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.share_of_total_change">share_of_total_change</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.pct_with_increase">pct_with_increase</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.pct_with_decrease">pct_with_decrease</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.pct_unchanged">pct_unchanged</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.baseline_etr">baseline_etr</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.new_etr">new_etr</a>
                        </li>
                        <li>
                                <a class="variable" href="#DistributionalResult.etr_change">etr_change</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#IncomeGroup">IncomeGroup</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#IncomeGroup.__init__">IncomeGroup</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.floor">floor</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.ceiling">ceiling</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.num_returns">num_returns</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.total_agi">total_agi</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.total_taxable_income">total_taxable_income</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.baseline_tax">baseline_tax</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.population_share">population_share</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.avg_agi">avg_agi</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.avg_tax">avg_tax</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroup.effective_tax_rate">effective_tax_rate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#IncomeGroupType">IncomeGroupType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#IncomeGroupType.QUINTILE">QUINTILE</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroupType.DECILE">DECILE</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroupType.JCT_DOLLAR">JCT_DOLLAR</a>
                        </li>
                        <li>
                                <a class="variable" href="#IncomeGroupType.CUSTOM">CUSTOM</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#format_distribution_table">format_distribution_table</a>
            </li>
            <li>
                    <a class="function" href="#generate_winners_losers_summary">generate_winners_losers_summary</a>
            </li>
            <li>
                    <a class="variable" href="#QUINTILE_THRESHOLDS_2024">QUINTILE_THRESHOLDS_2024</a>
            </li>
            <li>
                    <a class="variable" href="#DECILE_THRESHOLDS_2024">DECILE_THRESHOLDS_2024</a>
            </li>
            <li>
                    <a class="variable" href="#TOP_INCOME_THRESHOLDS_2024">TOP_INCOME_THRESHOLDS_2024</a>
            </li>
            <li>
                    <a class="variable" href="#JCT_DOLLAR_BRACKETS">JCT_DOLLAR_BRACKETS</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22160%22%20viewBox%3D%220%200%20150%2080%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M132.316%2048.886c.276-4.679%202.342-6.698%204.409-7.982s4.27-1.165%206.751-1.055c1.586.07%203.044.156%204.222-.482%201.142-.619%202.026-1.932%202.162-3.739.268-3.576-1.929-5.368-5.006-5.551s-7.599.524-10.517%201.606c-4.455%201.652-8.588%206.606-9.552%208.992s-2.342%206.193-1.745%2010.873%202.664%209.221%205.878%2011.79%205.878%203.808%2010.103%204.312%203.444.229%206.062.229%205.006-2.202%204.914-4.909-2.296-5.001-4.501-4.863-3.077.505-5.281.229-7.715-2.064-7.899-9.451z%22%20fill%3D%22%23198754%22/%3E%3Ccircle%20cx%3D%22101.504%22%20cy%3D%2248.943%22%20r%3D%2214.208%22%20fill%3D%22none%22%20stroke%3D%22%23198754%22%20stroke-width%3D%229.354%22/%3E%3Cpath%20d%3D%22M87.81.002c-3.637.065-5.001.454-7.014%201.232s-3.443%201.363-6.3%204.282c-1.723%201.76-3.148%205.019-3.776%207.329-.413%201.521-.316%202.63-.316%202.63l-.195%2034.612c.065%205.774-6.755%208.305-9.612%208.37s-9.678-1.038-9.743-9.408%207.128-9.521%208.362-9.521c1.413-.13%202.526-.021%203.718-.016%202.071.009%204.157-.778%204.092-4.671s-4.157-4.736-4.157-4.736c-6.3-.843-11.43%202.206-11.43%202.206S40.917%2038.15%2041.372%2049.634%2051.568%2068.19%2061.311%2068.125s18.316-7.007%2018.445-17.193l.13-22.772c.046-2.291%202.683-3.644%204.476-4.203.745-.232%201.694-.274%201.694-.274l10.457-.13s4.871-.324%207.729-3.114%204.352-6.294%204.352-6.294.974-3.049.13-4.606-.195-1.233-2.792-3.309-8.573-4.477-8.573-4.477S91.447-.063%2087.81.002zM0%2047.169l.065%2028.417S0%2080.127%204.481%2079.997s5.072-3.866%205.049-4.152l-.113-28.482s1.624-7.656%209.937-7.721%2010.002%206.942%2010.002%208.499-.909%2010.51-9.093%2010.51c-.948%200-2.99-.567-4.145-.272-3.919%201-3.194%204.554-3.194%204.554s.065%205.061%207.404%204.996%2018.575-6.034%2018.575-19.074S26.953%2030.04%2019.549%2029.91%201.234%2035.296%200%2047.169z%22%20fill%3D%22%23198754%22/%3E%3Cg%20transform%3D%22matrix%28.325601%200%200%20.325256%20-10.32669%20-45.802786%29%22%3E%3Ccircle%20cx%3D%22297.554%22%20cy%3D%22172.286%22%20r%3D%2216.5%22%20fill%3D%22%23fff%22/%3E%3Cellipse%20cx%3D%22297.709%22%20cy%3D%22172.642%22%20rx%3D%2211.071%22%20ry%3D%2210.871%22%20fill%3D%22%23105a48%22/%3E%3Ccircle%20cx%3D%22304.104%22%20cy%3D%22167.667%22%20r%3D%224.5%22%20fill%3D%22%23fff%22/%3E%3C/g%3E%3Cpath%20d%3D%22M94.661%2017.032l.893-1.476s.99.714%201.916.925%201.575.114%202.955.114l14.565-.162c1.283-.032%203.085-.762%203.02-3.293s-.373-3.503-.373-3.503l1.283-.487s.52.503.877%201.573.309%201.995.292%202.66-.227%201.541-.227%201.541%201.564-.308%202.359-1.038.823-.779%201.489-1.508.812-.86.812-.86.552-.13.877.26.341.957.065%201.46-1.672%202.206-3.247%203.066-2.76%201.427-3.929%201.768-3.848.73-7.063.714l-10.944-.114s-2.143-.081-3.02-.373-2.241-.973-2.598-1.265z%22%20fill%3D%22%23d36d49%22/%3E%3Cg%20fill%3D%22%23105a48%22%3E%3Cellipse%20cx%3D%2293.052%22%20cy%3D%2243.567%22%20rx%3D%22.869%22%20ry%3D%221.014%22%20transform%3D%22rotate%28341.022%29%22/%3E%3Cellipse%20cx%3D%22104.3%22%20cy%3D%22-16.184%22%20rx%3D%22.865%22%20ry%3D%221.009%22%20transform%3D%22rotate%2814.786%29%22/%3E%3C/g%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
fiscal_model    </h1>

                        <div class="docstring"><p>CBO-Style Fiscal Policy Scoring Model</p>

<p>A comprehensive framework for analyzing fiscal policy proposals
using Congressional Budget Office methodology.</p>
</div>

                        <input id="mod-fiscal_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-fiscal_model-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">CBO-Style Fiscal Policy Scoring Model</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">A comprehensive framework for analyzing fiscal policy proposals</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">using Congressional Budget Office methodology.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.policies</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>    <span class="n">Policy</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>    <span class="n">TaxPolicy</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>    <span class="n">CapitalGainsPolicy</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>    <span class="n">SpendingPolicy</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>    <span class="n">TransferPolicy</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>    <span class="n">PolicyPackage</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>    <span class="n">PolicyType</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>    <span class="n">create_income_tax_cut</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>    <span class="n">create_new_tax_credit</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>    <span class="n">create_spending_increase</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="p">)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.baseline</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaselineProjection</span><span class="p">,</span> <span class="n">CBOBaseline</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.scoring</span><span class="w"> </span><span class="kn">import</span> <span class="n">FiscalPolicyScorer</span><span class="p">,</span> <span class="n">ScoringResult</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.economics</span><span class="w"> </span><span class="kn">import</span> <span class="n">EconomicModel</span><span class="p">,</span> <span class="n">DynamicEffects</span><span class="p">,</span> <span class="n">EconomicConditions</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.uncertainty</span><span class="w"> </span><span class="kn">import</span> <span class="n">UncertaintyAnalysis</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.reporting</span><span class="w"> </span><span class="kn">import</span> <span class="n">BudgetReport</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.tcja</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>    <span class="n">TCJAExtensionPolicy</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="n">TCJAComponent</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="n">TCJA_COMPONENTS</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>    <span class="n">create_tcja_extension</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="n">create_tcja_repeal_salt_cap</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>    <span class="n">estimate_tcja_extension_cost</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="n">get_tcja_component_summary</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="p">)</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.corporate</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>    <span class="n">CorporateTaxPolicy</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>    <span class="n">create_corporate_rate_change</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="n">create_biden_corporate_rate_only</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">create_biden_corporate_proposal</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="n">create_tcja_corporate_repeal</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="n">create_republican_corporate_cut</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="n">estimate_corporate_rate_revenue</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="n">CURRENT_CORPORATE_RATE</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="n">BASELINE_CORPORATE_REVENUE_BILLIONS</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="p">)</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.credits</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="n">TaxCreditPolicy</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="n">CreditType</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">CTC_CURRENT_LAW</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="n">EITC_CURRENT_LAW</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="n">BASELINE_CREDIT_COSTS</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="n">create_ctc_expansion</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>    <span class="n">create_biden_ctc_2021</span><span class="p">,</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>    <span class="n">create_ctc_permanent_extension</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>    <span class="n">create_eitc_expansion</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="n">create_biden_eitc_childless</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="n">estimate_credit_cost</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="n">CREDIT_VALIDATION_SCENARIOS</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="p">)</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.estate</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="n">EstateTaxPolicy</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>    <span class="n">EstateTaxScenario</span><span class="p">,</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="n">CURRENT_ESTATE_TAX_RATE</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="n">BASELINE_ESTATE_DATA</span><span class="p">,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="n">CBO_ESTATE_ESTIMATES</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="n">create_tcja_estate_extension</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>    <span class="n">create_biden_estate_proposal</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="n">create_warren_estate_proposal</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="n">create_estate_rate_change</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="n">create_estate_exemption_change</span><span class="p">,</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>    <span class="n">create_eliminate_estate_tax</span><span class="p">,</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="n">estimate_estate_revenue</span><span class="p">,</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="n">ESTATE_VALIDATION_SCENARIOS</span><span class="p">,</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.payroll</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="n">PayrollTaxPolicy</span><span class="p">,</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="n">PayrollTaxType</span><span class="p">,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="n">MEDICARE_PARAMS</span><span class="p">,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="n">NIIT_PARAMS</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">,</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="n">create_ss_cap_90_percent</span><span class="p">,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="n">create_ss_donut_hole</span><span class="p">,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>    <span class="n">create_ss_eliminate_cap</span><span class="p">,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="n">create_ss_rate_increase</span><span class="p">,</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="n">create_expand_niit</span><span class="p">,</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="n">create_medicare_rate_increase</span><span class="p">,</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="n">create_biden_payroll_proposal</span><span class="p">,</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="n">estimate_payroll_revenue</span><span class="p">,</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="n">PAYROLL_VALIDATION_SCENARIOS</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="p">)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.amt</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="n">AMTPolicy</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="n">AMTType</span><span class="p">,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">,</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="n">AMT_EXEMPTIONS_TCJA_EXTENDED</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="n">AMT_RATES</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="n">CORPORATE_AMT</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="n">BASELINE_AMT_DATA</span><span class="p">,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    <span class="n">CBO_AMT_ESTIMATES</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="n">create_extend_tcja_amt_relief</span><span class="p">,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="n">create_repeal_individual_amt</span><span class="p">,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="n">create_repeal_corporate_amt</span><span class="p">,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>    <span class="n">create_increase_amt_exemption</span><span class="p">,</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="n">create_amt_rate_change</span><span class="p">,</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="n">estimate_amt_revenue</span><span class="p">,</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="n">AMT_VALIDATION_SCENARIOS</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="p">)</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.ptc</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="n">PremiumTaxCreditPolicy</span><span class="p">,</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="n">PTCScenario</span><span class="p">,</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>    <span class="n">FPL_2025</span><span class="p">,</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="n">ENHANCED_PTC_CAPS</span><span class="p">,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="n">ORIGINAL_ACA_CAPS</span><span class="p">,</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>    <span class="n">MARKETPLACE_DATA</span><span class="p">,</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="n">BASELINE_PTC_COSTS</span><span class="p">,</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>    <span class="n">CBO_PTC_ESTIMATES</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="n">get_fpl</span><span class="p">,</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="n">create_extend_enhanced_ptc</span><span class="p">,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="n">create_let_enhanced_expire</span><span class="p">,</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>    <span class="n">create_repeal_ptc</span><span class="p">,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="n">create_expand_ptc_eligibility</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>    <span class="n">create_lower_premium_cap</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="n">estimate_ptc_cost</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="n">PTC_VALIDATION_SCENARIOS</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.tax_expenditures</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="n">TaxExpenditurePolicy</span><span class="p">,</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="n">TaxExpenditureType</span><span class="p">,</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">,</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="n">REFORM_ESTIMATES</span><span class="p">,</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="n">create_cap_employer_health_exclusion</span><span class="p">,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="n">create_eliminate_mortgage_deduction</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="n">create_repeal_salt_cap</span><span class="p">,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="n">create_eliminate_salt_deduction</span><span class="p">,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="n">create_cap_charitable_deduction</span><span class="p">,</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="n">create_eliminate_step_up_basis</span><span class="p">,</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="n">create_eliminate_like_kind_exchange</span><span class="p">,</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>    <span class="n">create_cap_retirement_contributions</span><span class="p">,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>    <span class="n">estimate_expenditure_revenue</span><span class="p">,</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>    <span class="n">get_all_expenditure_estimates</span><span class="p">,</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>    <span class="n">TAX_EXPENDITURE_VALIDATION_SCENARIOS</span><span class="p">,</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="p">)</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.distribution</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>    <span class="n">DistributionalEngine</span><span class="p">,</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>    <span class="n">DistributionalAnalysis</span><span class="p">,</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="n">DistributionalResult</span><span class="p">,</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>    <span class="n">IncomeGroup</span><span class="p">,</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>    <span class="n">IncomeGroupType</span><span class="p">,</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="n">format_distribution_table</span><span class="p">,</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="n">generate_winners_losers_summary</span><span class="p">,</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>    <span class="n">QUINTILE_THRESHOLDS_2024</span><span class="p">,</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>    <span class="n">DECILE_THRESHOLDS_2024</span><span class="p">,</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="n">TOP_INCOME_THRESHOLDS_2024</span><span class="p">,</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="n">JCT_DOLLAR_BRACKETS</span><span class="p">,</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.0.0&quot;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>    <span class="s2">&quot;Policy&quot;</span><span class="p">,</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>    <span class="s2">&quot;TaxPolicy&quot;</span><span class="p">,</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>    <span class="s2">&quot;CapitalGainsPolicy&quot;</span><span class="p">,</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>    <span class="s2">&quot;SpendingPolicy&quot;</span><span class="p">,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>    <span class="s2">&quot;TransferPolicy&quot;</span><span class="p">,</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="s2">&quot;PolicyPackage&quot;</span><span class="p">,</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>    <span class="s2">&quot;PolicyType&quot;</span><span class="p">,</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>    <span class="s2">&quot;create_income_tax_cut&quot;</span><span class="p">,</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    <span class="s2">&quot;create_new_tax_credit&quot;</span><span class="p">,</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>    <span class="s2">&quot;create_spending_increase&quot;</span><span class="p">,</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>    <span class="s2">&quot;BaselineProjection&quot;</span><span class="p">,</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>    <span class="s2">&quot;CBOBaseline&quot;</span><span class="p">,</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>    <span class="s2">&quot;FiscalPolicyScorer&quot;</span><span class="p">,</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="s2">&quot;ScoringResult&quot;</span><span class="p">,</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>    <span class="s2">&quot;EconomicModel&quot;</span><span class="p">,</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>    <span class="s2">&quot;EconomicConditions&quot;</span><span class="p">,</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>    <span class="s2">&quot;DynamicEffects&quot;</span><span class="p">,</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>    <span class="s2">&quot;UncertaintyAnalysis&quot;</span><span class="p">,</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    <span class="s2">&quot;BudgetReport&quot;</span><span class="p">,</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>    <span class="c1"># TCJA extension</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>    <span class="s2">&quot;TCJAExtensionPolicy&quot;</span><span class="p">,</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    <span class="s2">&quot;TCJAComponent&quot;</span><span class="p">,</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="s2">&quot;TCJA_COMPONENTS&quot;</span><span class="p">,</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>    <span class="s2">&quot;create_tcja_extension&quot;</span><span class="p">,</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="s2">&quot;create_tcja_repeal_salt_cap&quot;</span><span class="p">,</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="s2">&quot;estimate_tcja_extension_cost&quot;</span><span class="p">,</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>    <span class="s2">&quot;get_tcja_component_summary&quot;</span><span class="p">,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>    <span class="c1"># Corporate tax</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>    <span class="s2">&quot;CorporateTaxPolicy&quot;</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="s2">&quot;create_corporate_rate_change&quot;</span><span class="p">,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>    <span class="s2">&quot;create_biden_corporate_rate_only&quot;</span><span class="p">,</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>    <span class="s2">&quot;create_biden_corporate_proposal&quot;</span><span class="p">,</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>    <span class="s2">&quot;create_tcja_corporate_repeal&quot;</span><span class="p">,</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    <span class="s2">&quot;create_republican_corporate_cut&quot;</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>    <span class="s2">&quot;estimate_corporate_rate_revenue&quot;</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>    <span class="s2">&quot;CURRENT_CORPORATE_RATE&quot;</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>    <span class="s2">&quot;BASELINE_CORPORATE_REVENUE_BILLIONS&quot;</span><span class="p">,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>    <span class="c1"># Tax credits</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>    <span class="s2">&quot;TaxCreditPolicy&quot;</span><span class="p">,</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    <span class="s2">&quot;CreditType&quot;</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>    <span class="s2">&quot;CTC_CURRENT_LAW&quot;</span><span class="p">,</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>    <span class="s2">&quot;EITC_CURRENT_LAW&quot;</span><span class="p">,</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>    <span class="s2">&quot;BASELINE_CREDIT_COSTS&quot;</span><span class="p">,</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>    <span class="s2">&quot;create_ctc_expansion&quot;</span><span class="p">,</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>    <span class="s2">&quot;create_biden_ctc_2021&quot;</span><span class="p">,</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>    <span class="s2">&quot;create_ctc_permanent_extension&quot;</span><span class="p">,</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>    <span class="s2">&quot;create_eitc_expansion&quot;</span><span class="p">,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>    <span class="s2">&quot;create_biden_eitc_childless&quot;</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>    <span class="s2">&quot;estimate_credit_cost&quot;</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>    <span class="s2">&quot;CREDIT_VALIDATION_SCENARIOS&quot;</span><span class="p">,</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>    <span class="c1"># Estate tax</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>    <span class="s2">&quot;EstateTaxPolicy&quot;</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>    <span class="s2">&quot;EstateTaxScenario&quot;</span><span class="p">,</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>    <span class="s2">&quot;ESTATE_TAX_EXEMPTIONS&quot;</span><span class="p">,</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>    <span class="s2">&quot;CURRENT_ESTATE_TAX_RATE&quot;</span><span class="p">,</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>    <span class="s2">&quot;BASELINE_ESTATE_DATA&quot;</span><span class="p">,</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>    <span class="s2">&quot;CBO_ESTATE_ESTIMATES&quot;</span><span class="p">,</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>    <span class="s2">&quot;create_tcja_estate_extension&quot;</span><span class="p">,</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>    <span class="s2">&quot;create_biden_estate_proposal&quot;</span><span class="p">,</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>    <span class="s2">&quot;create_warren_estate_proposal&quot;</span><span class="p">,</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>    <span class="s2">&quot;create_estate_rate_change&quot;</span><span class="p">,</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    <span class="s2">&quot;create_estate_exemption_change&quot;</span><span class="p">,</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>    <span class="s2">&quot;create_eliminate_estate_tax&quot;</span><span class="p">,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>    <span class="s2">&quot;estimate_estate_revenue&quot;</span><span class="p">,</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>    <span class="s2">&quot;ESTATE_VALIDATION_SCENARIOS&quot;</span><span class="p">,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>    <span class="c1"># Payroll tax</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>    <span class="s2">&quot;PayrollTaxPolicy&quot;</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    <span class="s2">&quot;PayrollTaxType&quot;</span><span class="p">,</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>    <span class="s2">&quot;SOCIAL_SECURITY_PARAMS&quot;</span><span class="p">,</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>    <span class="s2">&quot;MEDICARE_PARAMS&quot;</span><span class="p">,</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>    <span class="s2">&quot;NIIT_PARAMS&quot;</span><span class="p">,</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>    <span class="s2">&quot;CBO_PAYROLL_ESTIMATES&quot;</span><span class="p">,</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>    <span class="s2">&quot;create_ss_cap_90_percent&quot;</span><span class="p">,</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>    <span class="s2">&quot;create_ss_donut_hole&quot;</span><span class="p">,</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>    <span class="s2">&quot;create_ss_eliminate_cap&quot;</span><span class="p">,</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>    <span class="s2">&quot;create_ss_rate_increase&quot;</span><span class="p">,</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>    <span class="s2">&quot;create_expand_niit&quot;</span><span class="p">,</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="s2">&quot;create_medicare_rate_increase&quot;</span><span class="p">,</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>    <span class="s2">&quot;create_biden_payroll_proposal&quot;</span><span class="p">,</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    <span class="s2">&quot;estimate_payroll_revenue&quot;</span><span class="p">,</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="s2">&quot;PAYROLL_VALIDATION_SCENARIOS&quot;</span><span class="p">,</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>    <span class="c1"># AMT</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>    <span class="s2">&quot;AMTPolicy&quot;</span><span class="p">,</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>    <span class="s2">&quot;AMTType&quot;</span><span class="p">,</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="s2">&quot;AMT_EXEMPTIONS_TCJA&quot;</span><span class="p">,</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>    <span class="s2">&quot;AMT_EXEMPTIONS_TCJA_EXTENDED&quot;</span><span class="p">,</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>    <span class="s2">&quot;AMT_RATES&quot;</span><span class="p">,</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>    <span class="s2">&quot;CORPORATE_AMT&quot;</span><span class="p">,</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>    <span class="s2">&quot;BASELINE_AMT_DATA&quot;</span><span class="p">,</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>    <span class="s2">&quot;CBO_AMT_ESTIMATES&quot;</span><span class="p">,</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="s2">&quot;create_extend_tcja_amt_relief&quot;</span><span class="p">,</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="s2">&quot;create_repeal_individual_amt&quot;</span><span class="p">,</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    <span class="s2">&quot;create_repeal_corporate_amt&quot;</span><span class="p">,</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="s2">&quot;create_increase_amt_exemption&quot;</span><span class="p">,</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>    <span class="s2">&quot;create_amt_rate_change&quot;</span><span class="p">,</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>    <span class="s2">&quot;estimate_amt_revenue&quot;</span><span class="p">,</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>    <span class="s2">&quot;AMT_VALIDATION_SCENARIOS&quot;</span><span class="p">,</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>    <span class="c1"># Premium Tax Credits</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>    <span class="s2">&quot;PremiumTaxCreditPolicy&quot;</span><span class="p">,</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>    <span class="s2">&quot;PTCScenario&quot;</span><span class="p">,</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>    <span class="s2">&quot;FPL_2025&quot;</span><span class="p">,</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="s2">&quot;ENHANCED_PTC_CAPS&quot;</span><span class="p">,</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="s2">&quot;ORIGINAL_ACA_CAPS&quot;</span><span class="p">,</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>    <span class="s2">&quot;MARKETPLACE_DATA&quot;</span><span class="p">,</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>    <span class="s2">&quot;BASELINE_PTC_COSTS&quot;</span><span class="p">,</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    <span class="s2">&quot;CBO_PTC_ESTIMATES&quot;</span><span class="p">,</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>    <span class="s2">&quot;get_fpl&quot;</span><span class="p">,</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>    <span class="s2">&quot;create_extend_enhanced_ptc&quot;</span><span class="p">,</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="s2">&quot;create_let_enhanced_expire&quot;</span><span class="p">,</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>    <span class="s2">&quot;create_repeal_ptc&quot;</span><span class="p">,</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>    <span class="s2">&quot;create_expand_ptc_eligibility&quot;</span><span class="p">,</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="s2">&quot;create_lower_premium_cap&quot;</span><span class="p">,</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>    <span class="s2">&quot;estimate_ptc_cost&quot;</span><span class="p">,</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>    <span class="s2">&quot;PTC_VALIDATION_SCENARIOS&quot;</span><span class="p">,</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>    <span class="c1"># Tax Expenditures</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>    <span class="s2">&quot;TaxExpenditurePolicy&quot;</span><span class="p">,</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>    <span class="s2">&quot;TaxExpenditureType&quot;</span><span class="p">,</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>    <span class="s2">&quot;JCT_TAX_EXPENDITURES&quot;</span><span class="p">,</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>    <span class="s2">&quot;REFORM_ESTIMATES&quot;</span><span class="p">,</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>    <span class="s2">&quot;create_cap_employer_health_exclusion&quot;</span><span class="p">,</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>    <span class="s2">&quot;create_eliminate_mortgage_deduction&quot;</span><span class="p">,</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>    <span class="s2">&quot;create_repeal_salt_cap&quot;</span><span class="p">,</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>    <span class="s2">&quot;create_eliminate_salt_deduction&quot;</span><span class="p">,</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>    <span class="s2">&quot;create_cap_charitable_deduction&quot;</span><span class="p">,</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>    <span class="s2">&quot;create_eliminate_step_up_basis&quot;</span><span class="p">,</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>    <span class="s2">&quot;create_eliminate_like_kind_exchange&quot;</span><span class="p">,</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>    <span class="s2">&quot;create_cap_retirement_contributions&quot;</span><span class="p">,</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>    <span class="s2">&quot;estimate_expenditure_revenue&quot;</span><span class="p">,</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>    <span class="s2">&quot;get_all_expenditure_estimates&quot;</span><span class="p">,</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>    <span class="s2">&quot;TAX_EXPENDITURE_VALIDATION_SCENARIOS&quot;</span><span class="p">,</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>    <span class="c1"># Distributional Analysis</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>    <span class="s2">&quot;DistributionalEngine&quot;</span><span class="p">,</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>    <span class="s2">&quot;DistributionalAnalysis&quot;</span><span class="p">,</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>    <span class="s2">&quot;DistributionalResult&quot;</span><span class="p">,</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>    <span class="s2">&quot;IncomeGroup&quot;</span><span class="p">,</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>    <span class="s2">&quot;IncomeGroupType&quot;</span><span class="p">,</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>    <span class="s2">&quot;format_distribution_table&quot;</span><span class="p">,</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>    <span class="s2">&quot;generate_winners_losers_summary&quot;</span><span class="p">,</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>    <span class="s2">&quot;QUINTILE_THRESHOLDS_2024&quot;</span><span class="p">,</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>    <span class="s2">&quot;DECILE_THRESHOLDS_2024&quot;</span><span class="p">,</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>    <span class="s2">&quot;TOP_INCOME_THRESHOLDS_2024&quot;</span><span class="p">,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>    <span class="s2">&quot;JCT_DOLLAR_BRACKETS&quot;</span><span class="p">,</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="Policy">
                            <input id="Policy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Policy</span>:

                <label class="view-source-button" for="Policy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Policy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Policy-42"><a href="#Policy-42"><span class="linenos">42</span></a><span class="nd">@dataclass</span>
</span><span id="Policy-43"><a href="#Policy-43"><span class="linenos">43</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Policy</span><span class="p">:</span>
</span><span id="Policy-44"><a href="#Policy-44"><span class="linenos">44</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Policy-45"><a href="#Policy-45"><span class="linenos">45</span></a><span class="sd">    Base class for fiscal policy proposals.</span>
</span><span id="Policy-46"><a href="#Policy-46"><span class="linenos">46</span></a><span class="sd">    </span>
</span><span id="Policy-47"><a href="#Policy-47"><span class="linenos">47</span></a><span class="sd">    Attributes:</span>
</span><span id="Policy-48"><a href="#Policy-48"><span class="linenos">48</span></a><span class="sd">        name: Short descriptive name</span>
</span><span id="Policy-49"><a href="#Policy-49"><span class="linenos">49</span></a><span class="sd">        description: Detailed description of the policy</span>
</span><span id="Policy-50"><a href="#Policy-50"><span class="linenos">50</span></a><span class="sd">        policy_type: Category of fiscal policy</span>
</span><span id="Policy-51"><a href="#Policy-51"><span class="linenos">51</span></a><span class="sd">        start_year: First year the policy takes effect</span>
</span><span id="Policy-52"><a href="#Policy-52"><span class="linenos">52</span></a><span class="sd">        duration_years: Number of years the policy is in effect (default 10 for CBO window)</span>
</span><span id="Policy-53"><a href="#Policy-53"><span class="linenos">53</span></a><span class="sd">        phase_in_years: Years to fully phase in the policy (default 1 = immediate)</span>
</span><span id="Policy-54"><a href="#Policy-54"><span class="linenos">54</span></a><span class="sd">        sunset: Whether the policy expires after duration_years</span>
</span><span id="Policy-55"><a href="#Policy-55"><span class="linenos">55</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Policy-56"><a href="#Policy-56"><span class="linenos">56</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="Policy-57"><a href="#Policy-57"><span class="linenos">57</span></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="Policy-58"><a href="#Policy-58"><span class="linenos">58</span></a>    <span class="n">policy_type</span><span class="p">:</span> <span class="n">PolicyType</span>
</span><span id="Policy-59"><a href="#Policy-59"><span class="linenos">59</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>
</span><span id="Policy-60"><a href="#Policy-60"><span class="linenos">60</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="Policy-61"><a href="#Policy-61"><span class="linenos">61</span></a>    <span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Policy-62"><a href="#Policy-62"><span class="linenos">62</span></a>    <span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Policy-63"><a href="#Policy-63"><span class="linenos">63</span></a>    
</span><span id="Policy-64"><a href="#Policy-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_phase_in_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Policy-65"><a href="#Policy-65"><span class="linenos">65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Policy-66"><a href="#Policy-66"><span class="linenos">66</span></a><span class="sd">        Calculate the phase-in factor for a given year.</span>
</span><span id="Policy-67"><a href="#Policy-67"><span class="linenos">67</span></a><span class="sd">        Returns 0 if before start, 1 if fully phased in, fractional during phase-in.</span>
</span><span id="Policy-68"><a href="#Policy-68"><span class="linenos">68</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Policy-69"><a href="#Policy-69"><span class="linenos">69</span></a>        <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">:</span>
</span><span id="Policy-70"><a href="#Policy-70"><span class="linenos">70</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="Policy-71"><a href="#Policy-71"><span class="linenos">71</span></a>        
</span><span id="Policy-72"><a href="#Policy-72"><span class="linenos">72</span></a>        <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="Policy-73"><a href="#Policy-73"><span class="linenos">73</span></a>        
</span><span id="Policy-74"><a href="#Policy-74"><span class="linenos">74</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sunset</span> <span class="ow">and</span> <span class="n">years_since_start</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_years</span><span class="p">:</span>
</span><span id="Policy-75"><a href="#Policy-75"><span class="linenos">75</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="Policy-76"><a href="#Policy-76"><span class="linenos">76</span></a>            
</span><span id="Policy-77"><a href="#Policy-77"><span class="linenos">77</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_years</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Policy-78"><a href="#Policy-78"><span class="linenos">78</span></a>            <span class="k">return</span> <span class="mf">1.0</span>
</span><span id="Policy-79"><a href="#Policy-79"><span class="linenos">79</span></a>            
</span><span id="Policy-80"><a href="#Policy-80"><span class="linenos">80</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">years_since_start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_years</span><span class="p">)</span>
</span><span id="Policy-81"><a href="#Policy-81"><span class="linenos">81</span></a>    
</span><span id="Policy-82"><a href="#Policy-82"><span class="linenos">82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Policy-83"><a href="#Policy-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if policy is active in a given year.&quot;&quot;&quot;</span>
</span><span id="Policy-84"><a href="#Policy-84"><span class="linenos">84</span></a>        <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">:</span>
</span><span id="Policy-85"><a href="#Policy-85"><span class="linenos">85</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Policy-86"><a href="#Policy-86"><span class="linenos">86</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sunset</span> <span class="ow">and</span> <span class="n">year</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_years</span><span class="p">:</span>
</span><span id="Policy-87"><a href="#Policy-87"><span class="linenos">87</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Policy-88"><a href="#Policy-88"><span class="linenos">88</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Base class for fiscal policy proposals.</p>

<p>Attributes:
    name: Short descriptive name
    description: Detailed description of the policy
    policy_type: Category of fiscal policy
    start_year: First year the policy takes effect
    duration_years: Number of years the policy is in effect (default 10 for CBO window)
    phase_in_years: Years to fully phase in the policy (default 1 = immediate)
    sunset: Whether the policy expires after duration_years</p>
</div>


                            <div id="Policy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Policy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Policy.__init__"></a>
    
    

                            </div>
                            <div id="Policy.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#Policy.name"></a>
    
    

                            </div>
                            <div id="Policy.description" class="classattr">
                                <div class="attr variable">
            <span class="name">description</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#Policy.description"></a>
    
    

                            </div>
                            <div id="Policy.policy_type" class="classattr">
                                <div class="attr variable">
            <span class="name">policy_type</span><span class="annotation">: <a href="#PolicyType">PolicyType</a></span>

        
    </div>
    <a class="headerlink" href="#Policy.policy_type"></a>
    
    

                            </div>
                            <div id="Policy.start_year" class="classattr">
                                <div class="attr variable">
            <span class="name">start_year</span><span class="annotation">: int</span>        =
<span class="default_value">2025</span>

        
    </div>
    <a class="headerlink" href="#Policy.start_year"></a>
    
    

                            </div>
                            <div id="Policy.duration_years" class="classattr">
                                <div class="attr variable">
            <span class="name">duration_years</span><span class="annotation">: int</span>        =
<span class="default_value">10</span>

        
    </div>
    <a class="headerlink" href="#Policy.duration_years"></a>
    
    

                            </div>
                            <div id="Policy.phase_in_years" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_in_years</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#Policy.phase_in_years"></a>
    
    

                            </div>
                            <div id="Policy.sunset" class="classattr">
                                <div class="attr variable">
            <span class="name">sunset</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#Policy.sunset"></a>
    
    

                            </div>
                            <div id="Policy.get_phase_in_factor" class="classattr">
                                        <input id="Policy.get_phase_in_factor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_phase_in_factor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Policy.get_phase_in_factor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Policy.get_phase_in_factor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Policy.get_phase_in_factor-64"><a href="#Policy.get_phase_in_factor-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_phase_in_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Policy.get_phase_in_factor-65"><a href="#Policy.get_phase_in_factor-65"><span class="linenos">65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Policy.get_phase_in_factor-66"><a href="#Policy.get_phase_in_factor-66"><span class="linenos">66</span></a><span class="sd">        Calculate the phase-in factor for a given year.</span>
</span><span id="Policy.get_phase_in_factor-67"><a href="#Policy.get_phase_in_factor-67"><span class="linenos">67</span></a><span class="sd">        Returns 0 if before start, 1 if fully phased in, fractional during phase-in.</span>
</span><span id="Policy.get_phase_in_factor-68"><a href="#Policy.get_phase_in_factor-68"><span class="linenos">68</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Policy.get_phase_in_factor-69"><a href="#Policy.get_phase_in_factor-69"><span class="linenos">69</span></a>        <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">:</span>
</span><span id="Policy.get_phase_in_factor-70"><a href="#Policy.get_phase_in_factor-70"><span class="linenos">70</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="Policy.get_phase_in_factor-71"><a href="#Policy.get_phase_in_factor-71"><span class="linenos">71</span></a>        
</span><span id="Policy.get_phase_in_factor-72"><a href="#Policy.get_phase_in_factor-72"><span class="linenos">72</span></a>        <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="Policy.get_phase_in_factor-73"><a href="#Policy.get_phase_in_factor-73"><span class="linenos">73</span></a>        
</span><span id="Policy.get_phase_in_factor-74"><a href="#Policy.get_phase_in_factor-74"><span class="linenos">74</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sunset</span> <span class="ow">and</span> <span class="n">years_since_start</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_years</span><span class="p">:</span>
</span><span id="Policy.get_phase_in_factor-75"><a href="#Policy.get_phase_in_factor-75"><span class="linenos">75</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="Policy.get_phase_in_factor-76"><a href="#Policy.get_phase_in_factor-76"><span class="linenos">76</span></a>            
</span><span id="Policy.get_phase_in_factor-77"><a href="#Policy.get_phase_in_factor-77"><span class="linenos">77</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_years</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Policy.get_phase_in_factor-78"><a href="#Policy.get_phase_in_factor-78"><span class="linenos">78</span></a>            <span class="k">return</span> <span class="mf">1.0</span>
</span><span id="Policy.get_phase_in_factor-79"><a href="#Policy.get_phase_in_factor-79"><span class="linenos">79</span></a>            
</span><span id="Policy.get_phase_in_factor-80"><a href="#Policy.get_phase_in_factor-80"><span class="linenos">80</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">years_since_start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_years</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the phase-in factor for a given year.
Returns 0 if before start, 1 if fully phased in, fractional during phase-in.</p>
</div>


                            </div>
                            <div id="Policy.is_active" class="classattr">
                                        <input id="Policy.is_active-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_active</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Policy.is_active-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Policy.is_active"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Policy.is_active-82"><a href="#Policy.is_active-82"><span class="linenos">82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Policy.is_active-83"><a href="#Policy.is_active-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if policy is active in a given year.&quot;&quot;&quot;</span>
</span><span id="Policy.is_active-84"><a href="#Policy.is_active-84"><span class="linenos">84</span></a>        <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">:</span>
</span><span id="Policy.is_active-85"><a href="#Policy.is_active-85"><span class="linenos">85</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Policy.is_active-86"><a href="#Policy.is_active-86"><span class="linenos">86</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sunset</span> <span class="ow">and</span> <span class="n">year</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_years</span><span class="p">:</span>
</span><span id="Policy.is_active-87"><a href="#Policy.is_active-87"><span class="linenos">87</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Policy.is_active-88"><a href="#Policy.is_active-88"><span class="linenos">88</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Check if policy is active in a given year.</p>
</div>


                            </div>
                </section>
                <section id="TaxPolicy">
                            <input id="TaxPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">TaxPolicy</span><wbr>(<span class="base"><a href="#Policy">fiscal_model.Policy</a></span>):

                <label class="view-source-button" for="TaxPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxPolicy-91"><a href="#TaxPolicy-91"><span class="linenos"> 91</span></a><span class="nd">@dataclass</span>
</span><span id="TaxPolicy-92"><a href="#TaxPolicy-92"><span class="linenos"> 92</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TaxPolicy</span><span class="p">(</span><span class="n">Policy</span><span class="p">):</span>
</span><span id="TaxPolicy-93"><a href="#TaxPolicy-93"><span class="linenos"> 93</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxPolicy-94"><a href="#TaxPolicy-94"><span class="linenos"> 94</span></a><span class="sd">    Tax policy proposal with detailed parameters.</span>
</span><span id="TaxPolicy-95"><a href="#TaxPolicy-95"><span class="linenos"> 95</span></a><span class="sd">    </span>
</span><span id="TaxPolicy-96"><a href="#TaxPolicy-96"><span class="linenos"> 96</span></a><span class="sd">    Supports various tax changes including rate changes, threshold changes,</span>
</span><span id="TaxPolicy-97"><a href="#TaxPolicy-97"><span class="linenos"> 97</span></a><span class="sd">    new credits/deductions, and base broadening.</span>
</span><span id="TaxPolicy-98"><a href="#TaxPolicy-98"><span class="linenos"> 98</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TaxPolicy-99"><a href="#TaxPolicy-99"><span class="linenos"> 99</span></a>    <span class="c1"># Rate changes</span>
</span><span id="TaxPolicy-100"><a href="#TaxPolicy-100"><span class="linenos">100</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in tax rate (e.g., -0.02 for 2pp reduction)</span>
</span><span id="TaxPolicy-101"><a href="#TaxPolicy-101"><span class="linenos">101</span></a>    <span class="n">new_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Alternative: specify new rate directly</span>
</span><span id="TaxPolicy-102"><a href="#TaxPolicy-102"><span class="linenos">102</span></a>    
</span><span id="TaxPolicy-103"><a href="#TaxPolicy-103"><span class="linenos">103</span></a>    <span class="c1"># Who is affected</span>
</span><span id="TaxPolicy-104"><a href="#TaxPolicy-104"><span class="linenos">104</span></a>    <span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Income threshold for applicability</span>
</span><span id="TaxPolicy-105"><a href="#TaxPolicy-105"><span class="linenos">105</span></a>    <span class="n">affected_income_cap</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Upper bound if applicable</span>
</span><span id="TaxPolicy-106"><a href="#TaxPolicy-106"><span class="linenos">106</span></a>    
</span><span id="TaxPolicy-107"><a href="#TaxPolicy-107"><span class="linenos">107</span></a>    <span class="c1"># For credits/deductions</span>
</span><span id="TaxPolicy-108"><a href="#TaxPolicy-108"><span class="linenos">108</span></a>    <span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Per-taxpayer credit amount</span>
</span><span id="TaxPolicy-109"><a href="#TaxPolicy-109"><span class="linenos">109</span></a>    <span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Is the credit refundable?</span>
</span><span id="TaxPolicy-110"><a href="#TaxPolicy-110"><span class="linenos">110</span></a>    <span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Deduction amount</span>
</span><span id="TaxPolicy-111"><a href="#TaxPolicy-111"><span class="linenos">111</span></a>    
</span><span id="TaxPolicy-112"><a href="#TaxPolicy-112"><span class="linenos">112</span></a>    <span class="c1"># Affected population</span>
</span><span id="TaxPolicy-113"><a href="#TaxPolicy-113"><span class="linenos">113</span></a>    <span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Estimated affected population</span>
</span><span id="TaxPolicy-114"><a href="#TaxPolicy-114"><span class="linenos">114</span></a>    
</span><span id="TaxPolicy-115"><a href="#TaxPolicy-115"><span class="linenos">115</span></a>    <span class="c1"># Behavioral parameters (CBO-style elasticities)</span>
</span><span id="TaxPolicy-116"><a href="#TaxPolicy-116"><span class="linenos">116</span></a>    <span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># ETI - key behavioral parameter</span>
</span><span id="TaxPolicy-117"><a href="#TaxPolicy-117"><span class="linenos">117</span></a>    <span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Compensated labor supply elasticity</span>
</span><span id="TaxPolicy-118"><a href="#TaxPolicy-118"><span class="linenos">118</span></a>    
</span><span id="TaxPolicy-119"><a href="#TaxPolicy-119"><span class="linenos">119</span></a>    <span class="c1"># Revenue estimate override (if known from external source)</span>
</span><span id="TaxPolicy-120"><a href="#TaxPolicy-120"><span class="linenos">120</span></a>    <span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TaxPolicy-121"><a href="#TaxPolicy-121"><span class="linenos">121</span></a>    
</span><span id="TaxPolicy-122"><a href="#TaxPolicy-122"><span class="linenos">122</span></a>    <span class="c1"># More granular inputs for accurate static estimation</span>
</span><span id="TaxPolicy-123"><a href="#TaxPolicy-123"><span class="linenos">123</span></a>    <span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Average taxable income of affected filers</span>
</span><span id="TaxPolicy-124"><a href="#TaxPolicy-124"><span class="linenos">124</span></a>    <span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Current marginal rate in affected bracket</span>
</span><span id="TaxPolicy-125"><a href="#TaxPolicy-125"><span class="linenos">125</span></a>
</span><span id="TaxPolicy-126"><a href="#TaxPolicy-126"><span class="linenos">126</span></a>    <span class="c1"># Data integration</span>
</span><span id="TaxPolicy-127"><a href="#TaxPolicy-127"><span class="linenos">127</span></a>    <span class="n">data_year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># IRS data year to use (None = most recent available)</span>
</span><span id="TaxPolicy-128"><a href="#TaxPolicy-128"><span class="linenos">128</span></a>
</span><span id="TaxPolicy-129"><a href="#TaxPolicy-129"><span class="linenos">129</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxPolicy-130"><a href="#TaxPolicy-130"><span class="linenos">130</span></a>                                       <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxPolicy-131"><a href="#TaxPolicy-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxPolicy-132"><a href="#TaxPolicy-132"><span class="linenos">132</span></a><span class="sd">        Estimate static revenue effect before behavioral responses.</span>
</span><span id="TaxPolicy-133"><a href="#TaxPolicy-133"><span class="linenos">133</span></a>
</span><span id="TaxPolicy-134"><a href="#TaxPolicy-134"><span class="linenos">134</span></a><span class="sd">        Uses the more accurate formula when bracket-level data is provided:</span>
</span><span id="TaxPolicy-135"><a href="#TaxPolicy-135"><span class="linenos">135</span></a><span class="sd">            Revenue Change = Rate Change  Taxable Income  Affected Taxpayers</span>
</span><span id="TaxPolicy-136"><a href="#TaxPolicy-136"><span class="linenos">136</span></a>
</span><span id="TaxPolicy-137"><a href="#TaxPolicy-137"><span class="linenos">137</span></a><span class="sd">        NEW: Can auto-populate parameters from IRS SOI data when available!</span>
</span><span id="TaxPolicy-138"><a href="#TaxPolicy-138"><span class="linenos">138</span></a>
</span><span id="TaxPolicy-139"><a href="#TaxPolicy-139"><span class="linenos">139</span></a><span class="sd">        Falls back to proportional estimation if granular data unavailable.</span>
</span><span id="TaxPolicy-140"><a href="#TaxPolicy-140"><span class="linenos">140</span></a>
</span><span id="TaxPolicy-141"><a href="#TaxPolicy-141"><span class="linenos">141</span></a><span class="sd">        Args:</span>
</span><span id="TaxPolicy-142"><a href="#TaxPolicy-142"><span class="linenos">142</span></a><span class="sd">            baseline_revenue: Baseline revenue in billions for affected tax</span>
</span><span id="TaxPolicy-143"><a href="#TaxPolicy-143"><span class="linenos">143</span></a><span class="sd">            use_real_data: If True, try to auto-populate from IRS SOI data</span>
</span><span id="TaxPolicy-144"><a href="#TaxPolicy-144"><span class="linenos">144</span></a>
</span><span id="TaxPolicy-145"><a href="#TaxPolicy-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="TaxPolicy-146"><a href="#TaxPolicy-146"><span class="linenos">146</span></a><span class="sd">            Change in revenue in billions (negative = revenue loss)</span>
</span><span id="TaxPolicy-147"><a href="#TaxPolicy-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxPolicy-148"><a href="#TaxPolicy-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxPolicy-149"><a href="#TaxPolicy-149"><span class="linenos">149</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="TaxPolicy-150"><a href="#TaxPolicy-150"><span class="linenos">150</span></a>
</span><span id="TaxPolicy-151"><a href="#TaxPolicy-151"><span class="linenos">151</span></a>        <span class="c1"># NEW: Try to auto-populate from IRS SOI data</span>
</span><span id="TaxPolicy-152"><a href="#TaxPolicy-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">use_real_data</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_use_irs_data</span><span class="p">():</span>
</span><span id="TaxPolicy-153"><a href="#TaxPolicy-153"><span class="linenos">153</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TaxPolicy-154"><a href="#TaxPolicy-154"><span class="linenos">154</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_from_irs_data</span><span class="p">(</span><span class="n">baseline_revenue</span><span class="p">)</span>
</span><span id="TaxPolicy-155"><a href="#TaxPolicy-155"><span class="linenos">155</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TaxPolicy-156"><a href="#TaxPolicy-156"><span class="linenos">156</span></a>                <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="TaxPolicy-157"><a href="#TaxPolicy-157"><span class="linenos">157</span></a>                <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="TaxPolicy-158"><a href="#TaxPolicy-158"><span class="linenos">158</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not use IRS data for auto-population: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TaxPolicy-159"><a href="#TaxPolicy-159"><span class="linenos">159</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Falling back to manual parameters or heuristics&quot;</span><span class="p">)</span>
</span><span id="TaxPolicy-160"><a href="#TaxPolicy-160"><span class="linenos">160</span></a>                <span class="c1"># Fall through to existing logic</span>
</span><span id="TaxPolicy-161"><a href="#TaxPolicy-161"><span class="linenos">161</span></a>
</span><span id="TaxPolicy-162"><a href="#TaxPolicy-162"><span class="linenos">162</span></a>        <span class="c1"># PREFERRED: Use bracket-level calculation if data provided</span>
</span><span id="TaxPolicy-163"><a href="#TaxPolicy-163"><span class="linenos">163</span></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> 
</span><span id="TaxPolicy-164"><a href="#TaxPolicy-164"><span class="linenos">164</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> 
</span><span id="TaxPolicy-165"><a href="#TaxPolicy-165"><span class="linenos">165</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">avg_taxable_income_in_bracket</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="TaxPolicy-166"><a href="#TaxPolicy-166"><span class="linenos">166</span></a>            <span class="c1"># Key insight: Rate changes apply only to MARGINAL income above threshold,</span>
</span><span id="TaxPolicy-167"><a href="#TaxPolicy-167"><span class="linenos">167</span></a>            <span class="c1"># not the entire income of affected filers.</span>
</span><span id="TaxPolicy-168"><a href="#TaxPolicy-168"><span class="linenos">168</span></a>            <span class="c1"># </span>
</span><span id="TaxPolicy-169"><a href="#TaxPolicy-169"><span class="linenos">169</span></a>            <span class="c1"># Example: For a $400K threshold, someone earning $500K only has $100K</span>
</span><span id="TaxPolicy-170"><a href="#TaxPolicy-170"><span class="linenos">170</span></a>            <span class="c1"># subject to the rate change, not the full $500K.</span>
</span><span id="TaxPolicy-171"><a href="#TaxPolicy-171"><span class="linenos">171</span></a>            <span class="c1">#</span>
</span><span id="TaxPolicy-172"><a href="#TaxPolicy-172"><span class="linenos">172</span></a>            <span class="c1"># Formula: Revenue = Rate  Marginal_Income  # Taxpayers</span>
</span><span id="TaxPolicy-173"><a href="#TaxPolicy-173"><span class="linenos">173</span></a>            <span class="c1"># where Marginal_Income = Avg_Income - Threshold</span>
</span><span id="TaxPolicy-174"><a href="#TaxPolicy-174"><span class="linenos">174</span></a>            
</span><span id="TaxPolicy-175"><a href="#TaxPolicy-175"><span class="linenos">175</span></a>            <span class="n">marginal_income</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_taxable_income_in_bracket</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span><span class="p">)</span>
</span><span id="TaxPolicy-176"><a href="#TaxPolicy-176"><span class="linenos">176</span></a>            
</span><span id="TaxPolicy-177"><a href="#TaxPolicy-177"><span class="linenos">177</span></a>            <span class="c1"># If threshold is 0 (affects all income), use full average income</span>
</span><span id="TaxPolicy-178"><a href="#TaxPolicy-178"><span class="linenos">178</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy-179"><a href="#TaxPolicy-179"><span class="linenos">179</span></a>                <span class="n">marginal_income</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_taxable_income_in_bracket</span>
</span><span id="TaxPolicy-180"><a href="#TaxPolicy-180"><span class="linenos">180</span></a>            
</span><span id="TaxPolicy-181"><a href="#TaxPolicy-181"><span class="linenos">181</span></a>            <span class="n">revenue_change</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="TaxPolicy-182"><a href="#TaxPolicy-182"><span class="linenos">182</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">*</span>  <span class="c1"># e.g., -0.02 for 2pp cut</span>
</span><span id="TaxPolicy-183"><a href="#TaxPolicy-183"><span class="linenos">183</span></a>                <span class="n">marginal_income</span> <span class="o">*</span>   <span class="c1"># income ABOVE threshold subject to rate change</span>
</span><span id="TaxPolicy-184"><a href="#TaxPolicy-184"><span class="linenos">184</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">*</span> <span class="mf">1e6</span>  <span class="c1"># convert to actual count</span>
</span><span id="TaxPolicy-185"><a href="#TaxPolicy-185"><span class="linenos">185</span></a>            <span class="p">)</span> <span class="o">/</span> <span class="mf">1e9</span>  <span class="c1"># convert to billions</span>
</span><span id="TaxPolicy-186"><a href="#TaxPolicy-186"><span class="linenos">186</span></a>            <span class="k">return</span> <span class="n">revenue_change</span>
</span><span id="TaxPolicy-187"><a href="#TaxPolicy-187"><span class="linenos">187</span></a>        
</span><span id="TaxPolicy-188"><a href="#TaxPolicy-188"><span class="linenos">188</span></a>        <span class="c1"># FALLBACK: Simple proportional estimation (less accurate)</span>
</span><span id="TaxPolicy-189"><a href="#TaxPolicy-189"><span class="linenos">189</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy-190"><a href="#TaxPolicy-190"><span class="linenos">190</span></a>            <span class="c1"># Estimate affected share of total revenue</span>
</span><span id="TaxPolicy-191"><a href="#TaxPolicy-191"><span class="linenos">191</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy-192"><a href="#TaxPolicy-192"><span class="linenos">192</span></a>                <span class="c1"># Higher thresholds affect smaller share of revenue</span>
</span><span id="TaxPolicy-193"><a href="#TaxPolicy-193"><span class="linenos">193</span></a>                <span class="c1"># Rough heuristic: income above $500K is ~20% of income tax base</span>
</span><span id="TaxPolicy-194"><a href="#TaxPolicy-194"><span class="linenos">194</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;=</span> <span class="mi">500000</span><span class="p">:</span>
</span><span id="TaxPolicy-195"><a href="#TaxPolicy-195"><span class="linenos">195</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.20</span>
</span><span id="TaxPolicy-196"><a href="#TaxPolicy-196"><span class="linenos">196</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;=</span> <span class="mi">200000</span><span class="p">:</span>
</span><span id="TaxPolicy-197"><a href="#TaxPolicy-197"><span class="linenos">197</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.40</span>
</span><span id="TaxPolicy-198"><a href="#TaxPolicy-198"><span class="linenos">198</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;=</span> <span class="mi">100000</span><span class="p">:</span>
</span><span id="TaxPolicy-199"><a href="#TaxPolicy-199"><span class="linenos">199</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.55</span>
</span><span id="TaxPolicy-200"><a href="#TaxPolicy-200"><span class="linenos">200</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;=</span> <span class="mi">50000</span><span class="p">:</span>
</span><span id="TaxPolicy-201"><a href="#TaxPolicy-201"><span class="linenos">201</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.75</span>
</span><span id="TaxPolicy-202"><a href="#TaxPolicy-202"><span class="linenos">202</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TaxPolicy-203"><a href="#TaxPolicy-203"><span class="linenos">203</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.90</span>
</span><span id="TaxPolicy-204"><a href="#TaxPolicy-204"><span class="linenos">204</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TaxPolicy-205"><a href="#TaxPolicy-205"><span class="linenos">205</span></a>                <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Affects all brackets</span>
</span><span id="TaxPolicy-206"><a href="#TaxPolicy-206"><span class="linenos">206</span></a>            
</span><span id="TaxPolicy-207"><a href="#TaxPolicy-207"><span class="linenos">207</span></a>            <span class="c1"># Revenue change = baseline  affected share  (rate change / avg rate)</span>
</span><span id="TaxPolicy-208"><a href="#TaxPolicy-208"><span class="linenos">208</span></a>            <span class="n">avg_effective_rate</span> <span class="o">=</span> <span class="mf">0.18</span>  <span class="c1"># Average effective income tax rate</span>
</span><span id="TaxPolicy-209"><a href="#TaxPolicy-209"><span class="linenos">209</span></a>            <span class="k">return</span> <span class="n">baseline_revenue</span> <span class="o">*</span> <span class="n">affected_share</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">/</span> <span class="n">avg_effective_rate</span><span class="p">)</span>
</span><span id="TaxPolicy-210"><a href="#TaxPolicy-210"><span class="linenos">210</span></a>            
</span><span id="TaxPolicy-211"><a href="#TaxPolicy-211"><span class="linenos">211</span></a>        <span class="c1"># Credit/deduction effects</span>
</span><span id="TaxPolicy-212"><a href="#TaxPolicy-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_amount</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy-213"><a href="#TaxPolicy-213"><span class="linenos">213</span></a>            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">credit_amount</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">/</span> <span class="mf">1e3</span>
</span><span id="TaxPolicy-214"><a href="#TaxPolicy-214"><span class="linenos">214</span></a>            
</span><span id="TaxPolicy-215"><a href="#TaxPolicy-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deduction_amount</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy-216"><a href="#TaxPolicy-216"><span class="linenos">216</span></a>            <span class="c1"># Deduction value depends on marginal rate</span>
</span><span id="TaxPolicy-217"><a href="#TaxPolicy-217"><span class="linenos">217</span></a>            <span class="n">marginal_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">marginal_rate_before</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">marginal_rate_before</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.25</span>
</span><span id="TaxPolicy-218"><a href="#TaxPolicy-218"><span class="linenos">218</span></a>            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">deduction_amount</span> <span class="o">*</span> <span class="n">marginal_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">/</span> <span class="mf">1e3</span>
</span><span id="TaxPolicy-219"><a href="#TaxPolicy-219"><span class="linenos">219</span></a>            
</span><span id="TaxPolicy-220"><a href="#TaxPolicy-220"><span class="linenos">220</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="TaxPolicy-221"><a href="#TaxPolicy-221"><span class="linenos">221</span></a>
</span><span id="TaxPolicy-222"><a href="#TaxPolicy-222"><span class="linenos">222</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_should_use_irs_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="TaxPolicy-223"><a href="#TaxPolicy-223"><span class="linenos">223</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxPolicy-224"><a href="#TaxPolicy-224"><span class="linenos">224</span></a><span class="sd">        Check if we should attempt to auto-populate from IRS SOI data.</span>
</span><span id="TaxPolicy-225"><a href="#TaxPolicy-225"><span class="linenos">225</span></a>
</span><span id="TaxPolicy-226"><a href="#TaxPolicy-226"><span class="linenos">226</span></a><span class="sd">        Returns True if:</span>
</span><span id="TaxPolicy-227"><a href="#TaxPolicy-227"><span class="linenos">227</span></a><span class="sd">        - Rate change is specified (non-zero)</span>
</span><span id="TaxPolicy-228"><a href="#TaxPolicy-228"><span class="linenos">228</span></a><span class="sd">        - Income threshold is specified</span>
</span><span id="TaxPolicy-229"><a href="#TaxPolicy-229"><span class="linenos">229</span></a><span class="sd">        - Manual parameters NOT already provided</span>
</span><span id="TaxPolicy-230"><a href="#TaxPolicy-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxPolicy-231"><a href="#TaxPolicy-231"><span class="linenos">231</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="TaxPolicy-232"><a href="#TaxPolicy-232"><span class="linenos">232</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span>
</span><span id="TaxPolicy-233"><a href="#TaxPolicy-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span>
</span><span id="TaxPolicy-234"><a href="#TaxPolicy-234"><span class="linenos">234</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">==</span> <span class="mi">0</span>  <span class="c1"># Not manually specified</span>
</span><span id="TaxPolicy-235"><a href="#TaxPolicy-235"><span class="linenos">235</span></a>        <span class="p">)</span>
</span><span id="TaxPolicy-236"><a href="#TaxPolicy-236"><span class="linenos">236</span></a>
</span><span id="TaxPolicy-237"><a href="#TaxPolicy-237"><span class="linenos">237</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_estimate_from_irs_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxPolicy-238"><a href="#TaxPolicy-238"><span class="linenos">238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxPolicy-239"><a href="#TaxPolicy-239"><span class="linenos">239</span></a><span class="sd">        Auto-populate parameters from IRS SOI data and estimate revenue effect.</span>
</span><span id="TaxPolicy-240"><a href="#TaxPolicy-240"><span class="linenos">240</span></a>
</span><span id="TaxPolicy-241"><a href="#TaxPolicy-241"><span class="linenos">241</span></a><span class="sd">        This method automatically looks up:</span>
</span><span id="TaxPolicy-242"><a href="#TaxPolicy-242"><span class="linenos">242</span></a><span class="sd">        - Number of filers above the income threshold</span>
</span><span id="TaxPolicy-243"><a href="#TaxPolicy-243"><span class="linenos">243</span></a><span class="sd">        - Average taxable income in affected brackets</span>
</span><span id="TaxPolicy-244"><a href="#TaxPolicy-244"><span class="linenos">244</span></a><span class="sd">        - Total tax liability</span>
</span><span id="TaxPolicy-245"><a href="#TaxPolicy-245"><span class="linenos">245</span></a>
</span><span id="TaxPolicy-246"><a href="#TaxPolicy-246"><span class="linenos">246</span></a><span class="sd">        Args:</span>
</span><span id="TaxPolicy-247"><a href="#TaxPolicy-247"><span class="linenos">247</span></a><span class="sd">            baseline_revenue: Baseline revenue (not used in this method)</span>
</span><span id="TaxPolicy-248"><a href="#TaxPolicy-248"><span class="linenos">248</span></a>
</span><span id="TaxPolicy-249"><a href="#TaxPolicy-249"><span class="linenos">249</span></a><span class="sd">        Returns:</span>
</span><span id="TaxPolicy-250"><a href="#TaxPolicy-250"><span class="linenos">250</span></a><span class="sd">            Revenue change in billions</span>
</span><span id="TaxPolicy-251"><a href="#TaxPolicy-251"><span class="linenos">251</span></a>
</span><span id="TaxPolicy-252"><a href="#TaxPolicy-252"><span class="linenos">252</span></a><span class="sd">        Raises:</span>
</span><span id="TaxPolicy-253"><a href="#TaxPolicy-253"><span class="linenos">253</span></a><span class="sd">            FileNotFoundError: If IRS SOI data files not available</span>
</span><span id="TaxPolicy-254"><a href="#TaxPolicy-254"><span class="linenos">254</span></a><span class="sd">            ValueError: If data lookup fails</span>
</span><span id="TaxPolicy-255"><a href="#TaxPolicy-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxPolicy-256"><a href="#TaxPolicy-256"><span class="linenos">256</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="TaxPolicy-257"><a href="#TaxPolicy-257"><span class="linenos">257</span></a>        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="TaxPolicy-258"><a href="#TaxPolicy-258"><span class="linenos">258</span></a>
</span><span id="TaxPolicy-259"><a href="#TaxPolicy-259"><span class="linenos">259</span></a>        <span class="c1"># Import here to avoid circular dependency</span>
</span><span id="TaxPolicy-260"><a href="#TaxPolicy-260"><span class="linenos">260</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">fiscal_model.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">IRSSOIData</span>
</span><span id="TaxPolicy-261"><a href="#TaxPolicy-261"><span class="linenos">261</span></a>
</span><span id="TaxPolicy-262"><a href="#TaxPolicy-262"><span class="linenos">262</span></a>        <span class="c1"># Initialize data loader</span>
</span><span id="TaxPolicy-263"><a href="#TaxPolicy-263"><span class="linenos">263</span></a>        <span class="n">irs_data</span> <span class="o">=</span> <span class="n">IRSSOIData</span><span class="p">()</span>
</span><span id="TaxPolicy-264"><a href="#TaxPolicy-264"><span class="linenos">264</span></a>
</span><span id="TaxPolicy-265"><a href="#TaxPolicy-265"><span class="linenos">265</span></a>        <span class="c1"># Get most recent available data year (or use specified year)</span>
</span><span id="TaxPolicy-266"><a href="#TaxPolicy-266"><span class="linenos">266</span></a>        <span class="n">available_years</span> <span class="o">=</span> <span class="n">irs_data</span><span class="o">.</span><span class="n">get_data_years_available</span><span class="p">()</span>
</span><span id="TaxPolicy-267"><a href="#TaxPolicy-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">available_years</span><span class="p">:</span>
</span><span id="TaxPolicy-268"><a href="#TaxPolicy-268"><span class="linenos">268</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
</span><span id="TaxPolicy-269"><a href="#TaxPolicy-269"><span class="linenos">269</span></a>                <span class="s2">&quot;No IRS SOI data files found. &quot;</span>
</span><span id="TaxPolicy-270"><a href="#TaxPolicy-270"><span class="linenos">270</span></a>                <span class="s2">&quot;See fiscal_model/data_files/irs_soi/README.md for download instructions.&quot;</span>
</span><span id="TaxPolicy-271"><a href="#TaxPolicy-271"><span class="linenos">271</span></a>            <span class="p">)</span>
</span><span id="TaxPolicy-272"><a href="#TaxPolicy-272"><span class="linenos">272</span></a>
</span><span id="TaxPolicy-273"><a href="#TaxPolicy-273"><span class="linenos">273</span></a>        <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_year</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_year</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="n">available_years</span><span class="p">)</span>
</span><span id="TaxPolicy-274"><a href="#TaxPolicy-274"><span class="linenos">274</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto-populating tax policy parameters from </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2"> IRS SOI data&quot;</span><span class="p">)</span>
</span><span id="TaxPolicy-275"><a href="#TaxPolicy-275"><span class="linenos">275</span></a>
</span><span id="TaxPolicy-276"><a href="#TaxPolicy-276"><span class="linenos">276</span></a>        <span class="c1"># Get filer statistics for income above threshold</span>
</span><span id="TaxPolicy-277"><a href="#TaxPolicy-277"><span class="linenos">277</span></a>        <span class="n">bracket_info</span> <span class="o">=</span> <span class="n">irs_data</span><span class="o">.</span><span class="n">get_filers_by_bracket</span><span class="p">(</span>
</span><span id="TaxPolicy-278"><a href="#TaxPolicy-278"><span class="linenos">278</span></a>            <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
</span><span id="TaxPolicy-279"><a href="#TaxPolicy-279"><span class="linenos">279</span></a>            <span class="n">threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span>
</span><span id="TaxPolicy-280"><a href="#TaxPolicy-280"><span class="linenos">280</span></a>        <span class="p">)</span>
</span><span id="TaxPolicy-281"><a href="#TaxPolicy-281"><span class="linenos">281</span></a>
</span><span id="TaxPolicy-282"><a href="#TaxPolicy-282"><span class="linenos">282</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="TaxPolicy-283"><a href="#TaxPolicy-283"><span class="linenos">283</span></a>            <span class="sa">f</span><span class="s2">&quot;  Affected filers: </span><span class="si">{</span><span class="n">bracket_info</span><span class="p">[</span><span class="s1">&#39;num_filers&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">M &quot;</span>
</span><span id="TaxPolicy-284"><a href="#TaxPolicy-284"><span class="linenos">284</span></a>            <span class="sa">f</span><span class="s2">&quot;(threshold: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="TaxPolicy-285"><a href="#TaxPolicy-285"><span class="linenos">285</span></a>        <span class="p">)</span>
</span><span id="TaxPolicy-286"><a href="#TaxPolicy-286"><span class="linenos">286</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="TaxPolicy-287"><a href="#TaxPolicy-287"><span class="linenos">287</span></a>            <span class="sa">f</span><span class="s2">&quot;  Avg taxable income: $</span><span class="si">{</span><span class="n">bracket_info</span><span class="p">[</span><span class="s1">&#39;avg_taxable_income&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="TaxPolicy-288"><a href="#TaxPolicy-288"><span class="linenos">288</span></a>        <span class="p">)</span>
</span><span id="TaxPolicy-289"><a href="#TaxPolicy-289"><span class="linenos">289</span></a>
</span><span id="TaxPolicy-290"><a href="#TaxPolicy-290"><span class="linenos">290</span></a>        <span class="c1"># Update policy object with auto-populated values (so UI can display them)</span>
</span><span id="TaxPolicy-291"><a href="#TaxPolicy-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">=</span> <span class="n">bracket_info</span><span class="p">[</span><span class="s1">&#39;num_filers&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e6</span>
</span><span id="TaxPolicy-292"><a href="#TaxPolicy-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">avg_taxable_income_in_bracket</span> <span class="o">=</span> <span class="n">bracket_info</span><span class="p">[</span><span class="s1">&#39;avg_taxable_income&#39;</span><span class="p">]</span>
</span><span id="TaxPolicy-293"><a href="#TaxPolicy-293"><span class="linenos">293</span></a>
</span><span id="TaxPolicy-294"><a href="#TaxPolicy-294"><span class="linenos">294</span></a>        <span class="c1"># Calculate MARGINAL income (income above threshold)</span>
</span><span id="TaxPolicy-295"><a href="#TaxPolicy-295"><span class="linenos">295</span></a>        <span class="n">marginal_income</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bracket_info</span><span class="p">[</span><span class="s1">&#39;avg_taxable_income&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span><span class="p">)</span>
</span><span id="TaxPolicy-296"><a href="#TaxPolicy-296"><span class="linenos">296</span></a>
</span><span id="TaxPolicy-297"><a href="#TaxPolicy-297"><span class="linenos">297</span></a>        <span class="c1"># If threshold is 0 (affects all income), use full average income</span>
</span><span id="TaxPolicy-298"><a href="#TaxPolicy-298"><span class="linenos">298</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy-299"><a href="#TaxPolicy-299"><span class="linenos">299</span></a>            <span class="n">marginal_income</span> <span class="o">=</span> <span class="n">bracket_info</span><span class="p">[</span><span class="s1">&#39;avg_taxable_income&#39;</span><span class="p">]</span>
</span><span id="TaxPolicy-300"><a href="#TaxPolicy-300"><span class="linenos">300</span></a>
</span><span id="TaxPolicy-301"><a href="#TaxPolicy-301"><span class="linenos">301</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="TaxPolicy-302"><a href="#TaxPolicy-302"><span class="linenos">302</span></a>            <span class="sa">f</span><span class="s2">&quot;  Avg total income: $</span><span class="si">{</span><span class="n">bracket_info</span><span class="p">[</span><span class="s1">&#39;avg_taxable_income&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="TaxPolicy-303"><a href="#TaxPolicy-303"><span class="linenos">303</span></a>        <span class="p">)</span>
</span><span id="TaxPolicy-304"><a href="#TaxPolicy-304"><span class="linenos">304</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="TaxPolicy-305"><a href="#TaxPolicy-305"><span class="linenos">305</span></a>            <span class="sa">f</span><span class="s2">&quot;  Marginal income above $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">: $</span><span class="si">{</span><span class="n">marginal_income</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="TaxPolicy-306"><a href="#TaxPolicy-306"><span class="linenos">306</span></a>        <span class="p">)</span>
</span><span id="TaxPolicy-307"><a href="#TaxPolicy-307"><span class="linenos">307</span></a>
</span><span id="TaxPolicy-308"><a href="#TaxPolicy-308"><span class="linenos">308</span></a>        <span class="c1"># Calculate revenue change using MARGINAL income</span>
</span><span id="TaxPolicy-309"><a href="#TaxPolicy-309"><span class="linenos">309</span></a>        <span class="n">revenue_change</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="TaxPolicy-310"><a href="#TaxPolicy-310"><span class="linenos">310</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">*</span>
</span><span id="TaxPolicy-311"><a href="#TaxPolicy-311"><span class="linenos">311</span></a>            <span class="n">marginal_income</span> <span class="o">*</span>
</span><span id="TaxPolicy-312"><a href="#TaxPolicy-312"><span class="linenos">312</span></a>            <span class="n">bracket_info</span><span class="p">[</span><span class="s1">&#39;num_filers&#39;</span><span class="p">]</span>
</span><span id="TaxPolicy-313"><a href="#TaxPolicy-313"><span class="linenos">313</span></a>        <span class="p">)</span> <span class="o">/</span> <span class="mf">1e9</span>  <span class="c1"># Convert to billions</span>
</span><span id="TaxPolicy-314"><a href="#TaxPolicy-314"><span class="linenos">314</span></a>
</span><span id="TaxPolicy-315"><a href="#TaxPolicy-315"><span class="linenos">315</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="TaxPolicy-316"><a href="#TaxPolicy-316"><span class="linenos">316</span></a>            <span class="sa">f</span><span class="s2">&quot;  Estimated revenue change: $</span><span class="si">{</span><span class="n">revenue_change</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">B &quot;</span>
</span><span id="TaxPolicy-317"><a href="#TaxPolicy-317"><span class="linenos">317</span></a>            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">+.1f</span><span class="si">}</span><span class="s2">pp rate change)&quot;</span>
</span><span id="TaxPolicy-318"><a href="#TaxPolicy-318"><span class="linenos">318</span></a>        <span class="p">)</span>
</span><span id="TaxPolicy-319"><a href="#TaxPolicy-319"><span class="linenos">319</span></a>
</span><span id="TaxPolicy-320"><a href="#TaxPolicy-320"><span class="linenos">320</span></a>        <span class="k">return</span> <span class="n">revenue_change</span>
</span><span id="TaxPolicy-321"><a href="#TaxPolicy-321"><span class="linenos">321</span></a>
</span><span id="TaxPolicy-322"><a href="#TaxPolicy-322"><span class="linenos">322</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxPolicy-323"><a href="#TaxPolicy-323"><span class="linenos">323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxPolicy-324"><a href="#TaxPolicy-324"><span class="linenos">324</span></a><span class="sd">        Estimate behavioral response offset to static revenue estimate.</span>
</span><span id="TaxPolicy-325"><a href="#TaxPolicy-325"><span class="linenos">325</span></a><span class="sd">        Uses elasticity of taxable income (ETI) approach.</span>
</span><span id="TaxPolicy-326"><a href="#TaxPolicy-326"><span class="linenos">326</span></a>
</span><span id="TaxPolicy-327"><a href="#TaxPolicy-327"><span class="linenos">327</span></a><span class="sd">        The behavioral offset represents REVENUE LOST due to behavioral response:</span>
</span><span id="TaxPolicy-328"><a href="#TaxPolicy-328"><span class="linenos">328</span></a><span class="sd">        - Tax INCREASE: People reduce taxable income  positive offset (lost revenue)</span>
</span><span id="TaxPolicy-329"><a href="#TaxPolicy-329"><span class="linenos">329</span></a><span class="sd">        - Tax CUT: People increase taxable income  negative offset (recovered revenue)</span>
</span><span id="TaxPolicy-330"><a href="#TaxPolicy-330"><span class="linenos">330</span></a>
</span><span id="TaxPolicy-331"><a href="#TaxPolicy-331"><span class="linenos">331</span></a><span class="sd">        This offset is ADDED to static deficit to get final deficit effect.</span>
</span><span id="TaxPolicy-332"><a href="#TaxPolicy-332"><span class="linenos">332</span></a>
</span><span id="TaxPolicy-333"><a href="#TaxPolicy-333"><span class="linenos">333</span></a><span class="sd">        Returns:</span>
</span><span id="TaxPolicy-334"><a href="#TaxPolicy-334"><span class="linenos">334</span></a><span class="sd">            Behavioral offset in billions (positive = revenue lost, increases deficit)</span>
</span><span id="TaxPolicy-335"><a href="#TaxPolicy-335"><span class="linenos">335</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxPolicy-336"><a href="#TaxPolicy-336"><span class="linenos">336</span></a>        <span class="c1"># Behavioral response reduces revenue from tax increases (positive offset)</span>
</span><span id="TaxPolicy-337"><a href="#TaxPolicy-337"><span class="linenos">337</span></a>        <span class="c1"># and recovers some revenue from tax cuts (negative offset)</span>
</span><span id="TaxPolicy-338"><a href="#TaxPolicy-338"><span class="linenos">338</span></a>        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxable_income_elasticity</span> <span class="o">*</span> <span class="mf">0.5</span>
</span></pre></div>


            <div class="docstring"><p>Tax policy proposal with detailed parameters.</p>

<p>Supports various tax changes including rate changes, threshold changes,
new credits/deductions, and base broadening.</p>
</div>


                            <div id="TaxPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TaxPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.__init__"></a>
    
    

                            </div>
                            <div id="TaxPolicy.rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.rate_change"></a>
    
    

                            </div>
                            <div id="TaxPolicy.new_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">new_rate</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.new_rate"></a>
    
    

                            </div>
                            <div id="TaxPolicy.affected_income_threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">affected_income_threshold</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.affected_income_threshold"></a>
    
    

                            </div>
                            <div id="TaxPolicy.affected_income_cap" class="classattr">
                                <div class="attr variable">
            <span class="name">affected_income_cap</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.affected_income_cap"></a>
    
    

                            </div>
                            <div id="TaxPolicy.credit_amount" class="classattr">
                                <div class="attr variable">
            <span class="name">credit_amount</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.credit_amount"></a>
    
    

                            </div>
                            <div id="TaxPolicy.credit_refundable" class="classattr">
                                <div class="attr variable">
            <span class="name">credit_refundable</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.credit_refundable"></a>
    
    

                            </div>
                            <div id="TaxPolicy.deduction_amount" class="classattr">
                                <div class="attr variable">
            <span class="name">deduction_amount</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.deduction_amount"></a>
    
    

                            </div>
                            <div id="TaxPolicy.affected_taxpayers_millions" class="classattr">
                                <div class="attr variable">
            <span class="name">affected_taxpayers_millions</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.affected_taxpayers_millions"></a>
    
    

                            </div>
                            <div id="TaxPolicy.taxable_income_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">taxable_income_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.25</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.taxable_income_elasticity"></a>
    
    

                            </div>
                            <div id="TaxPolicy.labor_supply_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">labor_supply_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.1</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.labor_supply_elasticity"></a>
    
    

                            </div>
                            <div id="TaxPolicy.annual_revenue_change_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_revenue_change_billions</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.annual_revenue_change_billions"></a>
    
    

                            </div>
                            <div id="TaxPolicy.avg_taxable_income_in_bracket" class="classattr">
                                <div class="attr variable">
            <span class="name">avg_taxable_income_in_bracket</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.avg_taxable_income_in_bracket"></a>
    
    

                            </div>
                            <div id="TaxPolicy.marginal_rate_before" class="classattr">
                                <div class="attr variable">
            <span class="name">marginal_rate_before</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.marginal_rate_before"></a>
    
    

                            </div>
                            <div id="TaxPolicy.data_year" class="classattr">
                                <div class="attr variable">
            <span class="name">data_year</span><span class="annotation">: int | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxPolicy.data_year"></a>
    
    

                            </div>
                            <div id="TaxPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="TaxPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TaxPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxPolicy.estimate_static_revenue_effect-129"><a href="#TaxPolicy.estimate_static_revenue_effect-129"><span class="linenos">129</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-130"><a href="#TaxPolicy.estimate_static_revenue_effect-130"><span class="linenos">130</span></a>                                       <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-131"><a href="#TaxPolicy.estimate_static_revenue_effect-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-132"><a href="#TaxPolicy.estimate_static_revenue_effect-132"><span class="linenos">132</span></a><span class="sd">        Estimate static revenue effect before behavioral responses.</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-133"><a href="#TaxPolicy.estimate_static_revenue_effect-133"><span class="linenos">133</span></a>
</span><span id="TaxPolicy.estimate_static_revenue_effect-134"><a href="#TaxPolicy.estimate_static_revenue_effect-134"><span class="linenos">134</span></a><span class="sd">        Uses the more accurate formula when bracket-level data is provided:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-135"><a href="#TaxPolicy.estimate_static_revenue_effect-135"><span class="linenos">135</span></a><span class="sd">            Revenue Change = Rate Change  Taxable Income  Affected Taxpayers</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-136"><a href="#TaxPolicy.estimate_static_revenue_effect-136"><span class="linenos">136</span></a>
</span><span id="TaxPolicy.estimate_static_revenue_effect-137"><a href="#TaxPolicy.estimate_static_revenue_effect-137"><span class="linenos">137</span></a><span class="sd">        NEW: Can auto-populate parameters from IRS SOI data when available!</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-138"><a href="#TaxPolicy.estimate_static_revenue_effect-138"><span class="linenos">138</span></a>
</span><span id="TaxPolicy.estimate_static_revenue_effect-139"><a href="#TaxPolicy.estimate_static_revenue_effect-139"><span class="linenos">139</span></a><span class="sd">        Falls back to proportional estimation if granular data unavailable.</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-140"><a href="#TaxPolicy.estimate_static_revenue_effect-140"><span class="linenos">140</span></a>
</span><span id="TaxPolicy.estimate_static_revenue_effect-141"><a href="#TaxPolicy.estimate_static_revenue_effect-141"><span class="linenos">141</span></a><span class="sd">        Args:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-142"><a href="#TaxPolicy.estimate_static_revenue_effect-142"><span class="linenos">142</span></a><span class="sd">            baseline_revenue: Baseline revenue in billions for affected tax</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-143"><a href="#TaxPolicy.estimate_static_revenue_effect-143"><span class="linenos">143</span></a><span class="sd">            use_real_data: If True, try to auto-populate from IRS SOI data</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-144"><a href="#TaxPolicy.estimate_static_revenue_effect-144"><span class="linenos">144</span></a>
</span><span id="TaxPolicy.estimate_static_revenue_effect-145"><a href="#TaxPolicy.estimate_static_revenue_effect-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-146"><a href="#TaxPolicy.estimate_static_revenue_effect-146"><span class="linenos">146</span></a><span class="sd">            Change in revenue in billions (negative = revenue loss)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-147"><a href="#TaxPolicy.estimate_static_revenue_effect-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-148"><a href="#TaxPolicy.estimate_static_revenue_effect-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-149"><a href="#TaxPolicy.estimate_static_revenue_effect-149"><span class="linenos">149</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-150"><a href="#TaxPolicy.estimate_static_revenue_effect-150"><span class="linenos">150</span></a>
</span><span id="TaxPolicy.estimate_static_revenue_effect-151"><a href="#TaxPolicy.estimate_static_revenue_effect-151"><span class="linenos">151</span></a>        <span class="c1"># NEW: Try to auto-populate from IRS SOI data</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-152"><a href="#TaxPolicy.estimate_static_revenue_effect-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">use_real_data</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_use_irs_data</span><span class="p">():</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-153"><a href="#TaxPolicy.estimate_static_revenue_effect-153"><span class="linenos">153</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-154"><a href="#TaxPolicy.estimate_static_revenue_effect-154"><span class="linenos">154</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_from_irs_data</span><span class="p">(</span><span class="n">baseline_revenue</span><span class="p">)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-155"><a href="#TaxPolicy.estimate_static_revenue_effect-155"><span class="linenos">155</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-156"><a href="#TaxPolicy.estimate_static_revenue_effect-156"><span class="linenos">156</span></a>                <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-157"><a href="#TaxPolicy.estimate_static_revenue_effect-157"><span class="linenos">157</span></a>                <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-158"><a href="#TaxPolicy.estimate_static_revenue_effect-158"><span class="linenos">158</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not use IRS data for auto-population: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-159"><a href="#TaxPolicy.estimate_static_revenue_effect-159"><span class="linenos">159</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Falling back to manual parameters or heuristics&quot;</span><span class="p">)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-160"><a href="#TaxPolicy.estimate_static_revenue_effect-160"><span class="linenos">160</span></a>                <span class="c1"># Fall through to existing logic</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-161"><a href="#TaxPolicy.estimate_static_revenue_effect-161"><span class="linenos">161</span></a>
</span><span id="TaxPolicy.estimate_static_revenue_effect-162"><a href="#TaxPolicy.estimate_static_revenue_effect-162"><span class="linenos">162</span></a>        <span class="c1"># PREFERRED: Use bracket-level calculation if data provided</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-163"><a href="#TaxPolicy.estimate_static_revenue_effect-163"><span class="linenos">163</span></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> 
</span><span id="TaxPolicy.estimate_static_revenue_effect-164"><a href="#TaxPolicy.estimate_static_revenue_effect-164"><span class="linenos">164</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> 
</span><span id="TaxPolicy.estimate_static_revenue_effect-165"><a href="#TaxPolicy.estimate_static_revenue_effect-165"><span class="linenos">165</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">avg_taxable_income_in_bracket</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-166"><a href="#TaxPolicy.estimate_static_revenue_effect-166"><span class="linenos">166</span></a>            <span class="c1"># Key insight: Rate changes apply only to MARGINAL income above threshold,</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-167"><a href="#TaxPolicy.estimate_static_revenue_effect-167"><span class="linenos">167</span></a>            <span class="c1"># not the entire income of affected filers.</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-168"><a href="#TaxPolicy.estimate_static_revenue_effect-168"><span class="linenos">168</span></a>            <span class="c1"># </span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-169"><a href="#TaxPolicy.estimate_static_revenue_effect-169"><span class="linenos">169</span></a>            <span class="c1"># Example: For a $400K threshold, someone earning $500K only has $100K</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-170"><a href="#TaxPolicy.estimate_static_revenue_effect-170"><span class="linenos">170</span></a>            <span class="c1"># subject to the rate change, not the full $500K.</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-171"><a href="#TaxPolicy.estimate_static_revenue_effect-171"><span class="linenos">171</span></a>            <span class="c1">#</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-172"><a href="#TaxPolicy.estimate_static_revenue_effect-172"><span class="linenos">172</span></a>            <span class="c1"># Formula: Revenue = Rate  Marginal_Income  # Taxpayers</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-173"><a href="#TaxPolicy.estimate_static_revenue_effect-173"><span class="linenos">173</span></a>            <span class="c1"># where Marginal_Income = Avg_Income - Threshold</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-174"><a href="#TaxPolicy.estimate_static_revenue_effect-174"><span class="linenos">174</span></a>            
</span><span id="TaxPolicy.estimate_static_revenue_effect-175"><a href="#TaxPolicy.estimate_static_revenue_effect-175"><span class="linenos">175</span></a>            <span class="n">marginal_income</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_taxable_income_in_bracket</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span><span class="p">)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-176"><a href="#TaxPolicy.estimate_static_revenue_effect-176"><span class="linenos">176</span></a>            
</span><span id="TaxPolicy.estimate_static_revenue_effect-177"><a href="#TaxPolicy.estimate_static_revenue_effect-177"><span class="linenos">177</span></a>            <span class="c1"># If threshold is 0 (affects all income), use full average income</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-178"><a href="#TaxPolicy.estimate_static_revenue_effect-178"><span class="linenos">178</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-179"><a href="#TaxPolicy.estimate_static_revenue_effect-179"><span class="linenos">179</span></a>                <span class="n">marginal_income</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_taxable_income_in_bracket</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-180"><a href="#TaxPolicy.estimate_static_revenue_effect-180"><span class="linenos">180</span></a>            
</span><span id="TaxPolicy.estimate_static_revenue_effect-181"><a href="#TaxPolicy.estimate_static_revenue_effect-181"><span class="linenos">181</span></a>            <span class="n">revenue_change</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-182"><a href="#TaxPolicy.estimate_static_revenue_effect-182"><span class="linenos">182</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">*</span>  <span class="c1"># e.g., -0.02 for 2pp cut</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-183"><a href="#TaxPolicy.estimate_static_revenue_effect-183"><span class="linenos">183</span></a>                <span class="n">marginal_income</span> <span class="o">*</span>   <span class="c1"># income ABOVE threshold subject to rate change</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-184"><a href="#TaxPolicy.estimate_static_revenue_effect-184"><span class="linenos">184</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">*</span> <span class="mf">1e6</span>  <span class="c1"># convert to actual count</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-185"><a href="#TaxPolicy.estimate_static_revenue_effect-185"><span class="linenos">185</span></a>            <span class="p">)</span> <span class="o">/</span> <span class="mf">1e9</span>  <span class="c1"># convert to billions</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-186"><a href="#TaxPolicy.estimate_static_revenue_effect-186"><span class="linenos">186</span></a>            <span class="k">return</span> <span class="n">revenue_change</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-187"><a href="#TaxPolicy.estimate_static_revenue_effect-187"><span class="linenos">187</span></a>        
</span><span id="TaxPolicy.estimate_static_revenue_effect-188"><a href="#TaxPolicy.estimate_static_revenue_effect-188"><span class="linenos">188</span></a>        <span class="c1"># FALLBACK: Simple proportional estimation (less accurate)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-189"><a href="#TaxPolicy.estimate_static_revenue_effect-189"><span class="linenos">189</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-190"><a href="#TaxPolicy.estimate_static_revenue_effect-190"><span class="linenos">190</span></a>            <span class="c1"># Estimate affected share of total revenue</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-191"><a href="#TaxPolicy.estimate_static_revenue_effect-191"><span class="linenos">191</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-192"><a href="#TaxPolicy.estimate_static_revenue_effect-192"><span class="linenos">192</span></a>                <span class="c1"># Higher thresholds affect smaller share of revenue</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-193"><a href="#TaxPolicy.estimate_static_revenue_effect-193"><span class="linenos">193</span></a>                <span class="c1"># Rough heuristic: income above $500K is ~20% of income tax base</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-194"><a href="#TaxPolicy.estimate_static_revenue_effect-194"><span class="linenos">194</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;=</span> <span class="mi">500000</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-195"><a href="#TaxPolicy.estimate_static_revenue_effect-195"><span class="linenos">195</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.20</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-196"><a href="#TaxPolicy.estimate_static_revenue_effect-196"><span class="linenos">196</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;=</span> <span class="mi">200000</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-197"><a href="#TaxPolicy.estimate_static_revenue_effect-197"><span class="linenos">197</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.40</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-198"><a href="#TaxPolicy.estimate_static_revenue_effect-198"><span class="linenos">198</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;=</span> <span class="mi">100000</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-199"><a href="#TaxPolicy.estimate_static_revenue_effect-199"><span class="linenos">199</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.55</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-200"><a href="#TaxPolicy.estimate_static_revenue_effect-200"><span class="linenos">200</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span> <span class="o">&gt;=</span> <span class="mi">50000</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-201"><a href="#TaxPolicy.estimate_static_revenue_effect-201"><span class="linenos">201</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.75</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-202"><a href="#TaxPolicy.estimate_static_revenue_effect-202"><span class="linenos">202</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-203"><a href="#TaxPolicy.estimate_static_revenue_effect-203"><span class="linenos">203</span></a>                    <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">0.90</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-204"><a href="#TaxPolicy.estimate_static_revenue_effect-204"><span class="linenos">204</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-205"><a href="#TaxPolicy.estimate_static_revenue_effect-205"><span class="linenos">205</span></a>                <span class="n">affected_share</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Affects all brackets</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-206"><a href="#TaxPolicy.estimate_static_revenue_effect-206"><span class="linenos">206</span></a>            
</span><span id="TaxPolicy.estimate_static_revenue_effect-207"><a href="#TaxPolicy.estimate_static_revenue_effect-207"><span class="linenos">207</span></a>            <span class="c1"># Revenue change = baseline  affected share  (rate change / avg rate)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-208"><a href="#TaxPolicy.estimate_static_revenue_effect-208"><span class="linenos">208</span></a>            <span class="n">avg_effective_rate</span> <span class="o">=</span> <span class="mf">0.18</span>  <span class="c1"># Average effective income tax rate</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-209"><a href="#TaxPolicy.estimate_static_revenue_effect-209"><span class="linenos">209</span></a>            <span class="k">return</span> <span class="n">baseline_revenue</span> <span class="o">*</span> <span class="n">affected_share</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">/</span> <span class="n">avg_effective_rate</span><span class="p">)</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-210"><a href="#TaxPolicy.estimate_static_revenue_effect-210"><span class="linenos">210</span></a>            
</span><span id="TaxPolicy.estimate_static_revenue_effect-211"><a href="#TaxPolicy.estimate_static_revenue_effect-211"><span class="linenos">211</span></a>        <span class="c1"># Credit/deduction effects</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-212"><a href="#TaxPolicy.estimate_static_revenue_effect-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_amount</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-213"><a href="#TaxPolicy.estimate_static_revenue_effect-213"><span class="linenos">213</span></a>            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">credit_amount</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">/</span> <span class="mf">1e3</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-214"><a href="#TaxPolicy.estimate_static_revenue_effect-214"><span class="linenos">214</span></a>            
</span><span id="TaxPolicy.estimate_static_revenue_effect-215"><a href="#TaxPolicy.estimate_static_revenue_effect-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deduction_amount</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-216"><a href="#TaxPolicy.estimate_static_revenue_effect-216"><span class="linenos">216</span></a>            <span class="c1"># Deduction value depends on marginal rate</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-217"><a href="#TaxPolicy.estimate_static_revenue_effect-217"><span class="linenos">217</span></a>            <span class="n">marginal_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">marginal_rate_before</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">marginal_rate_before</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.25</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-218"><a href="#TaxPolicy.estimate_static_revenue_effect-218"><span class="linenos">218</span></a>            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">deduction_amount</span> <span class="o">*</span> <span class="n">marginal_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_taxpayers_millions</span> <span class="o">/</span> <span class="mf">1e3</span>
</span><span id="TaxPolicy.estimate_static_revenue_effect-219"><a href="#TaxPolicy.estimate_static_revenue_effect-219"><span class="linenos">219</span></a>            
</span><span id="TaxPolicy.estimate_static_revenue_effect-220"><a href="#TaxPolicy.estimate_static_revenue_effect-220"><span class="linenos">220</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span></pre></div>


            <div class="docstring"><p>Estimate static revenue effect before behavioral responses.</p>

<p>Uses the more accurate formula when bracket-level data is provided:
    Revenue Change = Rate Change  Taxable Income  Affected Taxpayers</p>

<p>NEW: Can auto-populate parameters from IRS SOI data when available!</p>

<p>Falls back to proportional estimation if granular data unavailable.</p>

<p>Args:
    baseline_revenue: Baseline revenue in billions for affected tax
    use_real_data: If True, try to auto-populate from IRS SOI data</p>

<p>Returns:
    Change in revenue in billions (negative = revenue loss)</p>
</div>


                            </div>
                            <div id="TaxPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="TaxPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TaxPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxPolicy.estimate_behavioral_offset-322"><a href="#TaxPolicy.estimate_behavioral_offset-322"><span class="linenos">322</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-323"><a href="#TaxPolicy.estimate_behavioral_offset-323"><span class="linenos">323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-324"><a href="#TaxPolicy.estimate_behavioral_offset-324"><span class="linenos">324</span></a><span class="sd">        Estimate behavioral response offset to static revenue estimate.</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-325"><a href="#TaxPolicy.estimate_behavioral_offset-325"><span class="linenos">325</span></a><span class="sd">        Uses elasticity of taxable income (ETI) approach.</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-326"><a href="#TaxPolicy.estimate_behavioral_offset-326"><span class="linenos">326</span></a>
</span><span id="TaxPolicy.estimate_behavioral_offset-327"><a href="#TaxPolicy.estimate_behavioral_offset-327"><span class="linenos">327</span></a><span class="sd">        The behavioral offset represents REVENUE LOST due to behavioral response:</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-328"><a href="#TaxPolicy.estimate_behavioral_offset-328"><span class="linenos">328</span></a><span class="sd">        - Tax INCREASE: People reduce taxable income  positive offset (lost revenue)</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-329"><a href="#TaxPolicy.estimate_behavioral_offset-329"><span class="linenos">329</span></a><span class="sd">        - Tax CUT: People increase taxable income  negative offset (recovered revenue)</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-330"><a href="#TaxPolicy.estimate_behavioral_offset-330"><span class="linenos">330</span></a>
</span><span id="TaxPolicy.estimate_behavioral_offset-331"><a href="#TaxPolicy.estimate_behavioral_offset-331"><span class="linenos">331</span></a><span class="sd">        This offset is ADDED to static deficit to get final deficit effect.</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-332"><a href="#TaxPolicy.estimate_behavioral_offset-332"><span class="linenos">332</span></a>
</span><span id="TaxPolicy.estimate_behavioral_offset-333"><a href="#TaxPolicy.estimate_behavioral_offset-333"><span class="linenos">333</span></a><span class="sd">        Returns:</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-334"><a href="#TaxPolicy.estimate_behavioral_offset-334"><span class="linenos">334</span></a><span class="sd">            Behavioral offset in billions (positive = revenue lost, increases deficit)</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-335"><a href="#TaxPolicy.estimate_behavioral_offset-335"><span class="linenos">335</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-336"><a href="#TaxPolicy.estimate_behavioral_offset-336"><span class="linenos">336</span></a>        <span class="c1"># Behavioral response reduces revenue from tax increases (positive offset)</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-337"><a href="#TaxPolicy.estimate_behavioral_offset-337"><span class="linenos">337</span></a>        <span class="c1"># and recovers some revenue from tax cuts (negative offset)</span>
</span><span id="TaxPolicy.estimate_behavioral_offset-338"><a href="#TaxPolicy.estimate_behavioral_offset-338"><span class="linenos">338</span></a>        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxable_income_elasticity</span> <span class="o">*</span> <span class="mf">0.5</span>
</span></pre></div>


            <div class="docstring"><p>Estimate behavioral response offset to static revenue estimate.
Uses elasticity of taxable income (ETI) approach.</p>

<p>The behavioral offset represents REVENUE LOST due to behavioral response:</p>

<ul>
<li>Tax INCREASE: People reduce taxable income  positive offset (lost revenue)</li>
<li>Tax CUT: People increase taxable income  negative offset (recovered revenue)</li>
</ul>

<p>This offset is ADDED to static deficit to get final deficit effect.</p>

<p>Returns:
    Behavioral offset in billions (positive = revenue lost, increases deficit)</p>
</div>


                            </div>
                </section>
                <section id="CapitalGainsPolicy">
                            <input id="CapitalGainsPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">CapitalGainsPolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="CapitalGainsPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CapitalGainsPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CapitalGainsPolicy-341"><a href="#CapitalGainsPolicy-341"><span class="linenos">341</span></a><span class="nd">@dataclass</span>
</span><span id="CapitalGainsPolicy-342"><a href="#CapitalGainsPolicy-342"><span class="linenos">342</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CapitalGainsPolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="CapitalGainsPolicy-343"><a href="#CapitalGainsPolicy-343"><span class="linenos">343</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-344"><a href="#CapitalGainsPolicy-344"><span class="linenos">344</span></a><span class="sd">    Capital gains tax policy with realizations behavioral response.</span>
</span><span id="CapitalGainsPolicy-345"><a href="#CapitalGainsPolicy-345"><span class="linenos">345</span></a>
</span><span id="CapitalGainsPolicy-346"><a href="#CapitalGainsPolicy-346"><span class="linenos">346</span></a><span class="sd">    Unlike wage income, capital gains realizations respond strongly to the tax rate</span>
</span><span id="CapitalGainsPolicy-347"><a href="#CapitalGainsPolicy-347"><span class="linenos">347</span></a><span class="sd">    due to timing/lock-in effects. This policy models that channel explicitly.</span>
</span><span id="CapitalGainsPolicy-348"><a href="#CapitalGainsPolicy-348"><span class="linenos">348</span></a>
</span><span id="CapitalGainsPolicy-349"><a href="#CapitalGainsPolicy-349"><span class="linenos">349</span></a><span class="sd">    Required inputs (currently user-provided):</span>
</span><span id="CapitalGainsPolicy-350"><a href="#CapitalGainsPolicy-350"><span class="linenos">350</span></a><span class="sd">    - baseline_capital_gains_rate: baseline effective marginal rate (0-1) for the affected group</span>
</span><span id="CapitalGainsPolicy-351"><a href="#CapitalGainsPolicy-351"><span class="linenos">351</span></a><span class="sd">    - baseline_realizations_billions: taxable realizations base ($B/year) for the affected group</span>
</span><span id="CapitalGainsPolicy-352"><a href="#CapitalGainsPolicy-352"><span class="linenos">352</span></a>
</span><span id="CapitalGainsPolicy-353"><a href="#CapitalGainsPolicy-353"><span class="linenos">353</span></a><span class="sd">    Elasticity parameters (time-varying):</span>
</span><span id="CapitalGainsPolicy-354"><a href="#CapitalGainsPolicy-354"><span class="linenos">354</span></a><span class="sd">    - short_run_elasticity: elasticity in years 1-3 (higher due to timing effects), default 0.8</span>
</span><span id="CapitalGainsPolicy-355"><a href="#CapitalGainsPolicy-355"><span class="linenos">355</span></a><span class="sd">    - long_run_elasticity: elasticity in years 4+ (timing effects exhausted), default 0.4</span>
</span><span id="CapitalGainsPolicy-356"><a href="#CapitalGainsPolicy-356"><span class="linenos">356</span></a><span class="sd">    - transition_years: years to transition from short-run to long-run, default 3</span>
</span><span id="CapitalGainsPolicy-357"><a href="#CapitalGainsPolicy-357"><span class="linenos">357</span></a>
</span><span id="CapitalGainsPolicy-358"><a href="#CapitalGainsPolicy-358"><span class="linenos">358</span></a><span class="sd">    The realization_elasticity parameter is kept for backward compatibility; if</span>
</span><span id="CapitalGainsPolicy-359"><a href="#CapitalGainsPolicy-359"><span class="linenos">359</span></a><span class="sd">    short_run_elasticity and long_run_elasticity are both left at defaults,</span>
</span><span id="CapitalGainsPolicy-360"><a href="#CapitalGainsPolicy-360"><span class="linenos">360</span></a><span class="sd">    realization_elasticity is used as a single constant instead.</span>
</span><span id="CapitalGainsPolicy-361"><a href="#CapitalGainsPolicy-361"><span class="linenos">361</span></a>
</span><span id="CapitalGainsPolicy-362"><a href="#CapitalGainsPolicy-362"><span class="linenos">362</span></a><span class="sd">    References:</span>
</span><span id="CapitalGainsPolicy-363"><a href="#CapitalGainsPolicy-363"><span class="linenos">363</span></a><span class="sd">    - CBO (2012): &quot;How Capital Gains Tax Rates Affect Revenues&quot;  short-run   0.7-1.0</span>
</span><span id="CapitalGainsPolicy-364"><a href="#CapitalGainsPolicy-364"><span class="linenos">364</span></a><span class="sd">    - Dowd, McClelland, Muthitacharoen (2015): long-run   0.3-0.5</span>
</span><span id="CapitalGainsPolicy-365"><a href="#CapitalGainsPolicy-365"><span class="linenos">365</span></a><span class="sd">    - Yale Budget Lab: distinguishes transitory vs permanent behavioral response</span>
</span><span id="CapitalGainsPolicy-366"><a href="#CapitalGainsPolicy-366"><span class="linenos">366</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-367"><a href="#CapitalGainsPolicy-367"><span class="linenos">367</span></a>
</span><span id="CapitalGainsPolicy-368"><a href="#CapitalGainsPolicy-368"><span class="linenos">368</span></a>    <span class="n">baseline_capital_gains_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.20</span>
</span><span id="CapitalGainsPolicy-369"><a href="#CapitalGainsPolicy-369"><span class="linenos">369</span></a>    <span class="n">baseline_realizations_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="CapitalGainsPolicy-370"><a href="#CapitalGainsPolicy-370"><span class="linenos">370</span></a>
</span><span id="CapitalGainsPolicy-371"><a href="#CapitalGainsPolicy-371"><span class="linenos">371</span></a>    <span class="c1"># Time-varying elasticity parameters</span>
</span><span id="CapitalGainsPolicy-372"><a href="#CapitalGainsPolicy-372"><span class="linenos">372</span></a>    <span class="n">short_run_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span>   <span class="c1"># Years 1-3: timing/anticipation effects dominate</span>
</span><span id="CapitalGainsPolicy-373"><a href="#CapitalGainsPolicy-373"><span class="linenos">373</span></a>    <span class="n">long_run_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span>    <span class="c1"># Years 4+: permanent behavioral response only</span>
</span><span id="CapitalGainsPolicy-374"><a href="#CapitalGainsPolicy-374"><span class="linenos">374</span></a>    <span class="n">transition_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>           <span class="c1"># Years over which elasticity transitions</span>
</span><span id="CapitalGainsPolicy-375"><a href="#CapitalGainsPolicy-375"><span class="linenos">375</span></a>
</span><span id="CapitalGainsPolicy-376"><a href="#CapitalGainsPolicy-376"><span class="linenos">376</span></a>    <span class="c1"># Backward-compatible single elasticity (used if short/long are at defaults)</span>
</span><span id="CapitalGainsPolicy-377"><a href="#CapitalGainsPolicy-377"><span class="linenos">377</span></a>    <span class="n">realization_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="CapitalGainsPolicy-378"><a href="#CapitalGainsPolicy-378"><span class="linenos">378</span></a>
</span><span id="CapitalGainsPolicy-379"><a href="#CapitalGainsPolicy-379"><span class="linenos">379</span></a>    <span class="c1"># Whether to use time-varying elasticity (auto-detected, can override)</span>
</span><span id="CapitalGainsPolicy-380"><a href="#CapitalGainsPolicy-380"><span class="linenos">380</span></a>    <span class="n">use_time_varying_elasticity</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CapitalGainsPolicy-381"><a href="#CapitalGainsPolicy-381"><span class="linenos">381</span></a>
</span><span id="CapitalGainsPolicy-382"><a href="#CapitalGainsPolicy-382"><span class="linenos">382</span></a>    <span class="c1"># Step-up basis at death parameters</span>
</span><span id="CapitalGainsPolicy-383"><a href="#CapitalGainsPolicy-383"><span class="linenos">383</span></a>    <span class="c1"># Current law: unrealized gains are forgiven at death (step-up basis)</span>
</span><span id="CapitalGainsPolicy-384"><a href="#CapitalGainsPolicy-384"><span class="linenos">384</span></a>    <span class="c1"># This creates strong lock-in incentive to hold until death</span>
</span><span id="CapitalGainsPolicy-385"><a href="#CapitalGainsPolicy-385"><span class="linenos">385</span></a>    <span class="n">step_up_at_death</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>       <span class="c1"># Current law default</span>
</span><span id="CapitalGainsPolicy-386"><a href="#CapitalGainsPolicy-386"><span class="linenos">386</span></a>    <span class="n">eliminate_step_up</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>     <span class="c1"># Policy change: tax gains at death</span>
</span><span id="CapitalGainsPolicy-387"><a href="#CapitalGainsPolicy-387"><span class="linenos">387</span></a>    <span class="n">step_up_exemption</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>      <span class="c1"># Exemption per decedent (Biden: $1M)</span>
</span><span id="CapitalGainsPolicy-388"><a href="#CapitalGainsPolicy-388"><span class="linenos">388</span></a>
</span><span id="CapitalGainsPolicy-389"><a href="#CapitalGainsPolicy-389"><span class="linenos">389</span></a>    <span class="c1"># Unrealized gains at death (for step-up elimination revenue)</span>
</span><span id="CapitalGainsPolicy-390"><a href="#CapitalGainsPolicy-390"><span class="linenos">390</span></a>    <span class="c1"># JCT estimates ~$40-60B/year in forgone revenue from step-up</span>
</span><span id="CapitalGainsPolicy-391"><a href="#CapitalGainsPolicy-391"><span class="linenos">391</span></a>    <span class="c1"># CBO estimates ~$54B/year taxable if step-up eliminated</span>
</span><span id="CapitalGainsPolicy-392"><a href="#CapitalGainsPolicy-392"><span class="linenos">392</span></a>    <span class="n">gains_at_death_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">54.0</span>  <span class="c1"># Annual unrealized gains at death</span>
</span><span id="CapitalGainsPolicy-393"><a href="#CapitalGainsPolicy-393"><span class="linenos">393</span></a>
</span><span id="CapitalGainsPolicy-394"><a href="#CapitalGainsPolicy-394"><span class="linenos">394</span></a>    <span class="c1"># Step-up elasticity multiplier: how much step-up increases lock-in</span>
</span><span id="CapitalGainsPolicy-395"><a href="#CapitalGainsPolicy-395"><span class="linenos">395</span></a>    <span class="c1"># With step-up, taxpayers can avoid tax entirely by holding until death</span>
</span><span id="CapitalGainsPolicy-396"><a href="#CapitalGainsPolicy-396"><span class="linenos">396</span></a>    <span class="c1"># This creates much stronger deferral incentive than just timing</span>
</span><span id="CapitalGainsPolicy-397"><a href="#CapitalGainsPolicy-397"><span class="linenos">397</span></a>    <span class="c1"># Calibrated from PWBM: need ~2x elasticity multiplier to match their results</span>
</span><span id="CapitalGainsPolicy-398"><a href="#CapitalGainsPolicy-398"><span class="linenos">398</span></a>    <span class="n">step_up_lock_in_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span>
</span><span id="CapitalGainsPolicy-399"><a href="#CapitalGainsPolicy-399"><span class="linenos">399</span></a>
</span><span id="CapitalGainsPolicy-400"><a href="#CapitalGainsPolicy-400"><span class="linenos">400</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_elasticity_for_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">years_since_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-401"><a href="#CapitalGainsPolicy-401"><span class="linenos">401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-402"><a href="#CapitalGainsPolicy-402"><span class="linenos">402</span></a><span class="sd">        Get the appropriate realization elasticity based on years since policy start.</span>
</span><span id="CapitalGainsPolicy-403"><a href="#CapitalGainsPolicy-403"><span class="linenos">403</span></a>
</span><span id="CapitalGainsPolicy-404"><a href="#CapitalGainsPolicy-404"><span class="linenos">404</span></a><span class="sd">        The elasticity transitions from short_run_elasticity to long_run_elasticity</span>
</span><span id="CapitalGainsPolicy-405"><a href="#CapitalGainsPolicy-405"><span class="linenos">405</span></a><span class="sd">        over the transition_years period using linear interpolation.</span>
</span><span id="CapitalGainsPolicy-406"><a href="#CapitalGainsPolicy-406"><span class="linenos">406</span></a>
</span><span id="CapitalGainsPolicy-407"><a href="#CapitalGainsPolicy-407"><span class="linenos">407</span></a><span class="sd">        If step-up basis at death is in effect (current law), the elasticity is</span>
</span><span id="CapitalGainsPolicy-408"><a href="#CapitalGainsPolicy-408"><span class="linenos">408</span></a><span class="sd">        multiplied by step_up_lock_in_multiplier to capture the stronger deferral</span>
</span><span id="CapitalGainsPolicy-409"><a href="#CapitalGainsPolicy-409"><span class="linenos">409</span></a><span class="sd">        incentive from being able to avoid tax entirely by holding until death.</span>
</span><span id="CapitalGainsPolicy-410"><a href="#CapitalGainsPolicy-410"><span class="linenos">410</span></a>
</span><span id="CapitalGainsPolicy-411"><a href="#CapitalGainsPolicy-411"><span class="linenos">411</span></a><span class="sd">        Args:</span>
</span><span id="CapitalGainsPolicy-412"><a href="#CapitalGainsPolicy-412"><span class="linenos">412</span></a><span class="sd">            years_since_start: Number of years since policy took effect (0 = first year)</span>
</span><span id="CapitalGainsPolicy-413"><a href="#CapitalGainsPolicy-413"><span class="linenos">413</span></a>
</span><span id="CapitalGainsPolicy-414"><a href="#CapitalGainsPolicy-414"><span class="linenos">414</span></a><span class="sd">        Returns:</span>
</span><span id="CapitalGainsPolicy-415"><a href="#CapitalGainsPolicy-415"><span class="linenos">415</span></a><span class="sd">            Elasticity value for that year (may be multiplied by step-up factor)</span>
</span><span id="CapitalGainsPolicy-416"><a href="#CapitalGainsPolicy-416"><span class="linenos">416</span></a>
</span><span id="CapitalGainsPolicy-417"><a href="#CapitalGainsPolicy-417"><span class="linenos">417</span></a><span class="sd">        Example with defaults (short=0.8, long=0.4, transition=3):</span>
</span><span id="CapitalGainsPolicy-418"><a href="#CapitalGainsPolicy-418"><span class="linenos">418</span></a><span class="sd">            Year 0: 0.8 (full short-run)</span>
</span><span id="CapitalGainsPolicy-419"><a href="#CapitalGainsPolicy-419"><span class="linenos">419</span></a><span class="sd">            Year 1: 0.67</span>
</span><span id="CapitalGainsPolicy-420"><a href="#CapitalGainsPolicy-420"><span class="linenos">420</span></a><span class="sd">            Year 2: 0.53</span>
</span><span id="CapitalGainsPolicy-421"><a href="#CapitalGainsPolicy-421"><span class="linenos">421</span></a><span class="sd">            Year 3+: 0.4 (full long-run)</span>
</span><span id="CapitalGainsPolicy-422"><a href="#CapitalGainsPolicy-422"><span class="linenos">422</span></a>
</span><span id="CapitalGainsPolicy-423"><a href="#CapitalGainsPolicy-423"><span class="linenos">423</span></a><span class="sd">        With step_up_at_death=True and multiplier=2.0:</span>
</span><span id="CapitalGainsPolicy-424"><a href="#CapitalGainsPolicy-424"><span class="linenos">424</span></a><span class="sd">            Year 0: 1.6, Year 3+: 0.8</span>
</span><span id="CapitalGainsPolicy-425"><a href="#CapitalGainsPolicy-425"><span class="linenos">425</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-426"><a href="#CapitalGainsPolicy-426"><span class="linenos">426</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_time_varying_elasticity</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-427"><a href="#CapitalGainsPolicy-427"><span class="linenos">427</span></a>            <span class="n">base_elasticity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">realization_elasticity</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-428"><a href="#CapitalGainsPolicy-428"><span class="linenos">428</span></a>        <span class="k">elif</span> <span class="n">years_since_start</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-429"><a href="#CapitalGainsPolicy-429"><span class="linenos">429</span></a>            <span class="n">base_elasticity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">short_run_elasticity</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-430"><a href="#CapitalGainsPolicy-430"><span class="linenos">430</span></a>        <span class="k">elif</span> <span class="n">years_since_start</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_years</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-431"><a href="#CapitalGainsPolicy-431"><span class="linenos">431</span></a>            <span class="n">base_elasticity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">long_run_elasticity</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-432"><a href="#CapitalGainsPolicy-432"><span class="linenos">432</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-433"><a href="#CapitalGainsPolicy-433"><span class="linenos">433</span></a>            <span class="c1"># Interpolate</span>
</span><span id="CapitalGainsPolicy-434"><a href="#CapitalGainsPolicy-434"><span class="linenos">434</span></a>            <span class="n">weight</span> <span class="o">=</span> <span class="n">years_since_start</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_years</span>
</span><span id="CapitalGainsPolicy-435"><a href="#CapitalGainsPolicy-435"><span class="linenos">435</span></a>            <span class="n">base_elasticity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
</span><span id="CapitalGainsPolicy-436"><a href="#CapitalGainsPolicy-436"><span class="linenos">436</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">short_run_elasticity</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">weight</span><span class="p">)</span> <span class="o">+</span>
</span><span id="CapitalGainsPolicy-437"><a href="#CapitalGainsPolicy-437"><span class="linenos">437</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">long_run_elasticity</span> <span class="o">*</span> <span class="n">weight</span>
</span><span id="CapitalGainsPolicy-438"><a href="#CapitalGainsPolicy-438"><span class="linenos">438</span></a>            <span class="p">)</span>
</span><span id="CapitalGainsPolicy-439"><a href="#CapitalGainsPolicy-439"><span class="linenos">439</span></a>
</span><span id="CapitalGainsPolicy-440"><a href="#CapitalGainsPolicy-440"><span class="linenos">440</span></a>        <span class="c1"># Apply step-up lock-in multiplier if step-up is in effect</span>
</span><span id="CapitalGainsPolicy-441"><a href="#CapitalGainsPolicy-441"><span class="linenos">441</span></a>        <span class="c1"># When step-up is eliminated, the lock-in incentive is reduced</span>
</span><span id="CapitalGainsPolicy-442"><a href="#CapitalGainsPolicy-442"><span class="linenos">442</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_up_at_death</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminate_step_up</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-443"><a href="#CapitalGainsPolicy-443"><span class="linenos">443</span></a>            <span class="k">return</span> <span class="n">base_elasticity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_up_lock_in_multiplier</span>
</span><span id="CapitalGainsPolicy-444"><a href="#CapitalGainsPolicy-444"><span class="linenos">444</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-445"><a href="#CapitalGainsPolicy-445"><span class="linenos">445</span></a>            <span class="k">return</span> <span class="n">base_elasticity</span>
</span><span id="CapitalGainsPolicy-446"><a href="#CapitalGainsPolicy-446"><span class="linenos">446</span></a>
</span><span id="CapitalGainsPolicy-447"><a href="#CapitalGainsPolicy-447"><span class="linenos">447</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_reform_capital_gains_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-448"><a href="#CapitalGainsPolicy-448"><span class="linenos">448</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-449"><a href="#CapitalGainsPolicy-449"><span class="linenos">449</span></a><span class="sd">        Determine the reform capital gains rate.</span>
</span><span id="CapitalGainsPolicy-450"><a href="#CapitalGainsPolicy-450"><span class="linenos">450</span></a>
</span><span id="CapitalGainsPolicy-451"><a href="#CapitalGainsPolicy-451"><span class="linenos">451</span></a><span class="sd">        Precedence:</span>
</span><span id="CapitalGainsPolicy-452"><a href="#CapitalGainsPolicy-452"><span class="linenos">452</span></a><span class="sd">        1) new_rate if provided</span>
</span><span id="CapitalGainsPolicy-453"><a href="#CapitalGainsPolicy-453"><span class="linenos">453</span></a><span class="sd">        2) baseline_capital_gains_rate + rate_change</span>
</span><span id="CapitalGainsPolicy-454"><a href="#CapitalGainsPolicy-454"><span class="linenos">454</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-455"><a href="#CapitalGainsPolicy-455"><span class="linenos">455</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-456"><a href="#CapitalGainsPolicy-456"><span class="linenos">456</span></a>            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_rate</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-457"><a href="#CapitalGainsPolicy-457"><span class="linenos">457</span></a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_capital_gains_rate</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-458"><a href="#CapitalGainsPolicy-458"><span class="linenos">458</span></a>
</span><span id="CapitalGainsPolicy-459"><a href="#CapitalGainsPolicy-459"><span class="linenos">459</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_step_up_elimination_revenue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-460"><a href="#CapitalGainsPolicy-460"><span class="linenos">460</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-461"><a href="#CapitalGainsPolicy-461"><span class="linenos">461</span></a><span class="sd">        Estimate annual revenue from eliminating step-up basis at death.</span>
</span><span id="CapitalGainsPolicy-462"><a href="#CapitalGainsPolicy-462"><span class="linenos">462</span></a>
</span><span id="CapitalGainsPolicy-463"><a href="#CapitalGainsPolicy-463"><span class="linenos">463</span></a><span class="sd">        When step-up is eliminated, unrealized capital gains become taxable at death.</span>
</span><span id="CapitalGainsPolicy-464"><a href="#CapitalGainsPolicy-464"><span class="linenos">464</span></a><span class="sd">        This creates a NEW revenue stream separate from lifetime realizations.</span>
</span><span id="CapitalGainsPolicy-465"><a href="#CapitalGainsPolicy-465"><span class="linenos">465</span></a>
</span><span id="CapitalGainsPolicy-466"><a href="#CapitalGainsPolicy-466"><span class="linenos">466</span></a><span class="sd">        Formula:</span>
</span><span id="CapitalGainsPolicy-467"><a href="#CapitalGainsPolicy-467"><span class="linenos">467</span></a><span class="sd">            Revenue =   Gains_at_death  (1 - exemption_share)</span>
</span><span id="CapitalGainsPolicy-468"><a href="#CapitalGainsPolicy-468"><span class="linenos">468</span></a>
</span><span id="CapitalGainsPolicy-469"><a href="#CapitalGainsPolicy-469"><span class="linenos">469</span></a><span class="sd">        Where:</span>
</span><span id="CapitalGainsPolicy-470"><a href="#CapitalGainsPolicy-470"><span class="linenos">470</span></a><span class="sd">        -  = reform capital gains rate</span>
</span><span id="CapitalGainsPolicy-471"><a href="#CapitalGainsPolicy-471"><span class="linenos">471</span></a><span class="sd">        - Gains_at_death = annual unrealized gains transferred at death (~$54B baseline)</span>
</span><span id="CapitalGainsPolicy-472"><a href="#CapitalGainsPolicy-472"><span class="linenos">472</span></a><span class="sd">        - exemption_share = fraction of gains below exemption threshold</span>
</span><span id="CapitalGainsPolicy-473"><a href="#CapitalGainsPolicy-473"><span class="linenos">473</span></a>
</span><span id="CapitalGainsPolicy-474"><a href="#CapitalGainsPolicy-474"><span class="linenos">474</span></a><span class="sd">        Returns:</span>
</span><span id="CapitalGainsPolicy-475"><a href="#CapitalGainsPolicy-475"><span class="linenos">475</span></a><span class="sd">            Annual revenue in billions from taxing gains at death (0 if step-up not eliminated)</span>
</span><span id="CapitalGainsPolicy-476"><a href="#CapitalGainsPolicy-476"><span class="linenos">476</span></a>
</span><span id="CapitalGainsPolicy-477"><a href="#CapitalGainsPolicy-477"><span class="linenos">477</span></a><span class="sd">        References:</span>
</span><span id="CapitalGainsPolicy-478"><a href="#CapitalGainsPolicy-478"><span class="linenos">478</span></a><span class="sd">        - JCT: Step-up tax expenditure ~$40-60B/year</span>
</span><span id="CapitalGainsPolicy-479"><a href="#CapitalGainsPolicy-479"><span class="linenos">479</span></a><span class="sd">        - CBO: Taxing at death would raise ~$54B/year (no exemption)</span>
</span><span id="CapitalGainsPolicy-480"><a href="#CapitalGainsPolicy-480"><span class="linenos">480</span></a><span class="sd">        - Biden proposal: $1M exemption reduces revenue to ~$32B/year</span>
</span><span id="CapitalGainsPolicy-481"><a href="#CapitalGainsPolicy-481"><span class="linenos">481</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-482"><a href="#CapitalGainsPolicy-482"><span class="linenos">482</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminate_step_up</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-483"><a href="#CapitalGainsPolicy-483"><span class="linenos">483</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="CapitalGainsPolicy-484"><a href="#CapitalGainsPolicy-484"><span class="linenos">484</span></a>
</span><span id="CapitalGainsPolicy-485"><a href="#CapitalGainsPolicy-485"><span class="linenos">485</span></a>        <span class="n">tau1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_reform_capital_gains_rate</span><span class="p">())</span>
</span><span id="CapitalGainsPolicy-486"><a href="#CapitalGainsPolicy-486"><span class="linenos">486</span></a>        <span class="n">gains_at_death</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gains_at_death_billions</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-487"><a href="#CapitalGainsPolicy-487"><span class="linenos">487</span></a>
</span><span id="CapitalGainsPolicy-488"><a href="#CapitalGainsPolicy-488"><span class="linenos">488</span></a>        <span class="c1"># Calculate exemption share</span>
</span><span id="CapitalGainsPolicy-489"><a href="#CapitalGainsPolicy-489"><span class="linenos">489</span></a>        <span class="c1"># Biden proposal: $1M per person exemption</span>
</span><span id="CapitalGainsPolicy-490"><a href="#CapitalGainsPolicy-490"><span class="linenos">490</span></a>        <span class="c1"># Rough estimate: ~40% of gains at death are below $1M threshold</span>
</span><span id="CapitalGainsPolicy-491"><a href="#CapitalGainsPolicy-491"><span class="linenos">491</span></a>        <span class="c1"># Higher exemptions reduce taxable share further</span>
</span><span id="CapitalGainsPolicy-492"><a href="#CapitalGainsPolicy-492"><span class="linenos">492</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_up_exemption</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-493"><a href="#CapitalGainsPolicy-493"><span class="linenos">493</span></a>            <span class="c1"># Rough heuristic: each $1M of exemption shields ~40% of gains</span>
</span><span id="CapitalGainsPolicy-494"><a href="#CapitalGainsPolicy-494"><span class="linenos">494</span></a>            <span class="c1"># This is a simplification; actual distribution is complex</span>
</span><span id="CapitalGainsPolicy-495"><a href="#CapitalGainsPolicy-495"><span class="linenos">495</span></a>            <span class="n">exemption_millions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_up_exemption</span> <span class="o">/</span> <span class="mi">1_000_000</span>
</span><span id="CapitalGainsPolicy-496"><a href="#CapitalGainsPolicy-496"><span class="linenos">496</span></a>            <span class="n">exemption_share</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">exemption_millions</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-497"><a href="#CapitalGainsPolicy-497"><span class="linenos">497</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-498"><a href="#CapitalGainsPolicy-498"><span class="linenos">498</span></a>            <span class="n">exemption_share</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="CapitalGainsPolicy-499"><a href="#CapitalGainsPolicy-499"><span class="linenos">499</span></a>
</span><span id="CapitalGainsPolicy-500"><a href="#CapitalGainsPolicy-500"><span class="linenos">500</span></a>        <span class="n">taxable_gains</span> <span class="o">=</span> <span class="n">gains_at_death</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">exemption_share</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-501"><a href="#CapitalGainsPolicy-501"><span class="linenos">501</span></a>        <span class="k">return</span> <span class="n">tau1</span> <span class="o">*</span> <span class="n">taxable_gains</span>
</span><span id="CapitalGainsPolicy-502"><a href="#CapitalGainsPolicy-502"><span class="linenos">502</span></a>
</span><span id="CapitalGainsPolicy-503"><a href="#CapitalGainsPolicy-503"><span class="linenos">503</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-504"><a href="#CapitalGainsPolicy-504"><span class="linenos">504</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-505"><a href="#CapitalGainsPolicy-505"><span class="linenos">505</span></a><span class="sd">        Static effect holding realizations fixed:</span>
</span><span id="CapitalGainsPolicy-506"><a href="#CapitalGainsPolicy-506"><span class="linenos">506</span></a>
</span><span id="CapitalGainsPolicy-507"><a href="#CapitalGainsPolicy-507"><span class="linenos">507</span></a><span class="sd">            Rev_static = (1 - 0) * R0</span>
</span><span id="CapitalGainsPolicy-508"><a href="#CapitalGainsPolicy-508"><span class="linenos">508</span></a>
</span><span id="CapitalGainsPolicy-509"><a href="#CapitalGainsPolicy-509"><span class="linenos">509</span></a><span class="sd">        where:</span>
</span><span id="CapitalGainsPolicy-510"><a href="#CapitalGainsPolicy-510"><span class="linenos">510</span></a><span class="sd">        - 0 baseline rate</span>
</span><span id="CapitalGainsPolicy-511"><a href="#CapitalGainsPolicy-511"><span class="linenos">511</span></a><span class="sd">        - 1 reform rate</span>
</span><span id="CapitalGainsPolicy-512"><a href="#CapitalGainsPolicy-512"><span class="linenos">512</span></a><span class="sd">        - R0 baseline realizations base ($B/year)</span>
</span><span id="CapitalGainsPolicy-513"><a href="#CapitalGainsPolicy-513"><span class="linenos">513</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-514"><a href="#CapitalGainsPolicy-514"><span class="linenos">514</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">baseline_revenue</span>  <span class="c1"># Not used for capital gains; base is provided directly.</span>
</span><span id="CapitalGainsPolicy-515"><a href="#CapitalGainsPolicy-515"><span class="linenos">515</span></a>        <span class="c1"># Auto-populate baseline realizations/rate when requested and not provided.</span>
</span><span id="CapitalGainsPolicy-516"><a href="#CapitalGainsPolicy-516"><span class="linenos">516</span></a>        <span class="k">if</span> <span class="n">use_real_data</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_realizations_billions</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-517"><a href="#CapitalGainsPolicy-517"><span class="linenos">517</span></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">fiscal_model.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">CapitalGainsBaseline</span>
</span><span id="CapitalGainsPolicy-518"><a href="#CapitalGainsPolicy-518"><span class="linenos">518</span></a>
</span><span id="CapitalGainsPolicy-519"><a href="#CapitalGainsPolicy-519"><span class="linenos">519</span></a>            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_year</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_year</span> <span class="k">else</span> <span class="mi">2022</span>
</span><span id="CapitalGainsPolicy-520"><a href="#CapitalGainsPolicy-520"><span class="linenos">520</span></a>            <span class="c1"># Use a by-AGI statutory proxy for 0 by default (more consistent with threshold targeting).</span>
</span><span id="CapitalGainsPolicy-521"><a href="#CapitalGainsPolicy-521"><span class="linenos">521</span></a>            <span class="n">baseline</span> <span class="o">=</span> <span class="n">CapitalGainsBaseline</span><span class="p">()</span><span class="o">.</span><span class="n">get_baseline_above_threshold_with_rate_method</span><span class="p">(</span>
</span><span id="CapitalGainsPolicy-522"><a href="#CapitalGainsPolicy-522"><span class="linenos">522</span></a>                <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
</span><span id="CapitalGainsPolicy-523"><a href="#CapitalGainsPolicy-523"><span class="linenos">523</span></a>                <span class="n">threshold</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span><span class="p">),</span>
</span><span id="CapitalGainsPolicy-524"><a href="#CapitalGainsPolicy-524"><span class="linenos">524</span></a>                <span class="n">rate_method</span><span class="o">=</span><span class="s2">&quot;statutory_by_agi&quot;</span><span class="p">,</span>
</span><span id="CapitalGainsPolicy-525"><a href="#CapitalGainsPolicy-525"><span class="linenos">525</span></a>            <span class="p">)</span>
</span><span id="CapitalGainsPolicy-526"><a href="#CapitalGainsPolicy-526"><span class="linenos">526</span></a>            <span class="c1"># Mutate for downstream display / reuse.</span>
</span><span id="CapitalGainsPolicy-527"><a href="#CapitalGainsPolicy-527"><span class="linenos">527</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_realizations_billions</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">baseline</span><span class="p">[</span><span class="s2">&quot;net_capital_gain_billions&quot;</span><span class="p">])</span>
</span><span id="CapitalGainsPolicy-528"><a href="#CapitalGainsPolicy-528"><span class="linenos">528</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_capital_gains_rate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">baseline</span><span class="p">[</span><span class="s2">&quot;average_effective_tax_rate&quot;</span><span class="p">])</span>
</span><span id="CapitalGainsPolicy-529"><a href="#CapitalGainsPolicy-529"><span class="linenos">529</span></a>
</span><span id="CapitalGainsPolicy-530"><a href="#CapitalGainsPolicy-530"><span class="linenos">530</span></a>        <span class="n">tau0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_capital_gains_rate</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-531"><a href="#CapitalGainsPolicy-531"><span class="linenos">531</span></a>        <span class="n">tau1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_reform_capital_gains_rate</span><span class="p">())</span>
</span><span id="CapitalGainsPolicy-532"><a href="#CapitalGainsPolicy-532"><span class="linenos">532</span></a>        <span class="n">r0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_realizations_billions</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-533"><a href="#CapitalGainsPolicy-533"><span class="linenos">533</span></a>
</span><span id="CapitalGainsPolicy-534"><a href="#CapitalGainsPolicy-534"><span class="linenos">534</span></a>        <span class="k">if</span> <span class="n">r0</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-535"><a href="#CapitalGainsPolicy-535"><span class="linenos">535</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="CapitalGainsPolicy-536"><a href="#CapitalGainsPolicy-536"><span class="linenos">536</span></a>                <span class="s2">&quot;baseline_realizations_billions must be &gt; 0 for CapitalGainsPolicy &quot;</span>
</span><span id="CapitalGainsPolicy-537"><a href="#CapitalGainsPolicy-537"><span class="linenos">537</span></a>                <span class="s2">&quot;(set it manually or enable real-data auto-population).&quot;</span>
</span><span id="CapitalGainsPolicy-538"><a href="#CapitalGainsPolicy-538"><span class="linenos">538</span></a>            <span class="p">)</span>
</span><span id="CapitalGainsPolicy-539"><a href="#CapitalGainsPolicy-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tau0</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tau1</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="CapitalGainsPolicy-540"><a href="#CapitalGainsPolicy-540"><span class="linenos">540</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Capital gains rates must be in [0, 1) for CapitalGainsPolicy&quot;</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-541"><a href="#CapitalGainsPolicy-541"><span class="linenos">541</span></a>
</span><span id="CapitalGainsPolicy-542"><a href="#CapitalGainsPolicy-542"><span class="linenos">542</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">tau1</span> <span class="o">-</span> <span class="n">tau0</span><span class="p">)</span> <span class="o">*</span> <span class="n">r0</span>
</span><span id="CapitalGainsPolicy-543"><a href="#CapitalGainsPolicy-543"><span class="linenos">543</span></a>
</span><span id="CapitalGainsPolicy-544"><a href="#CapitalGainsPolicy-544"><span class="linenos">544</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="CapitalGainsPolicy-545"><a href="#CapitalGainsPolicy-545"><span class="linenos">545</span></a>                                      <span class="n">years_since_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-546"><a href="#CapitalGainsPolicy-546"><span class="linenos">546</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-547"><a href="#CapitalGainsPolicy-547"><span class="linenos">547</span></a><span class="sd">        Behavioral offset from realizations response (timing/lock-in).</span>
</span><span id="CapitalGainsPolicy-548"><a href="#CapitalGainsPolicy-548"><span class="linenos">548</span></a>
</span><span id="CapitalGainsPolicy-549"><a href="#CapitalGainsPolicy-549"><span class="linenos">549</span></a><span class="sd">        Uses time-varying elasticity: higher in short-run (timing effects),</span>
</span><span id="CapitalGainsPolicy-550"><a href="#CapitalGainsPolicy-550"><span class="linenos">550</span></a><span class="sd">        lower in long-run (permanent behavioral response only).</span>
</span><span id="CapitalGainsPolicy-551"><a href="#CapitalGainsPolicy-551"><span class="linenos">551</span></a>
</span><span id="CapitalGainsPolicy-552"><a href="#CapitalGainsPolicy-552"><span class="linenos">552</span></a><span class="sd">        Realizations response:</span>
</span><span id="CapitalGainsPolicy-553"><a href="#CapitalGainsPolicy-553"><span class="linenos">553</span></a><span class="sd">            R1 = R0 * ((1 - 1) / (1 - 0)) ** (t)</span>
</span><span id="CapitalGainsPolicy-554"><a href="#CapitalGainsPolicy-554"><span class="linenos">554</span></a>
</span><span id="CapitalGainsPolicy-555"><a href="#CapitalGainsPolicy-555"><span class="linenos">555</span></a><span class="sd">        where (t) transitions from short_run_elasticity to long_run_elasticity.</span>
</span><span id="CapitalGainsPolicy-556"><a href="#CapitalGainsPolicy-556"><span class="linenos">556</span></a>
</span><span id="CapitalGainsPolicy-557"><a href="#CapitalGainsPolicy-557"><span class="linenos">557</span></a><span class="sd">        Total revenue change:</span>
</span><span id="CapitalGainsPolicy-558"><a href="#CapitalGainsPolicy-558"><span class="linenos">558</span></a><span class="sd">            Rev_total = 1*R1 - 0*R0</span>
</span><span id="CapitalGainsPolicy-559"><a href="#CapitalGainsPolicy-559"><span class="linenos">559</span></a>
</span><span id="CapitalGainsPolicy-560"><a href="#CapitalGainsPolicy-560"><span class="linenos">560</span></a><span class="sd">        Offset returned here is:</span>
</span><span id="CapitalGainsPolicy-561"><a href="#CapitalGainsPolicy-561"><span class="linenos">561</span></a><span class="sd">            behavioral_offset = Rev_static - Rev_total</span>
</span><span id="CapitalGainsPolicy-562"><a href="#CapitalGainsPolicy-562"><span class="linenos">562</span></a>
</span><span id="CapitalGainsPolicy-563"><a href="#CapitalGainsPolicy-563"><span class="linenos">563</span></a><span class="sd">        This is POSITIVE when behavioral response reduces revenue (rate increase</span>
</span><span id="CapitalGainsPolicy-564"><a href="#CapitalGainsPolicy-564"><span class="linenos">564</span></a><span class="sd">        causes deferral, so actual revenue &lt; static estimate).</span>
</span><span id="CapitalGainsPolicy-565"><a href="#CapitalGainsPolicy-565"><span class="linenos">565</span></a>
</span><span id="CapitalGainsPolicy-566"><a href="#CapitalGainsPolicy-566"><span class="linenos">566</span></a><span class="sd">        Args:</span>
</span><span id="CapitalGainsPolicy-567"><a href="#CapitalGainsPolicy-567"><span class="linenos">567</span></a><span class="sd">            static_effect: The static revenue effect (used for compatibility, not in calculation)</span>
</span><span id="CapitalGainsPolicy-568"><a href="#CapitalGainsPolicy-568"><span class="linenos">568</span></a><span class="sd">            years_since_start: Years since policy took effect (0 = first year)</span>
</span><span id="CapitalGainsPolicy-569"><a href="#CapitalGainsPolicy-569"><span class="linenos">569</span></a>
</span><span id="CapitalGainsPolicy-570"><a href="#CapitalGainsPolicy-570"><span class="linenos">570</span></a><span class="sd">        Returns:</span>
</span><span id="CapitalGainsPolicy-571"><a href="#CapitalGainsPolicy-571"><span class="linenos">571</span></a><span class="sd">            Behavioral offset in billions (positive = revenue lost, increases deficit)</span>
</span><span id="CapitalGainsPolicy-572"><a href="#CapitalGainsPolicy-572"><span class="linenos">572</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy-573"><a href="#CapitalGainsPolicy-573"><span class="linenos">573</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">static_effect</span>  <span class="c1"># We recompute consistently from stored parameters.</span>
</span><span id="CapitalGainsPolicy-574"><a href="#CapitalGainsPolicy-574"><span class="linenos">574</span></a>        <span class="n">tau0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_capital_gains_rate</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-575"><a href="#CapitalGainsPolicy-575"><span class="linenos">575</span></a>        <span class="n">tau1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_reform_capital_gains_rate</span><span class="p">())</span>
</span><span id="CapitalGainsPolicy-576"><a href="#CapitalGainsPolicy-576"><span class="linenos">576</span></a>        <span class="n">r0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_realizations_billions</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-577"><a href="#CapitalGainsPolicy-577"><span class="linenos">577</span></a>
</span><span id="CapitalGainsPolicy-578"><a href="#CapitalGainsPolicy-578"><span class="linenos">578</span></a>        <span class="c1"># Get time-varying elasticity</span>
</span><span id="CapitalGainsPolicy-579"><a href="#CapitalGainsPolicy-579"><span class="linenos">579</span></a>        <span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_elasticity_for_year</span><span class="p">(</span><span class="n">years_since_start</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-580"><a href="#CapitalGainsPolicy-580"><span class="linenos">580</span></a>
</span><span id="CapitalGainsPolicy-581"><a href="#CapitalGainsPolicy-581"><span class="linenos">581</span></a>        <span class="k">if</span> <span class="n">r0</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-582"><a href="#CapitalGainsPolicy-582"><span class="linenos">582</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;baseline_realizations_billions must be &gt; 0 for CapitalGainsPolicy&quot;</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-583"><a href="#CapitalGainsPolicy-583"><span class="linenos">583</span></a>        <span class="k">if</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy-584"><a href="#CapitalGainsPolicy-584"><span class="linenos">584</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;realization_elasticity must be &gt;= 0 for CapitalGainsPolicy&quot;</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-585"><a href="#CapitalGainsPolicy-585"><span class="linenos">585</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tau0</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tau1</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="CapitalGainsPolicy-586"><a href="#CapitalGainsPolicy-586"><span class="linenos">586</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Capital gains rates must be in [0, 1) for CapitalGainsPolicy&quot;</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-587"><a href="#CapitalGainsPolicy-587"><span class="linenos">587</span></a>
</span><span id="CapitalGainsPolicy-588"><a href="#CapitalGainsPolicy-588"><span class="linenos">588</span></a>        <span class="n">net0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">tau0</span>
</span><span id="CapitalGainsPolicy-589"><a href="#CapitalGainsPolicy-589"><span class="linenos">589</span></a>        <span class="n">net1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">tau1</span>
</span><span id="CapitalGainsPolicy-590"><a href="#CapitalGainsPolicy-590"><span class="linenos">590</span></a>        <span class="n">r1</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">*</span> <span class="p">(</span><span class="n">net1</span> <span class="o">/</span> <span class="n">net0</span><span class="p">)</span> <span class="o">**</span> <span class="n">eps</span>
</span><span id="CapitalGainsPolicy-591"><a href="#CapitalGainsPolicy-591"><span class="linenos">591</span></a>
</span><span id="CapitalGainsPolicy-592"><a href="#CapitalGainsPolicy-592"><span class="linenos">592</span></a>        <span class="n">delta_rev_static</span> <span class="o">=</span> <span class="p">(</span><span class="n">tau1</span> <span class="o">-</span> <span class="n">tau0</span><span class="p">)</span> <span class="o">*</span> <span class="n">r0</span>
</span><span id="CapitalGainsPolicy-593"><a href="#CapitalGainsPolicy-593"><span class="linenos">593</span></a>        <span class="n">delta_rev_total</span> <span class="o">=</span> <span class="p">(</span><span class="n">tau1</span> <span class="o">*</span> <span class="n">r1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">tau0</span> <span class="o">*</span> <span class="n">r0</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy-594"><a href="#CapitalGainsPolicy-594"><span class="linenos">594</span></a>
</span><span id="CapitalGainsPolicy-595"><a href="#CapitalGainsPolicy-595"><span class="linenos">595</span></a>        <span class="c1"># Return positive offset when revenue is lost (static &gt; total)</span>
</span><span id="CapitalGainsPolicy-596"><a href="#CapitalGainsPolicy-596"><span class="linenos">596</span></a>        <span class="k">return</span> <span class="n">delta_rev_static</span> <span class="o">-</span> <span class="n">delta_rev_total</span>
</span></pre></div>


            <div class="docstring"><p>Capital gains tax policy with realizations behavioral response.</p>

<p>Unlike wage income, capital gains realizations respond strongly to the tax rate
due to timing/lock-in effects. This policy models that channel explicitly.</p>

<p>Required inputs (currently user-provided):</p>

<ul>
<li>baseline_capital_gains_rate: baseline effective marginal rate (0-1) for the affected group</li>
<li>baseline_realizations_billions: taxable realizations base ($B/year) for the affected group</li>
</ul>

<p>Elasticity parameters (time-varying):</p>

<ul>
<li>short_run_elasticity: elasticity in years 1-3 (higher due to timing effects), default 0.8</li>
<li>long_run_elasticity: elasticity in years 4+ (timing effects exhausted), default 0.4</li>
<li>transition_years: years to transition from short-run to long-run, default 3</li>
</ul>

<p>The realization_elasticity parameter is kept for backward compatibility; if
short_run_elasticity and long_run_elasticity are both left at defaults,
realization_elasticity is used as a single constant instead.</p>

<p>References:</p>

<ul>
<li>CBO (2012): "How Capital Gains Tax Rates Affect Revenues"  short-run   0.7-1.0</li>
<li>Dowd, McClelland, Muthitacharoen (2015): long-run   0.3-0.5</li>
<li>Yale Budget Lab: distinguishes transitory vs permanent behavioral response</li>
</ul>
</div>


                            <div id="CapitalGainsPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">CapitalGainsPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">baseline_capital_gains_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span>,</span><span class="param">	<span class="n">baseline_realizations_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">short_run_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span>,</span><span class="param">	<span class="n">long_run_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span>,</span><span class="param">	<span class="n">transition_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>,</span><span class="param">	<span class="n">realization_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>,</span><span class="param">	<span class="n">use_time_varying_elasticity</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">step_up_at_death</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">eliminate_step_up</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">step_up_exemption</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">gains_at_death_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">54.0</span>,</span><span class="param">	<span class="n">step_up_lock_in_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.__init__"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.baseline_capital_gains_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_capital_gains_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.2</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.baseline_capital_gains_rate"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.baseline_realizations_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_realizations_billions</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.baseline_realizations_billions"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.short_run_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">short_run_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.8</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.short_run_elasticity"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.long_run_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">long_run_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.4</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.long_run_elasticity"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.transition_years" class="classattr">
                                <div class="attr variable">
            <span class="name">transition_years</span><span class="annotation">: int</span>        =
<span class="default_value">3</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.transition_years"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.realization_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">realization_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.5</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.realization_elasticity"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.use_time_varying_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">use_time_varying_elasticity</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.use_time_varying_elasticity"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.step_up_at_death" class="classattr">
                                <div class="attr variable">
            <span class="name">step_up_at_death</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.step_up_at_death"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.eliminate_step_up" class="classattr">
                                <div class="attr variable">
            <span class="name">eliminate_step_up</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.eliminate_step_up"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.step_up_exemption" class="classattr">
                                <div class="attr variable">
            <span class="name">step_up_exemption</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.step_up_exemption"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.gains_at_death_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">gains_at_death_billions</span><span class="annotation">: float</span>        =
<span class="default_value">54.0</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.gains_at_death_billions"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.step_up_lock_in_multiplier" class="classattr">
                                <div class="attr variable">
            <span class="name">step_up_lock_in_multiplier</span><span class="annotation">: float</span>        =
<span class="default_value">2.0</span>

        
    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.step_up_lock_in_multiplier"></a>
    
    

                            </div>
                            <div id="CapitalGainsPolicy.get_elasticity_for_year" class="classattr">
                                        <input id="CapitalGainsPolicy.get_elasticity_for_year-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_elasticity_for_year</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">years_since_start</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="CapitalGainsPolicy.get_elasticity_for_year-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.get_elasticity_for_year"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CapitalGainsPolicy.get_elasticity_for_year-400"><a href="#CapitalGainsPolicy.get_elasticity_for_year-400"><span class="linenos">400</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_elasticity_for_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">years_since_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-401"><a href="#CapitalGainsPolicy.get_elasticity_for_year-401"><span class="linenos">401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-402"><a href="#CapitalGainsPolicy.get_elasticity_for_year-402"><span class="linenos">402</span></a><span class="sd">        Get the appropriate realization elasticity based on years since policy start.</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-403"><a href="#CapitalGainsPolicy.get_elasticity_for_year-403"><span class="linenos">403</span></a>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-404"><a href="#CapitalGainsPolicy.get_elasticity_for_year-404"><span class="linenos">404</span></a><span class="sd">        The elasticity transitions from short_run_elasticity to long_run_elasticity</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-405"><a href="#CapitalGainsPolicy.get_elasticity_for_year-405"><span class="linenos">405</span></a><span class="sd">        over the transition_years period using linear interpolation.</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-406"><a href="#CapitalGainsPolicy.get_elasticity_for_year-406"><span class="linenos">406</span></a>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-407"><a href="#CapitalGainsPolicy.get_elasticity_for_year-407"><span class="linenos">407</span></a><span class="sd">        If step-up basis at death is in effect (current law), the elasticity is</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-408"><a href="#CapitalGainsPolicy.get_elasticity_for_year-408"><span class="linenos">408</span></a><span class="sd">        multiplied by step_up_lock_in_multiplier to capture the stronger deferral</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-409"><a href="#CapitalGainsPolicy.get_elasticity_for_year-409"><span class="linenos">409</span></a><span class="sd">        incentive from being able to avoid tax entirely by holding until death.</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-410"><a href="#CapitalGainsPolicy.get_elasticity_for_year-410"><span class="linenos">410</span></a>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-411"><a href="#CapitalGainsPolicy.get_elasticity_for_year-411"><span class="linenos">411</span></a><span class="sd">        Args:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-412"><a href="#CapitalGainsPolicy.get_elasticity_for_year-412"><span class="linenos">412</span></a><span class="sd">            years_since_start: Number of years since policy took effect (0 = first year)</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-413"><a href="#CapitalGainsPolicy.get_elasticity_for_year-413"><span class="linenos">413</span></a>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-414"><a href="#CapitalGainsPolicy.get_elasticity_for_year-414"><span class="linenos">414</span></a><span class="sd">        Returns:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-415"><a href="#CapitalGainsPolicy.get_elasticity_for_year-415"><span class="linenos">415</span></a><span class="sd">            Elasticity value for that year (may be multiplied by step-up factor)</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-416"><a href="#CapitalGainsPolicy.get_elasticity_for_year-416"><span class="linenos">416</span></a>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-417"><a href="#CapitalGainsPolicy.get_elasticity_for_year-417"><span class="linenos">417</span></a><span class="sd">        Example with defaults (short=0.8, long=0.4, transition=3):</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-418"><a href="#CapitalGainsPolicy.get_elasticity_for_year-418"><span class="linenos">418</span></a><span class="sd">            Year 0: 0.8 (full short-run)</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-419"><a href="#CapitalGainsPolicy.get_elasticity_for_year-419"><span class="linenos">419</span></a><span class="sd">            Year 1: 0.67</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-420"><a href="#CapitalGainsPolicy.get_elasticity_for_year-420"><span class="linenos">420</span></a><span class="sd">            Year 2: 0.53</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-421"><a href="#CapitalGainsPolicy.get_elasticity_for_year-421"><span class="linenos">421</span></a><span class="sd">            Year 3+: 0.4 (full long-run)</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-422"><a href="#CapitalGainsPolicy.get_elasticity_for_year-422"><span class="linenos">422</span></a>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-423"><a href="#CapitalGainsPolicy.get_elasticity_for_year-423"><span class="linenos">423</span></a><span class="sd">        With step_up_at_death=True and multiplier=2.0:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-424"><a href="#CapitalGainsPolicy.get_elasticity_for_year-424"><span class="linenos">424</span></a><span class="sd">            Year 0: 1.6, Year 3+: 0.8</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-425"><a href="#CapitalGainsPolicy.get_elasticity_for_year-425"><span class="linenos">425</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-426"><a href="#CapitalGainsPolicy.get_elasticity_for_year-426"><span class="linenos">426</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_time_varying_elasticity</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-427"><a href="#CapitalGainsPolicy.get_elasticity_for_year-427"><span class="linenos">427</span></a>            <span class="n">base_elasticity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">realization_elasticity</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-428"><a href="#CapitalGainsPolicy.get_elasticity_for_year-428"><span class="linenos">428</span></a>        <span class="k">elif</span> <span class="n">years_since_start</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-429"><a href="#CapitalGainsPolicy.get_elasticity_for_year-429"><span class="linenos">429</span></a>            <span class="n">base_elasticity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">short_run_elasticity</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-430"><a href="#CapitalGainsPolicy.get_elasticity_for_year-430"><span class="linenos">430</span></a>        <span class="k">elif</span> <span class="n">years_since_start</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_years</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-431"><a href="#CapitalGainsPolicy.get_elasticity_for_year-431"><span class="linenos">431</span></a>            <span class="n">base_elasticity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">long_run_elasticity</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-432"><a href="#CapitalGainsPolicy.get_elasticity_for_year-432"><span class="linenos">432</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-433"><a href="#CapitalGainsPolicy.get_elasticity_for_year-433"><span class="linenos">433</span></a>            <span class="c1"># Interpolate</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-434"><a href="#CapitalGainsPolicy.get_elasticity_for_year-434"><span class="linenos">434</span></a>            <span class="n">weight</span> <span class="o">=</span> <span class="n">years_since_start</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_years</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-435"><a href="#CapitalGainsPolicy.get_elasticity_for_year-435"><span class="linenos">435</span></a>            <span class="n">base_elasticity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-436"><a href="#CapitalGainsPolicy.get_elasticity_for_year-436"><span class="linenos">436</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">short_run_elasticity</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">weight</span><span class="p">)</span> <span class="o">+</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-437"><a href="#CapitalGainsPolicy.get_elasticity_for_year-437"><span class="linenos">437</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">long_run_elasticity</span> <span class="o">*</span> <span class="n">weight</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-438"><a href="#CapitalGainsPolicy.get_elasticity_for_year-438"><span class="linenos">438</span></a>            <span class="p">)</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-439"><a href="#CapitalGainsPolicy.get_elasticity_for_year-439"><span class="linenos">439</span></a>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-440"><a href="#CapitalGainsPolicy.get_elasticity_for_year-440"><span class="linenos">440</span></a>        <span class="c1"># Apply step-up lock-in multiplier if step-up is in effect</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-441"><a href="#CapitalGainsPolicy.get_elasticity_for_year-441"><span class="linenos">441</span></a>        <span class="c1"># When step-up is eliminated, the lock-in incentive is reduced</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-442"><a href="#CapitalGainsPolicy.get_elasticity_for_year-442"><span class="linenos">442</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_up_at_death</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminate_step_up</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-443"><a href="#CapitalGainsPolicy.get_elasticity_for_year-443"><span class="linenos">443</span></a>            <span class="k">return</span> <span class="n">base_elasticity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_up_lock_in_multiplier</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-444"><a href="#CapitalGainsPolicy.get_elasticity_for_year-444"><span class="linenos">444</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.get_elasticity_for_year-445"><a href="#CapitalGainsPolicy.get_elasticity_for_year-445"><span class="linenos">445</span></a>            <span class="k">return</span> <span class="n">base_elasticity</span>
</span></pre></div>


            <div class="docstring"><p>Get the appropriate realization elasticity based on years since policy start.</p>

<p>The elasticity transitions from short_run_elasticity to long_run_elasticity
over the transition_years period using linear interpolation.</p>

<p>If step-up basis at death is in effect (current law), the elasticity is
multiplied by step_up_lock_in_multiplier to capture the stronger deferral
incentive from being able to avoid tax entirely by holding until death.</p>

<p>Args:
    years_since_start: Number of years since policy took effect (0 = first year)</p>

<p>Returns:
    Elasticity value for that year (may be multiplied by step-up factor)</p>

<p>Example with defaults (short=0.8, long=0.4, transition=3):
    Year 0: 0.8 (full short-run)
    Year 1: 0.67
    Year 2: 0.53
    Year 3+: 0.4 (full long-run)</p>

<p>With step_up_at_death=True and multiplier=2.0:
    Year 0: 1.6, Year 3+: 0.8</p>
</div>


                            </div>
                            <div id="CapitalGainsPolicy.estimate_step_up_elimination_revenue" class="classattr">
                                        <input id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_step_up_elimination_revenue</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="CapitalGainsPolicy.estimate_step_up_elimination_revenue-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-459"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-459"><span class="linenos">459</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_step_up_elimination_revenue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-460"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-460"><span class="linenos">460</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-461"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-461"><span class="linenos">461</span></a><span class="sd">        Estimate annual revenue from eliminating step-up basis at death.</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-462"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-462"><span class="linenos">462</span></a>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-463"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-463"><span class="linenos">463</span></a><span class="sd">        When step-up is eliminated, unrealized capital gains become taxable at death.</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-464"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-464"><span class="linenos">464</span></a><span class="sd">        This creates a NEW revenue stream separate from lifetime realizations.</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-465"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-465"><span class="linenos">465</span></a>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-466"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-466"><span class="linenos">466</span></a><span class="sd">        Formula:</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-467"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-467"><span class="linenos">467</span></a><span class="sd">            Revenue =   Gains_at_death  (1 - exemption_share)</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-468"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-468"><span class="linenos">468</span></a>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-469"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-469"><span class="linenos">469</span></a><span class="sd">        Where:</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-470"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-470"><span class="linenos">470</span></a><span class="sd">        -  = reform capital gains rate</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-471"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-471"><span class="linenos">471</span></a><span class="sd">        - Gains_at_death = annual unrealized gains transferred at death (~$54B baseline)</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-472"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-472"><span class="linenos">472</span></a><span class="sd">        - exemption_share = fraction of gains below exemption threshold</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-473"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-473"><span class="linenos">473</span></a>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-474"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-474"><span class="linenos">474</span></a><span class="sd">        Returns:</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-475"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-475"><span class="linenos">475</span></a><span class="sd">            Annual revenue in billions from taxing gains at death (0 if step-up not eliminated)</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-476"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-476"><span class="linenos">476</span></a>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-477"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-477"><span class="linenos">477</span></a><span class="sd">        References:</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-478"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-478"><span class="linenos">478</span></a><span class="sd">        - JCT: Step-up tax expenditure ~$40-60B/year</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-479"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-479"><span class="linenos">479</span></a><span class="sd">        - CBO: Taxing at death would raise ~$54B/year (no exemption)</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-480"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-480"><span class="linenos">480</span></a><span class="sd">        - Biden proposal: $1M exemption reduces revenue to ~$32B/year</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-481"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-481"><span class="linenos">481</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-482"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-482"><span class="linenos">482</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminate_step_up</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-483"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-483"><span class="linenos">483</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-484"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-484"><span class="linenos">484</span></a>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-485"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-485"><span class="linenos">485</span></a>        <span class="n">tau1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_reform_capital_gains_rate</span><span class="p">())</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-486"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-486"><span class="linenos">486</span></a>        <span class="n">gains_at_death</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gains_at_death_billions</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-487"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-487"><span class="linenos">487</span></a>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-488"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-488"><span class="linenos">488</span></a>        <span class="c1"># Calculate exemption share</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-489"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-489"><span class="linenos">489</span></a>        <span class="c1"># Biden proposal: $1M per person exemption</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-490"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-490"><span class="linenos">490</span></a>        <span class="c1"># Rough estimate: ~40% of gains at death are below $1M threshold</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-491"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-491"><span class="linenos">491</span></a>        <span class="c1"># Higher exemptions reduce taxable share further</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-492"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-492"><span class="linenos">492</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_up_exemption</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-493"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-493"><span class="linenos">493</span></a>            <span class="c1"># Rough heuristic: each $1M of exemption shields ~40% of gains</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-494"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-494"><span class="linenos">494</span></a>            <span class="c1"># This is a simplification; actual distribution is complex</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-495"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-495"><span class="linenos">495</span></a>            <span class="n">exemption_millions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_up_exemption</span> <span class="o">/</span> <span class="mi">1_000_000</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-496"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-496"><span class="linenos">496</span></a>            <span class="n">exemption_share</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">exemption_millions</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-497"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-497"><span class="linenos">497</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-498"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-498"><span class="linenos">498</span></a>            <span class="n">exemption_share</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-499"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-499"><span class="linenos">499</span></a>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-500"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-500"><span class="linenos">500</span></a>        <span class="n">taxable_gains</span> <span class="o">=</span> <span class="n">gains_at_death</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">exemption_share</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_step_up_elimination_revenue-501"><a href="#CapitalGainsPolicy.estimate_step_up_elimination_revenue-501"><span class="linenos">501</span></a>        <span class="k">return</span> <span class="n">tau1</span> <span class="o">*</span> <span class="n">taxable_gains</span>
</span></pre></div>


            <div class="docstring"><p>Estimate annual revenue from eliminating step-up basis at death.</p>

<p>When step-up is eliminated, unrealized capital gains become taxable at death.
This creates a NEW revenue stream separate from lifetime realizations.</p>

<p>Formula:
    Revenue =   Gains_at_death  (1 - exemption_share)</p>

<p>Where:</p>

<ul>
<li> = reform capital gains rate</li>
<li>Gains_at_death = annual unrealized gains transferred at death (~$54B baseline)</li>
<li>exemption_share = fraction of gains below exemption threshold</li>
</ul>

<p>Returns:
    Annual revenue in billions from taxing gains at death (0 if step-up not eliminated)</p>

<p>References:</p>

<ul>
<li>JCT: Step-up tax expenditure ~$40-60B/year</li>
<li>CBO: Taxing at death would raise ~$54B/year (no exemption)</li>
<li>Biden proposal: $1M exemption reduces revenue to ~$32B/year</li>
</ul>
</div>


                            </div>
                            <div id="CapitalGainsPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="CapitalGainsPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="CapitalGainsPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-503"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-503"><span class="linenos">503</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-504"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-504"><span class="linenos">504</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-505"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-505"><span class="linenos">505</span></a><span class="sd">        Static effect holding realizations fixed:</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-506"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-506"><span class="linenos">506</span></a>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-507"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-507"><span class="linenos">507</span></a><span class="sd">            Rev_static = (1 - 0) * R0</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-508"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-508"><span class="linenos">508</span></a>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-509"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-509"><span class="linenos">509</span></a><span class="sd">        where:</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-510"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-510"><span class="linenos">510</span></a><span class="sd">        - 0 baseline rate</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-511"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-511"><span class="linenos">511</span></a><span class="sd">        - 1 reform rate</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-512"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-512"><span class="linenos">512</span></a><span class="sd">        - R0 baseline realizations base ($B/year)</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-513"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-513"><span class="linenos">513</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-514"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-514"><span class="linenos">514</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">baseline_revenue</span>  <span class="c1"># Not used for capital gains; base is provided directly.</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-515"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-515"><span class="linenos">515</span></a>        <span class="c1"># Auto-populate baseline realizations/rate when requested and not provided.</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-516"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-516"><span class="linenos">516</span></a>        <span class="k">if</span> <span class="n">use_real_data</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_realizations_billions</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-517"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-517"><span class="linenos">517</span></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">fiscal_model.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">CapitalGainsBaseline</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-518"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-518"><span class="linenos">518</span></a>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-519"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-519"><span class="linenos">519</span></a>            <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_year</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_year</span> <span class="k">else</span> <span class="mi">2022</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-520"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-520"><span class="linenos">520</span></a>            <span class="c1"># Use a by-AGI statutory proxy for 0 by default (more consistent with threshold targeting).</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-521"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-521"><span class="linenos">521</span></a>            <span class="n">baseline</span> <span class="o">=</span> <span class="n">CapitalGainsBaseline</span><span class="p">()</span><span class="o">.</span><span class="n">get_baseline_above_threshold_with_rate_method</span><span class="p">(</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-522"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-522"><span class="linenos">522</span></a>                <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-523"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-523"><span class="linenos">523</span></a>                <span class="n">threshold</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">affected_income_threshold</span><span class="p">),</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-524"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-524"><span class="linenos">524</span></a>                <span class="n">rate_method</span><span class="o">=</span><span class="s2">&quot;statutory_by_agi&quot;</span><span class="p">,</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-525"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-525"><span class="linenos">525</span></a>            <span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-526"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-526"><span class="linenos">526</span></a>            <span class="c1"># Mutate for downstream display / reuse.</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-527"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-527"><span class="linenos">527</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_realizations_billions</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">baseline</span><span class="p">[</span><span class="s2">&quot;net_capital_gain_billions&quot;</span><span class="p">])</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-528"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-528"><span class="linenos">528</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_capital_gains_rate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">baseline</span><span class="p">[</span><span class="s2">&quot;average_effective_tax_rate&quot;</span><span class="p">])</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-529"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-529"><span class="linenos">529</span></a>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-530"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-530"><span class="linenos">530</span></a>        <span class="n">tau0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_capital_gains_rate</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-531"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-531"><span class="linenos">531</span></a>        <span class="n">tau1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_reform_capital_gains_rate</span><span class="p">())</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-532"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-532"><span class="linenos">532</span></a>        <span class="n">r0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_realizations_billions</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-533"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-533"><span class="linenos">533</span></a>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-534"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-534"><span class="linenos">534</span></a>        <span class="k">if</span> <span class="n">r0</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-535"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-535"><span class="linenos">535</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-536"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-536"><span class="linenos">536</span></a>                <span class="s2">&quot;baseline_realizations_billions must be &gt; 0 for CapitalGainsPolicy &quot;</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-537"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-537"><span class="linenos">537</span></a>                <span class="s2">&quot;(set it manually or enable real-data auto-population).&quot;</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-538"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-538"><span class="linenos">538</span></a>            <span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-539"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tau0</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tau1</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-540"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-540"><span class="linenos">540</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Capital gains rates must be in [0, 1) for CapitalGainsPolicy&quot;</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-541"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-541"><span class="linenos">541</span></a>
</span><span id="CapitalGainsPolicy.estimate_static_revenue_effect-542"><a href="#CapitalGainsPolicy.estimate_static_revenue_effect-542"><span class="linenos">542</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">tau1</span> <span class="o">-</span> <span class="n">tau0</span><span class="p">)</span> <span class="o">*</span> <span class="n">r0</span>
</span></pre></div>


            <div class="docstring"><p>Static effect holding realizations fixed:</p>

<pre><code>Rev_static = (1 - 0) * R0
</code></pre>

<p>where:</p>

<ul>
<li>0 baseline rate</li>
<li>1 reform rate</li>
<li>R0 baseline realizations base ($B/year)</li>
</ul>
</div>


                            </div>
                            <div id="CapitalGainsPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="CapitalGainsPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">years_since_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="CapitalGainsPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CapitalGainsPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CapitalGainsPolicy.estimate_behavioral_offset-544"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-544"><span class="linenos">544</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-545"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-545"><span class="linenos">545</span></a>                                      <span class="n">years_since_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-546"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-546"><span class="linenos">546</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-547"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-547"><span class="linenos">547</span></a><span class="sd">        Behavioral offset from realizations response (timing/lock-in).</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-548"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-548"><span class="linenos">548</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-549"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-549"><span class="linenos">549</span></a><span class="sd">        Uses time-varying elasticity: higher in short-run (timing effects),</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-550"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-550"><span class="linenos">550</span></a><span class="sd">        lower in long-run (permanent behavioral response only).</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-551"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-551"><span class="linenos">551</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-552"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-552"><span class="linenos">552</span></a><span class="sd">        Realizations response:</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-553"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-553"><span class="linenos">553</span></a><span class="sd">            R1 = R0 * ((1 - 1) / (1 - 0)) ** (t)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-554"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-554"><span class="linenos">554</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-555"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-555"><span class="linenos">555</span></a><span class="sd">        where (t) transitions from short_run_elasticity to long_run_elasticity.</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-556"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-556"><span class="linenos">556</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-557"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-557"><span class="linenos">557</span></a><span class="sd">        Total revenue change:</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-558"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-558"><span class="linenos">558</span></a><span class="sd">            Rev_total = 1*R1 - 0*R0</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-559"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-559"><span class="linenos">559</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-560"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-560"><span class="linenos">560</span></a><span class="sd">        Offset returned here is:</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-561"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-561"><span class="linenos">561</span></a><span class="sd">            behavioral_offset = Rev_static - Rev_total</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-562"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-562"><span class="linenos">562</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-563"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-563"><span class="linenos">563</span></a><span class="sd">        This is POSITIVE when behavioral response reduces revenue (rate increase</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-564"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-564"><span class="linenos">564</span></a><span class="sd">        causes deferral, so actual revenue &lt; static estimate).</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-565"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-565"><span class="linenos">565</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-566"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-566"><span class="linenos">566</span></a><span class="sd">        Args:</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-567"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-567"><span class="linenos">567</span></a><span class="sd">            static_effect: The static revenue effect (used for compatibility, not in calculation)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-568"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-568"><span class="linenos">568</span></a><span class="sd">            years_since_start: Years since policy took effect (0 = first year)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-569"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-569"><span class="linenos">569</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-570"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-570"><span class="linenos">570</span></a><span class="sd">        Returns:</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-571"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-571"><span class="linenos">571</span></a><span class="sd">            Behavioral offset in billions (positive = revenue lost, increases deficit)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-572"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-572"><span class="linenos">572</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-573"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-573"><span class="linenos">573</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">static_effect</span>  <span class="c1"># We recompute consistently from stored parameters.</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-574"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-574"><span class="linenos">574</span></a>        <span class="n">tau0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_capital_gains_rate</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-575"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-575"><span class="linenos">575</span></a>        <span class="n">tau1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_reform_capital_gains_rate</span><span class="p">())</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-576"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-576"><span class="linenos">576</span></a>        <span class="n">r0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_realizations_billions</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-577"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-577"><span class="linenos">577</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-578"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-578"><span class="linenos">578</span></a>        <span class="c1"># Get time-varying elasticity</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-579"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-579"><span class="linenos">579</span></a>        <span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_elasticity_for_year</span><span class="p">(</span><span class="n">years_since_start</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-580"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-580"><span class="linenos">580</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-581"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-581"><span class="linenos">581</span></a>        <span class="k">if</span> <span class="n">r0</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-582"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-582"><span class="linenos">582</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;baseline_realizations_billions must be &gt; 0 for CapitalGainsPolicy&quot;</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-583"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-583"><span class="linenos">583</span></a>        <span class="k">if</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-584"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-584"><span class="linenos">584</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;realization_elasticity must be &gt;= 0 for CapitalGainsPolicy&quot;</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-585"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-585"><span class="linenos">585</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tau0</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tau1</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-586"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-586"><span class="linenos">586</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Capital gains rates must be in [0, 1) for CapitalGainsPolicy&quot;</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-587"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-587"><span class="linenos">587</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-588"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-588"><span class="linenos">588</span></a>        <span class="n">net0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">tau0</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-589"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-589"><span class="linenos">589</span></a>        <span class="n">net1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">tau1</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-590"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-590"><span class="linenos">590</span></a>        <span class="n">r1</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">*</span> <span class="p">(</span><span class="n">net1</span> <span class="o">/</span> <span class="n">net0</span><span class="p">)</span> <span class="o">**</span> <span class="n">eps</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-591"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-591"><span class="linenos">591</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-592"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-592"><span class="linenos">592</span></a>        <span class="n">delta_rev_static</span> <span class="o">=</span> <span class="p">(</span><span class="n">tau1</span> <span class="o">-</span> <span class="n">tau0</span><span class="p">)</span> <span class="o">*</span> <span class="n">r0</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-593"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-593"><span class="linenos">593</span></a>        <span class="n">delta_rev_total</span> <span class="o">=</span> <span class="p">(</span><span class="n">tau1</span> <span class="o">*</span> <span class="n">r1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">tau0</span> <span class="o">*</span> <span class="n">r0</span><span class="p">)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-594"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-594"><span class="linenos">594</span></a>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-595"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-595"><span class="linenos">595</span></a>        <span class="c1"># Return positive offset when revenue is lost (static &gt; total)</span>
</span><span id="CapitalGainsPolicy.estimate_behavioral_offset-596"><a href="#CapitalGainsPolicy.estimate_behavioral_offset-596"><span class="linenos">596</span></a>        <span class="k">return</span> <span class="n">delta_rev_static</span> <span class="o">-</span> <span class="n">delta_rev_total</span>
</span></pre></div>


            <div class="docstring"><p>Behavioral offset from realizations response (timing/lock-in).</p>

<p>Uses time-varying elasticity: higher in short-run (timing effects),
lower in long-run (permanent behavioral response only).</p>

<p>Realizations response:
    R1 = R0 * ((1 - 1) / (1 - 0)) ** (t)</p>

<p>where (t) transitions from short_run_elasticity to long_run_elasticity.</p>

<p>Total revenue change:
    Rev_total = 1<em>R1 - 0</em>R0</p>

<p>Offset returned here is:
    behavioral_offset = Rev_static - Rev_total</p>

<p>This is POSITIVE when behavioral response reduces revenue (rate increase
causes deferral, so actual revenue &lt; static estimate).</p>

<p>Args:
    static_effect: The static revenue effect (used for compatibility, not in calculation)
    years_since_start: Years since policy took effect (0 = first year)</p>

<p>Returns:
    Behavioral offset in billions (positive = revenue lost, increases deficit)</p>
</div>


                            </div>
                </section>
                <section id="SpendingPolicy">
                            <input id="SpendingPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">SpendingPolicy</span><wbr>(<span class="base"><a href="#Policy">fiscal_model.Policy</a></span>):

                <label class="view-source-button" for="SpendingPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpendingPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpendingPolicy-599"><a href="#SpendingPolicy-599"><span class="linenos">599</span></a><span class="nd">@dataclass</span>
</span><span id="SpendingPolicy-600"><a href="#SpendingPolicy-600"><span class="linenos">600</span></a><span class="k">class</span><span class="w"> </span><span class="nc">SpendingPolicy</span><span class="p">(</span><span class="n">Policy</span><span class="p">):</span>
</span><span id="SpendingPolicy-601"><a href="#SpendingPolicy-601"><span class="linenos">601</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpendingPolicy-602"><a href="#SpendingPolicy-602"><span class="linenos">602</span></a><span class="sd">    Spending policy proposal.</span>
</span><span id="SpendingPolicy-603"><a href="#SpendingPolicy-603"><span class="linenos">603</span></a><span class="sd">    </span>
</span><span id="SpendingPolicy-604"><a href="#SpendingPolicy-604"><span class="linenos">604</span></a><span class="sd">    Covers discretionary and mandatory spending changes.</span>
</span><span id="SpendingPolicy-605"><a href="#SpendingPolicy-605"><span class="linenos">605</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpendingPolicy-606"><a href="#SpendingPolicy-606"><span class="linenos">606</span></a>    <span class="c1"># Annual spending change</span>
</span><span id="SpendingPolicy-607"><a href="#SpendingPolicy-607"><span class="linenos">607</span></a>    <span class="n">annual_spending_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="SpendingPolicy-608"><a href="#SpendingPolicy-608"><span class="linenos">608</span></a>    
</span><span id="SpendingPolicy-609"><a href="#SpendingPolicy-609"><span class="linenos">609</span></a>    <span class="c1"># Growth rate for spending (real, after start year)</span>
</span><span id="SpendingPolicy-610"><a href="#SpendingPolicy-610"><span class="linenos">610</span></a>    <span class="n">annual_growth_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># Default 2% real growth</span>
</span><span id="SpendingPolicy-611"><a href="#SpendingPolicy-611"><span class="linenos">611</span></a>    
</span><span id="SpendingPolicy-612"><a href="#SpendingPolicy-612"><span class="linenos">612</span></a>    <span class="c1"># Economic impact parameters</span>
</span><span id="SpendingPolicy-613"><a href="#SpendingPolicy-613"><span class="linenos">613</span></a>    <span class="n">gdp_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Fiscal multiplier for GDP impact</span>
</span><span id="SpendingPolicy-614"><a href="#SpendingPolicy-614"><span class="linenos">614</span></a>    <span class="n">employment_per_billion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Jobs per billion dollars</span>
</span><span id="SpendingPolicy-615"><a href="#SpendingPolicy-615"><span class="linenos">615</span></a>    
</span><span id="SpendingPolicy-616"><a href="#SpendingPolicy-616"><span class="linenos">616</span></a>    <span class="c1"># Spending characteristics</span>
</span><span id="SpendingPolicy-617"><a href="#SpendingPolicy-617"><span class="linenos">617</span></a>    <span class="n">is_one_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># One-time vs recurring spending</span>
</span><span id="SpendingPolicy-618"><a href="#SpendingPolicy-618"><span class="linenos">618</span></a>    <span class="n">category</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;defense&quot;</span><span class="p">,</span> <span class="s2">&quot;nondefense&quot;</span><span class="p">,</span> <span class="s2">&quot;mandatory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nondefense&quot;</span>
</span><span id="SpendingPolicy-619"><a href="#SpendingPolicy-619"><span class="linenos">619</span></a>    
</span><span id="SpendingPolicy-620"><a href="#SpendingPolicy-620"><span class="linenos">620</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_spending_in_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">start_amount</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="SpendingPolicy-621"><a href="#SpendingPolicy-621"><span class="linenos">621</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpendingPolicy-622"><a href="#SpendingPolicy-622"><span class="linenos">622</span></a><span class="sd">        Calculate spending amount for a given year, including growth.</span>
</span><span id="SpendingPolicy-623"><a href="#SpendingPolicy-623"><span class="linenos">623</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpendingPolicy-624"><a href="#SpendingPolicy-624"><span class="linenos">624</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
</span><span id="SpendingPolicy-625"><a href="#SpendingPolicy-625"><span class="linenos">625</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="SpendingPolicy-626"><a href="#SpendingPolicy-626"><span class="linenos">626</span></a>            
</span><span id="SpendingPolicy-627"><a href="#SpendingPolicy-627"><span class="linenos">627</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">start_amount</span> <span class="k">if</span> <span class="n">start_amount</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_spending_change_billions</span>
</span><span id="SpendingPolicy-628"><a href="#SpendingPolicy-628"><span class="linenos">628</span></a>        <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="SpendingPolicy-629"><a href="#SpendingPolicy-629"><span class="linenos">629</span></a>        
</span><span id="SpendingPolicy-630"><a href="#SpendingPolicy-630"><span class="linenos">630</span></a>        <span class="n">phase_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_phase_in_factor</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
</span><span id="SpendingPolicy-631"><a href="#SpendingPolicy-631"><span class="linenos">631</span></a>        
</span><span id="SpendingPolicy-632"><a href="#SpendingPolicy-632"><span class="linenos">632</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_one_time</span> <span class="ow">and</span> <span class="n">years_since_start</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SpendingPolicy-633"><a href="#SpendingPolicy-633"><span class="linenos">633</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="SpendingPolicy-634"><a href="#SpendingPolicy-634"><span class="linenos">634</span></a>            
</span><span id="SpendingPolicy-635"><a href="#SpendingPolicy-635"><span class="linenos">635</span></a>        <span class="c1"># Apply growth rate</span>
</span><span id="SpendingPolicy-636"><a href="#SpendingPolicy-636"><span class="linenos">636</span></a>        <span class="n">growth_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_growth_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="SpendingPolicy-637"><a href="#SpendingPolicy-637"><span class="linenos">637</span></a>        
</span><span id="SpendingPolicy-638"><a href="#SpendingPolicy-638"><span class="linenos">638</span></a>        <span class="k">return</span> <span class="n">base</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase_factor</span>
</span></pre></div>


            <div class="docstring"><p>Spending policy proposal.</p>

<p>Covers discretionary and mandatory spending changes.</p>
</div>


                            <div id="SpendingPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">SpendingPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">annual_spending_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">annual_growth_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span>,</span><span class="param">	<span class="n">gdp_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>,</span><span class="param">	<span class="n">employment_per_billion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10000</span>,</span><span class="param">	<span class="n">is_one_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">category</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;defense&#39;</span><span class="p">,</span> <span class="s1">&#39;nondefense&#39;</span><span class="p">,</span> <span class="s1">&#39;mandatory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;nondefense&#39;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#SpendingPolicy.__init__"></a>
    
    

                            </div>
                            <div id="SpendingPolicy.annual_spending_change_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_spending_change_billions</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#SpendingPolicy.annual_spending_change_billions"></a>
    
    

                            </div>
                            <div id="SpendingPolicy.annual_growth_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_growth_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.02</span>

        
    </div>
    <a class="headerlink" href="#SpendingPolicy.annual_growth_rate"></a>
    
    

                            </div>
                            <div id="SpendingPolicy.gdp_multiplier" class="classattr">
                                <div class="attr variable">
            <span class="name">gdp_multiplier</span><span class="annotation">: float</span>        =
<span class="default_value">1.0</span>

        
    </div>
    <a class="headerlink" href="#SpendingPolicy.gdp_multiplier"></a>
    
    

                            </div>
                            <div id="SpendingPolicy.employment_per_billion" class="classattr">
                                <div class="attr variable">
            <span class="name">employment_per_billion</span><span class="annotation">: float</span>        =
<span class="default_value">10000</span>

        
    </div>
    <a class="headerlink" href="#SpendingPolicy.employment_per_billion"></a>
    
    

                            </div>
                            <div id="SpendingPolicy.is_one_time" class="classattr">
                                <div class="attr variable">
            <span class="name">is_one_time</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#SpendingPolicy.is_one_time"></a>
    
    

                            </div>
                            <div id="SpendingPolicy.category" class="classattr">
                                <div class="attr variable">
            <span class="name">category</span><span class="annotation">: Literal[&#39;defense&#39;, &#39;nondefense&#39;, &#39;mandatory&#39;]</span>        =
<span class="default_value">&#39;nondefense&#39;</span>

        
    </div>
    <a class="headerlink" href="#SpendingPolicy.category"></a>
    
    

                            </div>
                            <div id="SpendingPolicy.get_spending_in_year" class="classattr">
                                        <input id="SpendingPolicy.get_spending_in_year-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_spending_in_year</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">start_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="SpendingPolicy.get_spending_in_year-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpendingPolicy.get_spending_in_year"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpendingPolicy.get_spending_in_year-620"><a href="#SpendingPolicy.get_spending_in_year-620"><span class="linenos">620</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_spending_in_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">start_amount</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="SpendingPolicy.get_spending_in_year-621"><a href="#SpendingPolicy.get_spending_in_year-621"><span class="linenos">621</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SpendingPolicy.get_spending_in_year-622"><a href="#SpendingPolicy.get_spending_in_year-622"><span class="linenos">622</span></a><span class="sd">        Calculate spending amount for a given year, including growth.</span>
</span><span id="SpendingPolicy.get_spending_in_year-623"><a href="#SpendingPolicy.get_spending_in_year-623"><span class="linenos">623</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SpendingPolicy.get_spending_in_year-624"><a href="#SpendingPolicy.get_spending_in_year-624"><span class="linenos">624</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
</span><span id="SpendingPolicy.get_spending_in_year-625"><a href="#SpendingPolicy.get_spending_in_year-625"><span class="linenos">625</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="SpendingPolicy.get_spending_in_year-626"><a href="#SpendingPolicy.get_spending_in_year-626"><span class="linenos">626</span></a>            
</span><span id="SpendingPolicy.get_spending_in_year-627"><a href="#SpendingPolicy.get_spending_in_year-627"><span class="linenos">627</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">start_amount</span> <span class="k">if</span> <span class="n">start_amount</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_spending_change_billions</span>
</span><span id="SpendingPolicy.get_spending_in_year-628"><a href="#SpendingPolicy.get_spending_in_year-628"><span class="linenos">628</span></a>        <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="SpendingPolicy.get_spending_in_year-629"><a href="#SpendingPolicy.get_spending_in_year-629"><span class="linenos">629</span></a>        
</span><span id="SpendingPolicy.get_spending_in_year-630"><a href="#SpendingPolicy.get_spending_in_year-630"><span class="linenos">630</span></a>        <span class="n">phase_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_phase_in_factor</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
</span><span id="SpendingPolicy.get_spending_in_year-631"><a href="#SpendingPolicy.get_spending_in_year-631"><span class="linenos">631</span></a>        
</span><span id="SpendingPolicy.get_spending_in_year-632"><a href="#SpendingPolicy.get_spending_in_year-632"><span class="linenos">632</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_one_time</span> <span class="ow">and</span> <span class="n">years_since_start</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SpendingPolicy.get_spending_in_year-633"><a href="#SpendingPolicy.get_spending_in_year-633"><span class="linenos">633</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="SpendingPolicy.get_spending_in_year-634"><a href="#SpendingPolicy.get_spending_in_year-634"><span class="linenos">634</span></a>            
</span><span id="SpendingPolicy.get_spending_in_year-635"><a href="#SpendingPolicy.get_spending_in_year-635"><span class="linenos">635</span></a>        <span class="c1"># Apply growth rate</span>
</span><span id="SpendingPolicy.get_spending_in_year-636"><a href="#SpendingPolicy.get_spending_in_year-636"><span class="linenos">636</span></a>        <span class="n">growth_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_growth_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="SpendingPolicy.get_spending_in_year-637"><a href="#SpendingPolicy.get_spending_in_year-637"><span class="linenos">637</span></a>        
</span><span id="SpendingPolicy.get_spending_in_year-638"><a href="#SpendingPolicy.get_spending_in_year-638"><span class="linenos">638</span></a>        <span class="k">return</span> <span class="n">base</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase_factor</span>
</span></pre></div>


            <div class="docstring"><p>Calculate spending amount for a given year, including growth.</p>
</div>


                            </div>
                </section>
                <section id="TransferPolicy">
                            <input id="TransferPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">TransferPolicy</span><wbr>(<span class="base"><a href="#Policy">fiscal_model.Policy</a></span>):

                <label class="view-source-button" for="TransferPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TransferPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TransferPolicy-641"><a href="#TransferPolicy-641"><span class="linenos">641</span></a><span class="nd">@dataclass</span>
</span><span id="TransferPolicy-642"><a href="#TransferPolicy-642"><span class="linenos">642</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TransferPolicy</span><span class="p">(</span><span class="n">Policy</span><span class="p">):</span>
</span><span id="TransferPolicy-643"><a href="#TransferPolicy-643"><span class="linenos">643</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TransferPolicy-644"><a href="#TransferPolicy-644"><span class="linenos">644</span></a><span class="sd">    Transfer program policy (Social Security, Medicare, etc.)</span>
</span><span id="TransferPolicy-645"><a href="#TransferPolicy-645"><span class="linenos">645</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TransferPolicy-646"><a href="#TransferPolicy-646"><span class="linenos">646</span></a>    <span class="c1"># Benefit changes</span>
</span><span id="TransferPolicy-647"><a href="#TransferPolicy-647"><span class="linenos">647</span></a>    <span class="n">benefit_change_percent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Percentage change in benefits</span>
</span><span id="TransferPolicy-648"><a href="#TransferPolicy-648"><span class="linenos">648</span></a>    <span class="n">benefit_change_dollars</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Dollar change per beneficiary</span>
</span><span id="TransferPolicy-649"><a href="#TransferPolicy-649"><span class="linenos">649</span></a>    
</span><span id="TransferPolicy-650"><a href="#TransferPolicy-650"><span class="linenos">650</span></a>    <span class="c1"># Eligibility changes</span>
</span><span id="TransferPolicy-651"><a href="#TransferPolicy-651"><span class="linenos">651</span></a>    <span class="n">eligibility_age_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in eligibility age (years)</span>
</span><span id="TransferPolicy-652"><a href="#TransferPolicy-652"><span class="linenos">652</span></a>    <span class="n">new_beneficiaries_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Net new beneficiaries</span>
</span><span id="TransferPolicy-653"><a href="#TransferPolicy-653"><span class="linenos">653</span></a>    
</span><span id="TransferPolicy-654"><a href="#TransferPolicy-654"><span class="linenos">654</span></a>    <span class="c1"># Cost estimates</span>
</span><span id="TransferPolicy-655"><a href="#TransferPolicy-655"><span class="linenos">655</span></a>    <span class="n">annual_cost_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TransferPolicy-656"><a href="#TransferPolicy-656"><span class="linenos">656</span></a>    
</span><span id="TransferPolicy-657"><a href="#TransferPolicy-657"><span class="linenos">657</span></a>    <span class="c1"># Behavioral responses</span>
</span><span id="TransferPolicy-658"><a href="#TransferPolicy-658"><span class="linenos">658</span></a>    <span class="n">labor_force_participation_effect</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Effect on labor force participation</span>
</span><span id="TransferPolicy-659"><a href="#TransferPolicy-659"><span class="linenos">659</span></a>    
</span><span id="TransferPolicy-660"><a href="#TransferPolicy-660"><span class="linenos">660</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_cost_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_cost</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TransferPolicy-661"><a href="#TransferPolicy-661"><span class="linenos">661</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TransferPolicy-662"><a href="#TransferPolicy-662"><span class="linenos">662</span></a><span class="sd">        Estimate change in program costs.</span>
</span><span id="TransferPolicy-663"><a href="#TransferPolicy-663"><span class="linenos">663</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TransferPolicy-664"><a href="#TransferPolicy-664"><span class="linenos">664</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_cost_change_billions</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TransferPolicy-665"><a href="#TransferPolicy-665"><span class="linenos">665</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_cost_change_billions</span>
</span><span id="TransferPolicy-666"><a href="#TransferPolicy-666"><span class="linenos">666</span></a>            
</span><span id="TransferPolicy-667"><a href="#TransferPolicy-667"><span class="linenos">667</span></a>        <span class="c1"># Benefit change effect</span>
</span><span id="TransferPolicy-668"><a href="#TransferPolicy-668"><span class="linenos">668</span></a>        <span class="n">cost_change</span> <span class="o">=</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_change_percent</span>
</span><span id="TransferPolicy-669"><a href="#TransferPolicy-669"><span class="linenos">669</span></a>        
</span><span id="TransferPolicy-670"><a href="#TransferPolicy-670"><span class="linenos">670</span></a>        <span class="c1"># New beneficiaries (assume average benefit)</span>
</span><span id="TransferPolicy-671"><a href="#TransferPolicy-671"><span class="linenos">671</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_beneficiaries_millions</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TransferPolicy-672"><a href="#TransferPolicy-672"><span class="linenos">672</span></a>            <span class="n">avg_benefit</span> <span class="o">=</span> <span class="n">baseline_cost</span> <span class="o">/</span> <span class="mi">60</span>  <span class="c1"># Rough estimate per million beneficiaries</span>
</span><span id="TransferPolicy-673"><a href="#TransferPolicy-673"><span class="linenos">673</span></a>            <span class="n">cost_change</span> <span class="o">+=</span> <span class="n">avg_benefit</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_beneficiaries_millions</span>
</span><span id="TransferPolicy-674"><a href="#TransferPolicy-674"><span class="linenos">674</span></a>            
</span><span id="TransferPolicy-675"><a href="#TransferPolicy-675"><span class="linenos">675</span></a>        <span class="k">return</span> <span class="n">cost_change</span>
</span></pre></div>


            <div class="docstring"><p>Transfer program policy (Social Security, Medicare, etc.)</p>
</div>


                            <div id="TransferPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TransferPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">benefit_change_percent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">benefit_change_dollars</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">eligibility_age_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_beneficiaries_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">annual_cost_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">labor_force_participation_effect</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TransferPolicy.__init__"></a>
    
    

                            </div>
                            <div id="TransferPolicy.benefit_change_percent" class="classattr">
                                <div class="attr variable">
            <span class="name">benefit_change_percent</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TransferPolicy.benefit_change_percent"></a>
    
    

                            </div>
                            <div id="TransferPolicy.benefit_change_dollars" class="classattr">
                                <div class="attr variable">
            <span class="name">benefit_change_dollars</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TransferPolicy.benefit_change_dollars"></a>
    
    

                            </div>
                            <div id="TransferPolicy.eligibility_age_change" class="classattr">
                                <div class="attr variable">
            <span class="name">eligibility_age_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TransferPolicy.eligibility_age_change"></a>
    
    

                            </div>
                            <div id="TransferPolicy.new_beneficiaries_millions" class="classattr">
                                <div class="attr variable">
            <span class="name">new_beneficiaries_millions</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TransferPolicy.new_beneficiaries_millions"></a>
    
    

                            </div>
                            <div id="TransferPolicy.annual_cost_change_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_cost_change_billions</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TransferPolicy.annual_cost_change_billions"></a>
    
    

                            </div>
                            <div id="TransferPolicy.labor_force_participation_effect" class="classattr">
                                <div class="attr variable">
            <span class="name">labor_force_participation_effect</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TransferPolicy.labor_force_participation_effect"></a>
    
    

                            </div>
                            <div id="TransferPolicy.estimate_cost_effect" class="classattr">
                                        <input id="TransferPolicy.estimate_cost_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_cost_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_cost</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TransferPolicy.estimate_cost_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TransferPolicy.estimate_cost_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TransferPolicy.estimate_cost_effect-660"><a href="#TransferPolicy.estimate_cost_effect-660"><span class="linenos">660</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_cost_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_cost</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TransferPolicy.estimate_cost_effect-661"><a href="#TransferPolicy.estimate_cost_effect-661"><span class="linenos">661</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TransferPolicy.estimate_cost_effect-662"><a href="#TransferPolicy.estimate_cost_effect-662"><span class="linenos">662</span></a><span class="sd">        Estimate change in program costs.</span>
</span><span id="TransferPolicy.estimate_cost_effect-663"><a href="#TransferPolicy.estimate_cost_effect-663"><span class="linenos">663</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TransferPolicy.estimate_cost_effect-664"><a href="#TransferPolicy.estimate_cost_effect-664"><span class="linenos">664</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_cost_change_billions</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TransferPolicy.estimate_cost_effect-665"><a href="#TransferPolicy.estimate_cost_effect-665"><span class="linenos">665</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_cost_change_billions</span>
</span><span id="TransferPolicy.estimate_cost_effect-666"><a href="#TransferPolicy.estimate_cost_effect-666"><span class="linenos">666</span></a>            
</span><span id="TransferPolicy.estimate_cost_effect-667"><a href="#TransferPolicy.estimate_cost_effect-667"><span class="linenos">667</span></a>        <span class="c1"># Benefit change effect</span>
</span><span id="TransferPolicy.estimate_cost_effect-668"><a href="#TransferPolicy.estimate_cost_effect-668"><span class="linenos">668</span></a>        <span class="n">cost_change</span> <span class="o">=</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_change_percent</span>
</span><span id="TransferPolicy.estimate_cost_effect-669"><a href="#TransferPolicy.estimate_cost_effect-669"><span class="linenos">669</span></a>        
</span><span id="TransferPolicy.estimate_cost_effect-670"><a href="#TransferPolicy.estimate_cost_effect-670"><span class="linenos">670</span></a>        <span class="c1"># New beneficiaries (assume average benefit)</span>
</span><span id="TransferPolicy.estimate_cost_effect-671"><a href="#TransferPolicy.estimate_cost_effect-671"><span class="linenos">671</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_beneficiaries_millions</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TransferPolicy.estimate_cost_effect-672"><a href="#TransferPolicy.estimate_cost_effect-672"><span class="linenos">672</span></a>            <span class="n">avg_benefit</span> <span class="o">=</span> <span class="n">baseline_cost</span> <span class="o">/</span> <span class="mi">60</span>  <span class="c1"># Rough estimate per million beneficiaries</span>
</span><span id="TransferPolicy.estimate_cost_effect-673"><a href="#TransferPolicy.estimate_cost_effect-673"><span class="linenos">673</span></a>            <span class="n">cost_change</span> <span class="o">+=</span> <span class="n">avg_benefit</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_beneficiaries_millions</span>
</span><span id="TransferPolicy.estimate_cost_effect-674"><a href="#TransferPolicy.estimate_cost_effect-674"><span class="linenos">674</span></a>            
</span><span id="TransferPolicy.estimate_cost_effect-675"><a href="#TransferPolicy.estimate_cost_effect-675"><span class="linenos">675</span></a>        <span class="k">return</span> <span class="n">cost_change</span>
</span></pre></div>


            <div class="docstring"><p>Estimate change in program costs.</p>
</div>


                            </div>
                </section>
                <section id="PolicyPackage">
                            <input id="PolicyPackage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">PolicyPackage</span>:

                <label class="view-source-button" for="PolicyPackage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PolicyPackage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PolicyPackage-678"><a href="#PolicyPackage-678"><span class="linenos">678</span></a><span class="nd">@dataclass</span>
</span><span id="PolicyPackage-679"><a href="#PolicyPackage-679"><span class="linenos">679</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PolicyPackage</span><span class="p">:</span>
</span><span id="PolicyPackage-680"><a href="#PolicyPackage-680"><span class="linenos">680</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PolicyPackage-681"><a href="#PolicyPackage-681"><span class="linenos">681</span></a><span class="sd">    A package of multiple policies analyzed together.</span>
</span><span id="PolicyPackage-682"><a href="#PolicyPackage-682"><span class="linenos">682</span></a><span class="sd">    </span>
</span><span id="PolicyPackage-683"><a href="#PolicyPackage-683"><span class="linenos">683</span></a><span class="sd">    Allows for interaction effects between policies.</span>
</span><span id="PolicyPackage-684"><a href="#PolicyPackage-684"><span class="linenos">684</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PolicyPackage-685"><a href="#PolicyPackage-685"><span class="linenos">685</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="PolicyPackage-686"><a href="#PolicyPackage-686"><span class="linenos">686</span></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="PolicyPackage-687"><a href="#PolicyPackage-687"><span class="linenos">687</span></a>    <span class="n">policies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Policy</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="PolicyPackage-688"><a href="#PolicyPackage-688"><span class="linenos">688</span></a>    
</span><span id="PolicyPackage-689"><a href="#PolicyPackage-689"><span class="linenos">689</span></a>    <span class="c1"># Interaction parameters</span>
</span><span id="PolicyPackage-690"><a href="#PolicyPackage-690"><span class="linenos">690</span></a>    <span class="n">interaction_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Adjustment for policy interactions</span>
</span><span id="PolicyPackage-691"><a href="#PolicyPackage-691"><span class="linenos">691</span></a>    
</span><span id="PolicyPackage-692"><a href="#PolicyPackage-692"><span class="linenos">692</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">):</span>
</span><span id="PolicyPackage-693"><a href="#PolicyPackage-693"><span class="linenos">693</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a policy to the package.&quot;&quot;&quot;</span>
</span><span id="PolicyPackage-694"><a href="#PolicyPackage-694"><span class="linenos">694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">policies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span><span id="PolicyPackage-695"><a href="#PolicyPackage-695"><span class="linenos">695</span></a>        
</span><span id="PolicyPackage-696"><a href="#PolicyPackage-696"><span class="linenos">696</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_years</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="PolicyPackage-697"><a href="#PolicyPackage-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the range of years covered by all policies.&quot;&quot;&quot;</span>
</span><span id="PolicyPackage-698"><a href="#PolicyPackage-698"><span class="linenos">698</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">policies</span><span class="p">:</span>
</span><span id="PolicyPackage-699"><a href="#PolicyPackage-699"><span class="linenos">699</span></a>            <span class="k">return</span> <span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">2034</span><span class="p">)</span>
</span><span id="PolicyPackage-700"><a href="#PolicyPackage-700"><span class="linenos">700</span></a>            
</span><span id="PolicyPackage-701"><a href="#PolicyPackage-701"><span class="linenos">701</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">start_year</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">policies</span><span class="p">)</span>
</span><span id="PolicyPackage-702"><a href="#PolicyPackage-702"><span class="linenos">702</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">duration_years</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">policies</span><span class="p">)</span>
</span><span id="PolicyPackage-703"><a href="#PolicyPackage-703"><span class="linenos">703</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span id="PolicyPackage-704"><a href="#PolicyPackage-704"><span class="linenos">704</span></a>    
</span><span id="PolicyPackage-705"><a href="#PolicyPackage-705"><span class="linenos">705</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_active_policies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Policy</span><span class="p">]:</span>
</span><span id="PolicyPackage-706"><a href="#PolicyPackage-706"><span class="linenos">706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all policies active in a given year.&quot;&quot;&quot;</span>
</span><span id="PolicyPackage-707"><a href="#PolicyPackage-707"><span class="linenos">707</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">policies</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="n">year</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>A package of multiple policies analyzed together.</p>

<p>Allows for interaction effects between policies.</p>
</div>


                            <div id="PolicyPackage.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PolicyPackage</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Policy">Policy</a></span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">interaction_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PolicyPackage.__init__"></a>
    
    

                            </div>
                            <div id="PolicyPackage.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#PolicyPackage.name"></a>
    
    

                            </div>
                            <div id="PolicyPackage.description" class="classattr">
                                <div class="attr variable">
            <span class="name">description</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#PolicyPackage.description"></a>
    
    

                            </div>
                            <div id="PolicyPackage.policies" class="classattr">
                                <div class="attr variable">
            <span class="name">policies</span><span class="annotation">: list[<a href="#Policy">Policy</a>]</span>

        
    </div>
    <a class="headerlink" href="#PolicyPackage.policies"></a>
    
    

                            </div>
                            <div id="PolicyPackage.interaction_factor" class="classattr">
                                <div class="attr variable">
            <span class="name">interaction_factor</span><span class="annotation">: float</span>        =
<span class="default_value">1.0</span>

        
    </div>
    <a class="headerlink" href="#PolicyPackage.interaction_factor"></a>
    
    

                            </div>
                            <div id="PolicyPackage.add_policy" class="classattr">
                                        <input id="PolicyPackage.add_policy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_policy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PolicyPackage.add_policy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PolicyPackage.add_policy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PolicyPackage.add_policy-692"><a href="#PolicyPackage.add_policy-692"><span class="linenos">692</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">):</span>
</span><span id="PolicyPackage.add_policy-693"><a href="#PolicyPackage.add_policy-693"><span class="linenos">693</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a policy to the package.&quot;&quot;&quot;</span>
</span><span id="PolicyPackage.add_policy-694"><a href="#PolicyPackage.add_policy-694"><span class="linenos">694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">policies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add a policy to the package.</p>
</div>


                            </div>
                            <div id="PolicyPackage.get_all_years" class="classattr">
                                        <input id="PolicyPackage.get_all_years-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_all_years</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PolicyPackage.get_all_years-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PolicyPackage.get_all_years"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PolicyPackage.get_all_years-696"><a href="#PolicyPackage.get_all_years-696"><span class="linenos">696</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_years</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="PolicyPackage.get_all_years-697"><a href="#PolicyPackage.get_all_years-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the range of years covered by all policies.&quot;&quot;&quot;</span>
</span><span id="PolicyPackage.get_all_years-698"><a href="#PolicyPackage.get_all_years-698"><span class="linenos">698</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">policies</span><span class="p">:</span>
</span><span id="PolicyPackage.get_all_years-699"><a href="#PolicyPackage.get_all_years-699"><span class="linenos">699</span></a>            <span class="k">return</span> <span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">2034</span><span class="p">)</span>
</span><span id="PolicyPackage.get_all_years-700"><a href="#PolicyPackage.get_all_years-700"><span class="linenos">700</span></a>            
</span><span id="PolicyPackage.get_all_years-701"><a href="#PolicyPackage.get_all_years-701"><span class="linenos">701</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">start_year</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">policies</span><span class="p">)</span>
</span><span id="PolicyPackage.get_all_years-702"><a href="#PolicyPackage.get_all_years-702"><span class="linenos">702</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">duration_years</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">policies</span><span class="p">)</span>
</span><span id="PolicyPackage.get_all_years-703"><a href="#PolicyPackage.get_all_years-703"><span class="linenos">703</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the range of years covered by all policies.</p>
</div>


                            </div>
                            <div id="PolicyPackage.get_active_policies" class="classattr">
                                        <input id="PolicyPackage.get_active_policies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_active_policies</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#Policy">Policy</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PolicyPackage.get_active_policies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PolicyPackage.get_active_policies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PolicyPackage.get_active_policies-705"><a href="#PolicyPackage.get_active_policies-705"><span class="linenos">705</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_active_policies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Policy</span><span class="p">]:</span>
</span><span id="PolicyPackage.get_active_policies-706"><a href="#PolicyPackage.get_active_policies-706"><span class="linenos">706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all policies active in a given year.&quot;&quot;&quot;</span>
</span><span id="PolicyPackage.get_active_policies-707"><a href="#PolicyPackage.get_active_policies-707"><span class="linenos">707</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">policies</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="n">year</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Get all policies active in a given year.</p>
</div>


                            </div>
                </section>
                <section id="PolicyType">
                            <input id="PolicyType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PolicyType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="PolicyType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PolicyType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PolicyType-15"><a href="#PolicyType-15"><span class="linenos">15</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PolicyType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="PolicyType-16"><a href="#PolicyType-16"><span class="linenos">16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Categories of fiscal policies.&quot;&quot;&quot;</span>
</span><span id="PolicyType-17"><a href="#PolicyType-17"><span class="linenos">17</span></a>    <span class="c1"># Tax policies</span>
</span><span id="PolicyType-18"><a href="#PolicyType-18"><span class="linenos">18</span></a>    <span class="n">INCOME_TAX</span> <span class="o">=</span> <span class="s2">&quot;income_tax&quot;</span>
</span><span id="PolicyType-19"><a href="#PolicyType-19"><span class="linenos">19</span></a>    <span class="n">CORPORATE_TAX</span> <span class="o">=</span> <span class="s2">&quot;corporate_tax&quot;</span>
</span><span id="PolicyType-20"><a href="#PolicyType-20"><span class="linenos">20</span></a>    <span class="n">PAYROLL_TAX</span> <span class="o">=</span> <span class="s2">&quot;payroll_tax&quot;</span>
</span><span id="PolicyType-21"><a href="#PolicyType-21"><span class="linenos">21</span></a>    <span class="n">CAPITAL_GAINS_TAX</span> <span class="o">=</span> <span class="s2">&quot;capital_gains_tax&quot;</span>
</span><span id="PolicyType-22"><a href="#PolicyType-22"><span class="linenos">22</span></a>    <span class="n">ESTATE_TAX</span> <span class="o">=</span> <span class="s2">&quot;estate_tax&quot;</span>
</span><span id="PolicyType-23"><a href="#PolicyType-23"><span class="linenos">23</span></a>    <span class="n">EXCISE_TAX</span> <span class="o">=</span> <span class="s2">&quot;excise_tax&quot;</span>
</span><span id="PolicyType-24"><a href="#PolicyType-24"><span class="linenos">24</span></a>    <span class="n">TAX_CREDIT</span> <span class="o">=</span> <span class="s2">&quot;tax_credit&quot;</span>
</span><span id="PolicyType-25"><a href="#PolicyType-25"><span class="linenos">25</span></a>    <span class="n">TAX_DEDUCTION</span> <span class="o">=</span> <span class="s2">&quot;tax_deduction&quot;</span>
</span><span id="PolicyType-26"><a href="#PolicyType-26"><span class="linenos">26</span></a>    
</span><span id="PolicyType-27"><a href="#PolicyType-27"><span class="linenos">27</span></a>    <span class="c1"># Spending policies</span>
</span><span id="PolicyType-28"><a href="#PolicyType-28"><span class="linenos">28</span></a>    <span class="n">DISCRETIONARY_DEFENSE</span> <span class="o">=</span> <span class="s2">&quot;discretionary_defense&quot;</span>
</span><span id="PolicyType-29"><a href="#PolicyType-29"><span class="linenos">29</span></a>    <span class="n">DISCRETIONARY_NONDEFENSE</span> <span class="o">=</span> <span class="s2">&quot;discretionary_nondefense&quot;</span>
</span><span id="PolicyType-30"><a href="#PolicyType-30"><span class="linenos">30</span></a>    <span class="n">MANDATORY_SPENDING</span> <span class="o">=</span> <span class="s2">&quot;mandatory_spending&quot;</span>
</span><span id="PolicyType-31"><a href="#PolicyType-31"><span class="linenos">31</span></a>    <span class="n">INFRASTRUCTURE</span> <span class="o">=</span> <span class="s2">&quot;infrastructure&quot;</span>
</span><span id="PolicyType-32"><a href="#PolicyType-32"><span class="linenos">32</span></a>    
</span><span id="PolicyType-33"><a href="#PolicyType-33"><span class="linenos">33</span></a>    <span class="c1"># Transfer programs</span>
</span><span id="PolicyType-34"><a href="#PolicyType-34"><span class="linenos">34</span></a>    <span class="n">SOCIAL_SECURITY</span> <span class="o">=</span> <span class="s2">&quot;social_security&quot;</span>
</span><span id="PolicyType-35"><a href="#PolicyType-35"><span class="linenos">35</span></a>    <span class="n">MEDICARE</span> <span class="o">=</span> <span class="s2">&quot;medicare&quot;</span>
</span><span id="PolicyType-36"><a href="#PolicyType-36"><span class="linenos">36</span></a>    <span class="n">MEDICAID</span> <span class="o">=</span> <span class="s2">&quot;medicaid&quot;</span>
</span><span id="PolicyType-37"><a href="#PolicyType-37"><span class="linenos">37</span></a>    <span class="n">UNEMPLOYMENT</span> <span class="o">=</span> <span class="s2">&quot;unemployment&quot;</span>
</span><span id="PolicyType-38"><a href="#PolicyType-38"><span class="linenos">38</span></a>    <span class="n">SNAP</span> <span class="o">=</span> <span class="s2">&quot;snap&quot;</span>
</span><span id="PolicyType-39"><a href="#PolicyType-39"><span class="linenos">39</span></a>    <span class="n">OTHER_TRANSFER</span> <span class="o">=</span> <span class="s2">&quot;other_transfer&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Categories of fiscal policies.</p>
</div>


                            <div id="PolicyType.INCOME_TAX" class="classattr">
                                <div class="attr variable">
            <span class="name">INCOME_TAX</span>        =
<span class="default_value">&lt;<a href="#PolicyType.INCOME_TAX">PolicyType.INCOME_TAX</a>: &#39;income_tax&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.INCOME_TAX"></a>
    
    

                            </div>
                            <div id="PolicyType.CORPORATE_TAX" class="classattr">
                                <div class="attr variable">
            <span class="name">CORPORATE_TAX</span>        =
<span class="default_value">&lt;<a href="#PolicyType.CORPORATE_TAX">PolicyType.CORPORATE_TAX</a>: &#39;corporate_tax&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.CORPORATE_TAX"></a>
    
    

                            </div>
                            <div id="PolicyType.PAYROLL_TAX" class="classattr">
                                <div class="attr variable">
            <span class="name">PAYROLL_TAX</span>        =
<span class="default_value">&lt;<a href="#PolicyType.PAYROLL_TAX">PolicyType.PAYROLL_TAX</a>: &#39;payroll_tax&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.PAYROLL_TAX"></a>
    
    

                            </div>
                            <div id="PolicyType.CAPITAL_GAINS_TAX" class="classattr">
                                <div class="attr variable">
            <span class="name">CAPITAL_GAINS_TAX</span>        =
<span class="default_value">&lt;<a href="#PolicyType.CAPITAL_GAINS_TAX">PolicyType.CAPITAL_GAINS_TAX</a>: &#39;capital_gains_tax&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.CAPITAL_GAINS_TAX"></a>
    
    

                            </div>
                            <div id="PolicyType.ESTATE_TAX" class="classattr">
                                <div class="attr variable">
            <span class="name">ESTATE_TAX</span>        =
<span class="default_value">&lt;<a href="#PolicyType.ESTATE_TAX">PolicyType.ESTATE_TAX</a>: &#39;estate_tax&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.ESTATE_TAX"></a>
    
    

                            </div>
                            <div id="PolicyType.EXCISE_TAX" class="classattr">
                                <div class="attr variable">
            <span class="name">EXCISE_TAX</span>        =
<span class="default_value">&lt;<a href="#PolicyType.EXCISE_TAX">PolicyType.EXCISE_TAX</a>: &#39;excise_tax&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.EXCISE_TAX"></a>
    
    

                            </div>
                            <div id="PolicyType.TAX_CREDIT" class="classattr">
                                <div class="attr variable">
            <span class="name">TAX_CREDIT</span>        =
<span class="default_value">&lt;<a href="#PolicyType.TAX_CREDIT">PolicyType.TAX_CREDIT</a>: &#39;tax_credit&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.TAX_CREDIT"></a>
    
    

                            </div>
                            <div id="PolicyType.TAX_DEDUCTION" class="classattr">
                                <div class="attr variable">
            <span class="name">TAX_DEDUCTION</span>        =
<span class="default_value">&lt;<a href="#PolicyType.TAX_DEDUCTION">PolicyType.TAX_DEDUCTION</a>: &#39;tax_deduction&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.TAX_DEDUCTION"></a>
    
    

                            </div>
                            <div id="PolicyType.DISCRETIONARY_DEFENSE" class="classattr">
                                <div class="attr variable">
            <span class="name">DISCRETIONARY_DEFENSE</span>        =
<span class="default_value">&lt;<a href="#PolicyType.DISCRETIONARY_DEFENSE">PolicyType.DISCRETIONARY_DEFENSE</a>: &#39;discretionary_defense&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.DISCRETIONARY_DEFENSE"></a>
    
    

                            </div>
                            <div id="PolicyType.DISCRETIONARY_NONDEFENSE" class="classattr">
                                <div class="attr variable">
            <span class="name">DISCRETIONARY_NONDEFENSE</span>        =
<span class="default_value">&lt;<a href="#PolicyType.DISCRETIONARY_NONDEFENSE">PolicyType.DISCRETIONARY_NONDEFENSE</a>: &#39;discretionary_nondefense&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.DISCRETIONARY_NONDEFENSE"></a>
    
    

                            </div>
                            <div id="PolicyType.MANDATORY_SPENDING" class="classattr">
                                <div class="attr variable">
            <span class="name">MANDATORY_SPENDING</span>        =
<span class="default_value">&lt;<a href="#PolicyType.MANDATORY_SPENDING">PolicyType.MANDATORY_SPENDING</a>: &#39;mandatory_spending&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.MANDATORY_SPENDING"></a>
    
    

                            </div>
                            <div id="PolicyType.INFRASTRUCTURE" class="classattr">
                                <div class="attr variable">
            <span class="name">INFRASTRUCTURE</span>        =
<span class="default_value">&lt;<a href="#PolicyType.INFRASTRUCTURE">PolicyType.INFRASTRUCTURE</a>: &#39;infrastructure&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.INFRASTRUCTURE"></a>
    
    

                            </div>
                            <div id="PolicyType.SOCIAL_SECURITY" class="classattr">
                                <div class="attr variable">
            <span class="name">SOCIAL_SECURITY</span>        =
<span class="default_value">&lt;<a href="#PolicyType.SOCIAL_SECURITY">PolicyType.SOCIAL_SECURITY</a>: &#39;social_security&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.SOCIAL_SECURITY"></a>
    
    

                            </div>
                            <div id="PolicyType.MEDICARE" class="classattr">
                                <div class="attr variable">
            <span class="name">MEDICARE</span>        =
<span class="default_value">&lt;<a href="#PolicyType.MEDICARE">PolicyType.MEDICARE</a>: &#39;medicare&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.MEDICARE"></a>
    
    

                            </div>
                            <div id="PolicyType.MEDICAID" class="classattr">
                                <div class="attr variable">
            <span class="name">MEDICAID</span>        =
<span class="default_value">&lt;<a href="#PolicyType.MEDICAID">PolicyType.MEDICAID</a>: &#39;medicaid&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.MEDICAID"></a>
    
    

                            </div>
                            <div id="PolicyType.UNEMPLOYMENT" class="classattr">
                                <div class="attr variable">
            <span class="name">UNEMPLOYMENT</span>        =
<span class="default_value">&lt;<a href="#PolicyType.UNEMPLOYMENT">PolicyType.UNEMPLOYMENT</a>: &#39;unemployment&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.UNEMPLOYMENT"></a>
    
    

                            </div>
                            <div id="PolicyType.SNAP" class="classattr">
                                <div class="attr variable">
            <span class="name">SNAP</span>        =
<span class="default_value">&lt;<a href="#PolicyType.SNAP">PolicyType.SNAP</a>: &#39;snap&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.SNAP"></a>
    
    

                            </div>
                            <div id="PolicyType.OTHER_TRANSFER" class="classattr">
                                <div class="attr variable">
            <span class="name">OTHER_TRANSFER</span>        =
<span class="default_value">&lt;<a href="#PolicyType.OTHER_TRANSFER">PolicyType.OTHER_TRANSFER</a>: &#39;other_transfer&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PolicyType.OTHER_TRANSFER"></a>
    
    

                            </div>
                </section>
                <section id="create_income_tax_cut">
                            <input id="create_income_tax_cut-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_income_tax_cut</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">rate_reduction</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">affected_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxPolicy">TaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_income_tax_cut-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_income_tax_cut"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_income_tax_cut-712"><a href="#create_income_tax_cut-712"><span class="linenos">712</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_income_tax_cut</span><span class="p">(</span>
</span><span id="create_income_tax_cut-713"><a href="#create_income_tax_cut-713"><span class="linenos">713</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="create_income_tax_cut-714"><a href="#create_income_tax_cut-714"><span class="linenos">714</span></a>    <span class="n">rate_reduction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_income_tax_cut-715"><a href="#create_income_tax_cut-715"><span class="linenos">715</span></a>    <span class="n">income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="create_income_tax_cut-716"><a href="#create_income_tax_cut-716"><span class="linenos">716</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_income_tax_cut-717"><a href="#create_income_tax_cut-717"><span class="linenos">717</span></a>    <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_income_tax_cut-718"><a href="#create_income_tax_cut-718"><span class="linenos">718</span></a>    <span class="n">affected_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="create_income_tax_cut-719"><a href="#create_income_tax_cut-719"><span class="linenos">719</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxPolicy</span><span class="p">:</span>
</span><span id="create_income_tax_cut-720"><a href="#create_income_tax_cut-720"><span class="linenos">720</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_income_tax_cut-721"><a href="#create_income_tax_cut-721"><span class="linenos">721</span></a><span class="sd">    Create a standard income tax cut policy.</span>
</span><span id="create_income_tax_cut-722"><a href="#create_income_tax_cut-722"><span class="linenos">722</span></a>
</span><span id="create_income_tax_cut-723"><a href="#create_income_tax_cut-723"><span class="linenos">723</span></a><span class="sd">    Args:</span>
</span><span id="create_income_tax_cut-724"><a href="#create_income_tax_cut-724"><span class="linenos">724</span></a><span class="sd">        name: Policy name for identification</span>
</span><span id="create_income_tax_cut-725"><a href="#create_income_tax_cut-725"><span class="linenos">725</span></a><span class="sd">        rate_reduction: Reduction in tax rate as decimal (e.g., 0.02 for 2pp cut)</span>
</span><span id="create_income_tax_cut-726"><a href="#create_income_tax_cut-726"><span class="linenos">726</span></a><span class="sd">        income_threshold: Income threshold for applicability (dollars)</span>
</span><span id="create_income_tax_cut-727"><a href="#create_income_tax_cut-727"><span class="linenos">727</span></a><span class="sd">        start_year: First year policy takes effect</span>
</span><span id="create_income_tax_cut-728"><a href="#create_income_tax_cut-728"><span class="linenos">728</span></a><span class="sd">        duration: Number of years policy is active</span>
</span><span id="create_income_tax_cut-729"><a href="#create_income_tax_cut-729"><span class="linenos">729</span></a><span class="sd">        affected_millions: Estimated affected taxpayers in millions</span>
</span><span id="create_income_tax_cut-730"><a href="#create_income_tax_cut-730"><span class="linenos">730</span></a>
</span><span id="create_income_tax_cut-731"><a href="#create_income_tax_cut-731"><span class="linenos">731</span></a><span class="sd">    Returns:</span>
</span><span id="create_income_tax_cut-732"><a href="#create_income_tax_cut-732"><span class="linenos">732</span></a><span class="sd">        TaxPolicy configured as an income tax cut</span>
</span><span id="create_income_tax_cut-733"><a href="#create_income_tax_cut-733"><span class="linenos">733</span></a>
</span><span id="create_income_tax_cut-734"><a href="#create_income_tax_cut-734"><span class="linenos">734</span></a><span class="sd">    Example:</span>
</span><span id="create_income_tax_cut-735"><a href="#create_income_tax_cut-735"><span class="linenos">735</span></a><span class="sd">        &gt;&gt;&gt; policy = create_income_tax_cut(&quot;Top Rate Cut&quot;, 0.03, income_threshold=500000)</span>
</span><span id="create_income_tax_cut-736"><a href="#create_income_tax_cut-736"><span class="linenos">736</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_income_tax_cut-737"><a href="#create_income_tax_cut-737"><span class="linenos">737</span></a>    <span class="k">return</span> <span class="n">TaxPolicy</span><span class="p">(</span>
</span><span id="create_income_tax_cut-738"><a href="#create_income_tax_cut-738"><span class="linenos">738</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="create_income_tax_cut-739"><a href="#create_income_tax_cut-739"><span class="linenos">739</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Reduce income tax rate by </span><span class="si">{</span><span class="n">rate_reduction</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> percentage points&quot;</span><span class="p">,</span>
</span><span id="create_income_tax_cut-740"><a href="#create_income_tax_cut-740"><span class="linenos">740</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">,</span>
</span><span id="create_income_tax_cut-741"><a href="#create_income_tax_cut-741"><span class="linenos">741</span></a>        <span class="n">rate_change</span><span class="o">=-</span><span class="nb">abs</span><span class="p">(</span><span class="n">rate_reduction</span><span class="p">),</span>
</span><span id="create_income_tax_cut-742"><a href="#create_income_tax_cut-742"><span class="linenos">742</span></a>        <span class="n">affected_income_threshold</span><span class="o">=</span><span class="n">income_threshold</span><span class="p">,</span>
</span><span id="create_income_tax_cut-743"><a href="#create_income_tax_cut-743"><span class="linenos">743</span></a>        <span class="n">affected_taxpayers_millions</span><span class="o">=</span><span class="n">affected_millions</span><span class="p">,</span>
</span><span id="create_income_tax_cut-744"><a href="#create_income_tax_cut-744"><span class="linenos">744</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_income_tax_cut-745"><a href="#create_income_tax_cut-745"><span class="linenos">745</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
</span><span id="create_income_tax_cut-746"><a href="#create_income_tax_cut-746"><span class="linenos">746</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a standard income tax cut policy.</p>

<p>Args:
    name: Policy name for identification
    rate_reduction: Reduction in tax rate as decimal (e.g., 0.02 for 2pp cut)
    income_threshold: Income threshold for applicability (dollars)
    start_year: First year policy takes effect
    duration: Number of years policy is active
    affected_millions: Estimated affected taxpayers in millions</p>

<p>Returns:
    TaxPolicy configured as an income tax cut</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>policy = create_income_tax_cut("Top Rate Cut", 0.03, income_threshold=500000)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="create_new_tax_credit">
                            <input id="create_new_tax_credit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_new_tax_credit</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">amount</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">refundable</span><span class="p">:</span> <span class="nb">bool</span>,</span><span class="param">	<span class="n">affected_millions</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxPolicy">TaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_new_tax_credit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_new_tax_credit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_new_tax_credit-749"><a href="#create_new_tax_credit-749"><span class="linenos">749</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_new_tax_credit</span><span class="p">(</span>
</span><span id="create_new_tax_credit-750"><a href="#create_new_tax_credit-750"><span class="linenos">750</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="create_new_tax_credit-751"><a href="#create_new_tax_credit-751"><span class="linenos">751</span></a>    <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_new_tax_credit-752"><a href="#create_new_tax_credit-752"><span class="linenos">752</span></a>    <span class="n">refundable</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="create_new_tax_credit-753"><a href="#create_new_tax_credit-753"><span class="linenos">753</span></a>    <span class="n">affected_millions</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_new_tax_credit-754"><a href="#create_new_tax_credit-754"><span class="linenos">754</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_new_tax_credit-755"><a href="#create_new_tax_credit-755"><span class="linenos">755</span></a>    <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="create_new_tax_credit-756"><a href="#create_new_tax_credit-756"><span class="linenos">756</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxPolicy</span><span class="p">:</span>
</span><span id="create_new_tax_credit-757"><a href="#create_new_tax_credit-757"><span class="linenos">757</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_new_tax_credit-758"><a href="#create_new_tax_credit-758"><span class="linenos">758</span></a><span class="sd">    Create a new tax credit policy.</span>
</span><span id="create_new_tax_credit-759"><a href="#create_new_tax_credit-759"><span class="linenos">759</span></a>
</span><span id="create_new_tax_credit-760"><a href="#create_new_tax_credit-760"><span class="linenos">760</span></a><span class="sd">    Args:</span>
</span><span id="create_new_tax_credit-761"><a href="#create_new_tax_credit-761"><span class="linenos">761</span></a><span class="sd">        name: Policy name for identification</span>
</span><span id="create_new_tax_credit-762"><a href="#create_new_tax_credit-762"><span class="linenos">762</span></a><span class="sd">        amount: Credit amount per taxpayer in dollars</span>
</span><span id="create_new_tax_credit-763"><a href="#create_new_tax_credit-763"><span class="linenos">763</span></a><span class="sd">        refundable: Whether the credit is refundable (paid even if no tax liability)</span>
</span><span id="create_new_tax_credit-764"><a href="#create_new_tax_credit-764"><span class="linenos">764</span></a><span class="sd">        affected_millions: Estimated eligible taxpayers in millions</span>
</span><span id="create_new_tax_credit-765"><a href="#create_new_tax_credit-765"><span class="linenos">765</span></a><span class="sd">        start_year: First year policy takes effect</span>
</span><span id="create_new_tax_credit-766"><a href="#create_new_tax_credit-766"><span class="linenos">766</span></a><span class="sd">        duration: Number of years policy is active</span>
</span><span id="create_new_tax_credit-767"><a href="#create_new_tax_credit-767"><span class="linenos">767</span></a>
</span><span id="create_new_tax_credit-768"><a href="#create_new_tax_credit-768"><span class="linenos">768</span></a><span class="sd">    Returns:</span>
</span><span id="create_new_tax_credit-769"><a href="#create_new_tax_credit-769"><span class="linenos">769</span></a><span class="sd">        TaxPolicy configured as a tax credit</span>
</span><span id="create_new_tax_credit-770"><a href="#create_new_tax_credit-770"><span class="linenos">770</span></a>
</span><span id="create_new_tax_credit-771"><a href="#create_new_tax_credit-771"><span class="linenos">771</span></a><span class="sd">    Example:</span>
</span><span id="create_new_tax_credit-772"><a href="#create_new_tax_credit-772"><span class="linenos">772</span></a><span class="sd">        &gt;&gt;&gt; policy = create_new_tax_credit(&quot;New Family Credit&quot;, 1000, refundable=True, affected_millions=30)</span>
</span><span id="create_new_tax_credit-773"><a href="#create_new_tax_credit-773"><span class="linenos">773</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_new_tax_credit-774"><a href="#create_new_tax_credit-774"><span class="linenos">774</span></a>    <span class="k">return</span> <span class="n">TaxPolicy</span><span class="p">(</span>
</span><span id="create_new_tax_credit-775"><a href="#create_new_tax_credit-775"><span class="linenos">775</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="create_new_tax_credit-776"><a href="#create_new_tax_credit-776"><span class="linenos">776</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;New </span><span class="si">{</span><span class="s1">&#39;refundable&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">refundable</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;non-refundable&#39;</span><span class="si">}</span><span class="s2"> tax credit of $</span><span class="si">{</span><span class="n">amount</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_new_tax_credit-777"><a href="#create_new_tax_credit-777"><span class="linenos">777</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_new_tax_credit-778"><a href="#create_new_tax_credit-778"><span class="linenos">778</span></a>        <span class="n">credit_amount</span><span class="o">=</span><span class="n">amount</span><span class="p">,</span>
</span><span id="create_new_tax_credit-779"><a href="#create_new_tax_credit-779"><span class="linenos">779</span></a>        <span class="n">credit_refundable</span><span class="o">=</span><span class="n">refundable</span><span class="p">,</span>
</span><span id="create_new_tax_credit-780"><a href="#create_new_tax_credit-780"><span class="linenos">780</span></a>        <span class="n">affected_taxpayers_millions</span><span class="o">=</span><span class="n">affected_millions</span><span class="p">,</span>
</span><span id="create_new_tax_credit-781"><a href="#create_new_tax_credit-781"><span class="linenos">781</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_new_tax_credit-782"><a href="#create_new_tax_credit-782"><span class="linenos">782</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
</span><span id="create_new_tax_credit-783"><a href="#create_new_tax_credit-783"><span class="linenos">783</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a new tax credit policy.</p>

<p>Args:
    name: Policy name for identification
    amount: Credit amount per taxpayer in dollars
    refundable: Whether the credit is refundable (paid even if no tax liability)
    affected_millions: Estimated eligible taxpayers in millions
    start_year: First year policy takes effect
    duration: Number of years policy is active</p>

<p>Returns:
    TaxPolicy configured as a tax credit</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>policy = create_new_tax_credit("New Family Credit", 1000, refundable=True, affected_millions=30)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="create_spending_increase">
                            <input id="create_spending_increase-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_spending_increase</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">annual_billions</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">category</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;defense&#39;</span><span class="p">,</span> <span class="s1">&#39;nondefense&#39;</span><span class="p">,</span> <span class="s1">&#39;mandatory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;nondefense&#39;</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span></span><span class="return-annotation">) -> <span class="n"><a href="#SpendingPolicy">SpendingPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_spending_increase-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_spending_increase"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_spending_increase-786"><a href="#create_spending_increase-786"><span class="linenos">786</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_spending_increase</span><span class="p">(</span>
</span><span id="create_spending_increase-787"><a href="#create_spending_increase-787"><span class="linenos">787</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="create_spending_increase-788"><a href="#create_spending_increase-788"><span class="linenos">788</span></a>    <span class="n">annual_billions</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_spending_increase-789"><a href="#create_spending_increase-789"><span class="linenos">789</span></a>    <span class="n">category</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;defense&quot;</span><span class="p">,</span> <span class="s2">&quot;nondefense&quot;</span><span class="p">,</span> <span class="s2">&quot;mandatory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nondefense&quot;</span><span class="p">,</span>
</span><span id="create_spending_increase-790"><a href="#create_spending_increase-790"><span class="linenos">790</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_spending_increase-791"><a href="#create_spending_increase-791"><span class="linenos">791</span></a>    <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_spending_increase-792"><a href="#create_spending_increase-792"><span class="linenos">792</span></a>    <span class="n">multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="create_spending_increase-793"><a href="#create_spending_increase-793"><span class="linenos">793</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpendingPolicy</span><span class="p">:</span>
</span><span id="create_spending_increase-794"><a href="#create_spending_increase-794"><span class="linenos">794</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_spending_increase-795"><a href="#create_spending_increase-795"><span class="linenos">795</span></a><span class="sd">    Create a spending increase policy.</span>
</span><span id="create_spending_increase-796"><a href="#create_spending_increase-796"><span class="linenos">796</span></a>
</span><span id="create_spending_increase-797"><a href="#create_spending_increase-797"><span class="linenos">797</span></a><span class="sd">    Args:</span>
</span><span id="create_spending_increase-798"><a href="#create_spending_increase-798"><span class="linenos">798</span></a><span class="sd">        name: Policy name for identification</span>
</span><span id="create_spending_increase-799"><a href="#create_spending_increase-799"><span class="linenos">799</span></a><span class="sd">        annual_billions: Annual spending increase in billions of dollars</span>
</span><span id="create_spending_increase-800"><a href="#create_spending_increase-800"><span class="linenos">800</span></a><span class="sd">        category: Spending category (&#39;defense&#39;, &#39;nondefense&#39;, or &#39;mandatory&#39;)</span>
</span><span id="create_spending_increase-801"><a href="#create_spending_increase-801"><span class="linenos">801</span></a><span class="sd">        start_year: First year policy takes effect</span>
</span><span id="create_spending_increase-802"><a href="#create_spending_increase-802"><span class="linenos">802</span></a><span class="sd">        duration: Number of years policy is active</span>
</span><span id="create_spending_increase-803"><a href="#create_spending_increase-803"><span class="linenos">803</span></a><span class="sd">        multiplier: GDP multiplier for economic effects (default 1.0)</span>
</span><span id="create_spending_increase-804"><a href="#create_spending_increase-804"><span class="linenos">804</span></a>
</span><span id="create_spending_increase-805"><a href="#create_spending_increase-805"><span class="linenos">805</span></a><span class="sd">    Returns:</span>
</span><span id="create_spending_increase-806"><a href="#create_spending_increase-806"><span class="linenos">806</span></a><span class="sd">        SpendingPolicy configured for the spending increase</span>
</span><span id="create_spending_increase-807"><a href="#create_spending_increase-807"><span class="linenos">807</span></a>
</span><span id="create_spending_increase-808"><a href="#create_spending_increase-808"><span class="linenos">808</span></a><span class="sd">    Example:</span>
</span><span id="create_spending_increase-809"><a href="#create_spending_increase-809"><span class="linenos">809</span></a><span class="sd">        &gt;&gt;&gt; policy = create_spending_increase(&quot;Infrastructure&quot;, 50, category=&quot;nondefense&quot;, multiplier=1.5)</span>
</span><span id="create_spending_increase-810"><a href="#create_spending_increase-810"><span class="linenos">810</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_spending_increase-811"><a href="#create_spending_increase-811"><span class="linenos">811</span></a>    <span class="k">return</span> <span class="n">SpendingPolicy</span><span class="p">(</span>
</span><span id="create_spending_increase-812"><a href="#create_spending_increase-812"><span class="linenos">812</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="create_spending_increase-813"><a href="#create_spending_increase-813"><span class="linenos">813</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Increase </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2"> spending by $</span><span class="si">{</span><span class="n">annual_billions</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">B annually&quot;</span><span class="p">,</span>
</span><span id="create_spending_increase-814"><a href="#create_spending_increase-814"><span class="linenos">814</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">DISCRETIONARY_NONDEFENSE</span> <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;nondefense&quot;</span> 
</span><span id="create_spending_increase-815"><a href="#create_spending_increase-815"><span class="linenos">815</span></a>                   <span class="k">else</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">DISCRETIONARY_DEFENSE</span> <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;defense&quot;</span>
</span><span id="create_spending_increase-816"><a href="#create_spending_increase-816"><span class="linenos">816</span></a>                   <span class="k">else</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">MANDATORY_SPENDING</span><span class="p">,</span>
</span><span id="create_spending_increase-817"><a href="#create_spending_increase-817"><span class="linenos">817</span></a>        <span class="n">annual_spending_change_billions</span><span class="o">=</span><span class="n">annual_billions</span><span class="p">,</span>
</span><span id="create_spending_increase-818"><a href="#create_spending_increase-818"><span class="linenos">818</span></a>        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
</span><span id="create_spending_increase-819"><a href="#create_spending_increase-819"><span class="linenos">819</span></a>        <span class="n">gdp_multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span>
</span><span id="create_spending_increase-820"><a href="#create_spending_increase-820"><span class="linenos">820</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_spending_increase-821"><a href="#create_spending_increase-821"><span class="linenos">821</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
</span><span id="create_spending_increase-822"><a href="#create_spending_increase-822"><span class="linenos">822</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a spending increase policy.</p>

<p>Args:
    name: Policy name for identification
    annual_billions: Annual spending increase in billions of dollars
    category: Spending category ('defense', 'nondefense', or 'mandatory')
    start_year: First year policy takes effect
    duration: Number of years policy is active
    multiplier: GDP multiplier for economic effects (default 1.0)</p>

<p>Returns:
    SpendingPolicy configured for the spending increase</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>policy = create_spending_increase("Infrastructure", 50, category="nondefense", multiplier=1.5)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="BaselineProjection">
                            <input id="BaselineProjection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">BaselineProjection</span>:

                <label class="view-source-button" for="BaselineProjection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection-46"><a href="#BaselineProjection-46"><span class="linenos"> 46</span></a><span class="nd">@dataclass</span>
</span><span id="BaselineProjection-47"><a href="#BaselineProjection-47"><span class="linenos"> 47</span></a><span class="k">class</span><span class="w"> </span><span class="nc">BaselineProjection</span><span class="p">:</span>
</span><span id="BaselineProjection-48"><a href="#BaselineProjection-48"><span class="linenos"> 48</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-49"><a href="#BaselineProjection-49"><span class="linenos"> 49</span></a><span class="sd">    10-year baseline budget projection.</span>
</span><span id="BaselineProjection-50"><a href="#BaselineProjection-50"><span class="linenos"> 50</span></a><span class="sd">    </span>
</span><span id="BaselineProjection-51"><a href="#BaselineProjection-51"><span class="linenos"> 51</span></a><span class="sd">    All values in billions of dollars unless otherwise noted.</span>
</span><span id="BaselineProjection-52"><a href="#BaselineProjection-52"><span class="linenos"> 52</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BaselineProjection-53"><a href="#BaselineProjection-53"><span class="linenos"> 53</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>
</span><span id="BaselineProjection-54"><a href="#BaselineProjection-54"><span class="linenos"> 54</span></a>    <span class="n">years</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">2035</span><span class="p">))</span>
</span><span id="BaselineProjection-55"><a href="#BaselineProjection-55"><span class="linenos"> 55</span></a>    
</span><span id="BaselineProjection-56"><a href="#BaselineProjection-56"><span class="linenos"> 56</span></a>    <span class="c1"># Economic variables</span>
</span><span id="BaselineProjection-57"><a href="#BaselineProjection-57"><span class="linenos"> 57</span></a>    <span class="n">nominal_gdp</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-58"><a href="#BaselineProjection-58"><span class="linenos"> 58</span></a>    <span class="n">real_gdp</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-59"><a href="#BaselineProjection-59"><span class="linenos"> 59</span></a>    
</span><span id="BaselineProjection-60"><a href="#BaselineProjection-60"><span class="linenos"> 60</span></a>    <span class="c1"># Revenue categories</span>
</span><span id="BaselineProjection-61"><a href="#BaselineProjection-61"><span class="linenos"> 61</span></a>    <span class="n">individual_income_tax</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-62"><a href="#BaselineProjection-62"><span class="linenos"> 62</span></a>    <span class="n">corporate_income_tax</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-63"><a href="#BaselineProjection-63"><span class="linenos"> 63</span></a>    <span class="n">payroll_taxes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-64"><a href="#BaselineProjection-64"><span class="linenos"> 64</span></a>    <span class="n">other_revenues</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-65"><a href="#BaselineProjection-65"><span class="linenos"> 65</span></a>    
</span><span id="BaselineProjection-66"><a href="#BaselineProjection-66"><span class="linenos"> 66</span></a>    <span class="c1"># Spending categories</span>
</span><span id="BaselineProjection-67"><a href="#BaselineProjection-67"><span class="linenos"> 67</span></a>    <span class="n">social_security</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-68"><a href="#BaselineProjection-68"><span class="linenos"> 68</span></a>    <span class="n">medicare</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-69"><a href="#BaselineProjection-69"><span class="linenos"> 69</span></a>    <span class="n">medicaid</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-70"><a href="#BaselineProjection-70"><span class="linenos"> 70</span></a>    <span class="n">other_mandatory</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-71"><a href="#BaselineProjection-71"><span class="linenos"> 71</span></a>    <span class="n">defense_discretionary</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-72"><a href="#BaselineProjection-72"><span class="linenos"> 72</span></a>    <span class="n">nondefense_discretionary</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-73"><a href="#BaselineProjection-73"><span class="linenos"> 73</span></a>    <span class="n">net_interest</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-74"><a href="#BaselineProjection-74"><span class="linenos"> 74</span></a>    
</span><span id="BaselineProjection-75"><a href="#BaselineProjection-75"><span class="linenos"> 75</span></a>    <span class="c1"># Debt</span>
</span><span id="BaselineProjection-76"><a href="#BaselineProjection-76"><span class="linenos"> 76</span></a>    <span class="n">debt_held_by_public</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="BaselineProjection-77"><a href="#BaselineProjection-77"><span class="linenos"> 77</span></a>    
</span><span id="BaselineProjection-78"><a href="#BaselineProjection-78"><span class="linenos"> 78</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection-79"><a href="#BaselineProjection-79"><span class="linenos"> 79</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_revenues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection-80"><a href="#BaselineProjection-80"><span class="linenos"> 80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total federal revenues.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-81"><a href="#BaselineProjection-81"><span class="linenos"> 81</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">individual_income_tax</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corporate_income_tax</span> <span class="o">+</span> 
</span><span id="BaselineProjection-82"><a href="#BaselineProjection-82"><span class="linenos"> 82</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">payroll_taxes</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">other_revenues</span><span class="p">)</span>
</span><span id="BaselineProjection-83"><a href="#BaselineProjection-83"><span class="linenos"> 83</span></a>    
</span><span id="BaselineProjection-84"><a href="#BaselineProjection-84"><span class="linenos"> 84</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection-85"><a href="#BaselineProjection-85"><span class="linenos"> 85</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_outlays</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection-86"><a href="#BaselineProjection-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total federal outlays.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-87"><a href="#BaselineProjection-87"><span class="linenos"> 87</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">social_security</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">medicare</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">medicaid</span> <span class="o">+</span>
</span><span id="BaselineProjection-88"><a href="#BaselineProjection-88"><span class="linenos"> 88</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">other_mandatory</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">defense_discretionary</span> <span class="o">+</span>
</span><span id="BaselineProjection-89"><a href="#BaselineProjection-89"><span class="linenos"> 89</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">nondefense_discretionary</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">net_interest</span><span class="p">)</span>
</span><span id="BaselineProjection-90"><a href="#BaselineProjection-90"><span class="linenos"> 90</span></a>    
</span><span id="BaselineProjection-91"><a href="#BaselineProjection-91"><span class="linenos"> 91</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection-92"><a href="#BaselineProjection-92"><span class="linenos"> 92</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deficit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection-93"><a href="#BaselineProjection-93"><span class="linenos"> 93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Budget deficit (positive = deficit, negative = surplus).&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-94"><a href="#BaselineProjection-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_outlays</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_revenues</span>
</span><span id="BaselineProjection-95"><a href="#BaselineProjection-95"><span class="linenos"> 95</span></a>    
</span><span id="BaselineProjection-96"><a href="#BaselineProjection-96"><span class="linenos"> 96</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection-97"><a href="#BaselineProjection-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">primary_deficit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection-98"><a href="#BaselineProjection-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Primary deficit (excluding interest payments).&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-99"><a href="#BaselineProjection-99"><span class="linenos"> 99</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">deficit</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">net_interest</span>
</span><span id="BaselineProjection-100"><a href="#BaselineProjection-100"><span class="linenos">100</span></a>    
</span><span id="BaselineProjection-101"><a href="#BaselineProjection-101"><span class="linenos">101</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection-102"><a href="#BaselineProjection-102"><span class="linenos">102</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deficit_to_gdp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection-103"><a href="#BaselineProjection-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deficit as percentage of GDP.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-104"><a href="#BaselineProjection-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">deficit</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="BaselineProjection-105"><a href="#BaselineProjection-105"><span class="linenos">105</span></a>    
</span><span id="BaselineProjection-106"><a href="#BaselineProjection-106"><span class="linenos">106</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection-107"><a href="#BaselineProjection-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">debt_to_gdp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection-108"><a href="#BaselineProjection-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Debt as percentage of GDP.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-109"><a href="#BaselineProjection-109"><span class="linenos">109</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">debt_held_by_public</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="BaselineProjection-110"><a href="#BaselineProjection-110"><span class="linenos">110</span></a>    
</span><span id="BaselineProjection-111"><a href="#BaselineProjection-111"><span class="linenos">111</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_year_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="BaselineProjection-112"><a href="#BaselineProjection-112"><span class="linenos">112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get array index for a given year.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-113"><a href="#BaselineProjection-113"><span class="linenos">113</span></a>        <span class="k">return</span> <span class="n">year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="BaselineProjection-114"><a href="#BaselineProjection-114"><span class="linenos">114</span></a>    
</span><span id="BaselineProjection-115"><a href="#BaselineProjection-115"><span class="linenos">115</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="BaselineProjection-116"><a href="#BaselineProjection-116"><span class="linenos">116</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a specific value for a category and year.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-117"><a href="#BaselineProjection-117"><span class="linenos">117</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_year_index</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
</span><span id="BaselineProjection-118"><a href="#BaselineProjection-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="BaselineProjection-119"><a href="#BaselineProjection-119"><span class="linenos">119</span></a>    
</span><span id="BaselineProjection-120"><a href="#BaselineProjection-120"><span class="linenos">120</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_cumulative_deficit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="BaselineProjection-121"><a href="#BaselineProjection-121"><span class="linenos">121</span></a>                               <span class="n">end_year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="BaselineProjection-122"><a href="#BaselineProjection-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get cumulative deficit over a period.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection-123"><a href="#BaselineProjection-123"><span class="linenos">123</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">start_year</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="BaselineProjection-124"><a href="#BaselineProjection-124"><span class="linenos">124</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="n">end_year</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="BaselineProjection-125"><a href="#BaselineProjection-125"><span class="linenos">125</span></a>        
</span><span id="BaselineProjection-126"><a href="#BaselineProjection-126"><span class="linenos">126</span></a>        <span class="n">start_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_year_index</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
</span><span id="BaselineProjection-127"><a href="#BaselineProjection-127"><span class="linenos">127</span></a>        <span class="n">end_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_year_index</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="BaselineProjection-128"><a href="#BaselineProjection-128"><span class="linenos">128</span></a>        
</span><span id="BaselineProjection-129"><a href="#BaselineProjection-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deficit</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>10-year baseline budget projection.</p>

<p>All values in billions of dollars unless otherwise noted.</p>
</div>


                            <div id="BaselineProjection.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">BaselineProjection</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">years</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">nominal_gdp</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">real_gdp</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">individual_income_tax</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">corporate_income_tax</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">payroll_taxes</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">other_revenues</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">social_security</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">medicare</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">medicaid</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">other_mandatory</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">defense_discretionary</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">nondefense_discretionary</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">net_interest</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">debt_held_by_public</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.__init__"></a>
    
    

                            </div>
                            <div id="BaselineProjection.start_year" class="classattr">
                                <div class="attr variable">
            <span class="name">start_year</span><span class="annotation">: int</span>        =
<span class="default_value">2025</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.start_year"></a>
    
    

                            </div>
                            <div id="BaselineProjection.years" class="classattr">
                                <div class="attr variable">
            <span class="name">years</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.years"></a>
    
    

                            </div>
                            <div id="BaselineProjection.nominal_gdp" class="classattr">
                                <div class="attr variable">
            <span class="name">nominal_gdp</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.nominal_gdp"></a>
    
    

                            </div>
                            <div id="BaselineProjection.real_gdp" class="classattr">
                                <div class="attr variable">
            <span class="name">real_gdp</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.real_gdp"></a>
    
    

                            </div>
                            <div id="BaselineProjection.individual_income_tax" class="classattr">
                                <div class="attr variable">
            <span class="name">individual_income_tax</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.individual_income_tax"></a>
    
    

                            </div>
                            <div id="BaselineProjection.corporate_income_tax" class="classattr">
                                <div class="attr variable">
            <span class="name">corporate_income_tax</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.corporate_income_tax"></a>
    
    

                            </div>
                            <div id="BaselineProjection.payroll_taxes" class="classattr">
                                <div class="attr variable">
            <span class="name">payroll_taxes</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.payroll_taxes"></a>
    
    

                            </div>
                            <div id="BaselineProjection.other_revenues" class="classattr">
                                <div class="attr variable">
            <span class="name">other_revenues</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.other_revenues"></a>
    
    

                            </div>
                            <div id="BaselineProjection.social_security" class="classattr">
                                <div class="attr variable">
            <span class="name">social_security</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.social_security"></a>
    
    

                            </div>
                            <div id="BaselineProjection.medicare" class="classattr">
                                <div class="attr variable">
            <span class="name">medicare</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.medicare"></a>
    
    

                            </div>
                            <div id="BaselineProjection.medicaid" class="classattr">
                                <div class="attr variable">
            <span class="name">medicaid</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.medicaid"></a>
    
    

                            </div>
                            <div id="BaselineProjection.other_mandatory" class="classattr">
                                <div class="attr variable">
            <span class="name">other_mandatory</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.other_mandatory"></a>
    
    

                            </div>
                            <div id="BaselineProjection.defense_discretionary" class="classattr">
                                <div class="attr variable">
            <span class="name">defense_discretionary</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.defense_discretionary"></a>
    
    

                            </div>
                            <div id="BaselineProjection.nondefense_discretionary" class="classattr">
                                <div class="attr variable">
            <span class="name">nondefense_discretionary</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.nondefense_discretionary"></a>
    
    

                            </div>
                            <div id="BaselineProjection.net_interest" class="classattr">
                                <div class="attr variable">
            <span class="name">net_interest</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.net_interest"></a>
    
    

                            </div>
                            <div id="BaselineProjection.debt_held_by_public" class="classattr">
                                <div class="attr variable">
            <span class="name">debt_held_by_public</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#BaselineProjection.debt_held_by_public"></a>
    
    

                            </div>
                            <div id="BaselineProjection.total_revenues" class="classattr">
                                        <input id="BaselineProjection.total_revenues-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">total_revenues</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="BaselineProjection.total_revenues-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.total_revenues"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.total_revenues-78"><a href="#BaselineProjection.total_revenues-78"><span class="linenos">78</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection.total_revenues-79"><a href="#BaselineProjection.total_revenues-79"><span class="linenos">79</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_revenues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection.total_revenues-80"><a href="#BaselineProjection.total_revenues-80"><span class="linenos">80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total federal revenues.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.total_revenues-81"><a href="#BaselineProjection.total_revenues-81"><span class="linenos">81</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">individual_income_tax</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">corporate_income_tax</span> <span class="o">+</span> 
</span><span id="BaselineProjection.total_revenues-82"><a href="#BaselineProjection.total_revenues-82"><span class="linenos">82</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">payroll_taxes</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">other_revenues</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Total federal revenues.</p>
</div>


                            </div>
                            <div id="BaselineProjection.total_outlays" class="classattr">
                                        <input id="BaselineProjection.total_outlays-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">total_outlays</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="BaselineProjection.total_outlays-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.total_outlays"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.total_outlays-84"><a href="#BaselineProjection.total_outlays-84"><span class="linenos">84</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection.total_outlays-85"><a href="#BaselineProjection.total_outlays-85"><span class="linenos">85</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_outlays</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection.total_outlays-86"><a href="#BaselineProjection.total_outlays-86"><span class="linenos">86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total federal outlays.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.total_outlays-87"><a href="#BaselineProjection.total_outlays-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">social_security</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">medicare</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">medicaid</span> <span class="o">+</span>
</span><span id="BaselineProjection.total_outlays-88"><a href="#BaselineProjection.total_outlays-88"><span class="linenos">88</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">other_mandatory</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">defense_discretionary</span> <span class="o">+</span>
</span><span id="BaselineProjection.total_outlays-89"><a href="#BaselineProjection.total_outlays-89"><span class="linenos">89</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">nondefense_discretionary</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">net_interest</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Total federal outlays.</p>
</div>


                            </div>
                            <div id="BaselineProjection.deficit" class="classattr">
                                        <input id="BaselineProjection.deficit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">deficit</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="BaselineProjection.deficit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.deficit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.deficit-91"><a href="#BaselineProjection.deficit-91"><span class="linenos">91</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection.deficit-92"><a href="#BaselineProjection.deficit-92"><span class="linenos">92</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deficit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection.deficit-93"><a href="#BaselineProjection.deficit-93"><span class="linenos">93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Budget deficit (positive = deficit, negative = surplus).&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.deficit-94"><a href="#BaselineProjection.deficit-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_outlays</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_revenues</span>
</span></pre></div>


            <div class="docstring"><p>Budget deficit (positive = deficit, negative = surplus).</p>
</div>


                            </div>
                            <div id="BaselineProjection.primary_deficit" class="classattr">
                                        <input id="BaselineProjection.primary_deficit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">primary_deficit</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="BaselineProjection.primary_deficit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.primary_deficit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.primary_deficit-96"><a href="#BaselineProjection.primary_deficit-96"><span class="linenos">96</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection.primary_deficit-97"><a href="#BaselineProjection.primary_deficit-97"><span class="linenos">97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">primary_deficit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection.primary_deficit-98"><a href="#BaselineProjection.primary_deficit-98"><span class="linenos">98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Primary deficit (excluding interest payments).&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.primary_deficit-99"><a href="#BaselineProjection.primary_deficit-99"><span class="linenos">99</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">deficit</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">net_interest</span>
</span></pre></div>


            <div class="docstring"><p>Primary deficit (excluding interest payments).</p>
</div>


                            </div>
                            <div id="BaselineProjection.deficit_to_gdp" class="classattr">
                                        <input id="BaselineProjection.deficit_to_gdp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">deficit_to_gdp</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="BaselineProjection.deficit_to_gdp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.deficit_to_gdp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.deficit_to_gdp-101"><a href="#BaselineProjection.deficit_to_gdp-101"><span class="linenos">101</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection.deficit_to_gdp-102"><a href="#BaselineProjection.deficit_to_gdp-102"><span class="linenos">102</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deficit_to_gdp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection.deficit_to_gdp-103"><a href="#BaselineProjection.deficit_to_gdp-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deficit as percentage of GDP.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.deficit_to_gdp-104"><a href="#BaselineProjection.deficit_to_gdp-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">deficit</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mi">100</span>
</span></pre></div>


            <div class="docstring"><p>Deficit as percentage of GDP.</p>
</div>


                            </div>
                            <div id="BaselineProjection.debt_to_gdp" class="classattr">
                                        <input id="BaselineProjection.debt_to_gdp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">debt_to_gdp</span><span class="annotation">: numpy.ndarray</span>

                <label class="view-source-button" for="BaselineProjection.debt_to_gdp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.debt_to_gdp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.debt_to_gdp-106"><a href="#BaselineProjection.debt_to_gdp-106"><span class="linenos">106</span></a>    <span class="nd">@property</span>
</span><span id="BaselineProjection.debt_to_gdp-107"><a href="#BaselineProjection.debt_to_gdp-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">debt_to_gdp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="BaselineProjection.debt_to_gdp-108"><a href="#BaselineProjection.debt_to_gdp-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Debt as percentage of GDP.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.debt_to_gdp-109"><a href="#BaselineProjection.debt_to_gdp-109"><span class="linenos">109</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">debt_held_by_public</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mi">100</span>
</span></pre></div>


            <div class="docstring"><p>Debt as percentage of GDP.</p>
</div>


                            </div>
                            <div id="BaselineProjection.get_year_index" class="classattr">
                                        <input id="BaselineProjection.get_year_index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_year_index</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="BaselineProjection.get_year_index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.get_year_index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.get_year_index-111"><a href="#BaselineProjection.get_year_index-111"><span class="linenos">111</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_year_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="BaselineProjection.get_year_index-112"><a href="#BaselineProjection.get_year_index-112"><span class="linenos">112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get array index for a given year.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.get_year_index-113"><a href="#BaselineProjection.get_year_index-113"><span class="linenos">113</span></a>        <span class="k">return</span> <span class="n">year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
</span></pre></div>


            <div class="docstring"><p>Get array index for a given year.</p>
</div>


                            </div>
                            <div id="BaselineProjection.get_value" class="classattr">
                                        <input id="BaselineProjection.get_value-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_value</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">category</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="BaselineProjection.get_value-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.get_value"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.get_value-115"><a href="#BaselineProjection.get_value-115"><span class="linenos">115</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="BaselineProjection.get_value-116"><a href="#BaselineProjection.get_value-116"><span class="linenos">116</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a specific value for a category and year.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.get_value-117"><a href="#BaselineProjection.get_value-117"><span class="linenos">117</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_year_index</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
</span><span id="BaselineProjection.get_value-118"><a href="#BaselineProjection.get_value-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get a specific value for a category and year.</p>
</div>


                            </div>
                            <div id="BaselineProjection.get_cumulative_deficit" class="classattr">
                                        <input id="BaselineProjection.get_cumulative_deficit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_cumulative_deficit</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">end_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="BaselineProjection.get_cumulative_deficit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaselineProjection.get_cumulative_deficit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaselineProjection.get_cumulative_deficit-120"><a href="#BaselineProjection.get_cumulative_deficit-120"><span class="linenos">120</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_cumulative_deficit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="BaselineProjection.get_cumulative_deficit-121"><a href="#BaselineProjection.get_cumulative_deficit-121"><span class="linenos">121</span></a>                               <span class="n">end_year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="BaselineProjection.get_cumulative_deficit-122"><a href="#BaselineProjection.get_cumulative_deficit-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get cumulative deficit over a period.&quot;&quot;&quot;</span>
</span><span id="BaselineProjection.get_cumulative_deficit-123"><a href="#BaselineProjection.get_cumulative_deficit-123"><span class="linenos">123</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">start_year</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="BaselineProjection.get_cumulative_deficit-124"><a href="#BaselineProjection.get_cumulative_deficit-124"><span class="linenos">124</span></a>        <span class="n">end</span> <span class="o">=</span> <span class="n">end_year</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="BaselineProjection.get_cumulative_deficit-125"><a href="#BaselineProjection.get_cumulative_deficit-125"><span class="linenos">125</span></a>        
</span><span id="BaselineProjection.get_cumulative_deficit-126"><a href="#BaselineProjection.get_cumulative_deficit-126"><span class="linenos">126</span></a>        <span class="n">start_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_year_index</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
</span><span id="BaselineProjection.get_cumulative_deficit-127"><a href="#BaselineProjection.get_cumulative_deficit-127"><span class="linenos">127</span></a>        <span class="n">end_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_year_index</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="BaselineProjection.get_cumulative_deficit-128"><a href="#BaselineProjection.get_cumulative_deficit-128"><span class="linenos">128</span></a>        
</span><span id="BaselineProjection.get_cumulative_deficit-129"><a href="#BaselineProjection.get_cumulative_deficit-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deficit</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Get cumulative deficit over a period.</p>
</div>


                            </div>
                </section>
                <section id="CBOBaseline">
                            <input id="CBOBaseline-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CBOBaseline</span>:

                <label class="view-source-button" for="CBOBaseline-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CBOBaseline"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CBOBaseline-132"><a href="#CBOBaseline-132"><span class="linenos">132</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CBOBaseline</span><span class="p">:</span>
</span><span id="CBOBaseline-133"><a href="#CBOBaseline-133"><span class="linenos">133</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-134"><a href="#CBOBaseline-134"><span class="linenos">134</span></a><span class="sd">    Generator for CBO-style baseline projections.</span>
</span><span id="CBOBaseline-135"><a href="#CBOBaseline-135"><span class="linenos">135</span></a><span class="sd">    </span>
</span><span id="CBOBaseline-136"><a href="#CBOBaseline-136"><span class="linenos">136</span></a><span class="sd">    Based on CBO&#39;s February 2024 baseline with adjustments.</span>
</span><span id="CBOBaseline-137"><a href="#CBOBaseline-137"><span class="linenos">137</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CBOBaseline-138"><a href="#CBOBaseline-138"><span class="linenos">138</span></a>    
</span><span id="CBOBaseline-139"><a href="#CBOBaseline-139"><span class="linenos">139</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span> <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="CBOBaseline-140"><a href="#CBOBaseline-140"><span class="linenos">140</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="CBOBaseline-141"><a href="#CBOBaseline-141"><span class="linenos">141</span></a>        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="CBOBaseline-142"><a href="#CBOBaseline-142"><span class="linenos">142</span></a>
</span><span id="CBOBaseline-143"><a href="#CBOBaseline-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">=</span> <span class="n">start_year</span>
</span><span id="CBOBaseline-144"><a href="#CBOBaseline-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">start_year</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-145"><a href="#CBOBaseline-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span> <span class="o">=</span> <span class="n">EconomicAssumptions</span><span class="p">()</span>
</span><span id="CBOBaseline-146"><a href="#CBOBaseline-146"><span class="linenos">146</span></a>
</span><span id="CBOBaseline-147"><a href="#CBOBaseline-147"><span class="linenos">147</span></a>        <span class="c1"># Try to load real data, fall back to hardcoded if unavailable</span>
</span><span id="CBOBaseline-148"><a href="#CBOBaseline-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="n">use_real_data</span><span class="p">:</span>
</span><span id="CBOBaseline-149"><a href="#CBOBaseline-149"><span class="linenos">149</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CBOBaseline-150"><a href="#CBOBaseline-150"><span class="linenos">150</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_from_data_sources</span><span class="p">()</span>
</span><span id="CBOBaseline-151"><a href="#CBOBaseline-151"><span class="linenos">151</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully loaded baseline data from IRS SOI and FRED&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline-152"><a href="#CBOBaseline-152"><span class="linenos">152</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="CBOBaseline-153"><a href="#CBOBaseline-153"><span class="linenos">153</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not load real data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline-154"><a href="#CBOBaseline-154"><span class="linenos">154</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Falling back to hardcoded baseline values&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline-155"><a href="#CBOBaseline-155"><span class="linenos">155</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_use_hardcoded_fallback</span><span class="p">()</span>
</span><span id="CBOBaseline-156"><a href="#CBOBaseline-156"><span class="linenos">156</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CBOBaseline-157"><a href="#CBOBaseline-157"><span class="linenos">157</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_use_hardcoded_fallback</span><span class="p">()</span>
</span><span id="CBOBaseline-158"><a href="#CBOBaseline-158"><span class="linenos">158</span></a>
</span><span id="CBOBaseline-159"><a href="#CBOBaseline-159"><span class="linenos">159</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_load_from_data_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CBOBaseline-160"><a href="#CBOBaseline-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load baseline values from IRS SOI and FRED data.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-161"><a href="#CBOBaseline-161"><span class="linenos">161</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">fiscal_model.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">IRSSOIData</span><span class="p">,</span> <span class="n">FREDData</span>
</span><span id="CBOBaseline-162"><a href="#CBOBaseline-162"><span class="linenos">162</span></a>
</span><span id="CBOBaseline-163"><a href="#CBOBaseline-163"><span class="linenos">163</span></a>        <span class="c1"># Initialize data loaders</span>
</span><span id="CBOBaseline-164"><a href="#CBOBaseline-164"><span class="linenos">164</span></a>        <span class="n">irs_data</span> <span class="o">=</span> <span class="n">IRSSOIData</span><span class="p">()</span>
</span><span id="CBOBaseline-165"><a href="#CBOBaseline-165"><span class="linenos">165</span></a>        <span class="n">fred_data</span> <span class="o">=</span> <span class="n">FREDData</span><span class="p">()</span>  <span class="c1"># Uses FRED_API_KEY env var</span>
</span><span id="CBOBaseline-166"><a href="#CBOBaseline-166"><span class="linenos">166</span></a>
</span><span id="CBOBaseline-167"><a href="#CBOBaseline-167"><span class="linenos">167</span></a>        <span class="c1"># Get most recent available IRS data year</span>
</span><span id="CBOBaseline-168"><a href="#CBOBaseline-168"><span class="linenos">168</span></a>        <span class="n">available_years</span> <span class="o">=</span> <span class="n">irs_data</span><span class="o">.</span><span class="n">get_data_years_available</span><span class="p">()</span>
</span><span id="CBOBaseline-169"><a href="#CBOBaseline-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">available_years</span><span class="p">:</span>
</span><span id="CBOBaseline-170"><a href="#CBOBaseline-170"><span class="linenos">170</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;No IRS SOI data files found. See fiscal_model/data_files/irs_soi/README.md&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline-171"><a href="#CBOBaseline-171"><span class="linenos">171</span></a>
</span><span id="CBOBaseline-172"><a href="#CBOBaseline-172"><span class="linenos">172</span></a>        <span class="n">data_year</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">available_years</span><span class="p">)</span>
</span><span id="CBOBaseline-173"><a href="#CBOBaseline-173"><span class="linenos">173</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading baseline from </span><span class="si">{</span><span class="n">data_year</span><span class="si">}</span><span class="s2"> IRS SOI data&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline-174"><a href="#CBOBaseline-174"><span class="linenos">174</span></a>
</span><span id="CBOBaseline-175"><a href="#CBOBaseline-175"><span class="linenos">175</span></a>        <span class="c1"># Load individual income tax revenue from IRS data</span>
</span><span id="CBOBaseline-176"><a href="#CBOBaseline-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_individual_income_tax</span> <span class="o">=</span> <span class="n">irs_data</span><span class="o">.</span><span class="n">get_total_revenue</span><span class="p">(</span><span class="n">data_year</span><span class="p">)</span>
</span><span id="CBOBaseline-177"><a href="#CBOBaseline-177"><span class="linenos">177</span></a>
</span><span id="CBOBaseline-178"><a href="#CBOBaseline-178"><span class="linenos">178</span></a>        <span class="c1"># Load GDP from FRED</span>
</span><span id="CBOBaseline-179"><a href="#CBOBaseline-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="n">fred_data</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
</span><span id="CBOBaseline-180"><a href="#CBOBaseline-180"><span class="linenos">180</span></a>            <span class="n">gdp_series</span> <span class="o">=</span> <span class="n">fred_data</span><span class="o">.</span><span class="n">get_gdp</span><span class="p">(</span><span class="n">nominal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CBOBaseline-181"><a href="#CBOBaseline-181"><span class="linenos">181</span></a>            <span class="c1"># Get most recent quarterly value (in billions)</span>
</span><span id="CBOBaseline-182"><a href="#CBOBaseline-182"><span class="linenos">182</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gdp_series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="CBOBaseline-183"><a href="#CBOBaseline-183"><span class="linenos">183</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded GDP from FRED: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline-184"><a href="#CBOBaseline-184"><span class="linenos">184</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CBOBaseline-185"><a href="#CBOBaseline-185"><span class="linenos">185</span></a>            <span class="c1"># Use ratio from IRS data</span>
</span><span id="CBOBaseline-186"><a href="#CBOBaseline-186"><span class="linenos">186</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FRED not available, estimating GDP from IRS data&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline-187"><a href="#CBOBaseline-187"><span class="linenos">187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_individual_income_tax</span> <span class="o">/</span> <span class="mf">0.088</span>  <span class="c1"># ~8.8% ratio</span>
</span><span id="CBOBaseline-188"><a href="#CBOBaseline-188"><span class="linenos">188</span></a>
</span><span id="CBOBaseline-189"><a href="#CBOBaseline-189"><span class="linenos">189</span></a>        <span class="c1"># Corporate tax: Historical ratio to individual income tax (~18%)</span>
</span><span id="CBOBaseline-190"><a href="#CBOBaseline-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_corporate_tax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_individual_income_tax</span> <span class="o">*</span> <span class="mf">0.18</span>
</span><span id="CBOBaseline-191"><a href="#CBOBaseline-191"><span class="linenos">191</span></a>
</span><span id="CBOBaseline-192"><a href="#CBOBaseline-192"><span class="linenos">192</span></a>        <span class="c1"># Payroll tax: ~6% of GDP (historical average)</span>
</span><span id="CBOBaseline-193"><a href="#CBOBaseline-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_payroll_tax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.06</span>
</span><span id="CBOBaseline-194"><a href="#CBOBaseline-194"><span class="linenos">194</span></a>
</span><span id="CBOBaseline-195"><a href="#CBOBaseline-195"><span class="linenos">195</span></a>        <span class="c1"># Other revenue: Estate, excise, customs (~1.4% of GDP)</span>
</span><span id="CBOBaseline-196"><a href="#CBOBaseline-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_other_revenue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.014</span>
</span><span id="CBOBaseline-197"><a href="#CBOBaseline-197"><span class="linenos">197</span></a>
</span><span id="CBOBaseline-198"><a href="#CBOBaseline-198"><span class="linenos">198</span></a>        <span class="c1"># Spending categories: Use GDP ratios</span>
</span><span id="CBOBaseline-199"><a href="#CBOBaseline-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_social_security</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.053</span>  <span class="c1"># ~5.3% of GDP</span>
</span><span id="CBOBaseline-200"><a href="#CBOBaseline-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_medicare</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.032</span>  <span class="c1"># ~3.2% of GDP</span>
</span><span id="CBOBaseline-201"><a href="#CBOBaseline-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_medicaid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.021</span>  <span class="c1"># ~2.1% of GDP</span>
</span><span id="CBOBaseline-202"><a href="#CBOBaseline-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_other_mandatory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.032</span>  <span class="c1"># ~3.2% of GDP</span>
</span><span id="CBOBaseline-203"><a href="#CBOBaseline-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_defense</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.032</span>  <span class="c1"># ~3.2% of GDP</span>
</span><span id="CBOBaseline-204"><a href="#CBOBaseline-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_nondefense</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.026</span>  <span class="c1"># ~2.6% of GDP</span>
</span><span id="CBOBaseline-205"><a href="#CBOBaseline-205"><span class="linenos">205</span></a>
</span><span id="CBOBaseline-206"><a href="#CBOBaseline-206"><span class="linenos">206</span></a>        <span class="c1"># Debt: ~98% of GDP (current debt-to-GDP ratio)</span>
</span><span id="CBOBaseline-207"><a href="#CBOBaseline-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_debt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="mf">0.98</span>
</span><span id="CBOBaseline-208"><a href="#CBOBaseline-208"><span class="linenos">208</span></a>
</span><span id="CBOBaseline-209"><a href="#CBOBaseline-209"><span class="linenos">209</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_use_hardcoded_fallback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CBOBaseline-210"><a href="#CBOBaseline-210"><span class="linenos">210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Use hardcoded baseline values (fallback when data unavailable).&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-211"><a href="#CBOBaseline-211"><span class="linenos">211</span></a>        <span class="c1"># Base year (2024) values in billions</span>
</span><span id="CBOBaseline-212"><a href="#CBOBaseline-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">=</span> <span class="mi">28500</span>  <span class="c1"># Nominal GDP</span>
</span><span id="CBOBaseline-213"><a href="#CBOBaseline-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_individual_income_tax</span> <span class="o">=</span> <span class="mi">2500</span>
</span><span id="CBOBaseline-214"><a href="#CBOBaseline-214"><span class="linenos">214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_corporate_tax</span> <span class="o">=</span> <span class="mi">450</span>
</span><span id="CBOBaseline-215"><a href="#CBOBaseline-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_payroll_tax</span> <span class="o">=</span> <span class="mi">1700</span>
</span><span id="CBOBaseline-216"><a href="#CBOBaseline-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_other_revenue</span> <span class="o">=</span> <span class="mi">400</span>
</span><span id="CBOBaseline-217"><a href="#CBOBaseline-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_social_security</span> <span class="o">=</span> <span class="mi">1500</span>
</span><span id="CBOBaseline-218"><a href="#CBOBaseline-218"><span class="linenos">218</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_medicare</span> <span class="o">=</span> <span class="mi">900</span>
</span><span id="CBOBaseline-219"><a href="#CBOBaseline-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_medicaid</span> <span class="o">=</span> <span class="mi">600</span>
</span><span id="CBOBaseline-220"><a href="#CBOBaseline-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_other_mandatory</span> <span class="o">=</span> <span class="mi">900</span>
</span><span id="CBOBaseline-221"><a href="#CBOBaseline-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_defense</span> <span class="o">=</span> <span class="mi">900</span>
</span><span id="CBOBaseline-222"><a href="#CBOBaseline-222"><span class="linenos">222</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_nondefense</span> <span class="o">=</span> <span class="mi">750</span>
</span><span id="CBOBaseline-223"><a href="#CBOBaseline-223"><span class="linenos">223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_debt</span> <span class="o">=</span> <span class="mi">28000</span>
</span><span id="CBOBaseline-224"><a href="#CBOBaseline-224"><span class="linenos">224</span></a>        
</span><span id="CBOBaseline-225"><a href="#CBOBaseline-225"><span class="linenos">225</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaselineProjection</span><span class="p">:</span>
</span><span id="CBOBaseline-226"><a href="#CBOBaseline-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a 10-year baseline projection.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-227"><a href="#CBOBaseline-227"><span class="linenos">227</span></a>        <span class="n">proj</span> <span class="o">=</span> <span class="n">BaselineProjection</span><span class="p">(</span>
</span><span id="CBOBaseline-228"><a href="#CBOBaseline-228"><span class="linenos">228</span></a>            <span class="n">start_year</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="CBOBaseline-229"><a href="#CBOBaseline-229"><span class="linenos">229</span></a>            <span class="n">years</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CBOBaseline-230"><a href="#CBOBaseline-230"><span class="linenos">230</span></a>        <span class="p">)</span>
</span><span id="CBOBaseline-231"><a href="#CBOBaseline-231"><span class="linenos">231</span></a>        
</span><span id="CBOBaseline-232"><a href="#CBOBaseline-232"><span class="linenos">232</span></a>        <span class="c1"># Generate GDP path</span>
</span><span id="CBOBaseline-233"><a href="#CBOBaseline-233"><span class="linenos">233</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_gdp</span><span class="p">()</span>
</span><span id="CBOBaseline-234"><a href="#CBOBaseline-234"><span class="linenos">234</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">real_gdp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_real_gdp</span><span class="p">()</span>
</span><span id="CBOBaseline-235"><a href="#CBOBaseline-235"><span class="linenos">235</span></a>        
</span><span id="CBOBaseline-236"><a href="#CBOBaseline-236"><span class="linenos">236</span></a>        <span class="c1"># Generate revenues</span>
</span><span id="CBOBaseline-237"><a href="#CBOBaseline-237"><span class="linenos">237</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">individual_income_tax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_individual_tax</span><span class="p">()</span>
</span><span id="CBOBaseline-238"><a href="#CBOBaseline-238"><span class="linenos">238</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">corporate_income_tax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_corporate_tax</span><span class="p">()</span>
</span><span id="CBOBaseline-239"><a href="#CBOBaseline-239"><span class="linenos">239</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">payroll_taxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_payroll_tax</span><span class="p">()</span>
</span><span id="CBOBaseline-240"><a href="#CBOBaseline-240"><span class="linenos">240</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">other_revenues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_other_revenue</span><span class="p">()</span>
</span><span id="CBOBaseline-241"><a href="#CBOBaseline-241"><span class="linenos">241</span></a>        
</span><span id="CBOBaseline-242"><a href="#CBOBaseline-242"><span class="linenos">242</span></a>        <span class="c1"># Generate spending</span>
</span><span id="CBOBaseline-243"><a href="#CBOBaseline-243"><span class="linenos">243</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">social_security</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_social_security</span><span class="p">()</span>
</span><span id="CBOBaseline-244"><a href="#CBOBaseline-244"><span class="linenos">244</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">medicare</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_medicare</span><span class="p">()</span>
</span><span id="CBOBaseline-245"><a href="#CBOBaseline-245"><span class="linenos">245</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">medicaid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_medicaid</span><span class="p">()</span>
</span><span id="CBOBaseline-246"><a href="#CBOBaseline-246"><span class="linenos">246</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">other_mandatory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_other_mandatory</span><span class="p">()</span>
</span><span id="CBOBaseline-247"><a href="#CBOBaseline-247"><span class="linenos">247</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">defense_discretionary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_defense</span><span class="p">()</span>
</span><span id="CBOBaseline-248"><a href="#CBOBaseline-248"><span class="linenos">248</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">nondefense_discretionary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_nondefense</span><span class="p">()</span>
</span><span id="CBOBaseline-249"><a href="#CBOBaseline-249"><span class="linenos">249</span></a>        
</span><span id="CBOBaseline-250"><a href="#CBOBaseline-250"><span class="linenos">250</span></a>        <span class="c1"># Calculate interest and debt</span>
</span><span id="CBOBaseline-251"><a href="#CBOBaseline-251"><span class="linenos">251</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">debt_held_by_public</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_debt</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
</span><span id="CBOBaseline-252"><a href="#CBOBaseline-252"><span class="linenos">252</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">net_interest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_interest</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
</span><span id="CBOBaseline-253"><a href="#CBOBaseline-253"><span class="linenos">253</span></a>        
</span><span id="CBOBaseline-254"><a href="#CBOBaseline-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="n">proj</span>
</span><span id="CBOBaseline-255"><a href="#CBOBaseline-255"><span class="linenos">255</span></a>    
</span><span id="CBOBaseline-256"><a href="#CBOBaseline-256"><span class="linenos">256</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_gdp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-257"><a href="#CBOBaseline-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project nominal GDP.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-258"><a href="#CBOBaseline-258"><span class="linenos">258</span></a>        <span class="n">gdp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-259"><a href="#CBOBaseline-259"><span class="linenos">259</span></a>        <span class="n">gdp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">real_gdp_growth</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> 
</span><span id="CBOBaseline-260"><a href="#CBOBaseline-260"><span class="linenos">260</span></a>                                   <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">inflation</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="CBOBaseline-261"><a href="#CBOBaseline-261"><span class="linenos">261</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-262"><a href="#CBOBaseline-262"><span class="linenos">262</span></a>            <span class="n">growth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">real_gdp_growth</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">inflation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="CBOBaseline-263"><a href="#CBOBaseline-263"><span class="linenos">263</span></a>            <span class="n">gdp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth</span><span class="p">)</span>
</span><span id="CBOBaseline-264"><a href="#CBOBaseline-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="n">gdp</span>
</span><span id="CBOBaseline-265"><a href="#CBOBaseline-265"><span class="linenos">265</span></a>    
</span><span id="CBOBaseline-266"><a href="#CBOBaseline-266"><span class="linenos">266</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_real_gdp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-267"><a href="#CBOBaseline-267"><span class="linenos">267</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project real GDP (2024 dollars).&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-268"><a href="#CBOBaseline-268"><span class="linenos">268</span></a>        <span class="n">real_gdp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-269"><a href="#CBOBaseline-269"><span class="linenos">269</span></a>        <span class="n">real_gdp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_gdp</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">real_gdp_growth</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="CBOBaseline-270"><a href="#CBOBaseline-270"><span class="linenos">270</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-271"><a href="#CBOBaseline-271"><span class="linenos">271</span></a>            <span class="n">real_gdp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">real_gdp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">real_gdp_growth</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="CBOBaseline-272"><a href="#CBOBaseline-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="n">real_gdp</span>
</span><span id="CBOBaseline-273"><a href="#CBOBaseline-273"><span class="linenos">273</span></a>    
</span><span id="CBOBaseline-274"><a href="#CBOBaseline-274"><span class="linenos">274</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_individual_tax</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-275"><a href="#CBOBaseline-275"><span class="linenos">275</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project individual income tax revenues.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-276"><a href="#CBOBaseline-276"><span class="linenos">276</span></a>        <span class="c1"># Income tax grows faster than GDP due to bracket creep</span>
</span><span id="CBOBaseline-277"><a href="#CBOBaseline-277"><span class="linenos">277</span></a>        <span class="n">revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-278"><a href="#CBOBaseline-278"><span class="linenos">278</span></a>        <span class="n">growth_premium</span> <span class="o">=</span> <span class="mf">0.003</span>  <span class="c1"># Extra growth from real bracket creep</span>
</span><span id="CBOBaseline-279"><a href="#CBOBaseline-279"><span class="linenos">279</span></a>        
</span><span id="CBOBaseline-280"><a href="#CBOBaseline-280"><span class="linenos">280</span></a>        <span class="n">revenue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_individual_income_tax</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> 
</span><span id="CBOBaseline-281"><a href="#CBOBaseline-281"><span class="linenos">281</span></a>                     <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">real_gdp_growth</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> 
</span><span id="CBOBaseline-282"><a href="#CBOBaseline-282"><span class="linenos">282</span></a>                     <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">inflation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">growth_premium</span><span class="p">)</span>
</span><span id="CBOBaseline-283"><a href="#CBOBaseline-283"><span class="linenos">283</span></a>        
</span><span id="CBOBaseline-284"><a href="#CBOBaseline-284"><span class="linenos">284</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-285"><a href="#CBOBaseline-285"><span class="linenos">285</span></a>            <span class="n">base_growth</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">real_gdp_growth</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> 
</span><span id="CBOBaseline-286"><a href="#CBOBaseline-286"><span class="linenos">286</span></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">inflation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">growth_premium</span><span class="p">)</span>
</span><span id="CBOBaseline-287"><a href="#CBOBaseline-287"><span class="linenos">287</span></a>            <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">base_growth</span><span class="p">)</span>
</span><span id="CBOBaseline-288"><a href="#CBOBaseline-288"><span class="linenos">288</span></a>        
</span><span id="CBOBaseline-289"><a href="#CBOBaseline-289"><span class="linenos">289</span></a>        <span class="k">return</span> <span class="n">revenue</span>
</span><span id="CBOBaseline-290"><a href="#CBOBaseline-290"><span class="linenos">290</span></a>    
</span><span id="CBOBaseline-291"><a href="#CBOBaseline-291"><span class="linenos">291</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_corporate_tax</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-292"><a href="#CBOBaseline-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project corporate income tax revenues.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-293"><a href="#CBOBaseline-293"><span class="linenos">293</span></a>        <span class="c1"># More volatile, tied to profits</span>
</span><span id="CBOBaseline-294"><a href="#CBOBaseline-294"><span class="linenos">294</span></a>        <span class="n">revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-295"><a href="#CBOBaseline-295"><span class="linenos">295</span></a>        <span class="n">revenue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_corporate_tax</span> <span class="o">*</span> <span class="mf">1.04</span>
</span><span id="CBOBaseline-296"><a href="#CBOBaseline-296"><span class="linenos">296</span></a>        
</span><span id="CBOBaseline-297"><a href="#CBOBaseline-297"><span class="linenos">297</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-298"><a href="#CBOBaseline-298"><span class="linenos">298</span></a>            <span class="c1"># Corporate profits grow slightly faster than GDP</span>
</span><span id="CBOBaseline-299"><a href="#CBOBaseline-299"><span class="linenos">299</span></a>            <span class="n">growth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">real_gdp_growth</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">inflation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.01</span>
</span><span id="CBOBaseline-300"><a href="#CBOBaseline-300"><span class="linenos">300</span></a>            <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth</span><span class="p">)</span>
</span><span id="CBOBaseline-301"><a href="#CBOBaseline-301"><span class="linenos">301</span></a>        
</span><span id="CBOBaseline-302"><a href="#CBOBaseline-302"><span class="linenos">302</span></a>        <span class="k">return</span> <span class="n">revenue</span>
</span><span id="CBOBaseline-303"><a href="#CBOBaseline-303"><span class="linenos">303</span></a>    
</span><span id="CBOBaseline-304"><a href="#CBOBaseline-304"><span class="linenos">304</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_payroll_tax</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-305"><a href="#CBOBaseline-305"><span class="linenos">305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project payroll tax revenues.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-306"><a href="#CBOBaseline-306"><span class="linenos">306</span></a>        <span class="c1"># Tied to wage growth</span>
</span><span id="CBOBaseline-307"><a href="#CBOBaseline-307"><span class="linenos">307</span></a>        <span class="n">revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-308"><a href="#CBOBaseline-308"><span class="linenos">308</span></a>        <span class="n">revenue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_payroll_tax</span> <span class="o">*</span> <span class="mf">1.04</span>
</span><span id="CBOBaseline-309"><a href="#CBOBaseline-309"><span class="linenos">309</span></a>        
</span><span id="CBOBaseline-310"><a href="#CBOBaseline-310"><span class="linenos">310</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-311"><a href="#CBOBaseline-311"><span class="linenos">311</span></a>            <span class="c1"># Wage growth typically matches GDP growth</span>
</span><span id="CBOBaseline-312"><a href="#CBOBaseline-312"><span class="linenos">312</span></a>            <span class="n">growth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">real_gdp_growth</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">inflation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="CBOBaseline-313"><a href="#CBOBaseline-313"><span class="linenos">313</span></a>            <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth</span><span class="p">)</span>
</span><span id="CBOBaseline-314"><a href="#CBOBaseline-314"><span class="linenos">314</span></a>        
</span><span id="CBOBaseline-315"><a href="#CBOBaseline-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="n">revenue</span>
</span><span id="CBOBaseline-316"><a href="#CBOBaseline-316"><span class="linenos">316</span></a>    
</span><span id="CBOBaseline-317"><a href="#CBOBaseline-317"><span class="linenos">317</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_other_revenue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-318"><a href="#CBOBaseline-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project other revenues (excise, customs, misc).&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-319"><a href="#CBOBaseline-319"><span class="linenos">319</span></a>        <span class="n">revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-320"><a href="#CBOBaseline-320"><span class="linenos">320</span></a>        <span class="n">revenue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_other_revenue</span> <span class="o">*</span> <span class="mf">1.03</span>
</span><span id="CBOBaseline-321"><a href="#CBOBaseline-321"><span class="linenos">321</span></a>        
</span><span id="CBOBaseline-322"><a href="#CBOBaseline-322"><span class="linenos">322</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-323"><a href="#CBOBaseline-323"><span class="linenos">323</span></a>            <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.02</span>  <span class="c1"># Slower growth</span>
</span><span id="CBOBaseline-324"><a href="#CBOBaseline-324"><span class="linenos">324</span></a>        
</span><span id="CBOBaseline-325"><a href="#CBOBaseline-325"><span class="linenos">325</span></a>        <span class="k">return</span> <span class="n">revenue</span>
</span><span id="CBOBaseline-326"><a href="#CBOBaseline-326"><span class="linenos">326</span></a>    
</span><span id="CBOBaseline-327"><a href="#CBOBaseline-327"><span class="linenos">327</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_social_security</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-328"><a href="#CBOBaseline-328"><span class="linenos">328</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project Social Security spending.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-329"><a href="#CBOBaseline-329"><span class="linenos">329</span></a>        <span class="c1"># Fast growing due to demographics</span>
</span><span id="CBOBaseline-330"><a href="#CBOBaseline-330"><span class="linenos">330</span></a>        <span class="n">spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-331"><a href="#CBOBaseline-331"><span class="linenos">331</span></a>        <span class="n">spending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_social_security</span> <span class="o">*</span> <span class="mf">1.06</span>
</span><span id="CBOBaseline-332"><a href="#CBOBaseline-332"><span class="linenos">332</span></a>        
</span><span id="CBOBaseline-333"><a href="#CBOBaseline-333"><span class="linenos">333</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-334"><a href="#CBOBaseline-334"><span class="linenos">334</span></a>            <span class="c1"># ~5% annual growth</span>
</span><span id="CBOBaseline-335"><a href="#CBOBaseline-335"><span class="linenos">335</span></a>            <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.05</span>
</span><span id="CBOBaseline-336"><a href="#CBOBaseline-336"><span class="linenos">336</span></a>        
</span><span id="CBOBaseline-337"><a href="#CBOBaseline-337"><span class="linenos">337</span></a>        <span class="k">return</span> <span class="n">spending</span>
</span><span id="CBOBaseline-338"><a href="#CBOBaseline-338"><span class="linenos">338</span></a>    
</span><span id="CBOBaseline-339"><a href="#CBOBaseline-339"><span class="linenos">339</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_medicare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-340"><a href="#CBOBaseline-340"><span class="linenos">340</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project Medicare spending.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-341"><a href="#CBOBaseline-341"><span class="linenos">341</span></a>        <span class="c1"># Fast growing due to demographics and healthcare costs</span>
</span><span id="CBOBaseline-342"><a href="#CBOBaseline-342"><span class="linenos">342</span></a>        <span class="n">spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-343"><a href="#CBOBaseline-343"><span class="linenos">343</span></a>        <span class="n">spending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_medicare</span> <span class="o">*</span> <span class="mf">1.07</span>
</span><span id="CBOBaseline-344"><a href="#CBOBaseline-344"><span class="linenos">344</span></a>        
</span><span id="CBOBaseline-345"><a href="#CBOBaseline-345"><span class="linenos">345</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-346"><a href="#CBOBaseline-346"><span class="linenos">346</span></a>            <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.06</span>
</span><span id="CBOBaseline-347"><a href="#CBOBaseline-347"><span class="linenos">347</span></a>        
</span><span id="CBOBaseline-348"><a href="#CBOBaseline-348"><span class="linenos">348</span></a>        <span class="k">return</span> <span class="n">spending</span>
</span><span id="CBOBaseline-349"><a href="#CBOBaseline-349"><span class="linenos">349</span></a>    
</span><span id="CBOBaseline-350"><a href="#CBOBaseline-350"><span class="linenos">350</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_medicaid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-351"><a href="#CBOBaseline-351"><span class="linenos">351</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project Medicaid spending.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-352"><a href="#CBOBaseline-352"><span class="linenos">352</span></a>        <span class="n">spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-353"><a href="#CBOBaseline-353"><span class="linenos">353</span></a>        <span class="n">spending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_medicaid</span> <span class="o">*</span> <span class="mf">1.05</span>
</span><span id="CBOBaseline-354"><a href="#CBOBaseline-354"><span class="linenos">354</span></a>        
</span><span id="CBOBaseline-355"><a href="#CBOBaseline-355"><span class="linenos">355</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-356"><a href="#CBOBaseline-356"><span class="linenos">356</span></a>            <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.05</span>
</span><span id="CBOBaseline-357"><a href="#CBOBaseline-357"><span class="linenos">357</span></a>        
</span><span id="CBOBaseline-358"><a href="#CBOBaseline-358"><span class="linenos">358</span></a>        <span class="k">return</span> <span class="n">spending</span>
</span><span id="CBOBaseline-359"><a href="#CBOBaseline-359"><span class="linenos">359</span></a>    
</span><span id="CBOBaseline-360"><a href="#CBOBaseline-360"><span class="linenos">360</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_other_mandatory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-361"><a href="#CBOBaseline-361"><span class="linenos">361</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project other mandatory spending.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-362"><a href="#CBOBaseline-362"><span class="linenos">362</span></a>        <span class="n">spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-363"><a href="#CBOBaseline-363"><span class="linenos">363</span></a>        <span class="n">spending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_other_mandatory</span> <span class="o">*</span> <span class="mf">1.03</span>
</span><span id="CBOBaseline-364"><a href="#CBOBaseline-364"><span class="linenos">364</span></a>        
</span><span id="CBOBaseline-365"><a href="#CBOBaseline-365"><span class="linenos">365</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-366"><a href="#CBOBaseline-366"><span class="linenos">366</span></a>            <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.03</span>
</span><span id="CBOBaseline-367"><a href="#CBOBaseline-367"><span class="linenos">367</span></a>        
</span><span id="CBOBaseline-368"><a href="#CBOBaseline-368"><span class="linenos">368</span></a>        <span class="k">return</span> <span class="n">spending</span>
</span><span id="CBOBaseline-369"><a href="#CBOBaseline-369"><span class="linenos">369</span></a>    
</span><span id="CBOBaseline-370"><a href="#CBOBaseline-370"><span class="linenos">370</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_defense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-371"><a href="#CBOBaseline-371"><span class="linenos">371</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project defense discretionary spending.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-372"><a href="#CBOBaseline-372"><span class="linenos">372</span></a>        <span class="c1"># Assume caps or slow growth</span>
</span><span id="CBOBaseline-373"><a href="#CBOBaseline-373"><span class="linenos">373</span></a>        <span class="n">spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-374"><a href="#CBOBaseline-374"><span class="linenos">374</span></a>        <span class="n">spending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_defense</span> <span class="o">*</span> <span class="mf">1.02</span>
</span><span id="CBOBaseline-375"><a href="#CBOBaseline-375"><span class="linenos">375</span></a>        
</span><span id="CBOBaseline-376"><a href="#CBOBaseline-376"><span class="linenos">376</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-377"><a href="#CBOBaseline-377"><span class="linenos">377</span></a>            <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.02</span>
</span><span id="CBOBaseline-378"><a href="#CBOBaseline-378"><span class="linenos">378</span></a>        
</span><span id="CBOBaseline-379"><a href="#CBOBaseline-379"><span class="linenos">379</span></a>        <span class="k">return</span> <span class="n">spending</span>
</span><span id="CBOBaseline-380"><a href="#CBOBaseline-380"><span class="linenos">380</span></a>    
</span><span id="CBOBaseline-381"><a href="#CBOBaseline-381"><span class="linenos">381</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_nondefense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-382"><a href="#CBOBaseline-382"><span class="linenos">382</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project nondefense discretionary spending.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-383"><a href="#CBOBaseline-383"><span class="linenos">383</span></a>        <span class="n">spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-384"><a href="#CBOBaseline-384"><span class="linenos">384</span></a>        <span class="n">spending</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_nondefense</span> <span class="o">*</span> <span class="mf">1.01</span>
</span><span id="CBOBaseline-385"><a href="#CBOBaseline-385"><span class="linenos">385</span></a>        
</span><span id="CBOBaseline-386"><a href="#CBOBaseline-386"><span class="linenos">386</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-387"><a href="#CBOBaseline-387"><span class="linenos">387</span></a>            <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.01</span>
</span><span id="CBOBaseline-388"><a href="#CBOBaseline-388"><span class="linenos">388</span></a>        
</span><span id="CBOBaseline-389"><a href="#CBOBaseline-389"><span class="linenos">389</span></a>        <span class="k">return</span> <span class="n">spending</span>
</span><span id="CBOBaseline-390"><a href="#CBOBaseline-390"><span class="linenos">390</span></a>    
</span><span id="CBOBaseline-391"><a href="#CBOBaseline-391"><span class="linenos">391</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_debt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj</span><span class="p">:</span> <span class="n">BaselineProjection</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-392"><a href="#CBOBaseline-392"><span class="linenos">392</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project debt held by public (iterative with interest).&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-393"><a href="#CBOBaseline-393"><span class="linenos">393</span></a>        <span class="n">debt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-394"><a href="#CBOBaseline-394"><span class="linenos">394</span></a>        <span class="n">debt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_debt</span> <span class="o">+</span> <span class="n">proj</span><span class="o">.</span><span class="n">deficit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CBOBaseline-395"><a href="#CBOBaseline-395"><span class="linenos">395</span></a>        
</span><span id="CBOBaseline-396"><a href="#CBOBaseline-396"><span class="linenos">396</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-397"><a href="#CBOBaseline-397"><span class="linenos">397</span></a>            <span class="n">debt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">debt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">proj</span><span class="o">.</span><span class="n">deficit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="CBOBaseline-398"><a href="#CBOBaseline-398"><span class="linenos">398</span></a>        
</span><span id="CBOBaseline-399"><a href="#CBOBaseline-399"><span class="linenos">399</span></a>        <span class="k">return</span> <span class="n">debt</span>
</span><span id="CBOBaseline-400"><a href="#CBOBaseline-400"><span class="linenos">400</span></a>    
</span><span id="CBOBaseline-401"><a href="#CBOBaseline-401"><span class="linenos">401</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_project_interest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj</span><span class="p">:</span> <span class="n">BaselineProjection</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="CBOBaseline-402"><a href="#CBOBaseline-402"><span class="linenos">402</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Project net interest payments.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-403"><a href="#CBOBaseline-403"><span class="linenos">403</span></a>        <span class="n">interest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline-404"><a href="#CBOBaseline-404"><span class="linenos">404</span></a>        
</span><span id="CBOBaseline-405"><a href="#CBOBaseline-405"><span class="linenos">405</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span><span id="CBOBaseline-406"><a href="#CBOBaseline-406"><span class="linenos">406</span></a>            <span class="n">avg_debt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_debt</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">debt_held_by_public</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> 
</span><span id="CBOBaseline-407"><a href="#CBOBaseline-407"><span class="linenos">407</span></a>                                                       <span class="n">proj</span><span class="o">.</span><span class="n">debt_held_by_public</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="CBOBaseline-408"><a href="#CBOBaseline-408"><span class="linenos">408</span></a>            <span class="c1"># Effective interest rate is lower than 10-year due to mix of maturities</span>
</span><span id="CBOBaseline-409"><a href="#CBOBaseline-409"><span class="linenos">409</span></a>            <span class="n">effective_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span><span class="o">.</span><span class="n">interest_rate_10yr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.75</span>
</span><span id="CBOBaseline-410"><a href="#CBOBaseline-410"><span class="linenos">410</span></a>            <span class="n">interest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">avg_debt</span> <span class="o">*</span> <span class="n">effective_rate</span>
</span><span id="CBOBaseline-411"><a href="#CBOBaseline-411"><span class="linenos">411</span></a>        
</span><span id="CBOBaseline-412"><a href="#CBOBaseline-412"><span class="linenos">412</span></a>        <span class="k">return</span> <span class="n">interest</span>
</span><span id="CBOBaseline-413"><a href="#CBOBaseline-413"><span class="linenos">413</span></a>    
</span><span id="CBOBaseline-414"><a href="#CBOBaseline-414"><span class="linenos">414</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">adjust_for_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineProjection</span><span class="p">,</span> 
</span><span id="CBOBaseline-415"><a href="#CBOBaseline-415"><span class="linenos">415</span></a>                         <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="CBOBaseline-416"><a href="#CBOBaseline-416"><span class="linenos">416</span></a>                         <span class="n">changes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaselineProjection</span><span class="p">:</span>
</span><span id="CBOBaseline-417"><a href="#CBOBaseline-417"><span class="linenos">417</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CBOBaseline-418"><a href="#CBOBaseline-418"><span class="linenos">418</span></a><span class="sd">        Create a new projection with policy changes applied.</span>
</span><span id="CBOBaseline-419"><a href="#CBOBaseline-419"><span class="linenos">419</span></a><span class="sd">        </span>
</span><span id="CBOBaseline-420"><a href="#CBOBaseline-420"><span class="linenos">420</span></a><span class="sd">        Args:</span>
</span><span id="CBOBaseline-421"><a href="#CBOBaseline-421"><span class="linenos">421</span></a><span class="sd">            baseline: Original baseline projection</span>
</span><span id="CBOBaseline-422"><a href="#CBOBaseline-422"><span class="linenos">422</span></a><span class="sd">            category: Which category to modify</span>
</span><span id="CBOBaseline-423"><a href="#CBOBaseline-423"><span class="linenos">423</span></a><span class="sd">            changes: Array of changes for each year (in billions)</span>
</span><span id="CBOBaseline-424"><a href="#CBOBaseline-424"><span class="linenos">424</span></a><span class="sd">            </span>
</span><span id="CBOBaseline-425"><a href="#CBOBaseline-425"><span class="linenos">425</span></a><span class="sd">        Returns:</span>
</span><span id="CBOBaseline-426"><a href="#CBOBaseline-426"><span class="linenos">426</span></a><span class="sd">            New projection with changes applied</span>
</span><span id="CBOBaseline-427"><a href="#CBOBaseline-427"><span class="linenos">427</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CBOBaseline-428"><a href="#CBOBaseline-428"><span class="linenos">428</span></a>        <span class="c1"># Create a copy</span>
</span><span id="CBOBaseline-429"><a href="#CBOBaseline-429"><span class="linenos">429</span></a>        <span class="n">new_proj</span> <span class="o">=</span> <span class="n">BaselineProjection</span><span class="p">(</span>
</span><span id="CBOBaseline-430"><a href="#CBOBaseline-430"><span class="linenos">430</span></a>            <span class="n">start_year</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="CBOBaseline-431"><a href="#CBOBaseline-431"><span class="linenos">431</span></a>            <span class="n">years</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-432"><a href="#CBOBaseline-432"><span class="linenos">432</span></a>            <span class="n">nominal_gdp</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-433"><a href="#CBOBaseline-433"><span class="linenos">433</span></a>            <span class="n">real_gdp</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">real_gdp</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-434"><a href="#CBOBaseline-434"><span class="linenos">434</span></a>            <span class="n">individual_income_tax</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">individual_income_tax</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-435"><a href="#CBOBaseline-435"><span class="linenos">435</span></a>            <span class="n">corporate_income_tax</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">corporate_income_tax</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-436"><a href="#CBOBaseline-436"><span class="linenos">436</span></a>            <span class="n">payroll_taxes</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">payroll_taxes</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-437"><a href="#CBOBaseline-437"><span class="linenos">437</span></a>            <span class="n">other_revenues</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">other_revenues</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-438"><a href="#CBOBaseline-438"><span class="linenos">438</span></a>            <span class="n">social_security</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">social_security</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-439"><a href="#CBOBaseline-439"><span class="linenos">439</span></a>            <span class="n">medicare</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">medicare</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-440"><a href="#CBOBaseline-440"><span class="linenos">440</span></a>            <span class="n">medicaid</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">medicaid</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-441"><a href="#CBOBaseline-441"><span class="linenos">441</span></a>            <span class="n">other_mandatory</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">other_mandatory</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-442"><a href="#CBOBaseline-442"><span class="linenos">442</span></a>            <span class="n">defense_discretionary</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">defense_discretionary</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-443"><a href="#CBOBaseline-443"><span class="linenos">443</span></a>            <span class="n">nondefense_discretionary</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">nondefense_discretionary</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-444"><a href="#CBOBaseline-444"><span class="linenos">444</span></a>            <span class="n">net_interest</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">net_interest</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-445"><a href="#CBOBaseline-445"><span class="linenos">445</span></a>            <span class="n">debt_held_by_public</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">debt_held_by_public</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline-446"><a href="#CBOBaseline-446"><span class="linenos">446</span></a>        <span class="p">)</span>
</span><span id="CBOBaseline-447"><a href="#CBOBaseline-447"><span class="linenos">447</span></a>        
</span><span id="CBOBaseline-448"><a href="#CBOBaseline-448"><span class="linenos">448</span></a>        <span class="c1"># Apply changes</span>
</span><span id="CBOBaseline-449"><a href="#CBOBaseline-449"><span class="linenos">449</span></a>        <span class="n">current</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">new_proj</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>
</span><span id="CBOBaseline-450"><a href="#CBOBaseline-450"><span class="linenos">450</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">new_proj</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">current</span> <span class="o">+</span> <span class="n">changes</span><span class="p">)</span>
</span><span id="CBOBaseline-451"><a href="#CBOBaseline-451"><span class="linenos">451</span></a>        
</span><span id="CBOBaseline-452"><a href="#CBOBaseline-452"><span class="linenos">452</span></a>        <span class="k">return</span> <span class="n">new_proj</span>
</span></pre></div>


            <div class="docstring"><p>Generator for CBO-style baseline projections.</p>

<p>Based on CBO's February 2024 baseline with adjustments.</p>
</div>


                            <div id="CBOBaseline.__init__" class="classattr">
                                        <input id="CBOBaseline.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CBOBaseline</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="CBOBaseline.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CBOBaseline.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CBOBaseline.__init__-139"><a href="#CBOBaseline.__init__-139"><span class="linenos">139</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span> <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="CBOBaseline.__init__-140"><a href="#CBOBaseline.__init__-140"><span class="linenos">140</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="CBOBaseline.__init__-141"><a href="#CBOBaseline.__init__-141"><span class="linenos">141</span></a>        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="CBOBaseline.__init__-142"><a href="#CBOBaseline.__init__-142"><span class="linenos">142</span></a>
</span><span id="CBOBaseline.__init__-143"><a href="#CBOBaseline.__init__-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">=</span> <span class="n">start_year</span>
</span><span id="CBOBaseline.__init__-144"><a href="#CBOBaseline.__init__-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">start_year</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="CBOBaseline.__init__-145"><a href="#CBOBaseline.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assumptions</span> <span class="o">=</span> <span class="n">EconomicAssumptions</span><span class="p">()</span>
</span><span id="CBOBaseline.__init__-146"><a href="#CBOBaseline.__init__-146"><span class="linenos">146</span></a>
</span><span id="CBOBaseline.__init__-147"><a href="#CBOBaseline.__init__-147"><span class="linenos">147</span></a>        <span class="c1"># Try to load real data, fall back to hardcoded if unavailable</span>
</span><span id="CBOBaseline.__init__-148"><a href="#CBOBaseline.__init__-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="n">use_real_data</span><span class="p">:</span>
</span><span id="CBOBaseline.__init__-149"><a href="#CBOBaseline.__init__-149"><span class="linenos">149</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CBOBaseline.__init__-150"><a href="#CBOBaseline.__init__-150"><span class="linenos">150</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_load_from_data_sources</span><span class="p">()</span>
</span><span id="CBOBaseline.__init__-151"><a href="#CBOBaseline.__init__-151"><span class="linenos">151</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully loaded baseline data from IRS SOI and FRED&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline.__init__-152"><a href="#CBOBaseline.__init__-152"><span class="linenos">152</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="CBOBaseline.__init__-153"><a href="#CBOBaseline.__init__-153"><span class="linenos">153</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not load real data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline.__init__-154"><a href="#CBOBaseline.__init__-154"><span class="linenos">154</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Falling back to hardcoded baseline values&quot;</span><span class="p">)</span>
</span><span id="CBOBaseline.__init__-155"><a href="#CBOBaseline.__init__-155"><span class="linenos">155</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_use_hardcoded_fallback</span><span class="p">()</span>
</span><span id="CBOBaseline.__init__-156"><a href="#CBOBaseline.__init__-156"><span class="linenos">156</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CBOBaseline.__init__-157"><a href="#CBOBaseline.__init__-157"><span class="linenos">157</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_use_hardcoded_fallback</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="CBOBaseline.start_year" class="classattr">
                                <div class="attr variable">
            <span class="name">start_year</span>

        
    </div>
    <a class="headerlink" href="#CBOBaseline.start_year"></a>
    
    

                            </div>
                            <div id="CBOBaseline.years" class="classattr">
                                <div class="attr variable">
            <span class="name">years</span>

        
    </div>
    <a class="headerlink" href="#CBOBaseline.years"></a>
    
    

                            </div>
                            <div id="CBOBaseline.assumptions" class="classattr">
                                <div class="attr variable">
            <span class="name">assumptions</span>

        
    </div>
    <a class="headerlink" href="#CBOBaseline.assumptions"></a>
    
    

                            </div>
                            <div id="CBOBaseline.generate" class="classattr">
                                        <input id="CBOBaseline.generate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="#BaselineProjection">BaselineProjection</a></span>:</span></span>

                <label class="view-source-button" for="CBOBaseline.generate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CBOBaseline.generate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CBOBaseline.generate-225"><a href="#CBOBaseline.generate-225"><span class="linenos">225</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaselineProjection</span><span class="p">:</span>
</span><span id="CBOBaseline.generate-226"><a href="#CBOBaseline.generate-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a 10-year baseline projection.&quot;&quot;&quot;</span>
</span><span id="CBOBaseline.generate-227"><a href="#CBOBaseline.generate-227"><span class="linenos">227</span></a>        <span class="n">proj</span> <span class="o">=</span> <span class="n">BaselineProjection</span><span class="p">(</span>
</span><span id="CBOBaseline.generate-228"><a href="#CBOBaseline.generate-228"><span class="linenos">228</span></a>            <span class="n">start_year</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="CBOBaseline.generate-229"><a href="#CBOBaseline.generate-229"><span class="linenos">229</span></a>            <span class="n">years</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-230"><a href="#CBOBaseline.generate-230"><span class="linenos">230</span></a>        <span class="p">)</span>
</span><span id="CBOBaseline.generate-231"><a href="#CBOBaseline.generate-231"><span class="linenos">231</span></a>        
</span><span id="CBOBaseline.generate-232"><a href="#CBOBaseline.generate-232"><span class="linenos">232</span></a>        <span class="c1"># Generate GDP path</span>
</span><span id="CBOBaseline.generate-233"><a href="#CBOBaseline.generate-233"><span class="linenos">233</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_gdp</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-234"><a href="#CBOBaseline.generate-234"><span class="linenos">234</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">real_gdp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_real_gdp</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-235"><a href="#CBOBaseline.generate-235"><span class="linenos">235</span></a>        
</span><span id="CBOBaseline.generate-236"><a href="#CBOBaseline.generate-236"><span class="linenos">236</span></a>        <span class="c1"># Generate revenues</span>
</span><span id="CBOBaseline.generate-237"><a href="#CBOBaseline.generate-237"><span class="linenos">237</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">individual_income_tax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_individual_tax</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-238"><a href="#CBOBaseline.generate-238"><span class="linenos">238</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">corporate_income_tax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_corporate_tax</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-239"><a href="#CBOBaseline.generate-239"><span class="linenos">239</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">payroll_taxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_payroll_tax</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-240"><a href="#CBOBaseline.generate-240"><span class="linenos">240</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">other_revenues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_other_revenue</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-241"><a href="#CBOBaseline.generate-241"><span class="linenos">241</span></a>        
</span><span id="CBOBaseline.generate-242"><a href="#CBOBaseline.generate-242"><span class="linenos">242</span></a>        <span class="c1"># Generate spending</span>
</span><span id="CBOBaseline.generate-243"><a href="#CBOBaseline.generate-243"><span class="linenos">243</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">social_security</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_social_security</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-244"><a href="#CBOBaseline.generate-244"><span class="linenos">244</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">medicare</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_medicare</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-245"><a href="#CBOBaseline.generate-245"><span class="linenos">245</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">medicaid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_medicaid</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-246"><a href="#CBOBaseline.generate-246"><span class="linenos">246</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">other_mandatory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_other_mandatory</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-247"><a href="#CBOBaseline.generate-247"><span class="linenos">247</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">defense_discretionary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_defense</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-248"><a href="#CBOBaseline.generate-248"><span class="linenos">248</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">nondefense_discretionary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_nondefense</span><span class="p">()</span>
</span><span id="CBOBaseline.generate-249"><a href="#CBOBaseline.generate-249"><span class="linenos">249</span></a>        
</span><span id="CBOBaseline.generate-250"><a href="#CBOBaseline.generate-250"><span class="linenos">250</span></a>        <span class="c1"># Calculate interest and debt</span>
</span><span id="CBOBaseline.generate-251"><a href="#CBOBaseline.generate-251"><span class="linenos">251</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">debt_held_by_public</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_debt</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
</span><span id="CBOBaseline.generate-252"><a href="#CBOBaseline.generate-252"><span class="linenos">252</span></a>        <span class="n">proj</span><span class="o">.</span><span class="n">net_interest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_interest</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
</span><span id="CBOBaseline.generate-253"><a href="#CBOBaseline.generate-253"><span class="linenos">253</span></a>        
</span><span id="CBOBaseline.generate-254"><a href="#CBOBaseline.generate-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="n">proj</span>
</span></pre></div>


            <div class="docstring"><p>Generate a 10-year baseline projection.</p>
</div>


                            </div>
                            <div id="CBOBaseline.adjust_for_policy" class="classattr">
                                        <input id="CBOBaseline.adjust_for_policy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">adjust_for_policy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">baseline</span><span class="p">:</span> <span class="n"><a href="#BaselineProjection">BaselineProjection</a></span>,</span><span class="param">	<span class="n">category</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">changes</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span></span><span class="return-annotation">) -> <span class="n"><a href="#BaselineProjection">BaselineProjection</a></span>:</span></span>

                <label class="view-source-button" for="CBOBaseline.adjust_for_policy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CBOBaseline.adjust_for_policy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CBOBaseline.adjust_for_policy-414"><a href="#CBOBaseline.adjust_for_policy-414"><span class="linenos">414</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">adjust_for_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineProjection</span><span class="p">,</span> 
</span><span id="CBOBaseline.adjust_for_policy-415"><a href="#CBOBaseline.adjust_for_policy-415"><span class="linenos">415</span></a>                         <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="CBOBaseline.adjust_for_policy-416"><a href="#CBOBaseline.adjust_for_policy-416"><span class="linenos">416</span></a>                         <span class="n">changes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaselineProjection</span><span class="p">:</span>
</span><span id="CBOBaseline.adjust_for_policy-417"><a href="#CBOBaseline.adjust_for_policy-417"><span class="linenos">417</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CBOBaseline.adjust_for_policy-418"><a href="#CBOBaseline.adjust_for_policy-418"><span class="linenos">418</span></a><span class="sd">        Create a new projection with policy changes applied.</span>
</span><span id="CBOBaseline.adjust_for_policy-419"><a href="#CBOBaseline.adjust_for_policy-419"><span class="linenos">419</span></a><span class="sd">        </span>
</span><span id="CBOBaseline.adjust_for_policy-420"><a href="#CBOBaseline.adjust_for_policy-420"><span class="linenos">420</span></a><span class="sd">        Args:</span>
</span><span id="CBOBaseline.adjust_for_policy-421"><a href="#CBOBaseline.adjust_for_policy-421"><span class="linenos">421</span></a><span class="sd">            baseline: Original baseline projection</span>
</span><span id="CBOBaseline.adjust_for_policy-422"><a href="#CBOBaseline.adjust_for_policy-422"><span class="linenos">422</span></a><span class="sd">            category: Which category to modify</span>
</span><span id="CBOBaseline.adjust_for_policy-423"><a href="#CBOBaseline.adjust_for_policy-423"><span class="linenos">423</span></a><span class="sd">            changes: Array of changes for each year (in billions)</span>
</span><span id="CBOBaseline.adjust_for_policy-424"><a href="#CBOBaseline.adjust_for_policy-424"><span class="linenos">424</span></a><span class="sd">            </span>
</span><span id="CBOBaseline.adjust_for_policy-425"><a href="#CBOBaseline.adjust_for_policy-425"><span class="linenos">425</span></a><span class="sd">        Returns:</span>
</span><span id="CBOBaseline.adjust_for_policy-426"><a href="#CBOBaseline.adjust_for_policy-426"><span class="linenos">426</span></a><span class="sd">            New projection with changes applied</span>
</span><span id="CBOBaseline.adjust_for_policy-427"><a href="#CBOBaseline.adjust_for_policy-427"><span class="linenos">427</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CBOBaseline.adjust_for_policy-428"><a href="#CBOBaseline.adjust_for_policy-428"><span class="linenos">428</span></a>        <span class="c1"># Create a copy</span>
</span><span id="CBOBaseline.adjust_for_policy-429"><a href="#CBOBaseline.adjust_for_policy-429"><span class="linenos">429</span></a>        <span class="n">new_proj</span> <span class="o">=</span> <span class="n">BaselineProjection</span><span class="p">(</span>
</span><span id="CBOBaseline.adjust_for_policy-430"><a href="#CBOBaseline.adjust_for_policy-430"><span class="linenos">430</span></a>            <span class="n">start_year</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="CBOBaseline.adjust_for_policy-431"><a href="#CBOBaseline.adjust_for_policy-431"><span class="linenos">431</span></a>            <span class="n">years</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-432"><a href="#CBOBaseline.adjust_for_policy-432"><span class="linenos">432</span></a>            <span class="n">nominal_gdp</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-433"><a href="#CBOBaseline.adjust_for_policy-433"><span class="linenos">433</span></a>            <span class="n">real_gdp</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">real_gdp</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-434"><a href="#CBOBaseline.adjust_for_policy-434"><span class="linenos">434</span></a>            <span class="n">individual_income_tax</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">individual_income_tax</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-435"><a href="#CBOBaseline.adjust_for_policy-435"><span class="linenos">435</span></a>            <span class="n">corporate_income_tax</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">corporate_income_tax</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-436"><a href="#CBOBaseline.adjust_for_policy-436"><span class="linenos">436</span></a>            <span class="n">payroll_taxes</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">payroll_taxes</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-437"><a href="#CBOBaseline.adjust_for_policy-437"><span class="linenos">437</span></a>            <span class="n">other_revenues</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">other_revenues</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-438"><a href="#CBOBaseline.adjust_for_policy-438"><span class="linenos">438</span></a>            <span class="n">social_security</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">social_security</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-439"><a href="#CBOBaseline.adjust_for_policy-439"><span class="linenos">439</span></a>            <span class="n">medicare</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">medicare</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-440"><a href="#CBOBaseline.adjust_for_policy-440"><span class="linenos">440</span></a>            <span class="n">medicaid</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">medicaid</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-441"><a href="#CBOBaseline.adjust_for_policy-441"><span class="linenos">441</span></a>            <span class="n">other_mandatory</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">other_mandatory</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-442"><a href="#CBOBaseline.adjust_for_policy-442"><span class="linenos">442</span></a>            <span class="n">defense_discretionary</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">defense_discretionary</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-443"><a href="#CBOBaseline.adjust_for_policy-443"><span class="linenos">443</span></a>            <span class="n">nondefense_discretionary</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">nondefense_discretionary</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-444"><a href="#CBOBaseline.adjust_for_policy-444"><span class="linenos">444</span></a>            <span class="n">net_interest</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">net_interest</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-445"><a href="#CBOBaseline.adjust_for_policy-445"><span class="linenos">445</span></a>            <span class="n">debt_held_by_public</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">debt_held_by_public</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="CBOBaseline.adjust_for_policy-446"><a href="#CBOBaseline.adjust_for_policy-446"><span class="linenos">446</span></a>        <span class="p">)</span>
</span><span id="CBOBaseline.adjust_for_policy-447"><a href="#CBOBaseline.adjust_for_policy-447"><span class="linenos">447</span></a>        
</span><span id="CBOBaseline.adjust_for_policy-448"><a href="#CBOBaseline.adjust_for_policy-448"><span class="linenos">448</span></a>        <span class="c1"># Apply changes</span>
</span><span id="CBOBaseline.adjust_for_policy-449"><a href="#CBOBaseline.adjust_for_policy-449"><span class="linenos">449</span></a>        <span class="n">current</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">new_proj</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>
</span><span id="CBOBaseline.adjust_for_policy-450"><a href="#CBOBaseline.adjust_for_policy-450"><span class="linenos">450</span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">new_proj</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">current</span> <span class="o">+</span> <span class="n">changes</span><span class="p">)</span>
</span><span id="CBOBaseline.adjust_for_policy-451"><a href="#CBOBaseline.adjust_for_policy-451"><span class="linenos">451</span></a>        
</span><span id="CBOBaseline.adjust_for_policy-452"><a href="#CBOBaseline.adjust_for_policy-452"><span class="linenos">452</span></a>        <span class="k">return</span> <span class="n">new_proj</span>
</span></pre></div>


            <div class="docstring"><p>Create a new projection with policy changes applied.</p>

<p>Args:
    baseline: Original baseline projection
    category: Which category to modify
    changes: Array of changes for each year (in billions)</p>

<p>Returns:
    New projection with changes applied</p>
</div>


                            </div>
                </section>
                <section id="FiscalPolicyScorer">
                            <input id="FiscalPolicyScorer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FiscalPolicyScorer</span>:

                <label class="view-source-button" for="FiscalPolicyScorer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FiscalPolicyScorer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FiscalPolicyScorer-203"><a href="#FiscalPolicyScorer-203"><span class="linenos">203</span></a><span class="k">class</span><span class="w"> </span><span class="nc">FiscalPolicyScorer</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-204"><a href="#FiscalPolicyScorer-204"><span class="linenos">204</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-205"><a href="#FiscalPolicyScorer-205"><span class="linenos">205</span></a><span class="sd">    Main scoring engine for fiscal policy analysis.</span>
</span><span id="FiscalPolicyScorer-206"><a href="#FiscalPolicyScorer-206"><span class="linenos">206</span></a><span class="sd">    </span>
</span><span id="FiscalPolicyScorer-207"><a href="#FiscalPolicyScorer-207"><span class="linenos">207</span></a><span class="sd">    Implements CBO-style scoring methodology with both static</span>
</span><span id="FiscalPolicyScorer-208"><a href="#FiscalPolicyScorer-208"><span class="linenos">208</span></a><span class="sd">    and dynamic options.</span>
</span><span id="FiscalPolicyScorer-209"><a href="#FiscalPolicyScorer-209"><span class="linenos">209</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-210"><a href="#FiscalPolicyScorer-210"><span class="linenos">210</span></a>    
</span><span id="FiscalPolicyScorer-211"><a href="#FiscalPolicyScorer-211"><span class="linenos">211</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaselineProjection</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-212"><a href="#FiscalPolicyScorer-212"><span class="linenos">212</span></a>                 <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-213"><a href="#FiscalPolicyScorer-213"><span class="linenos">213</span></a>                 <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-214"><a href="#FiscalPolicyScorer-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-215"><a href="#FiscalPolicyScorer-215"><span class="linenos">215</span></a><span class="sd">        Initialize the scorer.</span>
</span><span id="FiscalPolicyScorer-216"><a href="#FiscalPolicyScorer-216"><span class="linenos">216</span></a>
</span><span id="FiscalPolicyScorer-217"><a href="#FiscalPolicyScorer-217"><span class="linenos">217</span></a><span class="sd">        Args:</span>
</span><span id="FiscalPolicyScorer-218"><a href="#FiscalPolicyScorer-218"><span class="linenos">218</span></a><span class="sd">            baseline: Pre-computed baseline projection (optional)</span>
</span><span id="FiscalPolicyScorer-219"><a href="#FiscalPolicyScorer-219"><span class="linenos">219</span></a><span class="sd">            start_year: Start year for analysis</span>
</span><span id="FiscalPolicyScorer-220"><a href="#FiscalPolicyScorer-220"><span class="linenos">220</span></a><span class="sd">            use_real_data: If True, load baseline from IRS/FRED data.</span>
</span><span id="FiscalPolicyScorer-221"><a href="#FiscalPolicyScorer-221"><span class="linenos">221</span></a><span class="sd">                          If False, use hardcoded fallback values.</span>
</span><span id="FiscalPolicyScorer-222"><a href="#FiscalPolicyScorer-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-223"><a href="#FiscalPolicyScorer-223"><span class="linenos">223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">=</span> <span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-224"><a href="#FiscalPolicyScorer-224"><span class="linenos">224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span> <span class="o">=</span> <span class="n">use_real_data</span>
</span><span id="FiscalPolicyScorer-225"><a href="#FiscalPolicyScorer-225"><span class="linenos">225</span></a>
</span><span id="FiscalPolicyScorer-226"><a href="#FiscalPolicyScorer-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-227"><a href="#FiscalPolicyScorer-227"><span class="linenos">227</span></a>            <span class="n">generator</span> <span class="o">=</span> <span class="n">CBOBaseline</span><span class="p">(</span><span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span> <span class="n">use_real_data</span><span class="o">=</span><span class="n">use_real_data</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-228"><a href="#FiscalPolicyScorer-228"><span class="linenos">228</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</span><span id="FiscalPolicyScorer-229"><a href="#FiscalPolicyScorer-229"><span class="linenos">229</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-230"><a href="#FiscalPolicyScorer-230"><span class="linenos">230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="n">baseline</span>
</span><span id="FiscalPolicyScorer-231"><a href="#FiscalPolicyScorer-231"><span class="linenos">231</span></a>
</span><span id="FiscalPolicyScorer-232"><a href="#FiscalPolicyScorer-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">economic_model</span> <span class="o">=</span> <span class="n">EconomicModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-233"><a href="#FiscalPolicyScorer-233"><span class="linenos">233</span></a>    
</span><span id="FiscalPolicyScorer-234"><a href="#FiscalPolicyScorer-234"><span class="linenos">234</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">score_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span> 
</span><span id="FiscalPolicyScorer-235"><a href="#FiscalPolicyScorer-235"><span class="linenos">235</span></a>                    <span class="n">dynamic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-236"><a href="#FiscalPolicyScorer-236"><span class="linenos">236</span></a>                    <span class="n">include_uncertainty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScoringResult</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-237"><a href="#FiscalPolicyScorer-237"><span class="linenos">237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-238"><a href="#FiscalPolicyScorer-238"><span class="linenos">238</span></a><span class="sd">        Score a fiscal policy proposal.</span>
</span><span id="FiscalPolicyScorer-239"><a href="#FiscalPolicyScorer-239"><span class="linenos">239</span></a><span class="sd">        </span>
</span><span id="FiscalPolicyScorer-240"><a href="#FiscalPolicyScorer-240"><span class="linenos">240</span></a><span class="sd">        Args:</span>
</span><span id="FiscalPolicyScorer-241"><a href="#FiscalPolicyScorer-241"><span class="linenos">241</span></a><span class="sd">            policy: Policy to score</span>
</span><span id="FiscalPolicyScorer-242"><a href="#FiscalPolicyScorer-242"><span class="linenos">242</span></a><span class="sd">            dynamic: Whether to include dynamic/macroeconomic effects</span>
</span><span id="FiscalPolicyScorer-243"><a href="#FiscalPolicyScorer-243"><span class="linenos">243</span></a><span class="sd">            include_uncertainty: Whether to calculate uncertainty ranges</span>
</span><span id="FiscalPolicyScorer-244"><a href="#FiscalPolicyScorer-244"><span class="linenos">244</span></a><span class="sd">            </span>
</span><span id="FiscalPolicyScorer-245"><a href="#FiscalPolicyScorer-245"><span class="linenos">245</span></a><span class="sd">        Returns:</span>
</span><span id="FiscalPolicyScorer-246"><a href="#FiscalPolicyScorer-246"><span class="linenos">246</span></a><span class="sd">            ScoringResult with complete analysis</span>
</span><span id="FiscalPolicyScorer-247"><a href="#FiscalPolicyScorer-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-248"><a href="#FiscalPolicyScorer-248"><span class="linenos">248</span></a>        <span class="n">years</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span>
</span><span id="FiscalPolicyScorer-249"><a href="#FiscalPolicyScorer-249"><span class="linenos">249</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-250"><a href="#FiscalPolicyScorer-250"><span class="linenos">250</span></a>        
</span><span id="FiscalPolicyScorer-251"><a href="#FiscalPolicyScorer-251"><span class="linenos">251</span></a>        <span class="c1"># Initialize effect arrays</span>
</span><span id="FiscalPolicyScorer-252"><a href="#FiscalPolicyScorer-252"><span class="linenos">252</span></a>        <span class="n">static_revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-253"><a href="#FiscalPolicyScorer-253"><span class="linenos">253</span></a>        <span class="n">static_spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-254"><a href="#FiscalPolicyScorer-254"><span class="linenos">254</span></a>        <span class="n">behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-255"><a href="#FiscalPolicyScorer-255"><span class="linenos">255</span></a>        
</span><span id="FiscalPolicyScorer-256"><a href="#FiscalPolicyScorer-256"><span class="linenos">256</span></a>        <span class="c1"># Calculate static effects based on policy type</span>
</span><span id="FiscalPolicyScorer-257"><a href="#FiscalPolicyScorer-257"><span class="linenos">257</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-258"><a href="#FiscalPolicyScorer-258"><span class="linenos">258</span></a>            <span class="n">static_revenue</span><span class="p">,</span> <span class="n">behavioral</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score_tax_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-259"><a href="#FiscalPolicyScorer-259"><span class="linenos">259</span></a>            <span class="n">static_spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-260"><a href="#FiscalPolicyScorer-260"><span class="linenos">260</span></a>            
</span><span id="FiscalPolicyScorer-261"><a href="#FiscalPolicyScorer-261"><span class="linenos">261</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">SpendingPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-262"><a href="#FiscalPolicyScorer-262"><span class="linenos">262</span></a>            <span class="n">static_revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-263"><a href="#FiscalPolicyScorer-263"><span class="linenos">263</span></a>            <span class="n">static_spending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score_spending_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-264"><a href="#FiscalPolicyScorer-264"><span class="linenos">264</span></a>            <span class="n">behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-265"><a href="#FiscalPolicyScorer-265"><span class="linenos">265</span></a>            
</span><span id="FiscalPolicyScorer-266"><a href="#FiscalPolicyScorer-266"><span class="linenos">266</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TransferPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-267"><a href="#FiscalPolicyScorer-267"><span class="linenos">267</span></a>            <span class="n">static_revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-268"><a href="#FiscalPolicyScorer-268"><span class="linenos">268</span></a>            <span class="n">static_spending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score_transfer_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-269"><a href="#FiscalPolicyScorer-269"><span class="linenos">269</span></a>            <span class="n">behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-270"><a href="#FiscalPolicyScorer-270"><span class="linenos">270</span></a>        
</span><span id="FiscalPolicyScorer-271"><a href="#FiscalPolicyScorer-271"><span class="linenos">271</span></a>        <span class="c1"># Static deficit effect (positive = increases deficit)</span>
</span><span id="FiscalPolicyScorer-272"><a href="#FiscalPolicyScorer-272"><span class="linenos">272</span></a>        <span class="n">static_deficit</span> <span class="o">=</span> <span class="n">static_spending</span> <span class="o">-</span> <span class="n">static_revenue</span>
</span><span id="FiscalPolicyScorer-273"><a href="#FiscalPolicyScorer-273"><span class="linenos">273</span></a>        
</span><span id="FiscalPolicyScorer-274"><a href="#FiscalPolicyScorer-274"><span class="linenos">274</span></a>        <span class="c1"># Apply behavioral offset</span>
</span><span id="FiscalPolicyScorer-275"><a href="#FiscalPolicyScorer-275"><span class="linenos">275</span></a>        <span class="n">deficit_after_behavioral</span> <span class="o">=</span> <span class="n">static_deficit</span> <span class="o">+</span> <span class="n">behavioral</span>
</span><span id="FiscalPolicyScorer-276"><a href="#FiscalPolicyScorer-276"><span class="linenos">276</span></a>        
</span><span id="FiscalPolicyScorer-277"><a href="#FiscalPolicyScorer-277"><span class="linenos">277</span></a>        <span class="c1"># Dynamic scoring if requested</span>
</span><span id="FiscalPolicyScorer-278"><a href="#FiscalPolicyScorer-278"><span class="linenos">278</span></a>        <span class="n">dynamic_effects</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FiscalPolicyScorer-279"><a href="#FiscalPolicyScorer-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="n">dynamic</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-280"><a href="#FiscalPolicyScorer-280"><span class="linenos">280</span></a>            <span class="n">dynamic_effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">economic_model</span><span class="o">.</span><span class="n">calculate_effects</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-281"><a href="#FiscalPolicyScorer-281"><span class="linenos">281</span></a>                <span class="n">policy</span><span class="p">,</span> <span class="n">deficit_after_behavioral</span>
</span><span id="FiscalPolicyScorer-282"><a href="#FiscalPolicyScorer-282"><span class="linenos">282</span></a>            <span class="p">)</span>
</span><span id="FiscalPolicyScorer-283"><a href="#FiscalPolicyScorer-283"><span class="linenos">283</span></a>            <span class="c1"># Revenue feedback reduces deficit impact</span>
</span><span id="FiscalPolicyScorer-284"><a href="#FiscalPolicyScorer-284"><span class="linenos">284</span></a>            <span class="n">final_deficit</span> <span class="o">=</span> <span class="n">deficit_after_behavioral</span> <span class="o">-</span> <span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span>
</span><span id="FiscalPolicyScorer-285"><a href="#FiscalPolicyScorer-285"><span class="linenos">285</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-286"><a href="#FiscalPolicyScorer-286"><span class="linenos">286</span></a>            <span class="n">final_deficit</span> <span class="o">=</span> <span class="n">deficit_after_behavioral</span>
</span><span id="FiscalPolicyScorer-287"><a href="#FiscalPolicyScorer-287"><span class="linenos">287</span></a>        
</span><span id="FiscalPolicyScorer-288"><a href="#FiscalPolicyScorer-288"><span class="linenos">288</span></a>        <span class="c1"># Uncertainty ranges</span>
</span><span id="FiscalPolicyScorer-289"><a href="#FiscalPolicyScorer-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="n">include_uncertainty</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-290"><a href="#FiscalPolicyScorer-290"><span class="linenos">290</span></a>            <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_uncertainty</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-291"><a href="#FiscalPolicyScorer-291"><span class="linenos">291</span></a>                <span class="n">policy</span><span class="p">,</span> <span class="n">final_deficit</span><span class="p">,</span> <span class="n">dynamic_effects</span>
</span><span id="FiscalPolicyScorer-292"><a href="#FiscalPolicyScorer-292"><span class="linenos">292</span></a>            <span class="p">)</span>
</span><span id="FiscalPolicyScorer-293"><a href="#FiscalPolicyScorer-293"><span class="linenos">293</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-294"><a href="#FiscalPolicyScorer-294"><span class="linenos">294</span></a>            <span class="n">low</span> <span class="o">=</span> <span class="n">final_deficit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="FiscalPolicyScorer-295"><a href="#FiscalPolicyScorer-295"><span class="linenos">295</span></a>            <span class="n">high</span> <span class="o">=</span> <span class="n">final_deficit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="FiscalPolicyScorer-296"><a href="#FiscalPolicyScorer-296"><span class="linenos">296</span></a>        
</span><span id="FiscalPolicyScorer-297"><a href="#FiscalPolicyScorer-297"><span class="linenos">297</span></a>        <span class="k">return</span> <span class="n">ScoringResult</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-298"><a href="#FiscalPolicyScorer-298"><span class="linenos">298</span></a>            <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-299"><a href="#FiscalPolicyScorer-299"><span class="linenos">299</span></a>            <span class="n">baseline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-300"><a href="#FiscalPolicyScorer-300"><span class="linenos">300</span></a>            <span class="n">years</span><span class="o">=</span><span class="n">years</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-301"><a href="#FiscalPolicyScorer-301"><span class="linenos">301</span></a>            <span class="n">static_revenue_effect</span><span class="o">=</span><span class="n">static_revenue</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-302"><a href="#FiscalPolicyScorer-302"><span class="linenos">302</span></a>            <span class="n">static_spending_effect</span><span class="o">=</span><span class="n">static_spending</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-303"><a href="#FiscalPolicyScorer-303"><span class="linenos">303</span></a>            <span class="n">static_deficit_effect</span><span class="o">=</span><span class="n">static_deficit</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-304"><a href="#FiscalPolicyScorer-304"><span class="linenos">304</span></a>            <span class="n">behavioral_offset</span><span class="o">=</span><span class="n">behavioral</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-305"><a href="#FiscalPolicyScorer-305"><span class="linenos">305</span></a>            <span class="n">dynamic_effects</span><span class="o">=</span><span class="n">dynamic_effects</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-306"><a href="#FiscalPolicyScorer-306"><span class="linenos">306</span></a>            <span class="n">final_deficit_effect</span><span class="o">=</span><span class="n">final_deficit</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-307"><a href="#FiscalPolicyScorer-307"><span class="linenos">307</span></a>            <span class="n">low_estimate</span><span class="o">=</span><span class="n">low</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-308"><a href="#FiscalPolicyScorer-308"><span class="linenos">308</span></a>            <span class="n">high_estimate</span><span class="o">=</span><span class="n">high</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-309"><a href="#FiscalPolicyScorer-309"><span class="linenos">309</span></a>        <span class="p">)</span>
</span><span id="FiscalPolicyScorer-310"><a href="#FiscalPolicyScorer-310"><span class="linenos">310</span></a>    
</span><span id="FiscalPolicyScorer-311"><a href="#FiscalPolicyScorer-311"><span class="linenos">311</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">score_package</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">:</span> <span class="n">PolicyPackage</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-312"><a href="#FiscalPolicyScorer-312"><span class="linenos">312</span></a>                     <span class="n">dynamic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScoringResult</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-313"><a href="#FiscalPolicyScorer-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-314"><a href="#FiscalPolicyScorer-314"><span class="linenos">314</span></a><span class="sd">        Score a package of policies together.</span>
</span><span id="FiscalPolicyScorer-315"><a href="#FiscalPolicyScorer-315"><span class="linenos">315</span></a><span class="sd">        </span>
</span><span id="FiscalPolicyScorer-316"><a href="#FiscalPolicyScorer-316"><span class="linenos">316</span></a><span class="sd">        Accounts for interactions between policies.</span>
</span><span id="FiscalPolicyScorer-317"><a href="#FiscalPolicyScorer-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-318"><a href="#FiscalPolicyScorer-318"><span class="linenos">318</span></a>        <span class="c1"># Score each policy</span>
</span><span id="FiscalPolicyScorer-319"><a href="#FiscalPolicyScorer-319"><span class="linenos">319</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">score_policy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dynamic</span><span class="o">=</span><span class="n">dynamic</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">package</span><span class="o">.</span><span class="n">policies</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-320"><a href="#FiscalPolicyScorer-320"><span class="linenos">320</span></a>        
</span><span id="FiscalPolicyScorer-321"><a href="#FiscalPolicyScorer-321"><span class="linenos">321</span></a>        <span class="c1"># Aggregate effects</span>
</span><span id="FiscalPolicyScorer-322"><a href="#FiscalPolicyScorer-322"><span class="linenos">322</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-323"><a href="#FiscalPolicyScorer-323"><span class="linenos">323</span></a>        
</span><span id="FiscalPolicyScorer-324"><a href="#FiscalPolicyScorer-324"><span class="linenos">324</span></a>        <span class="n">total_static_revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-325"><a href="#FiscalPolicyScorer-325"><span class="linenos">325</span></a>        <span class="n">total_static_spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-326"><a href="#FiscalPolicyScorer-326"><span class="linenos">326</span></a>        <span class="n">total_behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-327"><a href="#FiscalPolicyScorer-327"><span class="linenos">327</span></a>        
</span><span id="FiscalPolicyScorer-328"><a href="#FiscalPolicyScorer-328"><span class="linenos">328</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-329"><a href="#FiscalPolicyScorer-329"><span class="linenos">329</span></a>            <span class="n">total_static_revenue</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">static_revenue_effect</span>
</span><span id="FiscalPolicyScorer-330"><a href="#FiscalPolicyScorer-330"><span class="linenos">330</span></a>            <span class="n">total_static_spending</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">static_spending_effect</span>
</span><span id="FiscalPolicyScorer-331"><a href="#FiscalPolicyScorer-331"><span class="linenos">331</span></a>            <span class="n">total_behavioral</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">behavioral_offset</span>
</span><span id="FiscalPolicyScorer-332"><a href="#FiscalPolicyScorer-332"><span class="linenos">332</span></a>        
</span><span id="FiscalPolicyScorer-333"><a href="#FiscalPolicyScorer-333"><span class="linenos">333</span></a>        <span class="c1"># Apply interaction factor</span>
</span><span id="FiscalPolicyScorer-334"><a href="#FiscalPolicyScorer-334"><span class="linenos">334</span></a>        <span class="n">total_static_revenue</span> <span class="o">*=</span> <span class="n">package</span><span class="o">.</span><span class="n">interaction_factor</span>
</span><span id="FiscalPolicyScorer-335"><a href="#FiscalPolicyScorer-335"><span class="linenos">335</span></a>        <span class="n">total_static_spending</span> <span class="o">*=</span> <span class="n">package</span><span class="o">.</span><span class="n">interaction_factor</span>
</span><span id="FiscalPolicyScorer-336"><a href="#FiscalPolicyScorer-336"><span class="linenos">336</span></a>        
</span><span id="FiscalPolicyScorer-337"><a href="#FiscalPolicyScorer-337"><span class="linenos">337</span></a>        <span class="n">static_deficit</span> <span class="o">=</span> <span class="n">total_static_spending</span> <span class="o">-</span> <span class="n">total_static_revenue</span>
</span><span id="FiscalPolicyScorer-338"><a href="#FiscalPolicyScorer-338"><span class="linenos">338</span></a>        <span class="n">deficit_after_behavioral</span> <span class="o">=</span> <span class="n">static_deficit</span> <span class="o">+</span> <span class="n">total_behavioral</span>
</span><span id="FiscalPolicyScorer-339"><a href="#FiscalPolicyScorer-339"><span class="linenos">339</span></a>        
</span><span id="FiscalPolicyScorer-340"><a href="#FiscalPolicyScorer-340"><span class="linenos">340</span></a>        <span class="c1"># Aggregate dynamic effects</span>
</span><span id="FiscalPolicyScorer-341"><a href="#FiscalPolicyScorer-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="n">dynamic</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-342"><a href="#FiscalPolicyScorer-342"><span class="linenos">342</span></a>            <span class="c1"># Combine dynamic effects (simplified aggregation)</span>
</span><span id="FiscalPolicyScorer-343"><a href="#FiscalPolicyScorer-343"><span class="linenos">343</span></a>            <span class="n">combined_dynamic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_dynamic_effects</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-344"><a href="#FiscalPolicyScorer-344"><span class="linenos">344</span></a>            <span class="n">final_deficit</span> <span class="o">=</span> <span class="n">deficit_after_behavioral</span> <span class="o">-</span> <span class="n">combined_dynamic</span><span class="o">.</span><span class="n">revenue_feedback</span>
</span><span id="FiscalPolicyScorer-345"><a href="#FiscalPolicyScorer-345"><span class="linenos">345</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-346"><a href="#FiscalPolicyScorer-346"><span class="linenos">346</span></a>            <span class="n">combined_dynamic</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FiscalPolicyScorer-347"><a href="#FiscalPolicyScorer-347"><span class="linenos">347</span></a>            <span class="n">final_deficit</span> <span class="o">=</span> <span class="n">deficit_after_behavioral</span>
</span><span id="FiscalPolicyScorer-348"><a href="#FiscalPolicyScorer-348"><span class="linenos">348</span></a>        
</span><span id="FiscalPolicyScorer-349"><a href="#FiscalPolicyScorer-349"><span class="linenos">349</span></a>        <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_uncertainty</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-350"><a href="#FiscalPolicyScorer-350"><span class="linenos">350</span></a>            <span class="n">package</span><span class="o">.</span><span class="n">policies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">final_deficit</span><span class="p">,</span> <span class="n">combined_dynamic</span>
</span><span id="FiscalPolicyScorer-351"><a href="#FiscalPolicyScorer-351"><span class="linenos">351</span></a>        <span class="p">)</span>
</span><span id="FiscalPolicyScorer-352"><a href="#FiscalPolicyScorer-352"><span class="linenos">352</span></a>        
</span><span id="FiscalPolicyScorer-353"><a href="#FiscalPolicyScorer-353"><span class="linenos">353</span></a>        <span class="c1"># Create synthetic policy for package</span>
</span><span id="FiscalPolicyScorer-354"><a href="#FiscalPolicyScorer-354"><span class="linenos">354</span></a>        <span class="n">synthetic</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-355"><a href="#FiscalPolicyScorer-355"><span class="linenos">355</span></a>            <span class="n">name</span><span class="o">=</span><span class="n">package</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-356"><a href="#FiscalPolicyScorer-356"><span class="linenos">356</span></a>            <span class="n">description</span><span class="o">=</span><span class="n">package</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-357"><a href="#FiscalPolicyScorer-357"><span class="linenos">357</span></a>            <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">MANDATORY_SPENDING</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-358"><a href="#FiscalPolicyScorer-358"><span class="linenos">358</span></a>            <span class="n">start_year</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">start_year</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">package</span><span class="o">.</span><span class="n">policies</span><span class="p">),</span>
</span><span id="FiscalPolicyScorer-359"><a href="#FiscalPolicyScorer-359"><span class="linenos">359</span></a>        <span class="p">)</span>
</span><span id="FiscalPolicyScorer-360"><a href="#FiscalPolicyScorer-360"><span class="linenos">360</span></a>        
</span><span id="FiscalPolicyScorer-361"><a href="#FiscalPolicyScorer-361"><span class="linenos">361</span></a>        <span class="k">return</span> <span class="n">ScoringResult</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-362"><a href="#FiscalPolicyScorer-362"><span class="linenos">362</span></a>            <span class="n">policy</span><span class="o">=</span><span class="n">synthetic</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-363"><a href="#FiscalPolicyScorer-363"><span class="linenos">363</span></a>            <span class="n">baseline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-364"><a href="#FiscalPolicyScorer-364"><span class="linenos">364</span></a>            <span class="n">years</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-365"><a href="#FiscalPolicyScorer-365"><span class="linenos">365</span></a>            <span class="n">static_revenue_effect</span><span class="o">=</span><span class="n">total_static_revenue</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-366"><a href="#FiscalPolicyScorer-366"><span class="linenos">366</span></a>            <span class="n">static_spending_effect</span><span class="o">=</span><span class="n">total_static_spending</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-367"><a href="#FiscalPolicyScorer-367"><span class="linenos">367</span></a>            <span class="n">static_deficit_effect</span><span class="o">=</span><span class="n">static_deficit</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-368"><a href="#FiscalPolicyScorer-368"><span class="linenos">368</span></a>            <span class="n">behavioral_offset</span><span class="o">=</span><span class="n">total_behavioral</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-369"><a href="#FiscalPolicyScorer-369"><span class="linenos">369</span></a>            <span class="n">dynamic_effects</span><span class="o">=</span><span class="n">combined_dynamic</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-370"><a href="#FiscalPolicyScorer-370"><span class="linenos">370</span></a>            <span class="n">final_deficit_effect</span><span class="o">=</span><span class="n">final_deficit</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-371"><a href="#FiscalPolicyScorer-371"><span class="linenos">371</span></a>            <span class="n">low_estimate</span><span class="o">=</span><span class="n">low</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-372"><a href="#FiscalPolicyScorer-372"><span class="linenos">372</span></a>            <span class="n">high_estimate</span><span class="o">=</span><span class="n">high</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-373"><a href="#FiscalPolicyScorer-373"><span class="linenos">373</span></a>        <span class="p">)</span>
</span><span id="FiscalPolicyScorer-374"><a href="#FiscalPolicyScorer-374"><span class="linenos">374</span></a>    
</span><span id="FiscalPolicyScorer-375"><a href="#FiscalPolicyScorer-375"><span class="linenos">375</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_score_tax_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">TaxPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
</span><span id="FiscalPolicyScorer-376"><a href="#FiscalPolicyScorer-376"><span class="linenos">376</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate static revenue effect and behavioral offset for tax policy.&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-377"><a href="#FiscalPolicyScorer-377"><span class="linenos">377</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-378"><a href="#FiscalPolicyScorer-378"><span class="linenos">378</span></a>        <span class="n">revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-379"><a href="#FiscalPolicyScorer-379"><span class="linenos">379</span></a>        <span class="n">behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-380"><a href="#FiscalPolicyScorer-380"><span class="linenos">380</span></a>
</span><span id="FiscalPolicyScorer-381"><a href="#FiscalPolicyScorer-381"><span class="linenos">381</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-382"><a href="#FiscalPolicyScorer-382"><span class="linenos">382</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">policy</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-383"><a href="#FiscalPolicyScorer-383"><span class="linenos">383</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-384"><a href="#FiscalPolicyScorer-384"><span class="linenos">384</span></a>
</span><span id="FiscalPolicyScorer-385"><a href="#FiscalPolicyScorer-385"><span class="linenos">385</span></a>            <span class="n">phase</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_phase_in_factor</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-386"><a href="#FiscalPolicyScorer-386"><span class="linenos">386</span></a>
</span><span id="FiscalPolicyScorer-387"><a href="#FiscalPolicyScorer-387"><span class="linenos">387</span></a>            <span class="c1"># Special handling for TCJA extension (uses component-based costing)</span>
</span><span id="FiscalPolicyScorer-388"><a href="#FiscalPolicyScorer-388"><span class="linenos">388</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TCJAExtensionPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-389"><a href="#FiscalPolicyScorer-389"><span class="linenos">389</span></a>                <span class="c1"># TCJA uses year-indexed costs with growth rates per component</span>
</span><span id="FiscalPolicyScorer-390"><a href="#FiscalPolicyScorer-390"><span class="linenos">390</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-391"><a href="#FiscalPolicyScorer-391"><span class="linenos">391</span></a>                <span class="c1"># _get_annual_cost returns COST (positive = adds to deficit)</span>
</span><span id="FiscalPolicyScorer-392"><a href="#FiscalPolicyScorer-392"><span class="linenos">392</span></a>                <span class="c1"># Revenue effect should be NEGATIVE (tax cuts reduce revenue)</span>
</span><span id="FiscalPolicyScorer-393"><a href="#FiscalPolicyScorer-393"><span class="linenos">393</span></a>                <span class="n">annual_cost</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">_get_annual_cost</span><span class="p">(</span><span class="n">years_since_start</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-394"><a href="#FiscalPolicyScorer-394"><span class="linenos">394</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">annual_cost</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-395"><a href="#FiscalPolicyScorer-395"><span class="linenos">395</span></a>                <span class="c1"># TCJA behavioral offset is embedded in calibration; don&#39;t double-count</span>
</span><span id="FiscalPolicyScorer-396"><a href="#FiscalPolicyScorer-396"><span class="linenos">396</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="FiscalPolicyScorer-397"><a href="#FiscalPolicyScorer-397"><span class="linenos">397</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-398"><a href="#FiscalPolicyScorer-398"><span class="linenos">398</span></a>
</span><span id="FiscalPolicyScorer-399"><a href="#FiscalPolicyScorer-399"><span class="linenos">399</span></a>            <span class="c1"># Special handling for corporate tax (uses profit-based calculation with growth)</span>
</span><span id="FiscalPolicyScorer-400"><a href="#FiscalPolicyScorer-400"><span class="linenos">400</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">CorporateTaxPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-401"><a href="#FiscalPolicyScorer-401"><span class="linenos">401</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-402"><a href="#FiscalPolicyScorer-402"><span class="linenos">402</span></a>                <span class="c1"># Get baseline corporate revenue for this year</span>
</span><span id="FiscalPolicyScorer-403"><a href="#FiscalPolicyScorer-403"><span class="linenos">403</span></a>                <span class="n">base_rev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">corporate_income_tax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-404"><a href="#FiscalPolicyScorer-404"><span class="linenos">404</span></a>
</span><span id="FiscalPolicyScorer-405"><a href="#FiscalPolicyScorer-405"><span class="linenos">405</span></a>                <span class="c1"># Static effect from corporate policy (includes international, R&amp;D, etc.)</span>
</span><span id="FiscalPolicyScorer-406"><a href="#FiscalPolicyScorer-406"><span class="linenos">406</span></a>                <span class="n">static_annual</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-407"><a href="#FiscalPolicyScorer-407"><span class="linenos">407</span></a>                    <span class="n">base_rev</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-408"><a href="#FiscalPolicyScorer-408"><span class="linenos">408</span></a>                    <span class="n">use_real_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-409"><a href="#FiscalPolicyScorer-409"><span class="linenos">409</span></a>                <span class="p">)</span>
</span><span id="FiscalPolicyScorer-410"><a href="#FiscalPolicyScorer-410"><span class="linenos">410</span></a>                <span class="c1"># Apply growth rate for corporate profits over time (~4%/year)</span>
</span><span id="FiscalPolicyScorer-411"><a href="#FiscalPolicyScorer-411"><span class="linenos">411</span></a>                <span class="n">growth_factor</span> <span class="o">=</span> <span class="mf">1.04</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="FiscalPolicyScorer-412"><a href="#FiscalPolicyScorer-412"><span class="linenos">412</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">static_annual</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-413"><a href="#FiscalPolicyScorer-413"><span class="linenos">413</span></a>
</span><span id="FiscalPolicyScorer-414"><a href="#FiscalPolicyScorer-414"><span class="linenos">414</span></a>                <span class="c1"># Behavioral offset (corporate elasticity, pass-through shifting)</span>
</span><span id="FiscalPolicyScorer-415"><a href="#FiscalPolicyScorer-415"><span class="linenos">415</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="FiscalPolicyScorer-416"><a href="#FiscalPolicyScorer-416"><span class="linenos">416</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-417"><a href="#FiscalPolicyScorer-417"><span class="linenos">417</span></a>
</span><span id="FiscalPolicyScorer-418"><a href="#FiscalPolicyScorer-418"><span class="linenos">418</span></a>            <span class="c1"># Special handling for tax credits (cost grows with inflation/population)</span>
</span><span id="FiscalPolicyScorer-419"><a href="#FiscalPolicyScorer-419"><span class="linenos">419</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxCreditPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-420"><a href="#FiscalPolicyScorer-420"><span class="linenos">420</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-421"><a href="#FiscalPolicyScorer-421"><span class="linenos">421</span></a>                <span class="c1"># Static effect from credit change</span>
</span><span id="FiscalPolicyScorer-422"><a href="#FiscalPolicyScorer-422"><span class="linenos">422</span></a>                <span class="n">static_annual</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-423"><a href="#FiscalPolicyScorer-423"><span class="linenos">423</span></a>                    <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Credits don&#39;t use baseline revenue</span>
</span><span id="FiscalPolicyScorer-424"><a href="#FiscalPolicyScorer-424"><span class="linenos">424</span></a>                    <span class="n">use_real_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-425"><a href="#FiscalPolicyScorer-425"><span class="linenos">425</span></a>                <span class="p">)</span>
</span><span id="FiscalPolicyScorer-426"><a href="#FiscalPolicyScorer-426"><span class="linenos">426</span></a>                <span class="c1"># Credits grow with inflation + population (~3%/year)</span>
</span><span id="FiscalPolicyScorer-427"><a href="#FiscalPolicyScorer-427"><span class="linenos">427</span></a>                <span class="n">growth_factor</span> <span class="o">=</span> <span class="mf">1.03</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="FiscalPolicyScorer-428"><a href="#FiscalPolicyScorer-428"><span class="linenos">428</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">static_annual</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-429"><a href="#FiscalPolicyScorer-429"><span class="linenos">429</span></a>
</span><span id="FiscalPolicyScorer-430"><a href="#FiscalPolicyScorer-430"><span class="linenos">430</span></a>                <span class="c1"># Behavioral offset (labor supply effects, especially for EITC)</span>
</span><span id="FiscalPolicyScorer-431"><a href="#FiscalPolicyScorer-431"><span class="linenos">431</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="FiscalPolicyScorer-432"><a href="#FiscalPolicyScorer-432"><span class="linenos">432</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-433"><a href="#FiscalPolicyScorer-433"><span class="linenos">433</span></a>
</span><span id="FiscalPolicyScorer-434"><a href="#FiscalPolicyScorer-434"><span class="linenos">434</span></a>            <span class="c1"># Special handling for estate tax (wealth growth ~3%/year)</span>
</span><span id="FiscalPolicyScorer-435"><a href="#FiscalPolicyScorer-435"><span class="linenos">435</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">EstateTaxPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-436"><a href="#FiscalPolicyScorer-436"><span class="linenos">436</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-437"><a href="#FiscalPolicyScorer-437"><span class="linenos">437</span></a>                <span class="c1"># Static effect from exemption/rate changes</span>
</span><span id="FiscalPolicyScorer-438"><a href="#FiscalPolicyScorer-438"><span class="linenos">438</span></a>                <span class="n">static_annual</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-439"><a href="#FiscalPolicyScorer-439"><span class="linenos">439</span></a>                    <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Estate tax uses internal calculations</span>
</span><span id="FiscalPolicyScorer-440"><a href="#FiscalPolicyScorer-440"><span class="linenos">440</span></a>                    <span class="n">use_real_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-441"><a href="#FiscalPolicyScorer-441"><span class="linenos">441</span></a>                <span class="p">)</span>
</span><span id="FiscalPolicyScorer-442"><a href="#FiscalPolicyScorer-442"><span class="linenos">442</span></a>                <span class="c1"># Estate tax revenue grows with wealth (~3%/year)</span>
</span><span id="FiscalPolicyScorer-443"><a href="#FiscalPolicyScorer-443"><span class="linenos">443</span></a>                <span class="n">growth_factor</span> <span class="o">=</span> <span class="mf">1.03</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="FiscalPolicyScorer-444"><a href="#FiscalPolicyScorer-444"><span class="linenos">444</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">static_annual</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-445"><a href="#FiscalPolicyScorer-445"><span class="linenos">445</span></a>
</span><span id="FiscalPolicyScorer-446"><a href="#FiscalPolicyScorer-446"><span class="linenos">446</span></a>                <span class="c1"># Behavioral offset (estate planning, gifts)</span>
</span><span id="FiscalPolicyScorer-447"><a href="#FiscalPolicyScorer-447"><span class="linenos">447</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="FiscalPolicyScorer-448"><a href="#FiscalPolicyScorer-448"><span class="linenos">448</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-449"><a href="#FiscalPolicyScorer-449"><span class="linenos">449</span></a>
</span><span id="FiscalPolicyScorer-450"><a href="#FiscalPolicyScorer-450"><span class="linenos">450</span></a>            <span class="c1"># Special handling for payroll tax (wage growth ~4%/year)</span>
</span><span id="FiscalPolicyScorer-451"><a href="#FiscalPolicyScorer-451"><span class="linenos">451</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">PayrollTaxPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-452"><a href="#FiscalPolicyScorer-452"><span class="linenos">452</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-453"><a href="#FiscalPolicyScorer-453"><span class="linenos">453</span></a>                <span class="c1"># Static effect from cap/rate changes</span>
</span><span id="FiscalPolicyScorer-454"><a href="#FiscalPolicyScorer-454"><span class="linenos">454</span></a>                <span class="n">static_annual</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-455"><a href="#FiscalPolicyScorer-455"><span class="linenos">455</span></a>                    <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Payroll tax uses internal calculations</span>
</span><span id="FiscalPolicyScorer-456"><a href="#FiscalPolicyScorer-456"><span class="linenos">456</span></a>                    <span class="n">use_real_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-457"><a href="#FiscalPolicyScorer-457"><span class="linenos">457</span></a>                <span class="p">)</span>
</span><span id="FiscalPolicyScorer-458"><a href="#FiscalPolicyScorer-458"><span class="linenos">458</span></a>                <span class="c1"># Payroll tax revenue grows with wages (~4%/year)</span>
</span><span id="FiscalPolicyScorer-459"><a href="#FiscalPolicyScorer-459"><span class="linenos">459</span></a>                <span class="n">growth_factor</span> <span class="o">=</span> <span class="mf">1.04</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="FiscalPolicyScorer-460"><a href="#FiscalPolicyScorer-460"><span class="linenos">460</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">static_annual</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-461"><a href="#FiscalPolicyScorer-461"><span class="linenos">461</span></a>
</span><span id="FiscalPolicyScorer-462"><a href="#FiscalPolicyScorer-462"><span class="linenos">462</span></a>                <span class="c1"># Behavioral offset (labor supply, tax avoidance)</span>
</span><span id="FiscalPolicyScorer-463"><a href="#FiscalPolicyScorer-463"><span class="linenos">463</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="FiscalPolicyScorer-464"><a href="#FiscalPolicyScorer-464"><span class="linenos">464</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-465"><a href="#FiscalPolicyScorer-465"><span class="linenos">465</span></a>
</span><span id="FiscalPolicyScorer-466"><a href="#FiscalPolicyScorer-466"><span class="linenos">466</span></a>            <span class="c1"># Special handling for AMT (income growth ~3%/year)</span>
</span><span id="FiscalPolicyScorer-467"><a href="#FiscalPolicyScorer-467"><span class="linenos">467</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">AMTPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-468"><a href="#FiscalPolicyScorer-468"><span class="linenos">468</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-469"><a href="#FiscalPolicyScorer-469"><span class="linenos">469</span></a>                <span class="c1"># Static effect from exemption/rate changes</span>
</span><span id="FiscalPolicyScorer-470"><a href="#FiscalPolicyScorer-470"><span class="linenos">470</span></a>                <span class="n">static_annual</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-471"><a href="#FiscalPolicyScorer-471"><span class="linenos">471</span></a>                    <span class="mi">0</span><span class="p">,</span>  <span class="c1"># AMT uses internal calculations</span>
</span><span id="FiscalPolicyScorer-472"><a href="#FiscalPolicyScorer-472"><span class="linenos">472</span></a>                    <span class="n">use_real_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-473"><a href="#FiscalPolicyScorer-473"><span class="linenos">473</span></a>                <span class="p">)</span>
</span><span id="FiscalPolicyScorer-474"><a href="#FiscalPolicyScorer-474"><span class="linenos">474</span></a>                <span class="c1"># AMT revenue grows with income (~3%/year)</span>
</span><span id="FiscalPolicyScorer-475"><a href="#FiscalPolicyScorer-475"><span class="linenos">475</span></a>                <span class="n">growth_factor</span> <span class="o">=</span> <span class="mf">1.03</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="FiscalPolicyScorer-476"><a href="#FiscalPolicyScorer-476"><span class="linenos">476</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">static_annual</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-477"><a href="#FiscalPolicyScorer-477"><span class="linenos">477</span></a>
</span><span id="FiscalPolicyScorer-478"><a href="#FiscalPolicyScorer-478"><span class="linenos">478</span></a>                <span class="c1"># Behavioral offset (timing, avoidance)</span>
</span><span id="FiscalPolicyScorer-479"><a href="#FiscalPolicyScorer-479"><span class="linenos">479</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="FiscalPolicyScorer-480"><a href="#FiscalPolicyScorer-480"><span class="linenos">480</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-481"><a href="#FiscalPolicyScorer-481"><span class="linenos">481</span></a>
</span><span id="FiscalPolicyScorer-482"><a href="#FiscalPolicyScorer-482"><span class="linenos">482</span></a>            <span class="c1"># Special handling for Premium Tax Credits (healthcare growth ~4%/year)</span>
</span><span id="FiscalPolicyScorer-483"><a href="#FiscalPolicyScorer-483"><span class="linenos">483</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-484"><a href="#FiscalPolicyScorer-484"><span class="linenos">484</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-485"><a href="#FiscalPolicyScorer-485"><span class="linenos">485</span></a>                <span class="c1"># Static effect from subsidy changes</span>
</span><span id="FiscalPolicyScorer-486"><a href="#FiscalPolicyScorer-486"><span class="linenos">486</span></a>                <span class="n">static_annual</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-487"><a href="#FiscalPolicyScorer-487"><span class="linenos">487</span></a>                    <span class="mi">0</span><span class="p">,</span>  <span class="c1"># PTC uses internal calculations</span>
</span><span id="FiscalPolicyScorer-488"><a href="#FiscalPolicyScorer-488"><span class="linenos">488</span></a>                    <span class="n">use_real_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-489"><a href="#FiscalPolicyScorer-489"><span class="linenos">489</span></a>                <span class="p">)</span>
</span><span id="FiscalPolicyScorer-490"><a href="#FiscalPolicyScorer-490"><span class="linenos">490</span></a>                <span class="c1"># Healthcare costs grow ~4%/year</span>
</span><span id="FiscalPolicyScorer-491"><a href="#FiscalPolicyScorer-491"><span class="linenos">491</span></a>                <span class="n">growth_factor</span> <span class="o">=</span> <span class="mf">1.04</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="FiscalPolicyScorer-492"><a href="#FiscalPolicyScorer-492"><span class="linenos">492</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">static_annual</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-493"><a href="#FiscalPolicyScorer-493"><span class="linenos">493</span></a>
</span><span id="FiscalPolicyScorer-494"><a href="#FiscalPolicyScorer-494"><span class="linenos">494</span></a>                <span class="c1"># Behavioral offset (coverage, adverse selection)</span>
</span><span id="FiscalPolicyScorer-495"><a href="#FiscalPolicyScorer-495"><span class="linenos">495</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="FiscalPolicyScorer-496"><a href="#FiscalPolicyScorer-496"><span class="linenos">496</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-497"><a href="#FiscalPolicyScorer-497"><span class="linenos">497</span></a>
</span><span id="FiscalPolicyScorer-498"><a href="#FiscalPolicyScorer-498"><span class="linenos">498</span></a>            <span class="c1"># Special handling for Tax Expenditures (variable growth by type)</span>
</span><span id="FiscalPolicyScorer-499"><a href="#FiscalPolicyScorer-499"><span class="linenos">499</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxExpenditurePolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-500"><a href="#FiscalPolicyScorer-500"><span class="linenos">500</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-501"><a href="#FiscalPolicyScorer-501"><span class="linenos">501</span></a>                <span class="c1"># Static effect from expenditure changes</span>
</span><span id="FiscalPolicyScorer-502"><a href="#FiscalPolicyScorer-502"><span class="linenos">502</span></a>                <span class="n">static_annual</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-503"><a href="#FiscalPolicyScorer-503"><span class="linenos">503</span></a>                    <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Tax expenditure uses internal calculations</span>
</span><span id="FiscalPolicyScorer-504"><a href="#FiscalPolicyScorer-504"><span class="linenos">504</span></a>                    <span class="n">use_real_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-505"><a href="#FiscalPolicyScorer-505"><span class="linenos">505</span></a>                <span class="p">)</span>
</span><span id="FiscalPolicyScorer-506"><a href="#FiscalPolicyScorer-506"><span class="linenos">506</span></a>                <span class="c1"># Growth rate depends on expenditure type</span>
</span><span id="FiscalPolicyScorer-507"><a href="#FiscalPolicyScorer-507"><span class="linenos">507</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_expenditure_data</span><span class="p">()</span>
</span><span id="FiscalPolicyScorer-508"><a href="#FiscalPolicyScorer-508"><span class="linenos">508</span></a>                <span class="n">growth_rate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;growth_rate&quot;</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-509"><a href="#FiscalPolicyScorer-509"><span class="linenos">509</span></a>                <span class="n">growth_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">years_since_start</span>
</span><span id="FiscalPolicyScorer-510"><a href="#FiscalPolicyScorer-510"><span class="linenos">510</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">static_annual</span> <span class="o">*</span> <span class="n">growth_factor</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-511"><a href="#FiscalPolicyScorer-511"><span class="linenos">511</span></a>
</span><span id="FiscalPolicyScorer-512"><a href="#FiscalPolicyScorer-512"><span class="linenos">512</span></a>                <span class="c1"># Behavioral offset</span>
</span><span id="FiscalPolicyScorer-513"><a href="#FiscalPolicyScorer-513"><span class="linenos">513</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="FiscalPolicyScorer-514"><a href="#FiscalPolicyScorer-514"><span class="linenos">514</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-515"><a href="#FiscalPolicyScorer-515"><span class="linenos">515</span></a>
</span><span id="FiscalPolicyScorer-516"><a href="#FiscalPolicyScorer-516"><span class="linenos">516</span></a>            <span class="c1"># Get relevant baseline revenue</span>
</span><span id="FiscalPolicyScorer-517"><a href="#FiscalPolicyScorer-517"><span class="linenos">517</span></a>            <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-518"><a href="#FiscalPolicyScorer-518"><span class="linenos">518</span></a>                <span class="n">base_rev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">individual_income_tax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-519"><a href="#FiscalPolicyScorer-519"><span class="linenos">519</span></a>            <span class="k">elif</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-520"><a href="#FiscalPolicyScorer-520"><span class="linenos">520</span></a>                <span class="n">base_rev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">corporate_income_tax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-521"><a href="#FiscalPolicyScorer-521"><span class="linenos">521</span></a>            <span class="k">elif</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-522"><a href="#FiscalPolicyScorer-522"><span class="linenos">522</span></a>                <span class="n">base_rev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">payroll_taxes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-523"><a href="#FiscalPolicyScorer-523"><span class="linenos">523</span></a>            <span class="k">elif</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">CAPITAL_GAINS_TAX</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-524"><a href="#FiscalPolicyScorer-524"><span class="linenos">524</span></a>                <span class="c1"># Capital gains policy uses a realizations base; baseline revenue is not used.</span>
</span><span id="FiscalPolicyScorer-525"><a href="#FiscalPolicyScorer-525"><span class="linenos">525</span></a>                <span class="n">base_rev</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="FiscalPolicyScorer-526"><a href="#FiscalPolicyScorer-526"><span class="linenos">526</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-527"><a href="#FiscalPolicyScorer-527"><span class="linenos">527</span></a>                <span class="n">base_rev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">individual_income_tax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Default</span>
</span><span id="FiscalPolicyScorer-528"><a href="#FiscalPolicyScorer-528"><span class="linenos">528</span></a>
</span><span id="FiscalPolicyScorer-529"><a href="#FiscalPolicyScorer-529"><span class="linenos">529</span></a>            <span class="c1"># Static effect</span>
</span><span id="FiscalPolicyScorer-530"><a href="#FiscalPolicyScorer-530"><span class="linenos">530</span></a>            <span class="n">static_annual</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-531"><a href="#FiscalPolicyScorer-531"><span class="linenos">531</span></a>                <span class="n">base_rev</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-532"><a href="#FiscalPolicyScorer-532"><span class="linenos">532</span></a>                <span class="n">use_real_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-533"><a href="#FiscalPolicyScorer-533"><span class="linenos">533</span></a>            <span class="p">)</span>
</span><span id="FiscalPolicyScorer-534"><a href="#FiscalPolicyScorer-534"><span class="linenos">534</span></a>            <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">static_annual</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-535"><a href="#FiscalPolicyScorer-535"><span class="linenos">535</span></a>
</span><span id="FiscalPolicyScorer-536"><a href="#FiscalPolicyScorer-536"><span class="linenos">536</span></a>            <span class="c1"># For capital gains policies, add step-up elimination revenue if applicable</span>
</span><span id="FiscalPolicyScorer-537"><a href="#FiscalPolicyScorer-537"><span class="linenos">537</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">CapitalGainsPolicy</span><span class="p">)</span> <span class="ow">and</span> <span class="n">policy</span><span class="o">.</span><span class="n">eliminate_step_up</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-538"><a href="#FiscalPolicyScorer-538"><span class="linenos">538</span></a>                <span class="n">step_up_revenue</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_step_up_elimination_revenue</span><span class="p">()</span>
</span><span id="FiscalPolicyScorer-539"><a href="#FiscalPolicyScorer-539"><span class="linenos">539</span></a>                <span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">step_up_revenue</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-540"><a href="#FiscalPolicyScorer-540"><span class="linenos">540</span></a>
</span><span id="FiscalPolicyScorer-541"><a href="#FiscalPolicyScorer-541"><span class="linenos">541</span></a>            <span class="c1"># Behavioral offset (reduces revenue gain from tax increases,</span>
</span><span id="FiscalPolicyScorer-542"><a href="#FiscalPolicyScorer-542"><span class="linenos">542</span></a>            <span class="c1"># reduces revenue loss from tax cuts)</span>
</span><span id="FiscalPolicyScorer-543"><a href="#FiscalPolicyScorer-543"><span class="linenos">543</span></a>            <span class="c1"># For capital gains, pass years_since_start for time-varying elasticity</span>
</span><span id="FiscalPolicyScorer-544"><a href="#FiscalPolicyScorer-544"><span class="linenos">544</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">CapitalGainsPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-545"><a href="#FiscalPolicyScorer-545"><span class="linenos">545</span></a>                <span class="n">years_since_start</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="n">policy</span><span class="o">.</span><span class="n">start_year</span>
</span><span id="FiscalPolicyScorer-546"><a href="#FiscalPolicyScorer-546"><span class="linenos">546</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">years_since_start</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-547"><a href="#FiscalPolicyScorer-547"><span class="linenos">547</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-548"><a href="#FiscalPolicyScorer-548"><span class="linenos">548</span></a>                <span class="n">behavioral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">revenue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="FiscalPolicyScorer-549"><a href="#FiscalPolicyScorer-549"><span class="linenos">549</span></a>
</span><span id="FiscalPolicyScorer-550"><a href="#FiscalPolicyScorer-550"><span class="linenos">550</span></a>        <span class="k">return</span> <span class="n">revenue</span><span class="p">,</span> <span class="n">behavioral</span>
</span><span id="FiscalPolicyScorer-551"><a href="#FiscalPolicyScorer-551"><span class="linenos">551</span></a>    
</span><span id="FiscalPolicyScorer-552"><a href="#FiscalPolicyScorer-552"><span class="linenos">552</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_score_spending_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">SpendingPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-553"><a href="#FiscalPolicyScorer-553"><span class="linenos">553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate static spending effect for spending policy.&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-554"><a href="#FiscalPolicyScorer-554"><span class="linenos">554</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-555"><a href="#FiscalPolicyScorer-555"><span class="linenos">555</span></a>        <span class="n">spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-556"><a href="#FiscalPolicyScorer-556"><span class="linenos">556</span></a>        
</span><span id="FiscalPolicyScorer-557"><a href="#FiscalPolicyScorer-557"><span class="linenos">557</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-558"><a href="#FiscalPolicyScorer-558"><span class="linenos">558</span></a>            <span class="n">spending</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_spending_in_year</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-559"><a href="#FiscalPolicyScorer-559"><span class="linenos">559</span></a>        
</span><span id="FiscalPolicyScorer-560"><a href="#FiscalPolicyScorer-560"><span class="linenos">560</span></a>        <span class="k">return</span> <span class="n">spending</span>
</span><span id="FiscalPolicyScorer-561"><a href="#FiscalPolicyScorer-561"><span class="linenos">561</span></a>    
</span><span id="FiscalPolicyScorer-562"><a href="#FiscalPolicyScorer-562"><span class="linenos">562</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_score_transfer_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">TransferPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-563"><a href="#FiscalPolicyScorer-563"><span class="linenos">563</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate static cost effect for transfer policy.&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-564"><a href="#FiscalPolicyScorer-564"><span class="linenos">564</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-565"><a href="#FiscalPolicyScorer-565"><span class="linenos">565</span></a>        <span class="n">cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-566"><a href="#FiscalPolicyScorer-566"><span class="linenos">566</span></a>        
</span><span id="FiscalPolicyScorer-567"><a href="#FiscalPolicyScorer-567"><span class="linenos">567</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-568"><a href="#FiscalPolicyScorer-568"><span class="linenos">568</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">policy</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-569"><a href="#FiscalPolicyScorer-569"><span class="linenos">569</span></a>                <span class="k">continue</span>
</span><span id="FiscalPolicyScorer-570"><a href="#FiscalPolicyScorer-570"><span class="linenos">570</span></a>            
</span><span id="FiscalPolicyScorer-571"><a href="#FiscalPolicyScorer-571"><span class="linenos">571</span></a>            <span class="n">phase</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_phase_in_factor</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-572"><a href="#FiscalPolicyScorer-572"><span class="linenos">572</span></a>            
</span><span id="FiscalPolicyScorer-573"><a href="#FiscalPolicyScorer-573"><span class="linenos">573</span></a>            <span class="c1"># Get relevant baseline cost</span>
</span><span id="FiscalPolicyScorer-574"><a href="#FiscalPolicyScorer-574"><span class="linenos">574</span></a>            <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">SOCIAL_SECURITY</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-575"><a href="#FiscalPolicyScorer-575"><span class="linenos">575</span></a>                <span class="n">base_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">social_security</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-576"><a href="#FiscalPolicyScorer-576"><span class="linenos">576</span></a>            <span class="k">elif</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">MEDICARE</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-577"><a href="#FiscalPolicyScorer-577"><span class="linenos">577</span></a>                <span class="n">base_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">medicare</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-578"><a href="#FiscalPolicyScorer-578"><span class="linenos">578</span></a>            <span class="k">elif</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">MEDICAID</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-579"><a href="#FiscalPolicyScorer-579"><span class="linenos">579</span></a>                <span class="n">base_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">medicaid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-580"><a href="#FiscalPolicyScorer-580"><span class="linenos">580</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-581"><a href="#FiscalPolicyScorer-581"><span class="linenos">581</span></a>                <span class="n">base_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">other_mandatory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer-582"><a href="#FiscalPolicyScorer-582"><span class="linenos">582</span></a>            
</span><span id="FiscalPolicyScorer-583"><a href="#FiscalPolicyScorer-583"><span class="linenos">583</span></a>            <span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_cost_effect</span><span class="p">(</span><span class="n">base_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="FiscalPolicyScorer-584"><a href="#FiscalPolicyScorer-584"><span class="linenos">584</span></a>        
</span><span id="FiscalPolicyScorer-585"><a href="#FiscalPolicyScorer-585"><span class="linenos">585</span></a>        <span class="k">return</span> <span class="n">cost</span>
</span><span id="FiscalPolicyScorer-586"><a href="#FiscalPolicyScorer-586"><span class="linenos">586</span></a>    
</span><span id="FiscalPolicyScorer-587"><a href="#FiscalPolicyScorer-587"><span class="linenos">587</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_aggregate_dynamic_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="FiscalPolicyScorer-588"><a href="#FiscalPolicyScorer-588"><span class="linenos">588</span></a>                                   <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ScoringResult</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DynamicEffects</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-589"><a href="#FiscalPolicyScorer-589"><span class="linenos">589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Aggregate dynamic effects from multiple policies.&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-590"><a href="#FiscalPolicyScorer-590"><span class="linenos">590</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-591"><a href="#FiscalPolicyScorer-591"><span class="linenos">591</span></a>        
</span><span id="FiscalPolicyScorer-592"><a href="#FiscalPolicyScorer-592"><span class="linenos">592</span></a>        <span class="c1"># Sum up effects (simplified - ignores interactions)</span>
</span><span id="FiscalPolicyScorer-593"><a href="#FiscalPolicyScorer-593"><span class="linenos">593</span></a>        <span class="n">gdp_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-594"><a href="#FiscalPolicyScorer-594"><span class="linenos">594</span></a>        <span class="n">gdp_pct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-595"><a href="#FiscalPolicyScorer-595"><span class="linenos">595</span></a>        <span class="n">employment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-596"><a href="#FiscalPolicyScorer-596"><span class="linenos">596</span></a>        <span class="n">revenue_fb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-597"><a href="#FiscalPolicyScorer-597"><span class="linenos">597</span></a>        
</span><span id="FiscalPolicyScorer-598"><a href="#FiscalPolicyScorer-598"><span class="linenos">598</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-599"><a href="#FiscalPolicyScorer-599"><span class="linenos">599</span></a>            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-600"><a href="#FiscalPolicyScorer-600"><span class="linenos">600</span></a>                <span class="n">gdp_level</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_level_change</span>
</span><span id="FiscalPolicyScorer-601"><a href="#FiscalPolicyScorer-601"><span class="linenos">601</span></a>                <span class="n">gdp_pct</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span>
</span><span id="FiscalPolicyScorer-602"><a href="#FiscalPolicyScorer-602"><span class="linenos">602</span></a>                <span class="n">employment</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span>
</span><span id="FiscalPolicyScorer-603"><a href="#FiscalPolicyScorer-603"><span class="linenos">603</span></a>                <span class="n">revenue_fb</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span>
</span><span id="FiscalPolicyScorer-604"><a href="#FiscalPolicyScorer-604"><span class="linenos">604</span></a>        
</span><span id="FiscalPolicyScorer-605"><a href="#FiscalPolicyScorer-605"><span class="linenos">605</span></a>        <span class="k">return</span> <span class="n">DynamicEffects</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer-606"><a href="#FiscalPolicyScorer-606"><span class="linenos">606</span></a>            <span class="n">years</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="FiscalPolicyScorer-607"><a href="#FiscalPolicyScorer-607"><span class="linenos">607</span></a>            <span class="n">gdp_level_change</span><span class="o">=</span><span class="n">gdp_level</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-608"><a href="#FiscalPolicyScorer-608"><span class="linenos">608</span></a>            <span class="n">gdp_percent_change</span><span class="o">=</span><span class="n">gdp_pct</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-609"><a href="#FiscalPolicyScorer-609"><span class="linenos">609</span></a>            <span class="n">employment_change</span><span class="o">=</span><span class="n">employment</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-610"><a href="#FiscalPolicyScorer-610"><span class="linenos">610</span></a>            <span class="n">hours_worked_change</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="FiscalPolicyScorer-611"><a href="#FiscalPolicyScorer-611"><span class="linenos">611</span></a>            <span class="n">labor_force_change</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="FiscalPolicyScorer-612"><a href="#FiscalPolicyScorer-612"><span class="linenos">612</span></a>            <span class="n">capital_stock_change</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="FiscalPolicyScorer-613"><a href="#FiscalPolicyScorer-613"><span class="linenos">613</span></a>            <span class="n">investment_change</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="FiscalPolicyScorer-614"><a href="#FiscalPolicyScorer-614"><span class="linenos">614</span></a>            <span class="n">interest_rate_change</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="FiscalPolicyScorer-615"><a href="#FiscalPolicyScorer-615"><span class="linenos">615</span></a>            <span class="n">revenue_feedback</span><span class="o">=</span><span class="n">revenue_fb</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-616"><a href="#FiscalPolicyScorer-616"><span class="linenos">616</span></a>        <span class="p">)</span>
</span><span id="FiscalPolicyScorer-617"><a href="#FiscalPolicyScorer-617"><span class="linenos">617</span></a>    
</span><span id="FiscalPolicyScorer-618"><a href="#FiscalPolicyScorer-618"><span class="linenos">618</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="FiscalPolicyScorer-619"><a href="#FiscalPolicyScorer-619"><span class="linenos">619</span></a>                              <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-620"><a href="#FiscalPolicyScorer-620"><span class="linenos">620</span></a>                              <span class="n">central</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer-621"><a href="#FiscalPolicyScorer-621"><span class="linenos">621</span></a>                              <span class="n">dynamic</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DynamicEffects</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
</span><span id="FiscalPolicyScorer-622"><a href="#FiscalPolicyScorer-622"><span class="linenos">622</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-623"><a href="#FiscalPolicyScorer-623"><span class="linenos">623</span></a><span class="sd">        Calculate uncertainty ranges.</span>
</span><span id="FiscalPolicyScorer-624"><a href="#FiscalPolicyScorer-624"><span class="linenos">624</span></a><span class="sd">        </span>
</span><span id="FiscalPolicyScorer-625"><a href="#FiscalPolicyScorer-625"><span class="linenos">625</span></a><span class="sd">        Uses multiplicative factors that increase with forecast horizon,</span>
</span><span id="FiscalPolicyScorer-626"><a href="#FiscalPolicyScorer-626"><span class="linenos">626</span></a><span class="sd">        consistent with CBO uncertainty analysis.</span>
</span><span id="FiscalPolicyScorer-627"><a href="#FiscalPolicyScorer-627"><span class="linenos">627</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer-628"><a href="#FiscalPolicyScorer-628"><span class="linenos">628</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">central</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-629"><a href="#FiscalPolicyScorer-629"><span class="linenos">629</span></a>        
</span><span id="FiscalPolicyScorer-630"><a href="#FiscalPolicyScorer-630"><span class="linenos">630</span></a>        <span class="c1"># Base uncertainty (increases with time)</span>
</span><span id="FiscalPolicyScorer-631"><a href="#FiscalPolicyScorer-631"><span class="linenos">631</span></a>        <span class="n">base_uncertainty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.10</span> <span class="o">+</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">)])</span>
</span><span id="FiscalPolicyScorer-632"><a href="#FiscalPolicyScorer-632"><span class="linenos">632</span></a>        
</span><span id="FiscalPolicyScorer-633"><a href="#FiscalPolicyScorer-633"><span class="linenos">633</span></a>        <span class="c1"># Adjust for policy type (some are more uncertain)</span>
</span><span id="FiscalPolicyScorer-634"><a href="#FiscalPolicyScorer-634"><span class="linenos">634</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-635"><a href="#FiscalPolicyScorer-635"><span class="linenos">635</span></a>            <span class="c1"># Tax revenue is harder to predict</span>
</span><span id="FiscalPolicyScorer-636"><a href="#FiscalPolicyScorer-636"><span class="linenos">636</span></a>            <span class="n">policy_factor</span> <span class="o">=</span> <span class="mf">1.2</span>
</span><span id="FiscalPolicyScorer-637"><a href="#FiscalPolicyScorer-637"><span class="linenos">637</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">SpendingPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer-638"><a href="#FiscalPolicyScorer-638"><span class="linenos">638</span></a>            <span class="c1"># Direct spending is more predictable</span>
</span><span id="FiscalPolicyScorer-639"><a href="#FiscalPolicyScorer-639"><span class="linenos">639</span></a>            <span class="n">policy_factor</span> <span class="o">=</span> <span class="mf">0.8</span>
</span><span id="FiscalPolicyScorer-640"><a href="#FiscalPolicyScorer-640"><span class="linenos">640</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-641"><a href="#FiscalPolicyScorer-641"><span class="linenos">641</span></a>            <span class="n">policy_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="FiscalPolicyScorer-642"><a href="#FiscalPolicyScorer-642"><span class="linenos">642</span></a>        
</span><span id="FiscalPolicyScorer-643"><a href="#FiscalPolicyScorer-643"><span class="linenos">643</span></a>        <span class="c1"># Increase uncertainty for dynamic estimates</span>
</span><span id="FiscalPolicyScorer-644"><a href="#FiscalPolicyScorer-644"><span class="linenos">644</span></a>        <span class="k">if</span> <span class="n">dynamic</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-645"><a href="#FiscalPolicyScorer-645"><span class="linenos">645</span></a>            <span class="n">dynamic_factor</span> <span class="o">=</span> <span class="mf">1.5</span>
</span><span id="FiscalPolicyScorer-646"><a href="#FiscalPolicyScorer-646"><span class="linenos">646</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer-647"><a href="#FiscalPolicyScorer-647"><span class="linenos">647</span></a>            <span class="n">dynamic_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="FiscalPolicyScorer-648"><a href="#FiscalPolicyScorer-648"><span class="linenos">648</span></a>        
</span><span id="FiscalPolicyScorer-649"><a href="#FiscalPolicyScorer-649"><span class="linenos">649</span></a>        <span class="n">total_uncertainty</span> <span class="o">=</span> <span class="n">base_uncertainty</span> <span class="o">*</span> <span class="n">policy_factor</span> <span class="o">*</span> <span class="n">dynamic_factor</span>
</span><span id="FiscalPolicyScorer-650"><a href="#FiscalPolicyScorer-650"><span class="linenos">650</span></a>        
</span><span id="FiscalPolicyScorer-651"><a href="#FiscalPolicyScorer-651"><span class="linenos">651</span></a>        <span class="c1"># Calculate ranges (asymmetric - costs tend to be higher than estimated)</span>
</span><span id="FiscalPolicyScorer-652"><a href="#FiscalPolicyScorer-652"><span class="linenos">652</span></a>        <span class="n">low</span> <span class="o">=</span> <span class="n">central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">total_uncertainty</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-653"><a href="#FiscalPolicyScorer-653"><span class="linenos">653</span></a>        <span class="n">high</span> <span class="o">=</span> <span class="n">central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">total_uncertainty</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer-654"><a href="#FiscalPolicyScorer-654"><span class="linenos">654</span></a>        
</span><span id="FiscalPolicyScorer-655"><a href="#FiscalPolicyScorer-655"><span class="linenos">655</span></a>        <span class="k">return</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span>
</span></pre></div>


            <div class="docstring"><p>Main scoring engine for fiscal policy analysis.</p>

<p>Implements CBO-style scoring methodology with both static
and dynamic options.</p>
</div>


                            <div id="FiscalPolicyScorer.__init__" class="classattr">
                                        <input id="FiscalPolicyScorer.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FiscalPolicyScorer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">baseline</span><span class="p">:</span> <span class="n"><a href="#BaselineProjection">BaselineProjection</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="FiscalPolicyScorer.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FiscalPolicyScorer.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FiscalPolicyScorer.__init__-211"><a href="#FiscalPolicyScorer.__init__-211"><span class="linenos">211</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaselineProjection</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.__init__-212"><a href="#FiscalPolicyScorer.__init__-212"><span class="linenos">212</span></a>                 <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.__init__-213"><a href="#FiscalPolicyScorer.__init__-213"><span class="linenos">213</span></a>                 <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer.__init__-214"><a href="#FiscalPolicyScorer.__init__-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer.__init__-215"><a href="#FiscalPolicyScorer.__init__-215"><span class="linenos">215</span></a><span class="sd">        Initialize the scorer.</span>
</span><span id="FiscalPolicyScorer.__init__-216"><a href="#FiscalPolicyScorer.__init__-216"><span class="linenos">216</span></a>
</span><span id="FiscalPolicyScorer.__init__-217"><a href="#FiscalPolicyScorer.__init__-217"><span class="linenos">217</span></a><span class="sd">        Args:</span>
</span><span id="FiscalPolicyScorer.__init__-218"><a href="#FiscalPolicyScorer.__init__-218"><span class="linenos">218</span></a><span class="sd">            baseline: Pre-computed baseline projection (optional)</span>
</span><span id="FiscalPolicyScorer.__init__-219"><a href="#FiscalPolicyScorer.__init__-219"><span class="linenos">219</span></a><span class="sd">            start_year: Start year for analysis</span>
</span><span id="FiscalPolicyScorer.__init__-220"><a href="#FiscalPolicyScorer.__init__-220"><span class="linenos">220</span></a><span class="sd">            use_real_data: If True, load baseline from IRS/FRED data.</span>
</span><span id="FiscalPolicyScorer.__init__-221"><a href="#FiscalPolicyScorer.__init__-221"><span class="linenos">221</span></a><span class="sd">                          If False, use hardcoded fallback values.</span>
</span><span id="FiscalPolicyScorer.__init__-222"><a href="#FiscalPolicyScorer.__init__-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer.__init__-223"><a href="#FiscalPolicyScorer.__init__-223"><span class="linenos">223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">=</span> <span class="n">start_year</span>
</span><span id="FiscalPolicyScorer.__init__-224"><a href="#FiscalPolicyScorer.__init__-224"><span class="linenos">224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_real_data</span> <span class="o">=</span> <span class="n">use_real_data</span>
</span><span id="FiscalPolicyScorer.__init__-225"><a href="#FiscalPolicyScorer.__init__-225"><span class="linenos">225</span></a>
</span><span id="FiscalPolicyScorer.__init__-226"><a href="#FiscalPolicyScorer.__init__-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.__init__-227"><a href="#FiscalPolicyScorer.__init__-227"><span class="linenos">227</span></a>            <span class="n">generator</span> <span class="o">=</span> <span class="n">CBOBaseline</span><span class="p">(</span><span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span> <span class="n">use_real_data</span><span class="o">=</span><span class="n">use_real_data</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.__init__-228"><a href="#FiscalPolicyScorer.__init__-228"><span class="linenos">228</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</span><span id="FiscalPolicyScorer.__init__-229"><a href="#FiscalPolicyScorer.__init__-229"><span class="linenos">229</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.__init__-230"><a href="#FiscalPolicyScorer.__init__-230"><span class="linenos">230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="n">baseline</span>
</span><span id="FiscalPolicyScorer.__init__-231"><a href="#FiscalPolicyScorer.__init__-231"><span class="linenos">231</span></a>
</span><span id="FiscalPolicyScorer.__init__-232"><a href="#FiscalPolicyScorer.__init__-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">economic_model</span> <span class="o">=</span> <span class="n">EconomicModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the scorer.</p>

<p>Args:
    baseline: Pre-computed baseline projection (optional)
    start_year: Start year for analysis
    use_real_data: If True, load baseline from IRS/FRED data.
                  If False, use hardcoded fallback values.</p>
</div>


                            </div>
                            <div id="FiscalPolicyScorer.start_year" class="classattr">
                                <div class="attr variable">
            <span class="name">start_year</span>

        
    </div>
    <a class="headerlink" href="#FiscalPolicyScorer.start_year"></a>
    
    

                            </div>
                            <div id="FiscalPolicyScorer.use_real_data" class="classattr">
                                <div class="attr variable">
            <span class="name">use_real_data</span>

        
    </div>
    <a class="headerlink" href="#FiscalPolicyScorer.use_real_data"></a>
    
    

                            </div>
                            <div id="FiscalPolicyScorer.economic_model" class="classattr">
                                <div class="attr variable">
            <span class="name">economic_model</span>

        
    </div>
    <a class="headerlink" href="#FiscalPolicyScorer.economic_model"></a>
    
    

                            </div>
                            <div id="FiscalPolicyScorer.score_policy" class="classattr">
                                        <input id="FiscalPolicyScorer.score_policy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score_policy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">dynamic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">include_uncertainty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#ScoringResult">ScoringResult</a></span>:</span></span>

                <label class="view-source-button" for="FiscalPolicyScorer.score_policy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FiscalPolicyScorer.score_policy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FiscalPolicyScorer.score_policy-234"><a href="#FiscalPolicyScorer.score_policy-234"><span class="linenos">234</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">score_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span> 
</span><span id="FiscalPolicyScorer.score_policy-235"><a href="#FiscalPolicyScorer.score_policy-235"><span class="linenos">235</span></a>                    <span class="n">dynamic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-236"><a href="#FiscalPolicyScorer.score_policy-236"><span class="linenos">236</span></a>                    <span class="n">include_uncertainty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScoringResult</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_policy-237"><a href="#FiscalPolicyScorer.score_policy-237"><span class="linenos">237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer.score_policy-238"><a href="#FiscalPolicyScorer.score_policy-238"><span class="linenos">238</span></a><span class="sd">        Score a fiscal policy proposal.</span>
</span><span id="FiscalPolicyScorer.score_policy-239"><a href="#FiscalPolicyScorer.score_policy-239"><span class="linenos">239</span></a><span class="sd">        </span>
</span><span id="FiscalPolicyScorer.score_policy-240"><a href="#FiscalPolicyScorer.score_policy-240"><span class="linenos">240</span></a><span class="sd">        Args:</span>
</span><span id="FiscalPolicyScorer.score_policy-241"><a href="#FiscalPolicyScorer.score_policy-241"><span class="linenos">241</span></a><span class="sd">            policy: Policy to score</span>
</span><span id="FiscalPolicyScorer.score_policy-242"><a href="#FiscalPolicyScorer.score_policy-242"><span class="linenos">242</span></a><span class="sd">            dynamic: Whether to include dynamic/macroeconomic effects</span>
</span><span id="FiscalPolicyScorer.score_policy-243"><a href="#FiscalPolicyScorer.score_policy-243"><span class="linenos">243</span></a><span class="sd">            include_uncertainty: Whether to calculate uncertainty ranges</span>
</span><span id="FiscalPolicyScorer.score_policy-244"><a href="#FiscalPolicyScorer.score_policy-244"><span class="linenos">244</span></a><span class="sd">            </span>
</span><span id="FiscalPolicyScorer.score_policy-245"><a href="#FiscalPolicyScorer.score_policy-245"><span class="linenos">245</span></a><span class="sd">        Returns:</span>
</span><span id="FiscalPolicyScorer.score_policy-246"><a href="#FiscalPolicyScorer.score_policy-246"><span class="linenos">246</span></a><span class="sd">            ScoringResult with complete analysis</span>
</span><span id="FiscalPolicyScorer.score_policy-247"><a href="#FiscalPolicyScorer.score_policy-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer.score_policy-248"><a href="#FiscalPolicyScorer.score_policy-248"><span class="linenos">248</span></a>        <span class="n">years</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span>
</span><span id="FiscalPolicyScorer.score_policy-249"><a href="#FiscalPolicyScorer.score_policy-249"><span class="linenos">249</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-250"><a href="#FiscalPolicyScorer.score_policy-250"><span class="linenos">250</span></a>        
</span><span id="FiscalPolicyScorer.score_policy-251"><a href="#FiscalPolicyScorer.score_policy-251"><span class="linenos">251</span></a>        <span class="c1"># Initialize effect arrays</span>
</span><span id="FiscalPolicyScorer.score_policy-252"><a href="#FiscalPolicyScorer.score_policy-252"><span class="linenos">252</span></a>        <span class="n">static_revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-253"><a href="#FiscalPolicyScorer.score_policy-253"><span class="linenos">253</span></a>        <span class="n">static_spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-254"><a href="#FiscalPolicyScorer.score_policy-254"><span class="linenos">254</span></a>        <span class="n">behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-255"><a href="#FiscalPolicyScorer.score_policy-255"><span class="linenos">255</span></a>        
</span><span id="FiscalPolicyScorer.score_policy-256"><a href="#FiscalPolicyScorer.score_policy-256"><span class="linenos">256</span></a>        <span class="c1"># Calculate static effects based on policy type</span>
</span><span id="FiscalPolicyScorer.score_policy-257"><a href="#FiscalPolicyScorer.score_policy-257"><span class="linenos">257</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer.score_policy-258"><a href="#FiscalPolicyScorer.score_policy-258"><span class="linenos">258</span></a>            <span class="n">static_revenue</span><span class="p">,</span> <span class="n">behavioral</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score_tax_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-259"><a href="#FiscalPolicyScorer.score_policy-259"><span class="linenos">259</span></a>            <span class="n">static_spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-260"><a href="#FiscalPolicyScorer.score_policy-260"><span class="linenos">260</span></a>            
</span><span id="FiscalPolicyScorer.score_policy-261"><a href="#FiscalPolicyScorer.score_policy-261"><span class="linenos">261</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">SpendingPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer.score_policy-262"><a href="#FiscalPolicyScorer.score_policy-262"><span class="linenos">262</span></a>            <span class="n">static_revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-263"><a href="#FiscalPolicyScorer.score_policy-263"><span class="linenos">263</span></a>            <span class="n">static_spending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score_spending_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-264"><a href="#FiscalPolicyScorer.score_policy-264"><span class="linenos">264</span></a>            <span class="n">behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-265"><a href="#FiscalPolicyScorer.score_policy-265"><span class="linenos">265</span></a>            
</span><span id="FiscalPolicyScorer.score_policy-266"><a href="#FiscalPolicyScorer.score_policy-266"><span class="linenos">266</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TransferPolicy</span><span class="p">):</span>
</span><span id="FiscalPolicyScorer.score_policy-267"><a href="#FiscalPolicyScorer.score_policy-267"><span class="linenos">267</span></a>            <span class="n">static_revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-268"><a href="#FiscalPolicyScorer.score_policy-268"><span class="linenos">268</span></a>            <span class="n">static_spending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_score_transfer_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-269"><a href="#FiscalPolicyScorer.score_policy-269"><span class="linenos">269</span></a>            <span class="n">behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-270"><a href="#FiscalPolicyScorer.score_policy-270"><span class="linenos">270</span></a>        
</span><span id="FiscalPolicyScorer.score_policy-271"><a href="#FiscalPolicyScorer.score_policy-271"><span class="linenos">271</span></a>        <span class="c1"># Static deficit effect (positive = increases deficit)</span>
</span><span id="FiscalPolicyScorer.score_policy-272"><a href="#FiscalPolicyScorer.score_policy-272"><span class="linenos">272</span></a>        <span class="n">static_deficit</span> <span class="o">=</span> <span class="n">static_spending</span> <span class="o">-</span> <span class="n">static_revenue</span>
</span><span id="FiscalPolicyScorer.score_policy-273"><a href="#FiscalPolicyScorer.score_policy-273"><span class="linenos">273</span></a>        
</span><span id="FiscalPolicyScorer.score_policy-274"><a href="#FiscalPolicyScorer.score_policy-274"><span class="linenos">274</span></a>        <span class="c1"># Apply behavioral offset</span>
</span><span id="FiscalPolicyScorer.score_policy-275"><a href="#FiscalPolicyScorer.score_policy-275"><span class="linenos">275</span></a>        <span class="n">deficit_after_behavioral</span> <span class="o">=</span> <span class="n">static_deficit</span> <span class="o">+</span> <span class="n">behavioral</span>
</span><span id="FiscalPolicyScorer.score_policy-276"><a href="#FiscalPolicyScorer.score_policy-276"><span class="linenos">276</span></a>        
</span><span id="FiscalPolicyScorer.score_policy-277"><a href="#FiscalPolicyScorer.score_policy-277"><span class="linenos">277</span></a>        <span class="c1"># Dynamic scoring if requested</span>
</span><span id="FiscalPolicyScorer.score_policy-278"><a href="#FiscalPolicyScorer.score_policy-278"><span class="linenos">278</span></a>        <span class="n">dynamic_effects</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FiscalPolicyScorer.score_policy-279"><a href="#FiscalPolicyScorer.score_policy-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="n">dynamic</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_policy-280"><a href="#FiscalPolicyScorer.score_policy-280"><span class="linenos">280</span></a>            <span class="n">dynamic_effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">economic_model</span><span class="o">.</span><span class="n">calculate_effects</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer.score_policy-281"><a href="#FiscalPolicyScorer.score_policy-281"><span class="linenos">281</span></a>                <span class="n">policy</span><span class="p">,</span> <span class="n">deficit_after_behavioral</span>
</span><span id="FiscalPolicyScorer.score_policy-282"><a href="#FiscalPolicyScorer.score_policy-282"><span class="linenos">282</span></a>            <span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-283"><a href="#FiscalPolicyScorer.score_policy-283"><span class="linenos">283</span></a>            <span class="c1"># Revenue feedback reduces deficit impact</span>
</span><span id="FiscalPolicyScorer.score_policy-284"><a href="#FiscalPolicyScorer.score_policy-284"><span class="linenos">284</span></a>            <span class="n">final_deficit</span> <span class="o">=</span> <span class="n">deficit_after_behavioral</span> <span class="o">-</span> <span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span>
</span><span id="FiscalPolicyScorer.score_policy-285"><a href="#FiscalPolicyScorer.score_policy-285"><span class="linenos">285</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_policy-286"><a href="#FiscalPolicyScorer.score_policy-286"><span class="linenos">286</span></a>            <span class="n">final_deficit</span> <span class="o">=</span> <span class="n">deficit_after_behavioral</span>
</span><span id="FiscalPolicyScorer.score_policy-287"><a href="#FiscalPolicyScorer.score_policy-287"><span class="linenos">287</span></a>        
</span><span id="FiscalPolicyScorer.score_policy-288"><a href="#FiscalPolicyScorer.score_policy-288"><span class="linenos">288</span></a>        <span class="c1"># Uncertainty ranges</span>
</span><span id="FiscalPolicyScorer.score_policy-289"><a href="#FiscalPolicyScorer.score_policy-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="n">include_uncertainty</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_policy-290"><a href="#FiscalPolicyScorer.score_policy-290"><span class="linenos">290</span></a>            <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_uncertainty</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer.score_policy-291"><a href="#FiscalPolicyScorer.score_policy-291"><span class="linenos">291</span></a>                <span class="n">policy</span><span class="p">,</span> <span class="n">final_deficit</span><span class="p">,</span> <span class="n">dynamic_effects</span>
</span><span id="FiscalPolicyScorer.score_policy-292"><a href="#FiscalPolicyScorer.score_policy-292"><span class="linenos">292</span></a>            <span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_policy-293"><a href="#FiscalPolicyScorer.score_policy-293"><span class="linenos">293</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_policy-294"><a href="#FiscalPolicyScorer.score_policy-294"><span class="linenos">294</span></a>            <span class="n">low</span> <span class="o">=</span> <span class="n">final_deficit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="FiscalPolicyScorer.score_policy-295"><a href="#FiscalPolicyScorer.score_policy-295"><span class="linenos">295</span></a>            <span class="n">high</span> <span class="o">=</span> <span class="n">final_deficit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="FiscalPolicyScorer.score_policy-296"><a href="#FiscalPolicyScorer.score_policy-296"><span class="linenos">296</span></a>        
</span><span id="FiscalPolicyScorer.score_policy-297"><a href="#FiscalPolicyScorer.score_policy-297"><span class="linenos">297</span></a>        <span class="k">return</span> <span class="n">ScoringResult</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer.score_policy-298"><a href="#FiscalPolicyScorer.score_policy-298"><span class="linenos">298</span></a>            <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-299"><a href="#FiscalPolicyScorer.score_policy-299"><span class="linenos">299</span></a>            <span class="n">baseline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-300"><a href="#FiscalPolicyScorer.score_policy-300"><span class="linenos">300</span></a>            <span class="n">years</span><span class="o">=</span><span class="n">years</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-301"><a href="#FiscalPolicyScorer.score_policy-301"><span class="linenos">301</span></a>            <span class="n">static_revenue_effect</span><span class="o">=</span><span class="n">static_revenue</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-302"><a href="#FiscalPolicyScorer.score_policy-302"><span class="linenos">302</span></a>            <span class="n">static_spending_effect</span><span class="o">=</span><span class="n">static_spending</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-303"><a href="#FiscalPolicyScorer.score_policy-303"><span class="linenos">303</span></a>            <span class="n">static_deficit_effect</span><span class="o">=</span><span class="n">static_deficit</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-304"><a href="#FiscalPolicyScorer.score_policy-304"><span class="linenos">304</span></a>            <span class="n">behavioral_offset</span><span class="o">=</span><span class="n">behavioral</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-305"><a href="#FiscalPolicyScorer.score_policy-305"><span class="linenos">305</span></a>            <span class="n">dynamic_effects</span><span class="o">=</span><span class="n">dynamic_effects</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-306"><a href="#FiscalPolicyScorer.score_policy-306"><span class="linenos">306</span></a>            <span class="n">final_deficit_effect</span><span class="o">=</span><span class="n">final_deficit</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-307"><a href="#FiscalPolicyScorer.score_policy-307"><span class="linenos">307</span></a>            <span class="n">low_estimate</span><span class="o">=</span><span class="n">low</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-308"><a href="#FiscalPolicyScorer.score_policy-308"><span class="linenos">308</span></a>            <span class="n">high_estimate</span><span class="o">=</span><span class="n">high</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_policy-309"><a href="#FiscalPolicyScorer.score_policy-309"><span class="linenos">309</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Score a fiscal policy proposal.</p>

<p>Args:
    policy: Policy to score
    dynamic: Whether to include dynamic/macroeconomic effects
    include_uncertainty: Whether to calculate uncertainty ranges</p>

<p>Returns:
    ScoringResult with complete analysis</p>
</div>


                            </div>
                            <div id="FiscalPolicyScorer.score_package" class="classattr">
                                        <input id="FiscalPolicyScorer.score_package-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score_package</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">package</span><span class="p">:</span> <span class="n"><a href="#PolicyPackage">PolicyPackage</a></span>,</span><span class="param">	<span class="n">dynamic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#ScoringResult">ScoringResult</a></span>:</span></span>

                <label class="view-source-button" for="FiscalPolicyScorer.score_package-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FiscalPolicyScorer.score_package"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FiscalPolicyScorer.score_package-311"><a href="#FiscalPolicyScorer.score_package-311"><span class="linenos">311</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">score_package</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">:</span> <span class="n">PolicyPackage</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-312"><a href="#FiscalPolicyScorer.score_package-312"><span class="linenos">312</span></a>                     <span class="n">dynamic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScoringResult</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_package-313"><a href="#FiscalPolicyScorer.score_package-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer.score_package-314"><a href="#FiscalPolicyScorer.score_package-314"><span class="linenos">314</span></a><span class="sd">        Score a package of policies together.</span>
</span><span id="FiscalPolicyScorer.score_package-315"><a href="#FiscalPolicyScorer.score_package-315"><span class="linenos">315</span></a><span class="sd">        </span>
</span><span id="FiscalPolicyScorer.score_package-316"><a href="#FiscalPolicyScorer.score_package-316"><span class="linenos">316</span></a><span class="sd">        Accounts for interactions between policies.</span>
</span><span id="FiscalPolicyScorer.score_package-317"><a href="#FiscalPolicyScorer.score_package-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FiscalPolicyScorer.score_package-318"><a href="#FiscalPolicyScorer.score_package-318"><span class="linenos">318</span></a>        <span class="c1"># Score each policy</span>
</span><span id="FiscalPolicyScorer.score_package-319"><a href="#FiscalPolicyScorer.score_package-319"><span class="linenos">319</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">score_policy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dynamic</span><span class="o">=</span><span class="n">dynamic</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">package</span><span class="o">.</span><span class="n">policies</span><span class="p">]</span>
</span><span id="FiscalPolicyScorer.score_package-320"><a href="#FiscalPolicyScorer.score_package-320"><span class="linenos">320</span></a>        
</span><span id="FiscalPolicyScorer.score_package-321"><a href="#FiscalPolicyScorer.score_package-321"><span class="linenos">321</span></a>        <span class="c1"># Aggregate effects</span>
</span><span id="FiscalPolicyScorer.score_package-322"><a href="#FiscalPolicyScorer.score_package-322"><span class="linenos">322</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_package-323"><a href="#FiscalPolicyScorer.score_package-323"><span class="linenos">323</span></a>        
</span><span id="FiscalPolicyScorer.score_package-324"><a href="#FiscalPolicyScorer.score_package-324"><span class="linenos">324</span></a>        <span class="n">total_static_revenue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_package-325"><a href="#FiscalPolicyScorer.score_package-325"><span class="linenos">325</span></a>        <span class="n">total_static_spending</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_package-326"><a href="#FiscalPolicyScorer.score_package-326"><span class="linenos">326</span></a>        <span class="n">total_behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_package-327"><a href="#FiscalPolicyScorer.score_package-327"><span class="linenos">327</span></a>        
</span><span id="FiscalPolicyScorer.score_package-328"><a href="#FiscalPolicyScorer.score_package-328"><span class="linenos">328</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_package-329"><a href="#FiscalPolicyScorer.score_package-329"><span class="linenos">329</span></a>            <span class="n">total_static_revenue</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">static_revenue_effect</span>
</span><span id="FiscalPolicyScorer.score_package-330"><a href="#FiscalPolicyScorer.score_package-330"><span class="linenos">330</span></a>            <span class="n">total_static_spending</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">static_spending_effect</span>
</span><span id="FiscalPolicyScorer.score_package-331"><a href="#FiscalPolicyScorer.score_package-331"><span class="linenos">331</span></a>            <span class="n">total_behavioral</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">behavioral_offset</span>
</span><span id="FiscalPolicyScorer.score_package-332"><a href="#FiscalPolicyScorer.score_package-332"><span class="linenos">332</span></a>        
</span><span id="FiscalPolicyScorer.score_package-333"><a href="#FiscalPolicyScorer.score_package-333"><span class="linenos">333</span></a>        <span class="c1"># Apply interaction factor</span>
</span><span id="FiscalPolicyScorer.score_package-334"><a href="#FiscalPolicyScorer.score_package-334"><span class="linenos">334</span></a>        <span class="n">total_static_revenue</span> <span class="o">*=</span> <span class="n">package</span><span class="o">.</span><span class="n">interaction_factor</span>
</span><span id="FiscalPolicyScorer.score_package-335"><a href="#FiscalPolicyScorer.score_package-335"><span class="linenos">335</span></a>        <span class="n">total_static_spending</span> <span class="o">*=</span> <span class="n">package</span><span class="o">.</span><span class="n">interaction_factor</span>
</span><span id="FiscalPolicyScorer.score_package-336"><a href="#FiscalPolicyScorer.score_package-336"><span class="linenos">336</span></a>        
</span><span id="FiscalPolicyScorer.score_package-337"><a href="#FiscalPolicyScorer.score_package-337"><span class="linenos">337</span></a>        <span class="n">static_deficit</span> <span class="o">=</span> <span class="n">total_static_spending</span> <span class="o">-</span> <span class="n">total_static_revenue</span>
</span><span id="FiscalPolicyScorer.score_package-338"><a href="#FiscalPolicyScorer.score_package-338"><span class="linenos">338</span></a>        <span class="n">deficit_after_behavioral</span> <span class="o">=</span> <span class="n">static_deficit</span> <span class="o">+</span> <span class="n">total_behavioral</span>
</span><span id="FiscalPolicyScorer.score_package-339"><a href="#FiscalPolicyScorer.score_package-339"><span class="linenos">339</span></a>        
</span><span id="FiscalPolicyScorer.score_package-340"><a href="#FiscalPolicyScorer.score_package-340"><span class="linenos">340</span></a>        <span class="c1"># Aggregate dynamic effects</span>
</span><span id="FiscalPolicyScorer.score_package-341"><a href="#FiscalPolicyScorer.score_package-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="n">dynamic</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_package-342"><a href="#FiscalPolicyScorer.score_package-342"><span class="linenos">342</span></a>            <span class="c1"># Combine dynamic effects (simplified aggregation)</span>
</span><span id="FiscalPolicyScorer.score_package-343"><a href="#FiscalPolicyScorer.score_package-343"><span class="linenos">343</span></a>            <span class="n">combined_dynamic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_dynamic_effects</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_package-344"><a href="#FiscalPolicyScorer.score_package-344"><span class="linenos">344</span></a>            <span class="n">final_deficit</span> <span class="o">=</span> <span class="n">deficit_after_behavioral</span> <span class="o">-</span> <span class="n">combined_dynamic</span><span class="o">.</span><span class="n">revenue_feedback</span>
</span><span id="FiscalPolicyScorer.score_package-345"><a href="#FiscalPolicyScorer.score_package-345"><span class="linenos">345</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FiscalPolicyScorer.score_package-346"><a href="#FiscalPolicyScorer.score_package-346"><span class="linenos">346</span></a>            <span class="n">combined_dynamic</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FiscalPolicyScorer.score_package-347"><a href="#FiscalPolicyScorer.score_package-347"><span class="linenos">347</span></a>            <span class="n">final_deficit</span> <span class="o">=</span> <span class="n">deficit_after_behavioral</span>
</span><span id="FiscalPolicyScorer.score_package-348"><a href="#FiscalPolicyScorer.score_package-348"><span class="linenos">348</span></a>        
</span><span id="FiscalPolicyScorer.score_package-349"><a href="#FiscalPolicyScorer.score_package-349"><span class="linenos">349</span></a>        <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_uncertainty</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer.score_package-350"><a href="#FiscalPolicyScorer.score_package-350"><span class="linenos">350</span></a>            <span class="n">package</span><span class="o">.</span><span class="n">policies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">final_deficit</span><span class="p">,</span> <span class="n">combined_dynamic</span>
</span><span id="FiscalPolicyScorer.score_package-351"><a href="#FiscalPolicyScorer.score_package-351"><span class="linenos">351</span></a>        <span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_package-352"><a href="#FiscalPolicyScorer.score_package-352"><span class="linenos">352</span></a>        
</span><span id="FiscalPolicyScorer.score_package-353"><a href="#FiscalPolicyScorer.score_package-353"><span class="linenos">353</span></a>        <span class="c1"># Create synthetic policy for package</span>
</span><span id="FiscalPolicyScorer.score_package-354"><a href="#FiscalPolicyScorer.score_package-354"><span class="linenos">354</span></a>        <span class="n">synthetic</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer.score_package-355"><a href="#FiscalPolicyScorer.score_package-355"><span class="linenos">355</span></a>            <span class="n">name</span><span class="o">=</span><span class="n">package</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-356"><a href="#FiscalPolicyScorer.score_package-356"><span class="linenos">356</span></a>            <span class="n">description</span><span class="o">=</span><span class="n">package</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-357"><a href="#FiscalPolicyScorer.score_package-357"><span class="linenos">357</span></a>            <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">MANDATORY_SPENDING</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-358"><a href="#FiscalPolicyScorer.score_package-358"><span class="linenos">358</span></a>            <span class="n">start_year</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">start_year</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">package</span><span class="o">.</span><span class="n">policies</span><span class="p">),</span>
</span><span id="FiscalPolicyScorer.score_package-359"><a href="#FiscalPolicyScorer.score_package-359"><span class="linenos">359</span></a>        <span class="p">)</span>
</span><span id="FiscalPolicyScorer.score_package-360"><a href="#FiscalPolicyScorer.score_package-360"><span class="linenos">360</span></a>        
</span><span id="FiscalPolicyScorer.score_package-361"><a href="#FiscalPolicyScorer.score_package-361"><span class="linenos">361</span></a>        <span class="k">return</span> <span class="n">ScoringResult</span><span class="p">(</span>
</span><span id="FiscalPolicyScorer.score_package-362"><a href="#FiscalPolicyScorer.score_package-362"><span class="linenos">362</span></a>            <span class="n">policy</span><span class="o">=</span><span class="n">synthetic</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-363"><a href="#FiscalPolicyScorer.score_package-363"><span class="linenos">363</span></a>            <span class="n">baseline</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-364"><a href="#FiscalPolicyScorer.score_package-364"><span class="linenos">364</span></a>            <span class="n">years</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-365"><a href="#FiscalPolicyScorer.score_package-365"><span class="linenos">365</span></a>            <span class="n">static_revenue_effect</span><span class="o">=</span><span class="n">total_static_revenue</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-366"><a href="#FiscalPolicyScorer.score_package-366"><span class="linenos">366</span></a>            <span class="n">static_spending_effect</span><span class="o">=</span><span class="n">total_static_spending</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-367"><a href="#FiscalPolicyScorer.score_package-367"><span class="linenos">367</span></a>            <span class="n">static_deficit_effect</span><span class="o">=</span><span class="n">static_deficit</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-368"><a href="#FiscalPolicyScorer.score_package-368"><span class="linenos">368</span></a>            <span class="n">behavioral_offset</span><span class="o">=</span><span class="n">total_behavioral</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-369"><a href="#FiscalPolicyScorer.score_package-369"><span class="linenos">369</span></a>            <span class="n">dynamic_effects</span><span class="o">=</span><span class="n">combined_dynamic</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-370"><a href="#FiscalPolicyScorer.score_package-370"><span class="linenos">370</span></a>            <span class="n">final_deficit_effect</span><span class="o">=</span><span class="n">final_deficit</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-371"><a href="#FiscalPolicyScorer.score_package-371"><span class="linenos">371</span></a>            <span class="n">low_estimate</span><span class="o">=</span><span class="n">low</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-372"><a href="#FiscalPolicyScorer.score_package-372"><span class="linenos">372</span></a>            <span class="n">high_estimate</span><span class="o">=</span><span class="n">high</span><span class="p">,</span>
</span><span id="FiscalPolicyScorer.score_package-373"><a href="#FiscalPolicyScorer.score_package-373"><span class="linenos">373</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Score a package of policies together.</p>

<p>Accounts for interactions between policies.</p>
</div>


                            </div>
                </section>
                <section id="ScoringResult">
                            <input id="ScoringResult-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">ScoringResult</span>:

                <label class="view-source-button" for="ScoringResult-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult-28"><a href="#ScoringResult-28"><span class="linenos"> 28</span></a><span class="nd">@dataclass</span>
</span><span id="ScoringResult-29"><a href="#ScoringResult-29"><span class="linenos"> 29</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ScoringResult</span><span class="p">:</span>
</span><span id="ScoringResult-30"><a href="#ScoringResult-30"><span class="linenos"> 30</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScoringResult-31"><a href="#ScoringResult-31"><span class="linenos"> 31</span></a><span class="sd">    Complete scoring results for a fiscal policy.</span>
</span><span id="ScoringResult-32"><a href="#ScoringResult-32"><span class="linenos"> 32</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ScoringResult-33"><a href="#ScoringResult-33"><span class="linenos"> 33</span></a>    <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span>
</span><span id="ScoringResult-34"><a href="#ScoringResult-34"><span class="linenos"> 34</span></a>    <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineProjection</span>
</span><span id="ScoringResult-35"><a href="#ScoringResult-35"><span class="linenos"> 35</span></a>    
</span><span id="ScoringResult-36"><a href="#ScoringResult-36"><span class="linenos"> 36</span></a>    <span class="c1"># Budget window</span>
</span><span id="ScoringResult-37"><a href="#ScoringResult-37"><span class="linenos"> 37</span></a>    <span class="n">years</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="ScoringResult-38"><a href="#ScoringResult-38"><span class="linenos"> 38</span></a>    
</span><span id="ScoringResult-39"><a href="#ScoringResult-39"><span class="linenos"> 39</span></a>    <span class="c1"># Static effects (before behavioral/economic feedback)</span>
</span><span id="ScoringResult-40"><a href="#ScoringResult-40"><span class="linenos"> 40</span></a>    <span class="n">static_revenue_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Billions, negative = revenue loss</span>
</span><span id="ScoringResult-41"><a href="#ScoringResult-41"><span class="linenos"> 41</span></a>    <span class="n">static_spending_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Billions, positive = spending increase</span>
</span><span id="ScoringResult-42"><a href="#ScoringResult-42"><span class="linenos"> 42</span></a>    <span class="n">static_deficit_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Net effect on deficit</span>
</span><span id="ScoringResult-43"><a href="#ScoringResult-43"><span class="linenos"> 43</span></a>    
</span><span id="ScoringResult-44"><a href="#ScoringResult-44"><span class="linenos"> 44</span></a>    <span class="c1"># Behavioral effects (microeconomic responses)</span>
</span><span id="ScoringResult-45"><a href="#ScoringResult-45"><span class="linenos"> 45</span></a>    <span class="n">behavioral_offset</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Revenue offset from behavioral response</span>
</span><span id="ScoringResult-46"><a href="#ScoringResult-46"><span class="linenos"> 46</span></a>    
</span><span id="ScoringResult-47"><a href="#ScoringResult-47"><span class="linenos"> 47</span></a>    <span class="c1"># Dynamic effects (macroeconomic feedback)</span>
</span><span id="ScoringResult-48"><a href="#ScoringResult-48"><span class="linenos"> 48</span></a>    <span class="n">dynamic_effects</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DynamicEffects</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScoringResult-49"><a href="#ScoringResult-49"><span class="linenos"> 49</span></a>    
</span><span id="ScoringResult-50"><a href="#ScoringResult-50"><span class="linenos"> 50</span></a>    <span class="c1"># Final estimates</span>
</span><span id="ScoringResult-51"><a href="#ScoringResult-51"><span class="linenos"> 51</span></a>    <span class="n">final_deficit_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="ScoringResult-52"><a href="#ScoringResult-52"><span class="linenos"> 52</span></a>    
</span><span id="ScoringResult-53"><a href="#ScoringResult-53"><span class="linenos"> 53</span></a>    <span class="c1"># Uncertainty</span>
</span><span id="ScoringResult-54"><a href="#ScoringResult-54"><span class="linenos"> 54</span></a>    <span class="n">low_estimate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="ScoringResult-55"><a href="#ScoringResult-55"><span class="linenos"> 55</span></a>    <span class="n">high_estimate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="ScoringResult-56"><a href="#ScoringResult-56"><span class="linenos"> 56</span></a>    
</span><span id="ScoringResult-57"><a href="#ScoringResult-57"><span class="linenos"> 57</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult-58"><a href="#ScoringResult-58"><span class="linenos"> 58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="ScoringResult-59"><a href="#ScoringResult-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether dynamic scoring was applied.&quot;&quot;&quot;</span>
</span><span id="ScoringResult-60"><a href="#ScoringResult-60"><span class="linenos"> 60</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="ScoringResult-61"><a href="#ScoringResult-61"><span class="linenos"> 61</span></a>    
</span><span id="ScoringResult-62"><a href="#ScoringResult-62"><span class="linenos"> 62</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult-63"><a href="#ScoringResult-63"><span class="linenos"> 63</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_10_year_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ScoringResult-64"><a href="#ScoringResult-64"><span class="linenos"> 64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total 10-year cost (positive = increases deficit).&quot;&quot;&quot;</span>
</span><span id="ScoringResult-65"><a href="#ScoringResult-65"><span class="linenos"> 65</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">)</span>
</span><span id="ScoringResult-66"><a href="#ScoringResult-66"><span class="linenos"> 66</span></a>    
</span><span id="ScoringResult-67"><a href="#ScoringResult-67"><span class="linenos"> 67</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult-68"><a href="#ScoringResult-68"><span class="linenos"> 68</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_static_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ScoringResult-69"><a href="#ScoringResult-69"><span class="linenos"> 69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total 10-year static cost.&quot;&quot;&quot;</span>
</span><span id="ScoringResult-70"><a href="#ScoringResult-70"><span class="linenos"> 70</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">)</span>
</span><span id="ScoringResult-71"><a href="#ScoringResult-71"><span class="linenos"> 71</span></a>    
</span><span id="ScoringResult-72"><a href="#ScoringResult-72"><span class="linenos"> 72</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult-73"><a href="#ScoringResult-73"><span class="linenos"> 73</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">revenue_feedback_10yr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ScoringResult-74"><a href="#ScoringResult-74"><span class="linenos"> 74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total revenue feedback from economic effects.&quot;&quot;&quot;</span>
</span><span id="ScoringResult-75"><a href="#ScoringResult-75"><span class="linenos"> 75</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="p">:</span>
</span><span id="ScoringResult-76"><a href="#ScoringResult-76"><span class="linenos"> 76</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">)</span>
</span><span id="ScoringResult-77"><a href="#ScoringResult-77"><span class="linenos"> 77</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="ScoringResult-78"><a href="#ScoringResult-78"><span class="linenos"> 78</span></a>    
</span><span id="ScoringResult-79"><a href="#ScoringResult-79"><span class="linenos"> 79</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult-80"><a href="#ScoringResult-80"><span class="linenos"> 80</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">average_annual_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ScoringResult-81"><a href="#ScoringResult-81"><span class="linenos"> 81</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Average annual cost.&quot;&quot;&quot;</span>
</span><span id="ScoringResult-82"><a href="#ScoringResult-82"><span class="linenos"> 82</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_10_year_cost</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="ScoringResult-83"><a href="#ScoringResult-83"><span class="linenos"> 83</span></a>    
</span><span id="ScoringResult-84"><a href="#ScoringResult-84"><span class="linenos"> 84</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_year_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="ScoringResult-85"><a href="#ScoringResult-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get detailed effects for a specific year.&quot;&quot;&quot;</span>
</span><span id="ScoringResult-86"><a href="#ScoringResult-86"><span class="linenos"> 86</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ScoringResult-87"><a href="#ScoringResult-87"><span class="linenos"> 87</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ScoringResult-88"><a href="#ScoringResult-88"><span class="linenos"> 88</span></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span>
</span><span id="ScoringResult-89"><a href="#ScoringResult-89"><span class="linenos"> 89</span></a>            <span class="s1">&#39;static_revenue&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-90"><a href="#ScoringResult-90"><span class="linenos"> 90</span></a>            <span class="s1">&#39;static_spending&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-91"><a href="#ScoringResult-91"><span class="linenos"> 91</span></a>            <span class="s1">&#39;static_deficit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-92"><a href="#ScoringResult-92"><span class="linenos"> 92</span></a>            <span class="s1">&#39;behavioral_offset&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-93"><a href="#ScoringResult-93"><span class="linenos"> 93</span></a>            <span class="s1">&#39;final_deficit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-94"><a href="#ScoringResult-94"><span class="linenos"> 94</span></a>            <span class="s1">&#39;low_estimate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-95"><a href="#ScoringResult-95"><span class="linenos"> 95</span></a>            <span class="s1">&#39;high_estimate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-96"><a href="#ScoringResult-96"><span class="linenos"> 96</span></a>        <span class="p">}</span>
</span><span id="ScoringResult-97"><a href="#ScoringResult-97"><span class="linenos"> 97</span></a>        
</span><span id="ScoringResult-98"><a href="#ScoringResult-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="p">:</span>
</span><span id="ScoringResult-99"><a href="#ScoringResult-99"><span class="linenos"> 99</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
</span><span id="ScoringResult-100"><a href="#ScoringResult-100"><span class="linenos">100</span></a>                <span class="s1">&#39;gdp_effect&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-101"><a href="#ScoringResult-101"><span class="linenos">101</span></a>                <span class="s1">&#39;gdp_pct&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-102"><a href="#ScoringResult-102"><span class="linenos">102</span></a>                <span class="s1">&#39;employment&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-103"><a href="#ScoringResult-103"><span class="linenos">103</span></a>                <span class="s1">&#39;revenue_feedback&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult-104"><a href="#ScoringResult-104"><span class="linenos">104</span></a>            <span class="p">})</span>
</span><span id="ScoringResult-105"><a href="#ScoringResult-105"><span class="linenos">105</span></a>        
</span><span id="ScoringResult-106"><a href="#ScoringResult-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="ScoringResult-107"><a href="#ScoringResult-107"><span class="linenos">107</span></a>    
</span><span id="ScoringResult-108"><a href="#ScoringResult-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScoringResult-109"><a href="#ScoringResult-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert results to pandas DataFrame.&quot;&quot;&quot;</span>
</span><span id="ScoringResult-110"><a href="#ScoringResult-110"><span class="linenos">110</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="ScoringResult-111"><a href="#ScoringResult-111"><span class="linenos">111</span></a>        
</span><span id="ScoringResult-112"><a href="#ScoringResult-112"><span class="linenos">112</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ScoringResult-113"><a href="#ScoringResult-113"><span class="linenos">113</span></a>            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span>
</span><span id="ScoringResult-114"><a href="#ScoringResult-114"><span class="linenos">114</span></a>            <span class="s1">&#39;Static Revenue Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">,</span>
</span><span id="ScoringResult-115"><a href="#ScoringResult-115"><span class="linenos">115</span></a>            <span class="s1">&#39;Static Spending Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">,</span>
</span><span id="ScoringResult-116"><a href="#ScoringResult-116"><span class="linenos">116</span></a>            <span class="s1">&#39;Static Deficit Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">,</span>
</span><span id="ScoringResult-117"><a href="#ScoringResult-117"><span class="linenos">117</span></a>            <span class="s1">&#39;Behavioral Offset ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">,</span>
</span><span id="ScoringResult-118"><a href="#ScoringResult-118"><span class="linenos">118</span></a>            <span class="s1">&#39;Final Deficit Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">,</span>
</span><span id="ScoringResult-119"><a href="#ScoringResult-119"><span class="linenos">119</span></a>            <span class="s1">&#39;Low Estimate ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">,</span>
</span><span id="ScoringResult-120"><a href="#ScoringResult-120"><span class="linenos">120</span></a>            <span class="s1">&#39;High Estimate ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">,</span>
</span><span id="ScoringResult-121"><a href="#ScoringResult-121"><span class="linenos">121</span></a>        <span class="p">}</span>
</span><span id="ScoringResult-122"><a href="#ScoringResult-122"><span class="linenos">122</span></a>        
</span><span id="ScoringResult-123"><a href="#ScoringResult-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="p">:</span>
</span><span id="ScoringResult-124"><a href="#ScoringResult-124"><span class="linenos">124</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
</span><span id="ScoringResult-125"><a href="#ScoringResult-125"><span class="linenos">125</span></a>                <span class="s1">&#39;GDP Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">,</span>
</span><span id="ScoringResult-126"><a href="#ScoringResult-126"><span class="linenos">126</span></a>                <span class="s1">&#39;GDP Effect (%)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">,</span>
</span><span id="ScoringResult-127"><a href="#ScoringResult-127"><span class="linenos">127</span></a>                <span class="s1">&#39;Employment (thousands)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">,</span>
</span><span id="ScoringResult-128"><a href="#ScoringResult-128"><span class="linenos">128</span></a>                <span class="s1">&#39;Revenue Feedback ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">,</span>
</span><span id="ScoringResult-129"><a href="#ScoringResult-129"><span class="linenos">129</span></a>            <span class="p">})</span>
</span><span id="ScoringResult-130"><a href="#ScoringResult-130"><span class="linenos">130</span></a>        
</span><span id="ScoringResult-131"><a href="#ScoringResult-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ScoringResult-132"><a href="#ScoringResult-132"><span class="linenos">132</span></a>    
</span><span id="ScoringResult-133"><a href="#ScoringResult-133"><span class="linenos">133</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScoringResult-134"><a href="#ScoringResult-134"><span class="linenos">134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print a formatted summary of results.&quot;&quot;&quot;</span>
</span><span id="ScoringResult-135"><a href="#ScoringResult-135"><span class="linenos">135</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="ScoringResult-136"><a href="#ScoringResult-136"><span class="linenos">136</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rich.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>
</span><span id="ScoringResult-137"><a href="#ScoringResult-137"><span class="linenos">137</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rich.panel</span><span class="w"> </span><span class="kn">import</span> <span class="n">Panel</span>
</span><span id="ScoringResult-138"><a href="#ScoringResult-138"><span class="linenos">138</span></a>        
</span><span id="ScoringResult-139"><a href="#ScoringResult-139"><span class="linenos">139</span></a>        <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="ScoringResult-140"><a href="#ScoringResult-140"><span class="linenos">140</span></a>        
</span><span id="ScoringResult-141"><a href="#ScoringResult-141"><span class="linenos">141</span></a>        <span class="c1"># Header</span>
</span><span id="ScoringResult-142"><a href="#ScoringResult-142"><span class="linenos">142</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">Panel</span><span class="p">(</span>
</span><span id="ScoringResult-143"><a href="#ScoringResult-143"><span class="linenos">143</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold blue]</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">[/bold blue]</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ScoringResult-144"><a href="#ScoringResult-144"><span class="linenos">144</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Fiscal Policy Score&quot;</span>
</span><span id="ScoringResult-145"><a href="#ScoringResult-145"><span class="linenos">145</span></a>        <span class="p">))</span>
</span><span id="ScoringResult-146"><a href="#ScoringResult-146"><span class="linenos">146</span></a>        
</span><span id="ScoringResult-147"><a href="#ScoringResult-147"><span class="linenos">147</span></a>        <span class="c1"># Summary stats</span>
</span><span id="ScoringResult-148"><a href="#ScoringResult-148"><span class="linenos">148</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[bold]10-Year Budget Impact:[/bold]&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-149"><a href="#ScoringResult-149"><span class="linenos">149</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Static Cost: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_static_cost</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> billion&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-150"><a href="#ScoringResult-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult-151"><a href="#ScoringResult-151"><span class="linenos">151</span></a>            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Revenue Feedback: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> billion&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-152"><a href="#ScoringResult-152"><span class="linenos">152</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [bold]Final Cost: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> billion[/bold]&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-153"><a href="#ScoringResult-153"><span class="linenos">153</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Range: $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">B to $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-154"><a href="#ScoringResult-154"><span class="linenos">154</span></a>        
</span><span id="ScoringResult-155"><a href="#ScoringResult-155"><span class="linenos">155</span></a>        <span class="c1"># Year-by-year table</span>
</span><span id="ScoringResult-156"><a href="#ScoringResult-156"><span class="linenos">156</span></a>        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Year-by-Year Effects ($ billions)&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-157"><a href="#ScoringResult-157"><span class="linenos">157</span></a>        
</span><span id="ScoringResult-158"><a href="#ScoringResult-158"><span class="linenos">158</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-159"><a href="#ScoringResult-159"><span class="linenos">159</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Static&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-160"><a href="#ScoringResult-160"><span class="linenos">160</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Behavioral&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-161"><a href="#ScoringResult-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult-162"><a href="#ScoringResult-162"><span class="linenos">162</span></a>            <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Feedback&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-163"><a href="#ScoringResult-163"><span class="linenos">163</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Final&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-164"><a href="#ScoringResult-164"><span class="linenos">164</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Range&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-165"><a href="#ScoringResult-165"><span class="linenos">165</span></a>        
</span><span id="ScoringResult-166"><a href="#ScoringResult-166"><span class="linenos">166</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">):</span>
</span><span id="ScoringResult-167"><a href="#ScoringResult-167"><span class="linenos">167</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScoringResult-168"><a href="#ScoringResult-168"><span class="linenos">168</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
</span><span id="ScoringResult-169"><a href="#ScoringResult-169"><span class="linenos">169</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ScoringResult-170"><a href="#ScoringResult-170"><span class="linenos">170</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ScoringResult-171"><a href="#ScoringResult-171"><span class="linenos">171</span></a>            <span class="p">]</span>
</span><span id="ScoringResult-172"><a href="#ScoringResult-172"><span class="linenos">172</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult-173"><a href="#ScoringResult-173"><span class="linenos">173</span></a>                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-174"><a href="#ScoringResult-174"><span class="linenos">174</span></a>            <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="ScoringResult-175"><a href="#ScoringResult-175"><span class="linenos">175</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ScoringResult-176"><a href="#ScoringResult-176"><span class="linenos">176</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="ScoringResult-177"><a href="#ScoringResult-177"><span class="linenos">177</span></a>            <span class="p">])</span>
</span><span id="ScoringResult-178"><a href="#ScoringResult-178"><span class="linenos">178</span></a>            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>
</span><span id="ScoringResult-179"><a href="#ScoringResult-179"><span class="linenos">179</span></a>        
</span><span id="ScoringResult-180"><a href="#ScoringResult-180"><span class="linenos">180</span></a>        <span class="c1"># Totals row</span>
</span><span id="ScoringResult-181"><a href="#ScoringResult-181"><span class="linenos">181</span></a>        <span class="n">total_row</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScoringResult-182"><a href="#ScoringResult-182"><span class="linenos">182</span></a>            <span class="s2">&quot;[bold]Total[/bold]&quot;</span><span class="p">,</span>
</span><span id="ScoringResult-183"><a href="#ScoringResult-183"><span class="linenos">183</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_static_cost</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span><span class="p">,</span>
</span><span id="ScoringResult-184"><a href="#ScoringResult-184"><span class="linenos">184</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span><span class="p">,</span>
</span><span id="ScoringResult-185"><a href="#ScoringResult-185"><span class="linenos">185</span></a>        <span class="p">]</span>
</span><span id="ScoringResult-186"><a href="#ScoringResult-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult-187"><a href="#ScoringResult-187"><span class="linenos">187</span></a>            <span class="n">total_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-188"><a href="#ScoringResult-188"><span class="linenos">188</span></a>        <span class="n">total_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="ScoringResult-189"><a href="#ScoringResult-189"><span class="linenos">189</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span><span class="p">,</span>
</span><span id="ScoringResult-190"><a href="#ScoringResult-190"><span class="linenos">190</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span>
</span><span id="ScoringResult-191"><a href="#ScoringResult-191"><span class="linenos">191</span></a>        <span class="p">])</span>
</span><span id="ScoringResult-192"><a href="#ScoringResult-192"><span class="linenos">192</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">total_row</span><span class="p">)</span>
</span><span id="ScoringResult-193"><a href="#ScoringResult-193"><span class="linenos">193</span></a>        
</span><span id="ScoringResult-194"><a href="#ScoringResult-194"><span class="linenos">194</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</span><span id="ScoringResult-195"><a href="#ScoringResult-195"><span class="linenos">195</span></a>        
</span><span id="ScoringResult-196"><a href="#ScoringResult-196"><span class="linenos">196</span></a>        <span class="c1"># Economic effects if dynamic</span>
</span><span id="ScoringResult-197"><a href="#ScoringResult-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult-198"><a href="#ScoringResult-198"><span class="linenos">198</span></a>            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[bold]Economic Effects (10-year average):[/bold]&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-199"><a href="#ScoringResult-199"><span class="linenos">199</span></a>            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  GDP: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</span><span id="ScoringResult-200"><a href="#ScoringResult-200"><span class="linenos">200</span></a>            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Employment: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> thousand jobs&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Complete scoring results for a fiscal policy.</p>
</div>


                            <div id="ScoringResult.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">ScoringResult</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">baseline</span><span class="p">:</span> <span class="n"><a href="#BaselineProjection">BaselineProjection</a></span>,</span><span class="param">	<span class="n">years</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">static_revenue_effect</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">static_spending_effect</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">static_deficit_effect</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">behavioral_offset</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">dynamic_effects</span><span class="p">:</span> <span class="n"><a href="#DynamicEffects">DynamicEffects</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">final_deficit_effect</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">low_estimate</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">high_estimate</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.__init__"></a>
    
    

                            </div>
                            <div id="ScoringResult.policy" class="classattr">
                                <div class="attr variable">
            <span class="name">policy</span><span class="annotation">: <a href="#Policy">Policy</a></span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.policy"></a>
    
    

                            </div>
                            <div id="ScoringResult.baseline" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline</span><span class="annotation">: <a href="#BaselineProjection">BaselineProjection</a></span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.baseline"></a>
    
    

                            </div>
                            <div id="ScoringResult.years" class="classattr">
                                <div class="attr variable">
            <span class="name">years</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.years"></a>
    
    

                            </div>
                            <div id="ScoringResult.static_revenue_effect" class="classattr">
                                <div class="attr variable">
            <span class="name">static_revenue_effect</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.static_revenue_effect"></a>
    
    

                            </div>
                            <div id="ScoringResult.static_spending_effect" class="classattr">
                                <div class="attr variable">
            <span class="name">static_spending_effect</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.static_spending_effect"></a>
    
    

                            </div>
                            <div id="ScoringResult.static_deficit_effect" class="classattr">
                                <div class="attr variable">
            <span class="name">static_deficit_effect</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.static_deficit_effect"></a>
    
    

                            </div>
                            <div id="ScoringResult.behavioral_offset" class="classattr">
                                <div class="attr variable">
            <span class="name">behavioral_offset</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.behavioral_offset"></a>
    
    

                            </div>
                            <div id="ScoringResult.dynamic_effects" class="classattr">
                                <div class="attr variable">
            <span class="name">dynamic_effects</span><span class="annotation">: <a href="#DynamicEffects">DynamicEffects</a> | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.dynamic_effects"></a>
    
    

                            </div>
                            <div id="ScoringResult.final_deficit_effect" class="classattr">
                                <div class="attr variable">
            <span class="name">final_deficit_effect</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.final_deficit_effect"></a>
    
    

                            </div>
                            <div id="ScoringResult.low_estimate" class="classattr">
                                <div class="attr variable">
            <span class="name">low_estimate</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.low_estimate"></a>
    
    

                            </div>
                            <div id="ScoringResult.high_estimate" class="classattr">
                                <div class="attr variable">
            <span class="name">high_estimate</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#ScoringResult.high_estimate"></a>
    
    

                            </div>
                            <div id="ScoringResult.is_dynamic" class="classattr">
                                        <input id="ScoringResult.is_dynamic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_dynamic</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="ScoringResult.is_dynamic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult.is_dynamic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult.is_dynamic-57"><a href="#ScoringResult.is_dynamic-57"><span class="linenos">57</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult.is_dynamic-58"><a href="#ScoringResult.is_dynamic-58"><span class="linenos">58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="ScoringResult.is_dynamic-59"><a href="#ScoringResult.is_dynamic-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether dynamic scoring was applied.&quot;&quot;&quot;</span>
</span><span id="ScoringResult.is_dynamic-60"><a href="#ScoringResult.is_dynamic-60"><span class="linenos">60</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Whether dynamic scoring was applied.</p>
</div>


                            </div>
                            <div id="ScoringResult.total_10_year_cost" class="classattr">
                                        <input id="ScoringResult.total_10_year_cost-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">total_10_year_cost</span><span class="annotation">: float</span>

                <label class="view-source-button" for="ScoringResult.total_10_year_cost-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult.total_10_year_cost"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult.total_10_year_cost-62"><a href="#ScoringResult.total_10_year_cost-62"><span class="linenos">62</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult.total_10_year_cost-63"><a href="#ScoringResult.total_10_year_cost-63"><span class="linenos">63</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_10_year_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ScoringResult.total_10_year_cost-64"><a href="#ScoringResult.total_10_year_cost-64"><span class="linenos">64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total 10-year cost (positive = increases deficit).&quot;&quot;&quot;</span>
</span><span id="ScoringResult.total_10_year_cost-65"><a href="#ScoringResult.total_10_year_cost-65"><span class="linenos">65</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Total 10-year cost (positive = increases deficit).</p>
</div>


                            </div>
                            <div id="ScoringResult.total_static_cost" class="classattr">
                                        <input id="ScoringResult.total_static_cost-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">total_static_cost</span><span class="annotation">: float</span>

                <label class="view-source-button" for="ScoringResult.total_static_cost-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult.total_static_cost"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult.total_static_cost-67"><a href="#ScoringResult.total_static_cost-67"><span class="linenos">67</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult.total_static_cost-68"><a href="#ScoringResult.total_static_cost-68"><span class="linenos">68</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_static_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ScoringResult.total_static_cost-69"><a href="#ScoringResult.total_static_cost-69"><span class="linenos">69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total 10-year static cost.&quot;&quot;&quot;</span>
</span><span id="ScoringResult.total_static_cost-70"><a href="#ScoringResult.total_static_cost-70"><span class="linenos">70</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Total 10-year static cost.</p>
</div>


                            </div>
                            <div id="ScoringResult.revenue_feedback_10yr" class="classattr">
                                        <input id="ScoringResult.revenue_feedback_10yr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">revenue_feedback_10yr</span><span class="annotation">: float</span>

                <label class="view-source-button" for="ScoringResult.revenue_feedback_10yr-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult.revenue_feedback_10yr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult.revenue_feedback_10yr-72"><a href="#ScoringResult.revenue_feedback_10yr-72"><span class="linenos">72</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult.revenue_feedback_10yr-73"><a href="#ScoringResult.revenue_feedback_10yr-73"><span class="linenos">73</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">revenue_feedback_10yr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ScoringResult.revenue_feedback_10yr-74"><a href="#ScoringResult.revenue_feedback_10yr-74"><span class="linenos">74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total revenue feedback from economic effects.&quot;&quot;&quot;</span>
</span><span id="ScoringResult.revenue_feedback_10yr-75"><a href="#ScoringResult.revenue_feedback_10yr-75"><span class="linenos">75</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="p">:</span>
</span><span id="ScoringResult.revenue_feedback_10yr-76"><a href="#ScoringResult.revenue_feedback_10yr-76"><span class="linenos">76</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">)</span>
</span><span id="ScoringResult.revenue_feedback_10yr-77"><a href="#ScoringResult.revenue_feedback_10yr-77"><span class="linenos">77</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span></pre></div>


            <div class="docstring"><p>Total revenue feedback from economic effects.</p>
</div>


                            </div>
                            <div id="ScoringResult.average_annual_cost" class="classattr">
                                        <input id="ScoringResult.average_annual_cost-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">average_annual_cost</span><span class="annotation">: float</span>

                <label class="view-source-button" for="ScoringResult.average_annual_cost-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult.average_annual_cost"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult.average_annual_cost-79"><a href="#ScoringResult.average_annual_cost-79"><span class="linenos">79</span></a>    <span class="nd">@property</span>
</span><span id="ScoringResult.average_annual_cost-80"><a href="#ScoringResult.average_annual_cost-80"><span class="linenos">80</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">average_annual_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ScoringResult.average_annual_cost-81"><a href="#ScoringResult.average_annual_cost-81"><span class="linenos">81</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Average annual cost.&quot;&quot;&quot;</span>
</span><span id="ScoringResult.average_annual_cost-82"><a href="#ScoringResult.average_annual_cost-82"><span class="linenos">82</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_10_year_cost</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Average annual cost.</p>
</div>


                            </div>
                            <div id="ScoringResult.get_year_effect" class="classattr">
                                        <input id="ScoringResult.get_year_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_year_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="ScoringResult.get_year_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult.get_year_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult.get_year_effect-84"><a href="#ScoringResult.get_year_effect-84"><span class="linenos"> 84</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_year_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="ScoringResult.get_year_effect-85"><a href="#ScoringResult.get_year_effect-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get detailed effects for a specific year.&quot;&quot;&quot;</span>
</span><span id="ScoringResult.get_year_effect-86"><a href="#ScoringResult.get_year_effect-86"><span class="linenos"> 86</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ScoringResult.get_year_effect-87"><a href="#ScoringResult.get_year_effect-87"><span class="linenos"> 87</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ScoringResult.get_year_effect-88"><a href="#ScoringResult.get_year_effect-88"><span class="linenos"> 88</span></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span>
</span><span id="ScoringResult.get_year_effect-89"><a href="#ScoringResult.get_year_effect-89"><span class="linenos"> 89</span></a>            <span class="s1">&#39;static_revenue&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-90"><a href="#ScoringResult.get_year_effect-90"><span class="linenos"> 90</span></a>            <span class="s1">&#39;static_spending&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-91"><a href="#ScoringResult.get_year_effect-91"><span class="linenos"> 91</span></a>            <span class="s1">&#39;static_deficit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-92"><a href="#ScoringResult.get_year_effect-92"><span class="linenos"> 92</span></a>            <span class="s1">&#39;behavioral_offset&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-93"><a href="#ScoringResult.get_year_effect-93"><span class="linenos"> 93</span></a>            <span class="s1">&#39;final_deficit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-94"><a href="#ScoringResult.get_year_effect-94"><span class="linenos"> 94</span></a>            <span class="s1">&#39;low_estimate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-95"><a href="#ScoringResult.get_year_effect-95"><span class="linenos"> 95</span></a>            <span class="s1">&#39;high_estimate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-96"><a href="#ScoringResult.get_year_effect-96"><span class="linenos"> 96</span></a>        <span class="p">}</span>
</span><span id="ScoringResult.get_year_effect-97"><a href="#ScoringResult.get_year_effect-97"><span class="linenos"> 97</span></a>        
</span><span id="ScoringResult.get_year_effect-98"><a href="#ScoringResult.get_year_effect-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="p">:</span>
</span><span id="ScoringResult.get_year_effect-99"><a href="#ScoringResult.get_year_effect-99"><span class="linenos"> 99</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
</span><span id="ScoringResult.get_year_effect-100"><a href="#ScoringResult.get_year_effect-100"><span class="linenos">100</span></a>                <span class="s1">&#39;gdp_effect&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-101"><a href="#ScoringResult.get_year_effect-101"><span class="linenos">101</span></a>                <span class="s1">&#39;gdp_pct&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-102"><a href="#ScoringResult.get_year_effect-102"><span class="linenos">102</span></a>                <span class="s1">&#39;employment&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-103"><a href="#ScoringResult.get_year_effect-103"><span class="linenos">103</span></a>                <span class="s1">&#39;revenue_feedback&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
</span><span id="ScoringResult.get_year_effect-104"><a href="#ScoringResult.get_year_effect-104"><span class="linenos">104</span></a>            <span class="p">})</span>
</span><span id="ScoringResult.get_year_effect-105"><a href="#ScoringResult.get_year_effect-105"><span class="linenos">105</span></a>        
</span><span id="ScoringResult.get_year_effect-106"><a href="#ScoringResult.get_year_effect-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Get detailed effects for a specific year.</p>
</div>


                            </div>
                            <div id="ScoringResult.to_dataframe" class="classattr">
                                        <input id="ScoringResult.to_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ScoringResult.to_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult.to_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult.to_dataframe-108"><a href="#ScoringResult.to_dataframe-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScoringResult.to_dataframe-109"><a href="#ScoringResult.to_dataframe-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert results to pandas DataFrame.&quot;&quot;&quot;</span>
</span><span id="ScoringResult.to_dataframe-110"><a href="#ScoringResult.to_dataframe-110"><span class="linenos">110</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="ScoringResult.to_dataframe-111"><a href="#ScoringResult.to_dataframe-111"><span class="linenos">111</span></a>        
</span><span id="ScoringResult.to_dataframe-112"><a href="#ScoringResult.to_dataframe-112"><span class="linenos">112</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ScoringResult.to_dataframe-113"><a href="#ScoringResult.to_dataframe-113"><span class="linenos">113</span></a>            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-114"><a href="#ScoringResult.to_dataframe-114"><span class="linenos">114</span></a>            <span class="s1">&#39;Static Revenue Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-115"><a href="#ScoringResult.to_dataframe-115"><span class="linenos">115</span></a>            <span class="s1">&#39;Static Spending Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-116"><a href="#ScoringResult.to_dataframe-116"><span class="linenos">116</span></a>            <span class="s1">&#39;Static Deficit Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-117"><a href="#ScoringResult.to_dataframe-117"><span class="linenos">117</span></a>            <span class="s1">&#39;Behavioral Offset ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-118"><a href="#ScoringResult.to_dataframe-118"><span class="linenos">118</span></a>            <span class="s1">&#39;Final Deficit Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-119"><a href="#ScoringResult.to_dataframe-119"><span class="linenos">119</span></a>            <span class="s1">&#39;Low Estimate ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-120"><a href="#ScoringResult.to_dataframe-120"><span class="linenos">120</span></a>            <span class="s1">&#39;High Estimate ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-121"><a href="#ScoringResult.to_dataframe-121"><span class="linenos">121</span></a>        <span class="p">}</span>
</span><span id="ScoringResult.to_dataframe-122"><a href="#ScoringResult.to_dataframe-122"><span class="linenos">122</span></a>        
</span><span id="ScoringResult.to_dataframe-123"><a href="#ScoringResult.to_dataframe-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="p">:</span>
</span><span id="ScoringResult.to_dataframe-124"><a href="#ScoringResult.to_dataframe-124"><span class="linenos">124</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
</span><span id="ScoringResult.to_dataframe-125"><a href="#ScoringResult.to_dataframe-125"><span class="linenos">125</span></a>                <span class="s1">&#39;GDP Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-126"><a href="#ScoringResult.to_dataframe-126"><span class="linenos">126</span></a>                <span class="s1">&#39;GDP Effect (%)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-127"><a href="#ScoringResult.to_dataframe-127"><span class="linenos">127</span></a>                <span class="s1">&#39;Employment (thousands)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-128"><a href="#ScoringResult.to_dataframe-128"><span class="linenos">128</span></a>                <span class="s1">&#39;Revenue Feedback ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">,</span>
</span><span id="ScoringResult.to_dataframe-129"><a href="#ScoringResult.to_dataframe-129"><span class="linenos">129</span></a>            <span class="p">})</span>
</span><span id="ScoringResult.to_dataframe-130"><a href="#ScoringResult.to_dataframe-130"><span class="linenos">130</span></a>        
</span><span id="ScoringResult.to_dataframe-131"><a href="#ScoringResult.to_dataframe-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert results to pandas DataFrame.</p>
</div>


                            </div>
                            <div id="ScoringResult.display_summary" class="classattr">
                                        <input id="ScoringResult.display_summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ScoringResult.display_summary-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScoringResult.display_summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScoringResult.display_summary-133"><a href="#ScoringResult.display_summary-133"><span class="linenos">133</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScoringResult.display_summary-134"><a href="#ScoringResult.display_summary-134"><span class="linenos">134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print a formatted summary of results.&quot;&quot;&quot;</span>
</span><span id="ScoringResult.display_summary-135"><a href="#ScoringResult.display_summary-135"><span class="linenos">135</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rich.console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
</span><span id="ScoringResult.display_summary-136"><a href="#ScoringResult.display_summary-136"><span class="linenos">136</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rich.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>
</span><span id="ScoringResult.display_summary-137"><a href="#ScoringResult.display_summary-137"><span class="linenos">137</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rich.panel</span><span class="w"> </span><span class="kn">import</span> <span class="n">Panel</span>
</span><span id="ScoringResult.display_summary-138"><a href="#ScoringResult.display_summary-138"><span class="linenos">138</span></a>        
</span><span id="ScoringResult.display_summary-139"><a href="#ScoringResult.display_summary-139"><span class="linenos">139</span></a>        <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
</span><span id="ScoringResult.display_summary-140"><a href="#ScoringResult.display_summary-140"><span class="linenos">140</span></a>        
</span><span id="ScoringResult.display_summary-141"><a href="#ScoringResult.display_summary-141"><span class="linenos">141</span></a>        <span class="c1"># Header</span>
</span><span id="ScoringResult.display_summary-142"><a href="#ScoringResult.display_summary-142"><span class="linenos">142</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">Panel</span><span class="p">(</span>
</span><span id="ScoringResult.display_summary-143"><a href="#ScoringResult.display_summary-143"><span class="linenos">143</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold blue]</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">[/bold blue]</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ScoringResult.display_summary-144"><a href="#ScoringResult.display_summary-144"><span class="linenos">144</span></a>            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Fiscal Policy Score&quot;</span>
</span><span id="ScoringResult.display_summary-145"><a href="#ScoringResult.display_summary-145"><span class="linenos">145</span></a>        <span class="p">))</span>
</span><span id="ScoringResult.display_summary-146"><a href="#ScoringResult.display_summary-146"><span class="linenos">146</span></a>        
</span><span id="ScoringResult.display_summary-147"><a href="#ScoringResult.display_summary-147"><span class="linenos">147</span></a>        <span class="c1"># Summary stats</span>
</span><span id="ScoringResult.display_summary-148"><a href="#ScoringResult.display_summary-148"><span class="linenos">148</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[bold]10-Year Budget Impact:[/bold]&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-149"><a href="#ScoringResult.display_summary-149"><span class="linenos">149</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Static Cost: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_static_cost</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> billion&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-150"><a href="#ScoringResult.display_summary-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult.display_summary-151"><a href="#ScoringResult.display_summary-151"><span class="linenos">151</span></a>            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Revenue Feedback: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> billion&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-152"><a href="#ScoringResult.display_summary-152"><span class="linenos">152</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [bold]Final Cost: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> billion[/bold]&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-153"><a href="#ScoringResult.display_summary-153"><span class="linenos">153</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Range: $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">B to $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-154"><a href="#ScoringResult.display_summary-154"><span class="linenos">154</span></a>        
</span><span id="ScoringResult.display_summary-155"><a href="#ScoringResult.display_summary-155"><span class="linenos">155</span></a>        <span class="c1"># Year-by-year table</span>
</span><span id="ScoringResult.display_summary-156"><a href="#ScoringResult.display_summary-156"><span class="linenos">156</span></a>        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Year-by-Year Effects ($ billions)&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-157"><a href="#ScoringResult.display_summary-157"><span class="linenos">157</span></a>        
</span><span id="ScoringResult.display_summary-158"><a href="#ScoringResult.display_summary-158"><span class="linenos">158</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-159"><a href="#ScoringResult.display_summary-159"><span class="linenos">159</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Static&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-160"><a href="#ScoringResult.display_summary-160"><span class="linenos">160</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Behavioral&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-161"><a href="#ScoringResult.display_summary-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult.display_summary-162"><a href="#ScoringResult.display_summary-162"><span class="linenos">162</span></a>            <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Feedback&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-163"><a href="#ScoringResult.display_summary-163"><span class="linenos">163</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Final&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-164"><a href="#ScoringResult.display_summary-164"><span class="linenos">164</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Range&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-165"><a href="#ScoringResult.display_summary-165"><span class="linenos">165</span></a>        
</span><span id="ScoringResult.display_summary-166"><a href="#ScoringResult.display_summary-166"><span class="linenos">166</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">):</span>
</span><span id="ScoringResult.display_summary-167"><a href="#ScoringResult.display_summary-167"><span class="linenos">167</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScoringResult.display_summary-168"><a href="#ScoringResult.display_summary-168"><span class="linenos">168</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
</span><span id="ScoringResult.display_summary-169"><a href="#ScoringResult.display_summary-169"><span class="linenos">169</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ScoringResult.display_summary-170"><a href="#ScoringResult.display_summary-170"><span class="linenos">170</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ScoringResult.display_summary-171"><a href="#ScoringResult.display_summary-171"><span class="linenos">171</span></a>            <span class="p">]</span>
</span><span id="ScoringResult.display_summary-172"><a href="#ScoringResult.display_summary-172"><span class="linenos">172</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult.display_summary-173"><a href="#ScoringResult.display_summary-173"><span class="linenos">173</span></a>                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-174"><a href="#ScoringResult.display_summary-174"><span class="linenos">174</span></a>            <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="ScoringResult.display_summary-175"><a href="#ScoringResult.display_summary-175"><span class="linenos">175</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ScoringResult.display_summary-176"><a href="#ScoringResult.display_summary-176"><span class="linenos">176</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="ScoringResult.display_summary-177"><a href="#ScoringResult.display_summary-177"><span class="linenos">177</span></a>            <span class="p">])</span>
</span><span id="ScoringResult.display_summary-178"><a href="#ScoringResult.display_summary-178"><span class="linenos">178</span></a>            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-179"><a href="#ScoringResult.display_summary-179"><span class="linenos">179</span></a>        
</span><span id="ScoringResult.display_summary-180"><a href="#ScoringResult.display_summary-180"><span class="linenos">180</span></a>        <span class="c1"># Totals row</span>
</span><span id="ScoringResult.display_summary-181"><a href="#ScoringResult.display_summary-181"><span class="linenos">181</span></a>        <span class="n">total_row</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ScoringResult.display_summary-182"><a href="#ScoringResult.display_summary-182"><span class="linenos">182</span></a>            <span class="s2">&quot;[bold]Total[/bold]&quot;</span><span class="p">,</span>
</span><span id="ScoringResult.display_summary-183"><a href="#ScoringResult.display_summary-183"><span class="linenos">183</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_static_cost</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span><span class="p">,</span>
</span><span id="ScoringResult.display_summary-184"><a href="#ScoringResult.display_summary-184"><span class="linenos">184</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span><span class="p">,</span>
</span><span id="ScoringResult.display_summary-185"><a href="#ScoringResult.display_summary-185"><span class="linenos">185</span></a>        <span class="p">]</span>
</span><span id="ScoringResult.display_summary-186"><a href="#ScoringResult.display_summary-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult.display_summary-187"><a href="#ScoringResult.display_summary-187"><span class="linenos">187</span></a>            <span class="n">total_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-188"><a href="#ScoringResult.display_summary-188"><span class="linenos">188</span></a>        <span class="n">total_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="ScoringResult.display_summary-189"><a href="#ScoringResult.display_summary-189"><span class="linenos">189</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span><span class="p">,</span>
</span><span id="ScoringResult.display_summary-190"><a href="#ScoringResult.display_summary-190"><span class="linenos">190</span></a>            <span class="sa">f</span><span class="s2">&quot;[bold]</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">[/bold]&quot;</span>
</span><span id="ScoringResult.display_summary-191"><a href="#ScoringResult.display_summary-191"><span class="linenos">191</span></a>        <span class="p">])</span>
</span><span id="ScoringResult.display_summary-192"><a href="#ScoringResult.display_summary-192"><span class="linenos">192</span></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">total_row</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-193"><a href="#ScoringResult.display_summary-193"><span class="linenos">193</span></a>        
</span><span id="ScoringResult.display_summary-194"><a href="#ScoringResult.display_summary-194"><span class="linenos">194</span></a>        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-195"><a href="#ScoringResult.display_summary-195"><span class="linenos">195</span></a>        
</span><span id="ScoringResult.display_summary-196"><a href="#ScoringResult.display_summary-196"><span class="linenos">196</span></a>        <span class="c1"># Economic effects if dynamic</span>
</span><span id="ScoringResult.display_summary-197"><a href="#ScoringResult.display_summary-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="ScoringResult.display_summary-198"><a href="#ScoringResult.display_summary-198"><span class="linenos">198</span></a>            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[bold]Economic Effects (10-year average):[/bold]&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-199"><a href="#ScoringResult.display_summary-199"><span class="linenos">199</span></a>            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  GDP: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</span><span id="ScoringResult.display_summary-200"><a href="#ScoringResult.display_summary-200"><span class="linenos">200</span></a>            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Employment: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> thousand jobs&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Print a formatted summary of results.</p>
</div>


                            </div>
                </section>
                <section id="EconomicModel">
                            <input id="EconomicModel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EconomicModel</span>:

                <label class="view-source-button" for="EconomicModel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicModel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicModel-110"><a href="#EconomicModel-110"><span class="linenos">110</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EconomicModel</span><span class="p">:</span>
</span><span id="EconomicModel-111"><a href="#EconomicModel-111"><span class="linenos">111</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EconomicModel-112"><a href="#EconomicModel-112"><span class="linenos">112</span></a><span class="sd">    Economic model for dynamic scoring.</span>
</span><span id="EconomicModel-113"><a href="#EconomicModel-113"><span class="linenos">113</span></a><span class="sd">    </span>
</span><span id="EconomicModel-114"><a href="#EconomicModel-114"><span class="linenos">114</span></a><span class="sd">    Incorporates key channels through which fiscal policy affects the economy:</span>
</span><span id="EconomicModel-115"><a href="#EconomicModel-115"><span class="linenos">115</span></a><span class="sd">    1. Aggregate demand effects (short-run)</span>
</span><span id="EconomicModel-116"><a href="#EconomicModel-116"><span class="linenos">116</span></a><span class="sd">    2. Labor supply effects</span>
</span><span id="EconomicModel-117"><a href="#EconomicModel-117"><span class="linenos">117</span></a><span class="sd">    3. Saving and investment effects</span>
</span><span id="EconomicModel-118"><a href="#EconomicModel-118"><span class="linenos">118</span></a><span class="sd">    4. Interest rate effects</span>
</span><span id="EconomicModel-119"><a href="#EconomicModel-119"><span class="linenos">119</span></a><span class="sd">    </span>
</span><span id="EconomicModel-120"><a href="#EconomicModel-120"><span class="linenos">120</span></a><span class="sd">    Based on CBO&#39;s approach to dynamic analysis.</span>
</span><span id="EconomicModel-121"><a href="#EconomicModel-121"><span class="linenos">121</span></a><span class="sd">    </span>
</span><span id="EconomicModel-122"><a href="#EconomicModel-122"><span class="linenos">122</span></a><span class="sd">    KEY IMPROVEMENT: Multipliers now vary with economic conditions.</span>
</span><span id="EconomicModel-123"><a href="#EconomicModel-123"><span class="linenos">123</span></a><span class="sd">    </span>
</span><span id="EconomicModel-124"><a href="#EconomicModel-124"><span class="linenos">124</span></a><span class="sd">    Multiplier estimates by condition (from empirical literature):</span>
</span><span id="EconomicModel-125"><a href="#EconomicModel-125"><span class="linenos">125</span></a><span class="sd">    - Normal times: Spending ~1.0, Tax cuts ~0.5</span>
</span><span id="EconomicModel-126"><a href="#EconomicModel-126"><span class="linenos">126</span></a><span class="sd">    - Recession: Spending ~1.5-2.0, Tax cuts ~0.8-1.0</span>
</span><span id="EconomicModel-127"><a href="#EconomicModel-127"><span class="linenos">127</span></a><span class="sd">    - At ZLB: Spending ~2.0+, Tax cuts ~1.0+</span>
</span><span id="EconomicModel-128"><a href="#EconomicModel-128"><span class="linenos">128</span></a><span class="sd">    - Overheating: Spending ~0.5, Tax cuts ~0.3 (crowding out dominates)</span>
</span><span id="EconomicModel-129"><a href="#EconomicModel-129"><span class="linenos">129</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="EconomicModel-130"><a href="#EconomicModel-130"><span class="linenos">130</span></a>    
</span><span id="EconomicModel-131"><a href="#EconomicModel-131"><span class="linenos">131</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineProjection</span><span class="p">,</span>
</span><span id="EconomicModel-132"><a href="#EconomicModel-132"><span class="linenos">132</span></a>                 <span class="n">conditions</span><span class="p">:</span> <span class="n">EconomicConditions</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="EconomicModel-133"><a href="#EconomicModel-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="n">baseline</span>
</span><span id="EconomicModel-134"><a href="#EconomicModel-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">years</span>
</span><span id="EconomicModel-135"><a href="#EconomicModel-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span> <span class="ow">or</span> <span class="n">EconomicConditions</span><span class="o">.</span><span class="n">normal_times</span><span class="p">()</span>
</span><span id="EconomicModel-136"><a href="#EconomicModel-136"><span class="linenos">136</span></a>        
</span><span id="EconomicModel-137"><a href="#EconomicModel-137"><span class="linenos">137</span></a>        <span class="c1"># Base parameters (adjusted by conditions below)</span>
</span><span id="EconomicModel-138"><a href="#EconomicModel-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_params</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EconomicModel-139"><a href="#EconomicModel-139"><span class="linenos">139</span></a>            <span class="c1"># Base multipliers (adjusted for conditions)</span>
</span><span id="EconomicModel-140"><a href="#EconomicModel-140"><span class="linenos">140</span></a>            <span class="s1">&#39;spending_multiplier_base&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="EconomicModel-141"><a href="#EconomicModel-141"><span class="linenos">141</span></a>            <span class="s1">&#39;tax_multiplier_base&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="EconomicModel-142"><a href="#EconomicModel-142"><span class="linenos">142</span></a>            <span class="s1">&#39;transfer_multiplier_base&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="EconomicModel-143"><a href="#EconomicModel-143"><span class="linenos">143</span></a>            <span class="s1">&#39;spending_multiplier_decay&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>  <span class="c1"># Annual decay rate</span>
</span><span id="EconomicModel-144"><a href="#EconomicModel-144"><span class="linenos">144</span></a>            
</span><span id="EconomicModel-145"><a href="#EconomicModel-145"><span class="linenos">145</span></a>            <span class="c1"># Supply-side elasticities</span>
</span><span id="EconomicModel-146"><a href="#EconomicModel-146"><span class="linenos">146</span></a>            <span class="s1">&#39;labor_supply_elasticity&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>  <span class="c1"># Compensated elasticity</span>
</span><span id="EconomicModel-147"><a href="#EconomicModel-147"><span class="linenos">147</span></a>            <span class="s1">&#39;capital_elasticity&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># Response of capital to after-tax return</span>
</span><span id="EconomicModel-148"><a href="#EconomicModel-148"><span class="linenos">148</span></a>            <span class="s1">&#39;eti&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># Elasticity of taxable income</span>
</span><span id="EconomicModel-149"><a href="#EconomicModel-149"><span class="linenos">149</span></a>            
</span><span id="EconomicModel-150"><a href="#EconomicModel-150"><span class="linenos">150</span></a>            <span class="c1"># Production function</span>
</span><span id="EconomicModel-151"><a href="#EconomicModel-151"><span class="linenos">151</span></a>            <span class="s1">&#39;labor_share&#39;</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>  <span class="c1"># Labor&#39;s share of output</span>
</span><span id="EconomicModel-152"><a href="#EconomicModel-152"><span class="linenos">152</span></a>            <span class="s1">&#39;capital_share&#39;</span><span class="p">:</span> <span class="mf">0.35</span><span class="p">,</span>  <span class="c1"># Capital&#39;s share</span>
</span><span id="EconomicModel-153"><a href="#EconomicModel-153"><span class="linenos">153</span></a>            <span class="s1">&#39;tfp_growth&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>  <span class="c1"># Annual TFP growth</span>
</span><span id="EconomicModel-154"><a href="#EconomicModel-154"><span class="linenos">154</span></a>            
</span><span id="EconomicModel-155"><a href="#EconomicModel-155"><span class="linenos">155</span></a>            <span class="c1"># Interest rate effects</span>
</span><span id="EconomicModel-156"><a href="#EconomicModel-156"><span class="linenos">156</span></a>            <span class="s1">&#39;crowding_out_base&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>  <span class="c1"># Interest rate increase per $100B deficit</span>
</span><span id="EconomicModel-157"><a href="#EconomicModel-157"><span class="linenos">157</span></a>            <span class="s1">&#39;investment_elasticity&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Response of investment to interest rates</span>
</span><span id="EconomicModel-158"><a href="#EconomicModel-158"><span class="linenos">158</span></a>            
</span><span id="EconomicModel-159"><a href="#EconomicModel-159"><span class="linenos">159</span></a>            <span class="c1"># Revenue feedback</span>
</span><span id="EconomicModel-160"><a href="#EconomicModel-160"><span class="linenos">160</span></a>            <span class="s1">&#39;marginal_revenue_rate&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># Avg marginal rate on additional income</span>
</span><span id="EconomicModel-161"><a href="#EconomicModel-161"><span class="linenos">161</span></a>        <span class="p">}</span>
</span><span id="EconomicModel-162"><a href="#EconomicModel-162"><span class="linenos">162</span></a>        
</span><span id="EconomicModel-163"><a href="#EconomicModel-163"><span class="linenos">163</span></a>        <span class="c1"># Apply condition adjustments</span>
</span><span id="EconomicModel-164"><a href="#EconomicModel-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_for_conditions</span><span class="p">()</span>
</span><span id="EconomicModel-165"><a href="#EconomicModel-165"><span class="linenos">165</span></a>    
</span><span id="EconomicModel-166"><a href="#EconomicModel-166"><span class="linenos">166</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_adjust_for_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel-167"><a href="#EconomicModel-167"><span class="linenos">167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EconomicModel-168"><a href="#EconomicModel-168"><span class="linenos">168</span></a><span class="sd">        Adjust model parameters based on economic conditions.</span>
</span><span id="EconomicModel-169"><a href="#EconomicModel-169"><span class="linenos">169</span></a><span class="sd">        </span>
</span><span id="EconomicModel-170"><a href="#EconomicModel-170"><span class="linenos">170</span></a><span class="sd">        Key relationships from empirical literature:</span>
</span><span id="EconomicModel-171"><a href="#EconomicModel-171"><span class="linenos">171</span></a><span class="sd">        1. Multipliers higher when output gap is negative (slack)</span>
</span><span id="EconomicModel-172"><a href="#EconomicModel-172"><span class="linenos">172</span></a><span class="sd">        2. Multipliers higher at ZLB (no monetary offset)</span>
</span><span id="EconomicModel-173"><a href="#EconomicModel-173"><span class="linenos">173</span></a><span class="sd">        3. Crowding out higher when debt is high</span>
</span><span id="EconomicModel-174"><a href="#EconomicModel-174"><span class="linenos">174</span></a><span class="sd">        4. Labor supply effects larger when unemployment is high</span>
</span><span id="EconomicModel-175"><a href="#EconomicModel-175"><span class="linenos">175</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EconomicModel-176"><a href="#EconomicModel-176"><span class="linenos">176</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="EconomicModel-177"><a href="#EconomicModel-177"><span class="linenos">177</span></a>        <span class="n">cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span>
</span><span id="EconomicModel-178"><a href="#EconomicModel-178"><span class="linenos">178</span></a>        
</span><span id="EconomicModel-179"><a href="#EconomicModel-179"><span class="linenos">179</span></a>        <span class="c1"># === MULTIPLIER ADJUSTMENTS ===</span>
</span><span id="EconomicModel-180"><a href="#EconomicModel-180"><span class="linenos">180</span></a>        
</span><span id="EconomicModel-181"><a href="#EconomicModel-181"><span class="linenos">181</span></a>        <span class="c1"># Output gap effect: Larger multipliers in recessions</span>
</span><span id="EconomicModel-182"><a href="#EconomicModel-182"><span class="linenos">182</span></a>        <span class="c1"># Based on Auerbach &amp; Gorodnichenko (2012)</span>
</span><span id="EconomicModel-183"><a href="#EconomicModel-183"><span class="linenos">183</span></a>        <span class="c1"># Multiplier ~1.5-2.0 in recessions vs ~0.5 in expansions</span>
</span><span id="EconomicModel-184"><a href="#EconomicModel-184"><span class="linenos">184</span></a>        <span class="k">if</span> <span class="n">cond</span><span class="o">.</span><span class="n">output_gap</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">:</span>
</span><span id="EconomicModel-185"><a href="#EconomicModel-185"><span class="linenos">185</span></a>            <span class="c1"># Deep recession: big multiplier boost</span>
</span><span id="EconomicModel-186"><a href="#EconomicModel-186"><span class="linenos">186</span></a>            <span class="n">gap_adjustment</span> <span class="o">=</span> <span class="mf">1.5</span>
</span><span id="EconomicModel-187"><a href="#EconomicModel-187"><span class="linenos">187</span></a>        <span class="k">elif</span> <span class="n">cond</span><span class="o">.</span><span class="n">output_gap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EconomicModel-188"><a href="#EconomicModel-188"><span class="linenos">188</span></a>            <span class="c1"># Mild recession: moderate boost</span>
</span><span id="EconomicModel-189"><a href="#EconomicModel-189"><span class="linenos">189</span></a>            <span class="n">gap_adjustment</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">output_gap</span><span class="p">)</span> <span class="o">*</span> <span class="mi">15</span>  <span class="c1"># scales up to 1.3</span>
</span><span id="EconomicModel-190"><a href="#EconomicModel-190"><span class="linenos">190</span></a>        <span class="k">elif</span> <span class="n">cond</span><span class="o">.</span><span class="n">output_gap</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
</span><span id="EconomicModel-191"><a href="#EconomicModel-191"><span class="linenos">191</span></a>            <span class="c1"># Overheating: reduced multipliers (crowding out)</span>
</span><span id="EconomicModel-192"><a href="#EconomicModel-192"><span class="linenos">192</span></a>            <span class="n">gap_adjustment</span> <span class="o">=</span> <span class="mf">0.7</span>
</span><span id="EconomicModel-193"><a href="#EconomicModel-193"><span class="linenos">193</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EconomicModel-194"><a href="#EconomicModel-194"><span class="linenos">194</span></a>            <span class="c1"># Normal: baseline</span>
</span><span id="EconomicModel-195"><a href="#EconomicModel-195"><span class="linenos">195</span></a>            <span class="n">gap_adjustment</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="EconomicModel-196"><a href="#EconomicModel-196"><span class="linenos">196</span></a>        
</span><span id="EconomicModel-197"><a href="#EconomicModel-197"><span class="linenos">197</span></a>        <span class="c1"># ZLB effect: No monetary offset when at zero lower bound</span>
</span><span id="EconomicModel-198"><a href="#EconomicModel-198"><span class="linenos">198</span></a>        <span class="c1"># Christiano et al. (2011): Multiplier can be 2-3x higher at ZLB</span>
</span><span id="EconomicModel-199"><a href="#EconomicModel-199"><span class="linenos">199</span></a>        <span class="n">zlb_adjustment</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="k">if</span> <span class="n">cond</span><span class="o">.</span><span class="n">at_zlb</span> <span class="k">else</span> <span class="mf">1.0</span>
</span><span id="EconomicModel-200"><a href="#EconomicModel-200"><span class="linenos">200</span></a>        
</span><span id="EconomicModel-201"><a href="#EconomicModel-201"><span class="linenos">201</span></a>        <span class="c1"># High debt reduces multiplier (Ricardian concerns, interest rates)</span>
</span><span id="EconomicModel-202"><a href="#EconomicModel-202"><span class="linenos">202</span></a>        <span class="n">debt_adjustment</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">debt_to_gdp</span> <span class="o">-</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
</span><span id="EconomicModel-203"><a href="#EconomicModel-203"><span class="linenos">203</span></a>        
</span><span id="EconomicModel-204"><a href="#EconomicModel-204"><span class="linenos">204</span></a>        <span class="c1"># Combined adjustment</span>
</span><span id="EconomicModel-205"><a href="#EconomicModel-205"><span class="linenos">205</span></a>        <span class="n">total_adjustment</span> <span class="o">=</span> <span class="n">gap_adjustment</span> <span class="o">*</span> <span class="n">zlb_adjustment</span> <span class="o">*</span> <span class="n">debt_adjustment</span>
</span><span id="EconomicModel-206"><a href="#EconomicModel-206"><span class="linenos">206</span></a>        
</span><span id="EconomicModel-207"><a href="#EconomicModel-207"><span class="linenos">207</span></a>        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;spending_multiplier_peak&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EconomicModel-208"><a href="#EconomicModel-208"><span class="linenos">208</span></a>            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;spending_multiplier_base&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_adjustment</span>
</span><span id="EconomicModel-209"><a href="#EconomicModel-209"><span class="linenos">209</span></a>        <span class="p">)</span>
</span><span id="EconomicModel-210"><a href="#EconomicModel-210"><span class="linenos">210</span></a>        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;tax_multiplier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EconomicModel-211"><a href="#EconomicModel-211"><span class="linenos">211</span></a>            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;tax_multiplier_base&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_adjustment</span>
</span><span id="EconomicModel-212"><a href="#EconomicModel-212"><span class="linenos">212</span></a>        <span class="p">)</span>
</span><span id="EconomicModel-213"><a href="#EconomicModel-213"><span class="linenos">213</span></a>        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;transfer_multiplier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="EconomicModel-214"><a href="#EconomicModel-214"><span class="linenos">214</span></a>            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;transfer_multiplier_base&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_adjustment</span>
</span><span id="EconomicModel-215"><a href="#EconomicModel-215"><span class="linenos">215</span></a>        <span class="p">)</span>
</span><span id="EconomicModel-216"><a href="#EconomicModel-216"><span class="linenos">216</span></a>        
</span><span id="EconomicModel-217"><a href="#EconomicModel-217"><span class="linenos">217</span></a>        <span class="c1"># === CROWDING OUT ADJUSTMENTS ===</span>
</span><span id="EconomicModel-218"><a href="#EconomicModel-218"><span class="linenos">218</span></a>        <span class="c1"># Higher when debt is high, lower at ZLB</span>
</span><span id="EconomicModel-219"><a href="#EconomicModel-219"><span class="linenos">219</span></a>        <span class="n">crowding_base</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;crowding_out_base&#39;</span><span class="p">]</span>
</span><span id="EconomicModel-220"><a href="#EconomicModel-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">cond</span><span class="o">.</span><span class="n">at_zlb</span><span class="p">:</span>
</span><span id="EconomicModel-221"><a href="#EconomicModel-221"><span class="linenos">221</span></a>            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;crowding_out&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crowding_base</span> <span class="o">*</span> <span class="mf">0.3</span>  <span class="c1"># Much less crowding out at ZLB</span>
</span><span id="EconomicModel-222"><a href="#EconomicModel-222"><span class="linenos">222</span></a>        <span class="k">elif</span> <span class="n">cond</span><span class="o">.</span><span class="n">debt_to_gdp</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
</span><span id="EconomicModel-223"><a href="#EconomicModel-223"><span class="linenos">223</span></a>            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;crowding_out&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crowding_base</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">debt_to_gdp</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span>
</span><span id="EconomicModel-224"><a href="#EconomicModel-224"><span class="linenos">224</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EconomicModel-225"><a href="#EconomicModel-225"><span class="linenos">225</span></a>            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;crowding_out&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crowding_base</span>
</span><span id="EconomicModel-226"><a href="#EconomicModel-226"><span class="linenos">226</span></a>        
</span><span id="EconomicModel-227"><a href="#EconomicModel-227"><span class="linenos">227</span></a>        <span class="k">return</span> <span class="n">params</span>
</span><span id="EconomicModel-228"><a href="#EconomicModel-228"><span class="linenos">228</span></a>    
</span><span id="EconomicModel-229"><a href="#EconomicModel-229"><span class="linenos">229</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conditions</span><span class="p">:</span> <span class="n">EconomicConditions</span><span class="p">):</span>
</span><span id="EconomicModel-230"><a href="#EconomicModel-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update economic conditions and recalculate parameters.&quot;&quot;&quot;</span>
</span><span id="EconomicModel-231"><a href="#EconomicModel-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span>
</span><span id="EconomicModel-232"><a href="#EconomicModel-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_for_conditions</span><span class="p">()</span>
</span><span id="EconomicModel-233"><a href="#EconomicModel-233"><span class="linenos">233</span></a>    
</span><span id="EconomicModel-234"><a href="#EconomicModel-234"><span class="linenos">234</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_multiplier_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel-235"><a href="#EconomicModel-235"><span class="linenos">235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return current effective multipliers for documentation.&quot;&quot;&quot;</span>
</span><span id="EconomicModel-236"><a href="#EconomicModel-236"><span class="linenos">236</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="EconomicModel-237"><a href="#EconomicModel-237"><span class="linenos">237</span></a>            <span class="s1">&#39;spending_multiplier&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;spending_multiplier_peak&#39;</span><span class="p">],</span>
</span><span id="EconomicModel-238"><a href="#EconomicModel-238"><span class="linenos">238</span></a>            <span class="s1">&#39;tax_multiplier&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;tax_multiplier&#39;</span><span class="p">],</span>
</span><span id="EconomicModel-239"><a href="#EconomicModel-239"><span class="linenos">239</span></a>            <span class="s1">&#39;transfer_multiplier&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;transfer_multiplier&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
</span><span id="EconomicModel-240"><a href="#EconomicModel-240"><span class="linenos">240</span></a>            <span class="s1">&#39;conditions&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="EconomicModel-241"><a href="#EconomicModel-241"><span class="linenos">241</span></a>                <span class="s1">&#39;output_gap&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="o">.</span><span class="n">output_gap</span><span class="p">,</span>
</span><span id="EconomicModel-242"><a href="#EconomicModel-242"><span class="linenos">242</span></a>                <span class="s1">&#39;at_zlb&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="o">.</span><span class="n">at_zlb</span><span class="p">,</span>
</span><span id="EconomicModel-243"><a href="#EconomicModel-243"><span class="linenos">243</span></a>                <span class="s1">&#39;debt_to_gdp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="o">.</span><span class="n">debt_to_gdp</span><span class="p">,</span>
</span><span id="EconomicModel-244"><a href="#EconomicModel-244"><span class="linenos">244</span></a>            <span class="p">}</span>
</span><span id="EconomicModel-245"><a href="#EconomicModel-245"><span class="linenos">245</span></a>        <span class="p">}</span>
</span><span id="EconomicModel-246"><a href="#EconomicModel-246"><span class="linenos">246</span></a>    
</span><span id="EconomicModel-247"><a href="#EconomicModel-247"><span class="linenos">247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span> 
</span><span id="EconomicModel-248"><a href="#EconomicModel-248"><span class="linenos">248</span></a>                         <span class="n">static_budget_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DynamicEffects</span><span class="p">:</span>
</span><span id="EconomicModel-249"><a href="#EconomicModel-249"><span class="linenos">249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EconomicModel-250"><a href="#EconomicModel-250"><span class="linenos">250</span></a><span class="sd">        Calculate dynamic economic effects of a policy.</span>
</span><span id="EconomicModel-251"><a href="#EconomicModel-251"><span class="linenos">251</span></a><span class="sd">        </span>
</span><span id="EconomicModel-252"><a href="#EconomicModel-252"><span class="linenos">252</span></a><span class="sd">        Args:</span>
</span><span id="EconomicModel-253"><a href="#EconomicModel-253"><span class="linenos">253</span></a><span class="sd">            policy: The policy being analyzed</span>
</span><span id="EconomicModel-254"><a href="#EconomicModel-254"><span class="linenos">254</span></a><span class="sd">            static_budget_effect: Static budget effect by year (billions, positive = costs)</span>
</span><span id="EconomicModel-255"><a href="#EconomicModel-255"><span class="linenos">255</span></a><span class="sd">            </span>
</span><span id="EconomicModel-256"><a href="#EconomicModel-256"><span class="linenos">256</span></a><span class="sd">        Returns:</span>
</span><span id="EconomicModel-257"><a href="#EconomicModel-257"><span class="linenos">257</span></a><span class="sd">            DynamicEffects container with all calculated effects</span>
</span><span id="EconomicModel-258"><a href="#EconomicModel-258"><span class="linenos">258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EconomicModel-259"><a href="#EconomicModel-259"><span class="linenos">259</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="EconomicModel-260"><a href="#EconomicModel-260"><span class="linenos">260</span></a>        
</span><span id="EconomicModel-261"><a href="#EconomicModel-261"><span class="linenos">261</span></a>        <span class="c1"># Initialize effect arrays</span>
</span><span id="EconomicModel-262"><a href="#EconomicModel-262"><span class="linenos">262</span></a>        <span class="n">gdp_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-263"><a href="#EconomicModel-263"><span class="linenos">263</span></a>        <span class="n">gdp_pct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-264"><a href="#EconomicModel-264"><span class="linenos">264</span></a>        <span class="n">employment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-265"><a href="#EconomicModel-265"><span class="linenos">265</span></a>        <span class="n">hours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-266"><a href="#EconomicModel-266"><span class="linenos">266</span></a>        <span class="n">labor_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-267"><a href="#EconomicModel-267"><span class="linenos">267</span></a>        <span class="n">capital</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-268"><a href="#EconomicModel-268"><span class="linenos">268</span></a>        <span class="n">investment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-269"><a href="#EconomicModel-269"><span class="linenos">269</span></a>        <span class="n">interest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-270"><a href="#EconomicModel-270"><span class="linenos">270</span></a>        <span class="n">revenue_fb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-271"><a href="#EconomicModel-271"><span class="linenos">271</span></a>        
</span><span id="EconomicModel-272"><a href="#EconomicModel-272"><span class="linenos">272</span></a>        <span class="c1"># Calculate effects based on policy type</span>
</span><span id="EconomicModel-273"><a href="#EconomicModel-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="EconomicModel-274"><a href="#EconomicModel-274"><span class="linenos">274</span></a>            <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tax_policy_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">static_budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel-275"><a href="#EconomicModel-275"><span class="linenos">275</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">SpendingPolicy</span><span class="p">):</span>
</span><span id="EconomicModel-276"><a href="#EconomicModel-276"><span class="linenos">276</span></a>            <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spending_policy_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">static_budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel-277"><a href="#EconomicModel-277"><span class="linenos">277</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TransferPolicy</span><span class="p">):</span>
</span><span id="EconomicModel-278"><a href="#EconomicModel-278"><span class="linenos">278</span></a>            <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_policy_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">static_budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel-279"><a href="#EconomicModel-279"><span class="linenos">279</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EconomicModel-280"><a href="#EconomicModel-280"><span class="linenos">280</span></a>            <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_policy_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">static_budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel-281"><a href="#EconomicModel-281"><span class="linenos">281</span></a>        
</span><span id="EconomicModel-282"><a href="#EconomicModel-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">DynamicEffects</span><span class="p">(</span>
</span><span id="EconomicModel-283"><a href="#EconomicModel-283"><span class="linenos">283</span></a>            <span class="n">years</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="EconomicModel-284"><a href="#EconomicModel-284"><span class="linenos">284</span></a>            <span class="o">**</span><span class="n">effects</span>
</span><span id="EconomicModel-285"><a href="#EconomicModel-285"><span class="linenos">285</span></a>        <span class="p">)</span>
</span><span id="EconomicModel-286"><a href="#EconomicModel-286"><span class="linenos">286</span></a>    
</span><span id="EconomicModel-287"><a href="#EconomicModel-287"><span class="linenos">287</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_tax_policy_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">TaxPolicy</span><span class="p">,</span> 
</span><span id="EconomicModel-288"><a href="#EconomicModel-288"><span class="linenos">288</span></a>                           <span class="n">budget_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel-289"><a href="#EconomicModel-289"><span class="linenos">289</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate effects of tax policy changes.&quot;&quot;&quot;</span>
</span><span id="EconomicModel-290"><a href="#EconomicModel-290"><span class="linenos">290</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="EconomicModel-291"><a href="#EconomicModel-291"><span class="linenos">291</span></a>        
</span><span id="EconomicModel-292"><a href="#EconomicModel-292"><span class="linenos">292</span></a>        <span class="c1"># Determine if tax cut or tax increase</span>
</span><span id="EconomicModel-293"><a href="#EconomicModel-293"><span class="linenos">293</span></a>        <span class="n">is_tax_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">budget_effect</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
</span><span id="EconomicModel-294"><a href="#EconomicModel-294"><span class="linenos">294</span></a>        
</span><span id="EconomicModel-295"><a href="#EconomicModel-295"><span class="linenos">295</span></a>        <span class="c1"># Labor supply effects (supply-side)</span>
</span><span id="EconomicModel-296"><a href="#EconomicModel-296"><span class="linenos">296</span></a>        <span class="n">labor_effect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-297"><a href="#EconomicModel-297"><span class="linenos">297</span></a>        <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EconomicModel-298"><a href="#EconomicModel-298"><span class="linenos">298</span></a>            <span class="c1"># Marginal rate change affects labor supply</span>
</span><span id="EconomicModel-299"><a href="#EconomicModel-299"><span class="linenos">299</span></a>            <span class="c1"># Uncompensated elasticity is small/negative, compensated is positive</span>
</span><span id="EconomicModel-300"><a href="#EconomicModel-300"><span class="linenos">300</span></a>            <span class="n">marginal_rate_change</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">rate_change</span>
</span><span id="EconomicModel-301"><a href="#EconomicModel-301"><span class="linenos">301</span></a>            <span class="n">labor_effect</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">marginal_rate_change</span> <span class="o">*</span> 
</span><span id="EconomicModel-302"><a href="#EconomicModel-302"><span class="linenos">302</span></a>                           <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;labor_supply_elasticity&#39;</span><span class="p">]</span> <span class="o">*</span> 
</span><span id="EconomicModel-303"><a href="#EconomicModel-303"><span class="linenos">303</span></a>                           <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_years</span><span class="p">))</span>
</span><span id="EconomicModel-304"><a href="#EconomicModel-304"><span class="linenos">304</span></a>        
</span><span id="EconomicModel-305"><a href="#EconomicModel-305"><span class="linenos">305</span></a>        <span class="c1"># Demand effects (short-run)</span>
</span><span id="EconomicModel-306"><a href="#EconomicModel-306"><span class="linenos">306</span></a>        <span class="n">demand_effect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-307"><a href="#EconomicModel-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="n">is_tax_cut</span><span class="p">:</span>
</span><span id="EconomicModel-308"><a href="#EconomicModel-308"><span class="linenos">308</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">):</span>
</span><span id="EconomicModel-309"><a href="#EconomicModel-309"><span class="linenos">309</span></a>                <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="EconomicModel-310"><a href="#EconomicModel-310"><span class="linenos">310</span></a>                    <span class="n">phase</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_phase_in_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="EconomicModel-311"><a href="#EconomicModel-311"><span class="linenos">311</span></a>                    <span class="c1"># Decaying multiplier effect</span>
</span><span id="EconomicModel-312"><a href="#EconomicModel-312"><span class="linenos">312</span></a>                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="EconomicModel-313"><a href="#EconomicModel-313"><span class="linenos">313</span></a>                        <span class="n">decay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;spending_multiplier_decay&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
</span><span id="EconomicModel-314"><a href="#EconomicModel-314"><span class="linenos">314</span></a>                        <span class="n">demand_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="n">budget_effect</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> 
</span><span id="EconomicModel-315"><a href="#EconomicModel-315"><span class="linenos">315</span></a>                                            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;tax_multiplier&#39;</span><span class="p">]</span> <span class="o">*</span> 
</span><span id="EconomicModel-316"><a href="#EconomicModel-316"><span class="linenos">316</span></a>                                            <span class="n">decay</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
</span><span id="EconomicModel-317"><a href="#EconomicModel-317"><span class="linenos">317</span></a>        
</span><span id="EconomicModel-318"><a href="#EconomicModel-318"><span class="linenos">318</span></a>        <span class="c1"># Total GDP effect</span>
</span><span id="EconomicModel-319"><a href="#EconomicModel-319"><span class="linenos">319</span></a>        <span class="n">gdp_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-320"><a href="#EconomicModel-320"><span class="linenos">320</span></a>        <span class="n">gdp_pct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-321"><a href="#EconomicModel-321"><span class="linenos">321</span></a>        
</span><span id="EconomicModel-322"><a href="#EconomicModel-322"><span class="linenos">322</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">):</span>
</span><span id="EconomicModel-323"><a href="#EconomicModel-323"><span class="linenos">323</span></a>            <span class="c1"># Short-run: demand effects dominate</span>
</span><span id="EconomicModel-324"><a href="#EconomicModel-324"><span class="linenos">324</span></a>            <span class="c1"># Long-run: supply effects matter more</span>
</span><span id="EconomicModel-325"><a href="#EconomicModel-325"><span class="linenos">325</span></a>            <span class="n">weight_demand</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>  <span class="c1"># Decay demand importance</span>
</span><span id="EconomicModel-326"><a href="#EconomicModel-326"><span class="linenos">326</span></a>            <span class="n">weight_supply</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">weight_demand</span>
</span><span id="EconomicModel-327"><a href="#EconomicModel-327"><span class="linenos">327</span></a>            
</span><span id="EconomicModel-328"><a href="#EconomicModel-328"><span class="linenos">328</span></a>            <span class="n">supply_gdp</span> <span class="o">=</span> <span class="n">labor_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="EconomicModel-329"><a href="#EconomicModel-329"><span class="linenos">329</span></a>            <span class="n">demand_gdp</span> <span class="o">=</span> <span class="n">demand_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="EconomicModel-330"><a href="#EconomicModel-330"><span class="linenos">330</span></a>            
</span><span id="EconomicModel-331"><a href="#EconomicModel-331"><span class="linenos">331</span></a>            <span class="n">gdp_level</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight_demand</span> <span class="o">*</span> <span class="n">demand_gdp</span> <span class="o">+</span> <span class="n">weight_supply</span> <span class="o">*</span> <span class="n">supply_gdp</span>
</span><span id="EconomicModel-332"><a href="#EconomicModel-332"><span class="linenos">332</span></a>            <span class="n">gdp_pct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_level</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="EconomicModel-333"><a href="#EconomicModel-333"><span class="linenos">333</span></a>        
</span><span id="EconomicModel-334"><a href="#EconomicModel-334"><span class="linenos">334</span></a>        <span class="c1"># Employment effects</span>
</span><span id="EconomicModel-335"><a href="#EconomicModel-335"><span class="linenos">335</span></a>        <span class="n">employment</span> <span class="o">=</span> <span class="n">gdp_pct</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="mi">150000</span>  <span class="c1"># Rough: 1% GDP = 1.5M jobs</span>
</span><span id="EconomicModel-336"><a href="#EconomicModel-336"><span class="linenos">336</span></a>        <span class="n">hours</span> <span class="o">=</span> <span class="n">labor_effect</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># Convert to percent</span>
</span><span id="EconomicModel-337"><a href="#EconomicModel-337"><span class="linenos">337</span></a>        
</span><span id="EconomicModel-338"><a href="#EconomicModel-338"><span class="linenos">338</span></a>        <span class="c1"># Capital effects (long-run)</span>
</span><span id="EconomicModel-339"><a href="#EconomicModel-339"><span class="linenos">339</span></a>        <span class="n">capital</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-340"><a href="#EconomicModel-340"><span class="linenos">340</span></a>        <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span><span class="p">,</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">CAPITAL_GAINS_TAX</span><span class="p">]:</span>
</span><span id="EconomicModel-341"><a href="#EconomicModel-341"><span class="linenos">341</span></a>            <span class="c1"># Corporate/capital gains tax affects investment</span>
</span><span id="EconomicModel-342"><a href="#EconomicModel-342"><span class="linenos">342</span></a>            <span class="n">after_tax_return_change</span> <span class="o">=</span> <span class="o">-</span><span class="n">policy</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">*</span> <span class="mf">0.5</span>
</span><span id="EconomicModel-343"><a href="#EconomicModel-343"><span class="linenos">343</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">):</span>
</span><span id="EconomicModel-344"><a href="#EconomicModel-344"><span class="linenos">344</span></a>                <span class="n">capital</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">after_tax_return_change</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;capital_elasticity&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span>
</span><span id="EconomicModel-345"><a href="#EconomicModel-345"><span class="linenos">345</span></a>        
</span><span id="EconomicModel-346"><a href="#EconomicModel-346"><span class="linenos">346</span></a>        <span class="n">investment</span> <span class="o">=</span> <span class="n">capital</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mf">0.18</span>  <span class="c1"># Investment ~18% of GDP</span>
</span><span id="EconomicModel-347"><a href="#EconomicModel-347"><span class="linenos">347</span></a>        
</span><span id="EconomicModel-348"><a href="#EconomicModel-348"><span class="linenos">348</span></a>        <span class="c1"># Interest rate effects (crowding out)</span>
</span><span id="EconomicModel-349"><a href="#EconomicModel-349"><span class="linenos">349</span></a>        <span class="n">cumulative_deficit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel-350"><a href="#EconomicModel-350"><span class="linenos">350</span></a>        <span class="n">interest_change</span> <span class="o">=</span> <span class="o">-</span><span class="n">cumulative_deficit</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;crowding_out&#39;</span><span class="p">]</span>
</span><span id="EconomicModel-351"><a href="#EconomicModel-351"><span class="linenos">351</span></a>        
</span><span id="EconomicModel-352"><a href="#EconomicModel-352"><span class="linenos">352</span></a>        <span class="c1"># Revenue feedback</span>
</span><span id="EconomicModel-353"><a href="#EconomicModel-353"><span class="linenos">353</span></a>        <span class="n">revenue_fb</span> <span class="o">=</span> <span class="n">gdp_level</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;marginal_revenue_rate&#39;</span><span class="p">]</span>
</span><span id="EconomicModel-354"><a href="#EconomicModel-354"><span class="linenos">354</span></a>        
</span><span id="EconomicModel-355"><a href="#EconomicModel-355"><span class="linenos">355</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="EconomicModel-356"><a href="#EconomicModel-356"><span class="linenos">356</span></a>            <span class="s1">&#39;gdp_level_change&#39;</span><span class="p">:</span> <span class="n">gdp_level</span><span class="p">,</span>
</span><span id="EconomicModel-357"><a href="#EconomicModel-357"><span class="linenos">357</span></a>            <span class="s1">&#39;gdp_percent_change&#39;</span><span class="p">:</span> <span class="n">gdp_pct</span><span class="p">,</span>
</span><span id="EconomicModel-358"><a href="#EconomicModel-358"><span class="linenos">358</span></a>            <span class="s1">&#39;employment_change&#39;</span><span class="p">:</span> <span class="n">employment</span><span class="p">,</span>
</span><span id="EconomicModel-359"><a href="#EconomicModel-359"><span class="linenos">359</span></a>            <span class="s1">&#39;hours_worked_change&#39;</span><span class="p">:</span> <span class="n">hours</span><span class="p">,</span>
</span><span id="EconomicModel-360"><a href="#EconomicModel-360"><span class="linenos">360</span></a>            <span class="s1">&#39;labor_force_change&#39;</span><span class="p">:</span> <span class="n">labor_effect</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="EconomicModel-361"><a href="#EconomicModel-361"><span class="linenos">361</span></a>            <span class="s1">&#39;capital_stock_change&#39;</span><span class="p">:</span> <span class="n">capital</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="EconomicModel-362"><a href="#EconomicModel-362"><span class="linenos">362</span></a>            <span class="s1">&#39;investment_change&#39;</span><span class="p">:</span> <span class="n">investment</span><span class="p">,</span>
</span><span id="EconomicModel-363"><a href="#EconomicModel-363"><span class="linenos">363</span></a>            <span class="s1">&#39;interest_rate_change&#39;</span><span class="p">:</span> <span class="n">interest_change</span><span class="p">,</span>
</span><span id="EconomicModel-364"><a href="#EconomicModel-364"><span class="linenos">364</span></a>            <span class="s1">&#39;revenue_feedback&#39;</span><span class="p">:</span> <span class="n">revenue_fb</span><span class="p">,</span>
</span><span id="EconomicModel-365"><a href="#EconomicModel-365"><span class="linenos">365</span></a>        <span class="p">}</span>
</span><span id="EconomicModel-366"><a href="#EconomicModel-366"><span class="linenos">366</span></a>    
</span><span id="EconomicModel-367"><a href="#EconomicModel-367"><span class="linenos">367</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_spending_policy_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">SpendingPolicy</span><span class="p">,</span>
</span><span id="EconomicModel-368"><a href="#EconomicModel-368"><span class="linenos">368</span></a>                                <span class="n">budget_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel-369"><a href="#EconomicModel-369"><span class="linenos">369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate effects of spending policy changes.&quot;&quot;&quot;</span>
</span><span id="EconomicModel-370"><a href="#EconomicModel-370"><span class="linenos">370</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="EconomicModel-371"><a href="#EconomicModel-371"><span class="linenos">371</span></a>        
</span><span id="EconomicModel-372"><a href="#EconomicModel-372"><span class="linenos">372</span></a>        <span class="c1"># Fiscal multiplier effects (demand)</span>
</span><span id="EconomicModel-373"><a href="#EconomicModel-373"><span class="linenos">373</span></a>        <span class="n">gdp_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-374"><a href="#EconomicModel-374"><span class="linenos">374</span></a>        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">gdp_multiplier</span>
</span><span id="EconomicModel-375"><a href="#EconomicModel-375"><span class="linenos">375</span></a>        
</span><span id="EconomicModel-376"><a href="#EconomicModel-376"><span class="linenos">376</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">):</span>
</span><span id="EconomicModel-377"><a href="#EconomicModel-377"><span class="linenos">377</span></a>            <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="EconomicModel-378"><a href="#EconomicModel-378"><span class="linenos">378</span></a>                <span class="n">phase</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_phase_in_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="EconomicModel-379"><a href="#EconomicModel-379"><span class="linenos">379</span></a>                <span class="c1"># Apply multiplier with decay</span>
</span><span id="EconomicModel-380"><a href="#EconomicModel-380"><span class="linenos">380</span></a>                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="EconomicModel-381"><a href="#EconomicModel-381"><span class="linenos">381</span></a>                    <span class="n">decay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;spending_multiplier_decay&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
</span><span id="EconomicModel-382"><a href="#EconomicModel-382"><span class="linenos">382</span></a>                    <span class="n">gdp_level</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">budget_effect</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="n">decay</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
</span><span id="EconomicModel-383"><a href="#EconomicModel-383"><span class="linenos">383</span></a>        
</span><span id="EconomicModel-384"><a href="#EconomicModel-384"><span class="linenos">384</span></a>        <span class="n">gdp_pct</span> <span class="o">=</span> <span class="n">gdp_level</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="EconomicModel-385"><a href="#EconomicModel-385"><span class="linenos">385</span></a>        
</span><span id="EconomicModel-386"><a href="#EconomicModel-386"><span class="linenos">386</span></a>        <span class="c1"># Employment from spending</span>
</span><span id="EconomicModel-387"><a href="#EconomicModel-387"><span class="linenos">387</span></a>        <span class="n">employment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-388"><a href="#EconomicModel-388"><span class="linenos">388</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">):</span>
</span><span id="EconomicModel-389"><a href="#EconomicModel-389"><span class="linenos">389</span></a>            <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="EconomicModel-390"><a href="#EconomicModel-390"><span class="linenos">390</span></a>                <span class="n">employment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">budget_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> 
</span><span id="EconomicModel-391"><a href="#EconomicModel-391"><span class="linenos">391</span></a>                               <span class="n">policy</span><span class="o">.</span><span class="n">employment_per_billion</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># In thousands</span>
</span><span id="EconomicModel-392"><a href="#EconomicModel-392"><span class="linenos">392</span></a>        
</span><span id="EconomicModel-393"><a href="#EconomicModel-393"><span class="linenos">393</span></a>        <span class="c1"># Long-run effects (crowding out)</span>
</span><span id="EconomicModel-394"><a href="#EconomicModel-394"><span class="linenos">394</span></a>        <span class="n">cumulative_deficit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel-395"><a href="#EconomicModel-395"><span class="linenos">395</span></a>        <span class="n">interest_change</span> <span class="o">=</span> <span class="n">cumulative_deficit</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;crowding_out&#39;</span><span class="p">]</span>
</span><span id="EconomicModel-396"><a href="#EconomicModel-396"><span class="linenos">396</span></a>        
</span><span id="EconomicModel-397"><a href="#EconomicModel-397"><span class="linenos">397</span></a>        <span class="c1"># Crowding out of private investment</span>
</span><span id="EconomicModel-398"><a href="#EconomicModel-398"><span class="linenos">398</span></a>        <span class="n">investment_effect</span> <span class="o">=</span> <span class="p">(</span><span class="n">interest_change</span> <span class="o">*</span> 
</span><span id="EconomicModel-399"><a href="#EconomicModel-399"><span class="linenos">399</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;investment_elasticity&#39;</span><span class="p">]</span> <span class="o">*</span> 
</span><span id="EconomicModel-400"><a href="#EconomicModel-400"><span class="linenos">400</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mf">0.18</span><span class="p">)</span>
</span><span id="EconomicModel-401"><a href="#EconomicModel-401"><span class="linenos">401</span></a>        
</span><span id="EconomicModel-402"><a href="#EconomicModel-402"><span class="linenos">402</span></a>        <span class="c1"># Adjust GDP for crowding out</span>
</span><span id="EconomicModel-403"><a href="#EconomicModel-403"><span class="linenos">403</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_years</span><span class="p">):</span>
</span><span id="EconomicModel-404"><a href="#EconomicModel-404"><span class="linenos">404</span></a>            <span class="n">gdp_level</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">investment_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.5</span>  <span class="c1"># Partial offset</span>
</span><span id="EconomicModel-405"><a href="#EconomicModel-405"><span class="linenos">405</span></a>        
</span><span id="EconomicModel-406"><a href="#EconomicModel-406"><span class="linenos">406</span></a>        <span class="n">gdp_pct</span> <span class="o">=</span> <span class="n">gdp_level</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="EconomicModel-407"><a href="#EconomicModel-407"><span class="linenos">407</span></a>        
</span><span id="EconomicModel-408"><a href="#EconomicModel-408"><span class="linenos">408</span></a>        <span class="c1"># Revenue feedback</span>
</span><span id="EconomicModel-409"><a href="#EconomicModel-409"><span class="linenos">409</span></a>        <span class="n">revenue_fb</span> <span class="o">=</span> <span class="n">gdp_level</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;marginal_revenue_rate&#39;</span><span class="p">]</span>
</span><span id="EconomicModel-410"><a href="#EconomicModel-410"><span class="linenos">410</span></a>        
</span><span id="EconomicModel-411"><a href="#EconomicModel-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="EconomicModel-412"><a href="#EconomicModel-412"><span class="linenos">412</span></a>            <span class="s1">&#39;gdp_level_change&#39;</span><span class="p">:</span> <span class="n">gdp_level</span><span class="p">,</span>
</span><span id="EconomicModel-413"><a href="#EconomicModel-413"><span class="linenos">413</span></a>            <span class="s1">&#39;gdp_percent_change&#39;</span><span class="p">:</span> <span class="n">gdp_pct</span><span class="p">,</span>
</span><span id="EconomicModel-414"><a href="#EconomicModel-414"><span class="linenos">414</span></a>            <span class="s1">&#39;employment_change&#39;</span><span class="p">:</span> <span class="n">employment</span><span class="p">,</span>
</span><span id="EconomicModel-415"><a href="#EconomicModel-415"><span class="linenos">415</span></a>            <span class="s1">&#39;hours_worked_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="EconomicModel-416"><a href="#EconomicModel-416"><span class="linenos">416</span></a>            <span class="s1">&#39;labor_force_change&#39;</span><span class="p">:</span> <span class="n">employment</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span>  <span class="c1"># Small LFP effect</span>
</span><span id="EconomicModel-417"><a href="#EconomicModel-417"><span class="linenos">417</span></a>            <span class="s1">&#39;capital_stock_change&#39;</span><span class="p">:</span> <span class="n">interest_change</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;investment_elasticity&#39;</span><span class="p">],</span>
</span><span id="EconomicModel-418"><a href="#EconomicModel-418"><span class="linenos">418</span></a>            <span class="s1">&#39;investment_change&#39;</span><span class="p">:</span> <span class="n">investment_effect</span><span class="p">,</span>
</span><span id="EconomicModel-419"><a href="#EconomicModel-419"><span class="linenos">419</span></a>            <span class="s1">&#39;interest_rate_change&#39;</span><span class="p">:</span> <span class="n">interest_change</span><span class="p">,</span>
</span><span id="EconomicModel-420"><a href="#EconomicModel-420"><span class="linenos">420</span></a>            <span class="s1">&#39;revenue_feedback&#39;</span><span class="p">:</span> <span class="n">revenue_fb</span><span class="p">,</span>
</span><span id="EconomicModel-421"><a href="#EconomicModel-421"><span class="linenos">421</span></a>        <span class="p">}</span>
</span><span id="EconomicModel-422"><a href="#EconomicModel-422"><span class="linenos">422</span></a>    
</span><span id="EconomicModel-423"><a href="#EconomicModel-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_transfer_policy_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">TransferPolicy</span><span class="p">,</span>
</span><span id="EconomicModel-424"><a href="#EconomicModel-424"><span class="linenos">424</span></a>                                <span class="n">budget_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel-425"><a href="#EconomicModel-425"><span class="linenos">425</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate effects of transfer policy changes.&quot;&quot;&quot;</span>
</span><span id="EconomicModel-426"><a href="#EconomicModel-426"><span class="linenos">426</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="EconomicModel-427"><a href="#EconomicModel-427"><span class="linenos">427</span></a>        
</span><span id="EconomicModel-428"><a href="#EconomicModel-428"><span class="linenos">428</span></a>        <span class="c1"># Transfers have lower multipliers than direct spending</span>
</span><span id="EconomicModel-429"><a href="#EconomicModel-429"><span class="linenos">429</span></a>        <span class="n">transfer_multiplier</span> <span class="o">=</span> <span class="mf">0.8</span>
</span><span id="EconomicModel-430"><a href="#EconomicModel-430"><span class="linenos">430</span></a>        
</span><span id="EconomicModel-431"><a href="#EconomicModel-431"><span class="linenos">431</span></a>        <span class="n">gdp_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-432"><a href="#EconomicModel-432"><span class="linenos">432</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">):</span>
</span><span id="EconomicModel-433"><a href="#EconomicModel-433"><span class="linenos">433</span></a>            <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="EconomicModel-434"><a href="#EconomicModel-434"><span class="linenos">434</span></a>                <span class="n">phase</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_phase_in_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="EconomicModel-435"><a href="#EconomicModel-435"><span class="linenos">435</span></a>                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="EconomicModel-436"><a href="#EconomicModel-436"><span class="linenos">436</span></a>                    <span class="n">decay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;spending_multiplier_decay&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
</span><span id="EconomicModel-437"><a href="#EconomicModel-437"><span class="linenos">437</span></a>                    <span class="n">gdp_level</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">budget_effect</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">transfer_multiplier</span> <span class="o">*</span> <span class="n">decay</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="EconomicModel-438"><a href="#EconomicModel-438"><span class="linenos">438</span></a>        
</span><span id="EconomicModel-439"><a href="#EconomicModel-439"><span class="linenos">439</span></a>        <span class="n">gdp_pct</span> <span class="o">=</span> <span class="n">gdp_level</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="EconomicModel-440"><a href="#EconomicModel-440"><span class="linenos">440</span></a>        
</span><span id="EconomicModel-441"><a href="#EconomicModel-441"><span class="linenos">441</span></a>        <span class="c1"># Labor force effects (transfers can reduce labor supply)</span>
</span><span id="EconomicModel-442"><a href="#EconomicModel-442"><span class="linenos">442</span></a>        <span class="n">labor_force_effect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel-443"><a href="#EconomicModel-443"><span class="linenos">443</span></a>        <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">labor_force_participation_effect</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EconomicModel-444"><a href="#EconomicModel-444"><span class="linenos">444</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">):</span>
</span><span id="EconomicModel-445"><a href="#EconomicModel-445"><span class="linenos">445</span></a>                <span class="k">if</span> <span class="n">policy</span><span class="o">.</span><span class="n">is_active</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="EconomicModel-446"><a href="#EconomicModel-446"><span class="linenos">446</span></a>                    <span class="n">phase</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_phase_in_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="EconomicModel-447"><a href="#EconomicModel-447"><span class="linenos">447</span></a>                    <span class="n">labor_force_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">labor_force_participation_effect</span> <span class="o">*</span> <span class="n">phase</span>
</span><span id="EconomicModel-448"><a href="#EconomicModel-448"><span class="linenos">448</span></a>        
</span><span id="EconomicModel-449"><a href="#EconomicModel-449"><span class="linenos">449</span></a>        <span class="c1"># Employment effect is sum of demand + labor supply effects</span>
</span><span id="EconomicModel-450"><a href="#EconomicModel-450"><span class="linenos">450</span></a>        <span class="n">employment</span> <span class="o">=</span> <span class="n">gdp_pct</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="mi">150000</span> <span class="o">+</span> <span class="n">labor_force_effect</span> <span class="o">*</span> <span class="mi">160000</span>
</span><span id="EconomicModel-451"><a href="#EconomicModel-451"><span class="linenos">451</span></a>        
</span><span id="EconomicModel-452"><a href="#EconomicModel-452"><span class="linenos">452</span></a>        <span class="c1"># Revenue feedback</span>
</span><span id="EconomicModel-453"><a href="#EconomicModel-453"><span class="linenos">453</span></a>        <span class="n">revenue_fb</span> <span class="o">=</span> <span class="n">gdp_level</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;marginal_revenue_rate&#39;</span><span class="p">]</span>
</span><span id="EconomicModel-454"><a href="#EconomicModel-454"><span class="linenos">454</span></a>        
</span><span id="EconomicModel-455"><a href="#EconomicModel-455"><span class="linenos">455</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="EconomicModel-456"><a href="#EconomicModel-456"><span class="linenos">456</span></a>            <span class="s1">&#39;gdp_level_change&#39;</span><span class="p">:</span> <span class="n">gdp_level</span><span class="p">,</span>
</span><span id="EconomicModel-457"><a href="#EconomicModel-457"><span class="linenos">457</span></a>            <span class="s1">&#39;gdp_percent_change&#39;</span><span class="p">:</span> <span class="n">gdp_pct</span><span class="p">,</span>
</span><span id="EconomicModel-458"><a href="#EconomicModel-458"><span class="linenos">458</span></a>            <span class="s1">&#39;employment_change&#39;</span><span class="p">:</span> <span class="n">employment</span><span class="p">,</span>
</span><span id="EconomicModel-459"><a href="#EconomicModel-459"><span class="linenos">459</span></a>            <span class="s1">&#39;hours_worked_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="EconomicModel-460"><a href="#EconomicModel-460"><span class="linenos">460</span></a>            <span class="s1">&#39;labor_force_change&#39;</span><span class="p">:</span> <span class="n">labor_force_effect</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="EconomicModel-461"><a href="#EconomicModel-461"><span class="linenos">461</span></a>            <span class="s1">&#39;capital_stock_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="EconomicModel-462"><a href="#EconomicModel-462"><span class="linenos">462</span></a>            <span class="s1">&#39;investment_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="EconomicModel-463"><a href="#EconomicModel-463"><span class="linenos">463</span></a>            <span class="s1">&#39;interest_rate_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">budget_effect</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;crowding_out&#39;</span><span class="p">],</span>
</span><span id="EconomicModel-464"><a href="#EconomicModel-464"><span class="linenos">464</span></a>            <span class="s1">&#39;revenue_feedback&#39;</span><span class="p">:</span> <span class="n">revenue_fb</span><span class="p">,</span>
</span><span id="EconomicModel-465"><a href="#EconomicModel-465"><span class="linenos">465</span></a>        <span class="p">}</span>
</span><span id="EconomicModel-466"><a href="#EconomicModel-466"><span class="linenos">466</span></a>    
</span><span id="EconomicModel-467"><a href="#EconomicModel-467"><span class="linenos">467</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generic_policy_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="EconomicModel-468"><a href="#EconomicModel-468"><span class="linenos">468</span></a>                               <span class="n">budget_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel-469"><a href="#EconomicModel-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate effects for generic policies.&quot;&quot;&quot;</span>
</span><span id="EconomicModel-470"><a href="#EconomicModel-470"><span class="linenos">470</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="EconomicModel-471"><a href="#EconomicModel-471"><span class="linenos">471</span></a>        
</span><span id="EconomicModel-472"><a href="#EconomicModel-472"><span class="linenos">472</span></a>        <span class="c1"># Simple multiplier approach</span>
</span><span id="EconomicModel-473"><a href="#EconomicModel-473"><span class="linenos">473</span></a>        <span class="n">gdp_level</span> <span class="o">=</span> <span class="n">budget_effect</span> <span class="o">*</span> <span class="mf">0.5</span>  <span class="c1"># Conservative multiplier</span>
</span><span id="EconomicModel-474"><a href="#EconomicModel-474"><span class="linenos">474</span></a>        <span class="n">gdp_pct</span> <span class="o">=</span> <span class="n">gdp_level</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="o">.</span><span class="n">nominal_gdp</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="EconomicModel-475"><a href="#EconomicModel-475"><span class="linenos">475</span></a>        
</span><span id="EconomicModel-476"><a href="#EconomicModel-476"><span class="linenos">476</span></a>        <span class="n">employment</span> <span class="o">=</span> <span class="n">gdp_pct</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="mi">150000</span>
</span><span id="EconomicModel-477"><a href="#EconomicModel-477"><span class="linenos">477</span></a>        <span class="n">revenue_fb</span> <span class="o">=</span> <span class="n">gdp_level</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;marginal_revenue_rate&#39;</span><span class="p">]</span>
</span><span id="EconomicModel-478"><a href="#EconomicModel-478"><span class="linenos">478</span></a>        
</span><span id="EconomicModel-479"><a href="#EconomicModel-479"><span class="linenos">479</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="EconomicModel-480"><a href="#EconomicModel-480"><span class="linenos">480</span></a>            <span class="s1">&#39;gdp_level_change&#39;</span><span class="p">:</span> <span class="n">gdp_level</span><span class="p">,</span>
</span><span id="EconomicModel-481"><a href="#EconomicModel-481"><span class="linenos">481</span></a>            <span class="s1">&#39;gdp_percent_change&#39;</span><span class="p">:</span> <span class="n">gdp_pct</span><span class="p">,</span>
</span><span id="EconomicModel-482"><a href="#EconomicModel-482"><span class="linenos">482</span></a>            <span class="s1">&#39;employment_change&#39;</span><span class="p">:</span> <span class="n">employment</span><span class="p">,</span>
</span><span id="EconomicModel-483"><a href="#EconomicModel-483"><span class="linenos">483</span></a>            <span class="s1">&#39;hours_worked_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="EconomicModel-484"><a href="#EconomicModel-484"><span class="linenos">484</span></a>            <span class="s1">&#39;labor_force_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="EconomicModel-485"><a href="#EconomicModel-485"><span class="linenos">485</span></a>            <span class="s1">&#39;capital_stock_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="EconomicModel-486"><a href="#EconomicModel-486"><span class="linenos">486</span></a>            <span class="s1">&#39;investment_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">),</span>
</span><span id="EconomicModel-487"><a href="#EconomicModel-487"><span class="linenos">487</span></a>            <span class="s1">&#39;interest_rate_change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">budget_effect</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;crowding_out&#39;</span><span class="p">],</span>
</span><span id="EconomicModel-488"><a href="#EconomicModel-488"><span class="linenos">488</span></a>            <span class="s1">&#39;revenue_feedback&#39;</span><span class="p">:</span> <span class="n">revenue_fb</span><span class="p">,</span>
</span><span id="EconomicModel-489"><a href="#EconomicModel-489"><span class="linenos">489</span></a>        <span class="p">}</span>
</span><span id="EconomicModel-490"><a href="#EconomicModel-490"><span class="linenos">490</span></a>    
</span><span id="EconomicModel-491"><a href="#EconomicModel-491"><span class="linenos">491</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_long_run_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span> 
</span><span id="EconomicModel-492"><a href="#EconomicModel-492"><span class="linenos">492</span></a>                            <span class="n">budget_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="EconomicModel-493"><a href="#EconomicModel-493"><span class="linenos">493</span></a>                            <span class="n">years_out</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel-494"><a href="#EconomicModel-494"><span class="linenos">494</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EconomicModel-495"><a href="#EconomicModel-495"><span class="linenos">495</span></a><span class="sd">        Estimate long-run (steady-state) effects beyond the budget window.</span>
</span><span id="EconomicModel-496"><a href="#EconomicModel-496"><span class="linenos">496</span></a><span class="sd">        </span>
</span><span id="EconomicModel-497"><a href="#EconomicModel-497"><span class="linenos">497</span></a><span class="sd">        Useful for understanding full policy impacts.</span>
</span><span id="EconomicModel-498"><a href="#EconomicModel-498"><span class="linenos">498</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EconomicModel-499"><a href="#EconomicModel-499"><span class="linenos">499</span></a>        <span class="c1"># Calculate 10-year effects first</span>
</span><span id="EconomicModel-500"><a href="#EconomicModel-500"><span class="linenos">500</span></a>        <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel-501"><a href="#EconomicModel-501"><span class="linenos">501</span></a>        
</span><span id="EconomicModel-502"><a href="#EconomicModel-502"><span class="linenos">502</span></a>        <span class="c1"># Extrapolate to long run</span>
</span><span id="EconomicModel-503"><a href="#EconomicModel-503"><span class="linenos">503</span></a>        <span class="c1"># GDP effect converges to supply-side effect</span>
</span><span id="EconomicModel-504"><a href="#EconomicModel-504"><span class="linenos">504</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="EconomicModel-505"><a href="#EconomicModel-505"><span class="linenos">505</span></a>            <span class="c1"># Long-run GDP effect from labor and capital changes</span>
</span><span id="EconomicModel-506"><a href="#EconomicModel-506"><span class="linenos">506</span></a>            <span class="n">labor_effect</span> <span class="o">=</span> <span class="n">effects</span><span class="o">.</span><span class="n">labor_force_change</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="EconomicModel-507"><a href="#EconomicModel-507"><span class="linenos">507</span></a>            <span class="n">capital_effect</span> <span class="o">=</span> <span class="n">effects</span><span class="o">.</span><span class="n">capital_stock_change</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="EconomicModel-508"><a href="#EconomicModel-508"><span class="linenos">508</span></a>            
</span><span id="EconomicModel-509"><a href="#EconomicModel-509"><span class="linenos">509</span></a>            <span class="n">long_run_gdp</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;labor_share&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">labor_effect</span> <span class="o">+</span>
</span><span id="EconomicModel-510"><a href="#EconomicModel-510"><span class="linenos">510</span></a>                           <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;capital_share&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">capital_effect</span><span class="p">)</span>
</span><span id="EconomicModel-511"><a href="#EconomicModel-511"><span class="linenos">511</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EconomicModel-512"><a href="#EconomicModel-512"><span class="linenos">512</span></a>            <span class="c1"># Other policies: effect decays to zero</span>
</span><span id="EconomicModel-513"><a href="#EconomicModel-513"><span class="linenos">513</span></a>            <span class="n">long_run_gdp</span> <span class="o">=</span> <span class="n">effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.5</span>
</span><span id="EconomicModel-514"><a href="#EconomicModel-514"><span class="linenos">514</span></a>        
</span><span id="EconomicModel-515"><a href="#EconomicModel-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="EconomicModel-516"><a href="#EconomicModel-516"><span class="linenos">516</span></a>            <span class="s1">&#39;long_run_gdp_percent&#39;</span><span class="p">:</span> <span class="n">long_run_gdp</span><span class="p">,</span>
</span><span id="EconomicModel-517"><a href="#EconomicModel-517"><span class="linenos">517</span></a>            <span class="s1">&#39;long_run_employment&#39;</span><span class="p">:</span> <span class="n">long_run_gdp</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="c1"># Okun&#39;s law</span>
</span><span id="EconomicModel-518"><a href="#EconomicModel-518"><span class="linenos">518</span></a>            <span class="s1">&#39;steady_state_year&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="EconomicModel-519"><a href="#EconomicModel-519"><span class="linenos">519</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Economic model for dynamic scoring.</p>

<p>Incorporates key channels through which fiscal policy affects the economy:</p>

<ol>
<li>Aggregate demand effects (short-run)</li>
<li>Labor supply effects</li>
<li>Saving and investment effects</li>
<li>Interest rate effects</li>
</ol>

<p>Based on CBO's approach to dynamic analysis.</p>

<p>KEY IMPROVEMENT: Multipliers now vary with economic conditions.</p>

<p>Multiplier estimates by condition (from empirical literature):</p>

<ul>
<li>Normal times: Spending ~1.0, Tax cuts ~0.5</li>
<li>Recession: Spending ~1.5-2.0, Tax cuts ~0.8-1.0</li>
<li>At ZLB: Spending ~2.0+, Tax cuts ~1.0+</li>
<li>Overheating: Spending ~0.5, Tax cuts ~0.3 (crowding out dominates)</li>
</ul>
</div>


                            <div id="EconomicModel.__init__" class="classattr">
                                        <input id="EconomicModel.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">EconomicModel</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">baseline</span><span class="p">:</span> <span class="n"><a href="#BaselineProjection">BaselineProjection</a></span>,</span><span class="param">	<span class="n">conditions</span><span class="p">:</span> <span class="n"><a href="#EconomicConditions">EconomicConditions</a></span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="EconomicModel.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicModel.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicModel.__init__-131"><a href="#EconomicModel.__init__-131"><span class="linenos">131</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineProjection</span><span class="p">,</span>
</span><span id="EconomicModel.__init__-132"><a href="#EconomicModel.__init__-132"><span class="linenos">132</span></a>                 <span class="n">conditions</span><span class="p">:</span> <span class="n">EconomicConditions</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="EconomicModel.__init__-133"><a href="#EconomicModel.__init__-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="n">baseline</span>
</span><span id="EconomicModel.__init__-134"><a href="#EconomicModel.__init__-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">years</span>
</span><span id="EconomicModel.__init__-135"><a href="#EconomicModel.__init__-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span> <span class="ow">or</span> <span class="n">EconomicConditions</span><span class="o">.</span><span class="n">normal_times</span><span class="p">()</span>
</span><span id="EconomicModel.__init__-136"><a href="#EconomicModel.__init__-136"><span class="linenos">136</span></a>        
</span><span id="EconomicModel.__init__-137"><a href="#EconomicModel.__init__-137"><span class="linenos">137</span></a>        <span class="c1"># Base parameters (adjusted by conditions below)</span>
</span><span id="EconomicModel.__init__-138"><a href="#EconomicModel.__init__-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_params</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EconomicModel.__init__-139"><a href="#EconomicModel.__init__-139"><span class="linenos">139</span></a>            <span class="c1"># Base multipliers (adjusted for conditions)</span>
</span><span id="EconomicModel.__init__-140"><a href="#EconomicModel.__init__-140"><span class="linenos">140</span></a>            <span class="s1">&#39;spending_multiplier_base&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="EconomicModel.__init__-141"><a href="#EconomicModel.__init__-141"><span class="linenos">141</span></a>            <span class="s1">&#39;tax_multiplier_base&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="EconomicModel.__init__-142"><a href="#EconomicModel.__init__-142"><span class="linenos">142</span></a>            <span class="s1">&#39;transfer_multiplier_base&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="EconomicModel.__init__-143"><a href="#EconomicModel.__init__-143"><span class="linenos">143</span></a>            <span class="s1">&#39;spending_multiplier_decay&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>  <span class="c1"># Annual decay rate</span>
</span><span id="EconomicModel.__init__-144"><a href="#EconomicModel.__init__-144"><span class="linenos">144</span></a>            
</span><span id="EconomicModel.__init__-145"><a href="#EconomicModel.__init__-145"><span class="linenos">145</span></a>            <span class="c1"># Supply-side elasticities</span>
</span><span id="EconomicModel.__init__-146"><a href="#EconomicModel.__init__-146"><span class="linenos">146</span></a>            <span class="s1">&#39;labor_supply_elasticity&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>  <span class="c1"># Compensated elasticity</span>
</span><span id="EconomicModel.__init__-147"><a href="#EconomicModel.__init__-147"><span class="linenos">147</span></a>            <span class="s1">&#39;capital_elasticity&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># Response of capital to after-tax return</span>
</span><span id="EconomicModel.__init__-148"><a href="#EconomicModel.__init__-148"><span class="linenos">148</span></a>            <span class="s1">&#39;eti&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># Elasticity of taxable income</span>
</span><span id="EconomicModel.__init__-149"><a href="#EconomicModel.__init__-149"><span class="linenos">149</span></a>            
</span><span id="EconomicModel.__init__-150"><a href="#EconomicModel.__init__-150"><span class="linenos">150</span></a>            <span class="c1"># Production function</span>
</span><span id="EconomicModel.__init__-151"><a href="#EconomicModel.__init__-151"><span class="linenos">151</span></a>            <span class="s1">&#39;labor_share&#39;</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>  <span class="c1"># Labor&#39;s share of output</span>
</span><span id="EconomicModel.__init__-152"><a href="#EconomicModel.__init__-152"><span class="linenos">152</span></a>            <span class="s1">&#39;capital_share&#39;</span><span class="p">:</span> <span class="mf">0.35</span><span class="p">,</span>  <span class="c1"># Capital&#39;s share</span>
</span><span id="EconomicModel.__init__-153"><a href="#EconomicModel.__init__-153"><span class="linenos">153</span></a>            <span class="s1">&#39;tfp_growth&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>  <span class="c1"># Annual TFP growth</span>
</span><span id="EconomicModel.__init__-154"><a href="#EconomicModel.__init__-154"><span class="linenos">154</span></a>            
</span><span id="EconomicModel.__init__-155"><a href="#EconomicModel.__init__-155"><span class="linenos">155</span></a>            <span class="c1"># Interest rate effects</span>
</span><span id="EconomicModel.__init__-156"><a href="#EconomicModel.__init__-156"><span class="linenos">156</span></a>            <span class="s1">&#39;crowding_out_base&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>  <span class="c1"># Interest rate increase per $100B deficit</span>
</span><span id="EconomicModel.__init__-157"><a href="#EconomicModel.__init__-157"><span class="linenos">157</span></a>            <span class="s1">&#39;investment_elasticity&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Response of investment to interest rates</span>
</span><span id="EconomicModel.__init__-158"><a href="#EconomicModel.__init__-158"><span class="linenos">158</span></a>            
</span><span id="EconomicModel.__init__-159"><a href="#EconomicModel.__init__-159"><span class="linenos">159</span></a>            <span class="c1"># Revenue feedback</span>
</span><span id="EconomicModel.__init__-160"><a href="#EconomicModel.__init__-160"><span class="linenos">160</span></a>            <span class="s1">&#39;marginal_revenue_rate&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># Avg marginal rate on additional income</span>
</span><span id="EconomicModel.__init__-161"><a href="#EconomicModel.__init__-161"><span class="linenos">161</span></a>        <span class="p">}</span>
</span><span id="EconomicModel.__init__-162"><a href="#EconomicModel.__init__-162"><span class="linenos">162</span></a>        
</span><span id="EconomicModel.__init__-163"><a href="#EconomicModel.__init__-163"><span class="linenos">163</span></a>        <span class="c1"># Apply condition adjustments</span>
</span><span id="EconomicModel.__init__-164"><a href="#EconomicModel.__init__-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_for_conditions</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="EconomicModel.baseline" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline</span>

        
    </div>
    <a class="headerlink" href="#EconomicModel.baseline"></a>
    
    

                            </div>
                            <div id="EconomicModel.years" class="classattr">
                                <div class="attr variable">
            <span class="name">years</span>

        
    </div>
    <a class="headerlink" href="#EconomicModel.years"></a>
    
    

                            </div>
                            <div id="EconomicModel.conditions" class="classattr">
                                <div class="attr variable">
            <span class="name">conditions</span>

        
    </div>
    <a class="headerlink" href="#EconomicModel.conditions"></a>
    
    

                            </div>
                            <div id="EconomicModel.params" class="classattr">
                                <div class="attr variable">
            <span class="name">params</span>

        
    </div>
    <a class="headerlink" href="#EconomicModel.params"></a>
    
    

                            </div>
                            <div id="EconomicModel.update_conditions" class="classattr">
                                        <input id="EconomicModel.update_conditions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_conditions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">conditions</span><span class="p">:</span> <span class="n"><a href="#EconomicConditions">EconomicConditions</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EconomicModel.update_conditions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicModel.update_conditions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicModel.update_conditions-229"><a href="#EconomicModel.update_conditions-229"><span class="linenos">229</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conditions</span><span class="p">:</span> <span class="n">EconomicConditions</span><span class="p">):</span>
</span><span id="EconomicModel.update_conditions-230"><a href="#EconomicModel.update_conditions-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update economic conditions and recalculate parameters.&quot;&quot;&quot;</span>
</span><span id="EconomicModel.update_conditions-231"><a href="#EconomicModel.update_conditions-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span>
</span><span id="EconomicModel.update_conditions-232"><a href="#EconomicModel.update_conditions-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_for_conditions</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Update economic conditions and recalculate parameters.</p>
</div>


                            </div>
                            <div id="EconomicModel.get_multiplier_summary" class="classattr">
                                        <input id="EconomicModel.get_multiplier_summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_multiplier_summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="EconomicModel.get_multiplier_summary-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicModel.get_multiplier_summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicModel.get_multiplier_summary-234"><a href="#EconomicModel.get_multiplier_summary-234"><span class="linenos">234</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_multiplier_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel.get_multiplier_summary-235"><a href="#EconomicModel.get_multiplier_summary-235"><span class="linenos">235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return current effective multipliers for documentation.&quot;&quot;&quot;</span>
</span><span id="EconomicModel.get_multiplier_summary-236"><a href="#EconomicModel.get_multiplier_summary-236"><span class="linenos">236</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="EconomicModel.get_multiplier_summary-237"><a href="#EconomicModel.get_multiplier_summary-237"><span class="linenos">237</span></a>            <span class="s1">&#39;spending_multiplier&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;spending_multiplier_peak&#39;</span><span class="p">],</span>
</span><span id="EconomicModel.get_multiplier_summary-238"><a href="#EconomicModel.get_multiplier_summary-238"><span class="linenos">238</span></a>            <span class="s1">&#39;tax_multiplier&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;tax_multiplier&#39;</span><span class="p">],</span>
</span><span id="EconomicModel.get_multiplier_summary-239"><a href="#EconomicModel.get_multiplier_summary-239"><span class="linenos">239</span></a>            <span class="s1">&#39;transfer_multiplier&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;transfer_multiplier&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
</span><span id="EconomicModel.get_multiplier_summary-240"><a href="#EconomicModel.get_multiplier_summary-240"><span class="linenos">240</span></a>            <span class="s1">&#39;conditions&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="EconomicModel.get_multiplier_summary-241"><a href="#EconomicModel.get_multiplier_summary-241"><span class="linenos">241</span></a>                <span class="s1">&#39;output_gap&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="o">.</span><span class="n">output_gap</span><span class="p">,</span>
</span><span id="EconomicModel.get_multiplier_summary-242"><a href="#EconomicModel.get_multiplier_summary-242"><span class="linenos">242</span></a>                <span class="s1">&#39;at_zlb&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="o">.</span><span class="n">at_zlb</span><span class="p">,</span>
</span><span id="EconomicModel.get_multiplier_summary-243"><a href="#EconomicModel.get_multiplier_summary-243"><span class="linenos">243</span></a>                <span class="s1">&#39;debt_to_gdp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="o">.</span><span class="n">debt_to_gdp</span><span class="p">,</span>
</span><span id="EconomicModel.get_multiplier_summary-244"><a href="#EconomicModel.get_multiplier_summary-244"><span class="linenos">244</span></a>            <span class="p">}</span>
</span><span id="EconomicModel.get_multiplier_summary-245"><a href="#EconomicModel.get_multiplier_summary-245"><span class="linenos">245</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Return current effective multipliers for documentation.</p>
</div>


                            </div>
                            <div id="EconomicModel.calculate_effects" class="classattr">
                                        <input id="EconomicModel.calculate_effects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_effects</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">static_budget_effect</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span></span><span class="return-annotation">) -> <span class="n"><a href="#DynamicEffects">DynamicEffects</a></span>:</span></span>

                <label class="view-source-button" for="EconomicModel.calculate_effects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicModel.calculate_effects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicModel.calculate_effects-247"><a href="#EconomicModel.calculate_effects-247"><span class="linenos">247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span> 
</span><span id="EconomicModel.calculate_effects-248"><a href="#EconomicModel.calculate_effects-248"><span class="linenos">248</span></a>                         <span class="n">static_budget_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DynamicEffects</span><span class="p">:</span>
</span><span id="EconomicModel.calculate_effects-249"><a href="#EconomicModel.calculate_effects-249"><span class="linenos">249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EconomicModel.calculate_effects-250"><a href="#EconomicModel.calculate_effects-250"><span class="linenos">250</span></a><span class="sd">        Calculate dynamic economic effects of a policy.</span>
</span><span id="EconomicModel.calculate_effects-251"><a href="#EconomicModel.calculate_effects-251"><span class="linenos">251</span></a><span class="sd">        </span>
</span><span id="EconomicModel.calculate_effects-252"><a href="#EconomicModel.calculate_effects-252"><span class="linenos">252</span></a><span class="sd">        Args:</span>
</span><span id="EconomicModel.calculate_effects-253"><a href="#EconomicModel.calculate_effects-253"><span class="linenos">253</span></a><span class="sd">            policy: The policy being analyzed</span>
</span><span id="EconomicModel.calculate_effects-254"><a href="#EconomicModel.calculate_effects-254"><span class="linenos">254</span></a><span class="sd">            static_budget_effect: Static budget effect by year (billions, positive = costs)</span>
</span><span id="EconomicModel.calculate_effects-255"><a href="#EconomicModel.calculate_effects-255"><span class="linenos">255</span></a><span class="sd">            </span>
</span><span id="EconomicModel.calculate_effects-256"><a href="#EconomicModel.calculate_effects-256"><span class="linenos">256</span></a><span class="sd">        Returns:</span>
</span><span id="EconomicModel.calculate_effects-257"><a href="#EconomicModel.calculate_effects-257"><span class="linenos">257</span></a><span class="sd">            DynamicEffects container with all calculated effects</span>
</span><span id="EconomicModel.calculate_effects-258"><a href="#EconomicModel.calculate_effects-258"><span class="linenos">258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EconomicModel.calculate_effects-259"><a href="#EconomicModel.calculate_effects-259"><span class="linenos">259</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-260"><a href="#EconomicModel.calculate_effects-260"><span class="linenos">260</span></a>        
</span><span id="EconomicModel.calculate_effects-261"><a href="#EconomicModel.calculate_effects-261"><span class="linenos">261</span></a>        <span class="c1"># Initialize effect arrays</span>
</span><span id="EconomicModel.calculate_effects-262"><a href="#EconomicModel.calculate_effects-262"><span class="linenos">262</span></a>        <span class="n">gdp_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-263"><a href="#EconomicModel.calculate_effects-263"><span class="linenos">263</span></a>        <span class="n">gdp_pct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-264"><a href="#EconomicModel.calculate_effects-264"><span class="linenos">264</span></a>        <span class="n">employment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-265"><a href="#EconomicModel.calculate_effects-265"><span class="linenos">265</span></a>        <span class="n">hours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-266"><a href="#EconomicModel.calculate_effects-266"><span class="linenos">266</span></a>        <span class="n">labor_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-267"><a href="#EconomicModel.calculate_effects-267"><span class="linenos">267</span></a>        <span class="n">capital</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-268"><a href="#EconomicModel.calculate_effects-268"><span class="linenos">268</span></a>        <span class="n">investment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-269"><a href="#EconomicModel.calculate_effects-269"><span class="linenos">269</span></a>        <span class="n">interest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-270"><a href="#EconomicModel.calculate_effects-270"><span class="linenos">270</span></a>        <span class="n">revenue_fb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-271"><a href="#EconomicModel.calculate_effects-271"><span class="linenos">271</span></a>        
</span><span id="EconomicModel.calculate_effects-272"><a href="#EconomicModel.calculate_effects-272"><span class="linenos">272</span></a>        <span class="c1"># Calculate effects based on policy type</span>
</span><span id="EconomicModel.calculate_effects-273"><a href="#EconomicModel.calculate_effects-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="EconomicModel.calculate_effects-274"><a href="#EconomicModel.calculate_effects-274"><span class="linenos">274</span></a>            <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tax_policy_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">static_budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-275"><a href="#EconomicModel.calculate_effects-275"><span class="linenos">275</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">SpendingPolicy</span><span class="p">):</span>
</span><span id="EconomicModel.calculate_effects-276"><a href="#EconomicModel.calculate_effects-276"><span class="linenos">276</span></a>            <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spending_policy_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">static_budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-277"><a href="#EconomicModel.calculate_effects-277"><span class="linenos">277</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TransferPolicy</span><span class="p">):</span>
</span><span id="EconomicModel.calculate_effects-278"><a href="#EconomicModel.calculate_effects-278"><span class="linenos">278</span></a>            <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_policy_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">static_budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-279"><a href="#EconomicModel.calculate_effects-279"><span class="linenos">279</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EconomicModel.calculate_effects-280"><a href="#EconomicModel.calculate_effects-280"><span class="linenos">280</span></a>            <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_policy_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">static_budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel.calculate_effects-281"><a href="#EconomicModel.calculate_effects-281"><span class="linenos">281</span></a>        
</span><span id="EconomicModel.calculate_effects-282"><a href="#EconomicModel.calculate_effects-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">DynamicEffects</span><span class="p">(</span>
</span><span id="EconomicModel.calculate_effects-283"><a href="#EconomicModel.calculate_effects-283"><span class="linenos">283</span></a>            <span class="n">years</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
</span><span id="EconomicModel.calculate_effects-284"><a href="#EconomicModel.calculate_effects-284"><span class="linenos">284</span></a>            <span class="o">**</span><span class="n">effects</span>
</span><span id="EconomicModel.calculate_effects-285"><a href="#EconomicModel.calculate_effects-285"><span class="linenos">285</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculate dynamic economic effects of a policy.</p>

<p>Args:
    policy: The policy being analyzed
    static_budget_effect: Static budget effect by year (billions, positive = costs)</p>

<p>Returns:
    DynamicEffects container with all calculated effects</p>
</div>


                            </div>
                            <div id="EconomicModel.get_long_run_effects" class="classattr">
                                        <input id="EconomicModel.get_long_run_effects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_long_run_effects</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">budget_effect</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">years_out</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="EconomicModel.get_long_run_effects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicModel.get_long_run_effects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicModel.get_long_run_effects-491"><a href="#EconomicModel.get_long_run_effects-491"><span class="linenos">491</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_long_run_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span> 
</span><span id="EconomicModel.get_long_run_effects-492"><a href="#EconomicModel.get_long_run_effects-492"><span class="linenos">492</span></a>                            <span class="n">budget_effect</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="EconomicModel.get_long_run_effects-493"><a href="#EconomicModel.get_long_run_effects-493"><span class="linenos">493</span></a>                            <span class="n">years_out</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="EconomicModel.get_long_run_effects-494"><a href="#EconomicModel.get_long_run_effects-494"><span class="linenos">494</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EconomicModel.get_long_run_effects-495"><a href="#EconomicModel.get_long_run_effects-495"><span class="linenos">495</span></a><span class="sd">        Estimate long-run (steady-state) effects beyond the budget window.</span>
</span><span id="EconomicModel.get_long_run_effects-496"><a href="#EconomicModel.get_long_run_effects-496"><span class="linenos">496</span></a><span class="sd">        </span>
</span><span id="EconomicModel.get_long_run_effects-497"><a href="#EconomicModel.get_long_run_effects-497"><span class="linenos">497</span></a><span class="sd">        Useful for understanding full policy impacts.</span>
</span><span id="EconomicModel.get_long_run_effects-498"><a href="#EconomicModel.get_long_run_effects-498"><span class="linenos">498</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EconomicModel.get_long_run_effects-499"><a href="#EconomicModel.get_long_run_effects-499"><span class="linenos">499</span></a>        <span class="c1"># Calculate 10-year effects first</span>
</span><span id="EconomicModel.get_long_run_effects-500"><a href="#EconomicModel.get_long_run_effects-500"><span class="linenos">500</span></a>        <span class="n">effects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_effects</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">budget_effect</span><span class="p">)</span>
</span><span id="EconomicModel.get_long_run_effects-501"><a href="#EconomicModel.get_long_run_effects-501"><span class="linenos">501</span></a>        
</span><span id="EconomicModel.get_long_run_effects-502"><a href="#EconomicModel.get_long_run_effects-502"><span class="linenos">502</span></a>        <span class="c1"># Extrapolate to long run</span>
</span><span id="EconomicModel.get_long_run_effects-503"><a href="#EconomicModel.get_long_run_effects-503"><span class="linenos">503</span></a>        <span class="c1"># GDP effect converges to supply-side effect</span>
</span><span id="EconomicModel.get_long_run_effects-504"><a href="#EconomicModel.get_long_run_effects-504"><span class="linenos">504</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="EconomicModel.get_long_run_effects-505"><a href="#EconomicModel.get_long_run_effects-505"><span class="linenos">505</span></a>            <span class="c1"># Long-run GDP effect from labor and capital changes</span>
</span><span id="EconomicModel.get_long_run_effects-506"><a href="#EconomicModel.get_long_run_effects-506"><span class="linenos">506</span></a>            <span class="n">labor_effect</span> <span class="o">=</span> <span class="n">effects</span><span class="o">.</span><span class="n">labor_force_change</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="EconomicModel.get_long_run_effects-507"><a href="#EconomicModel.get_long_run_effects-507"><span class="linenos">507</span></a>            <span class="n">capital_effect</span> <span class="o">=</span> <span class="n">effects</span><span class="o">.</span><span class="n">capital_stock_change</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="EconomicModel.get_long_run_effects-508"><a href="#EconomicModel.get_long_run_effects-508"><span class="linenos">508</span></a>            
</span><span id="EconomicModel.get_long_run_effects-509"><a href="#EconomicModel.get_long_run_effects-509"><span class="linenos">509</span></a>            <span class="n">long_run_gdp</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;labor_share&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">labor_effect</span> <span class="o">+</span>
</span><span id="EconomicModel.get_long_run_effects-510"><a href="#EconomicModel.get_long_run_effects-510"><span class="linenos">510</span></a>                           <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;capital_share&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">capital_effect</span><span class="p">)</span>
</span><span id="EconomicModel.get_long_run_effects-511"><a href="#EconomicModel.get_long_run_effects-511"><span class="linenos">511</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EconomicModel.get_long_run_effects-512"><a href="#EconomicModel.get_long_run_effects-512"><span class="linenos">512</span></a>            <span class="c1"># Other policies: effect decays to zero</span>
</span><span id="EconomicModel.get_long_run_effects-513"><a href="#EconomicModel.get_long_run_effects-513"><span class="linenos">513</span></a>            <span class="n">long_run_gdp</span> <span class="o">=</span> <span class="n">effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.5</span>
</span><span id="EconomicModel.get_long_run_effects-514"><a href="#EconomicModel.get_long_run_effects-514"><span class="linenos">514</span></a>        
</span><span id="EconomicModel.get_long_run_effects-515"><a href="#EconomicModel.get_long_run_effects-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="EconomicModel.get_long_run_effects-516"><a href="#EconomicModel.get_long_run_effects-516"><span class="linenos">516</span></a>            <span class="s1">&#39;long_run_gdp_percent&#39;</span><span class="p">:</span> <span class="n">long_run_gdp</span><span class="p">,</span>
</span><span id="EconomicModel.get_long_run_effects-517"><a href="#EconomicModel.get_long_run_effects-517"><span class="linenos">517</span></a>            <span class="s1">&#39;long_run_employment&#39;</span><span class="p">:</span> <span class="n">long_run_gdp</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="c1"># Okun&#39;s law</span>
</span><span id="EconomicModel.get_long_run_effects-518"><a href="#EconomicModel.get_long_run_effects-518"><span class="linenos">518</span></a>            <span class="s1">&#39;steady_state_year&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="EconomicModel.get_long_run_effects-519"><a href="#EconomicModel.get_long_run_effects-519"><span class="linenos">519</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Estimate long-run (steady-state) effects beyond the budget window.</p>

<p>Useful for understanding full policy impacts.</p>
</div>


                            </div>
                </section>
                <section id="EconomicConditions">
                            <input id="EconomicConditions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EconomicConditions</span>:

                <label class="view-source-button" for="EconomicConditions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicConditions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicConditions-59"><a href="#EconomicConditions-59"><span class="linenos"> 59</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EconomicConditions</span><span class="p">:</span>
</span><span id="EconomicConditions-60"><a href="#EconomicConditions-60"><span class="linenos"> 60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EconomicConditions-61"><a href="#EconomicConditions-61"><span class="linenos"> 61</span></a><span class="sd">    Economic conditions that affect fiscal multipliers.</span>
</span><span id="EconomicConditions-62"><a href="#EconomicConditions-62"><span class="linenos"> 62</span></a><span class="sd">    </span>
</span><span id="EconomicConditions-63"><a href="#EconomicConditions-63"><span class="linenos"> 63</span></a><span class="sd">    Based on empirical research showing multipliers vary with:</span>
</span><span id="EconomicConditions-64"><a href="#EconomicConditions-64"><span class="linenos"> 64</span></a><span class="sd">    - Output gap (slack in economy)</span>
</span><span id="EconomicConditions-65"><a href="#EconomicConditions-65"><span class="linenos"> 65</span></a><span class="sd">    - Monetary policy stance (ZLB constraint)</span>
</span><span id="EconomicConditions-66"><a href="#EconomicConditions-66"><span class="linenos"> 66</span></a><span class="sd">    - Exchange rate regime</span>
</span><span id="EconomicConditions-67"><a href="#EconomicConditions-67"><span class="linenos"> 67</span></a><span class="sd">    - Debt levels</span>
</span><span id="EconomicConditions-68"><a href="#EconomicConditions-68"><span class="linenos"> 68</span></a><span class="sd">    </span>
</span><span id="EconomicConditions-69"><a href="#EconomicConditions-69"><span class="linenos"> 69</span></a><span class="sd">    References:</span>
</span><span id="EconomicConditions-70"><a href="#EconomicConditions-70"><span class="linenos"> 70</span></a><span class="sd">    - Auerbach &amp; Gorodnichenko (2012): Multipliers larger in recessions</span>
</span><span id="EconomicConditions-71"><a href="#EconomicConditions-71"><span class="linenos"> 71</span></a><span class="sd">    - Christiano, Eichenbaum &amp; Rebelo (2011): ZLB increases multipliers</span>
</span><span id="EconomicConditions-72"><a href="#EconomicConditions-72"><span class="linenos"> 72</span></a><span class="sd">    - Blanchard &amp; Leigh (2013): IMF underestimated multipliers in 2010-11</span>
</span><span id="EconomicConditions-73"><a href="#EconomicConditions-73"><span class="linenos"> 73</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="EconomicConditions-74"><a href="#EconomicConditions-74"><span class="linenos"> 74</span></a>    
</span><span id="EconomicConditions-75"><a href="#EconomicConditions-75"><span class="linenos"> 75</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="EconomicConditions-76"><a href="#EconomicConditions-76"><span class="linenos"> 76</span></a>                 <span class="n">output_gap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Negative = recession</span>
</span><span id="EconomicConditions-77"><a href="#EconomicConditions-77"><span class="linenos"> 77</span></a>                 <span class="n">at_zero_lower_bound</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="EconomicConditions-78"><a href="#EconomicConditions-78"><span class="linenos"> 78</span></a>                 <span class="n">debt_to_gdp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Current ~100%</span>
</span><span id="EconomicConditions-79"><a href="#EconomicConditions-79"><span class="linenos"> 79</span></a>                 <span class="n">unemployment_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.04</span><span class="p">):</span>
</span><span id="EconomicConditions-80"><a href="#EconomicConditions-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_gap</span> <span class="o">=</span> <span class="n">output_gap</span>
</span><span id="EconomicConditions-81"><a href="#EconomicConditions-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">at_zlb</span> <span class="o">=</span> <span class="n">at_zero_lower_bound</span>
</span><span id="EconomicConditions-82"><a href="#EconomicConditions-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">debt_to_gdp</span> <span class="o">=</span> <span class="n">debt_to_gdp</span>
</span><span id="EconomicConditions-83"><a href="#EconomicConditions-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unemployment_rate</span> <span class="o">=</span> <span class="n">unemployment_rate</span>
</span><span id="EconomicConditions-84"><a href="#EconomicConditions-84"><span class="linenos"> 84</span></a>    
</span><span id="EconomicConditions-85"><a href="#EconomicConditions-85"><span class="linenos"> 85</span></a>    <span class="nd">@classmethod</span>
</span><span id="EconomicConditions-86"><a href="#EconomicConditions-86"><span class="linenos"> 86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">normal_times</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EconomicConditions&#39;</span><span class="p">:</span>
</span><span id="EconomicConditions-87"><a href="#EconomicConditions-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Normal economic conditions (near full employment).&quot;&quot;&quot;</span>
</span><span id="EconomicConditions-88"><a href="#EconomicConditions-88"><span class="linenos"> 88</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_gap</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">at_zero_lower_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
</span><span id="EconomicConditions-89"><a href="#EconomicConditions-89"><span class="linenos"> 89</span></a>                   <span class="n">debt_to_gdp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">unemployment_rate</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
</span><span id="EconomicConditions-90"><a href="#EconomicConditions-90"><span class="linenos"> 90</span></a>    
</span><span id="EconomicConditions-91"><a href="#EconomicConditions-91"><span class="linenos"> 91</span></a>    <span class="nd">@classmethod</span>
</span><span id="EconomicConditions-92"><a href="#EconomicConditions-92"><span class="linenos"> 92</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">recession</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EconomicConditions&#39;</span><span class="p">:</span>
</span><span id="EconomicConditions-93"><a href="#EconomicConditions-93"><span class="linenos"> 93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recession conditions (significant slack).&quot;&quot;&quot;</span>
</span><span id="EconomicConditions-94"><a href="#EconomicConditions-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_gap</span><span class="o">=-</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">at_zero_lower_bound</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EconomicConditions-95"><a href="#EconomicConditions-95"><span class="linenos"> 95</span></a>                   <span class="n">debt_to_gdp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">unemployment_rate</span><span class="o">=</span><span class="mf">0.07</span><span class="p">)</span>
</span><span id="EconomicConditions-96"><a href="#EconomicConditions-96"><span class="linenos"> 96</span></a>    
</span><span id="EconomicConditions-97"><a href="#EconomicConditions-97"><span class="linenos"> 97</span></a>    <span class="nd">@classmethod</span>
</span><span id="EconomicConditions-98"><a href="#EconomicConditions-98"><span class="linenos"> 98</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deep_recession</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EconomicConditions&#39;</span><span class="p">:</span>
</span><span id="EconomicConditions-99"><a href="#EconomicConditions-99"><span class="linenos"> 99</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deep recession (severe slack, like 2009).&quot;&quot;&quot;</span>
</span><span id="EconomicConditions-100"><a href="#EconomicConditions-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_gap</span><span class="o">=-</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">at_zero_lower_bound</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EconomicConditions-101"><a href="#EconomicConditions-101"><span class="linenos">101</span></a>                   <span class="n">debt_to_gdp</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">unemployment_rate</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>
</span><span id="EconomicConditions-102"><a href="#EconomicConditions-102"><span class="linenos">102</span></a>    
</span><span id="EconomicConditions-103"><a href="#EconomicConditions-103"><span class="linenos">103</span></a>    <span class="nd">@classmethod</span>
</span><span id="EconomicConditions-104"><a href="#EconomicConditions-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">overheating</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EconomicConditions&#39;</span><span class="p">:</span>
</span><span id="EconomicConditions-105"><a href="#EconomicConditions-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Overheating economy (above potential).&quot;&quot;&quot;</span>
</span><span id="EconomicConditions-106"><a href="#EconomicConditions-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_gap</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">at_zero_lower_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EconomicConditions-107"><a href="#EconomicConditions-107"><span class="linenos">107</span></a>                   <span class="n">debt_to_gdp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">unemployment_rate</span><span class="o">=</span><span class="mf">0.035</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Economic conditions that affect fiscal multipliers.</p>

<p>Based on empirical research showing multipliers vary with:</p>

<ul>
<li>Output gap (slack in economy)</li>
<li>Monetary policy stance (ZLB constraint)</li>
<li>Exchange rate regime</li>
<li>Debt levels</li>
</ul>

<p>References:</p>

<ul>
<li>Auerbach &amp; Gorodnichenko (2012): Multipliers larger in recessions</li>
<li>Christiano, Eichenbaum &amp; Rebelo (2011): ZLB increases multipliers</li>
<li>Blanchard &amp; Leigh (2013): IMF underestimated multipliers in 2010-11</li>
</ul>
</div>


                            <div id="EconomicConditions.__init__" class="classattr">
                                        <input id="EconomicConditions.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">EconomicConditions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">output_gap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">at_zero_lower_bound</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">debt_to_gdp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>,</span><span class="param">	<span class="n">unemployment_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.04</span></span>)</span>

                <label class="view-source-button" for="EconomicConditions.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicConditions.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicConditions.__init__-75"><a href="#EconomicConditions.__init__-75"><span class="linenos">75</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="EconomicConditions.__init__-76"><a href="#EconomicConditions.__init__-76"><span class="linenos">76</span></a>                 <span class="n">output_gap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Negative = recession</span>
</span><span id="EconomicConditions.__init__-77"><a href="#EconomicConditions.__init__-77"><span class="linenos">77</span></a>                 <span class="n">at_zero_lower_bound</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="EconomicConditions.__init__-78"><a href="#EconomicConditions.__init__-78"><span class="linenos">78</span></a>                 <span class="n">debt_to_gdp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Current ~100%</span>
</span><span id="EconomicConditions.__init__-79"><a href="#EconomicConditions.__init__-79"><span class="linenos">79</span></a>                 <span class="n">unemployment_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.04</span><span class="p">):</span>
</span><span id="EconomicConditions.__init__-80"><a href="#EconomicConditions.__init__-80"><span class="linenos">80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_gap</span> <span class="o">=</span> <span class="n">output_gap</span>
</span><span id="EconomicConditions.__init__-81"><a href="#EconomicConditions.__init__-81"><span class="linenos">81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">at_zlb</span> <span class="o">=</span> <span class="n">at_zero_lower_bound</span>
</span><span id="EconomicConditions.__init__-82"><a href="#EconomicConditions.__init__-82"><span class="linenos">82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">debt_to_gdp</span> <span class="o">=</span> <span class="n">debt_to_gdp</span>
</span><span id="EconomicConditions.__init__-83"><a href="#EconomicConditions.__init__-83"><span class="linenos">83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unemployment_rate</span> <span class="o">=</span> <span class="n">unemployment_rate</span>
</span></pre></div>


    

                            </div>
                            <div id="EconomicConditions.output_gap" class="classattr">
                                <div class="attr variable">
            <span class="name">output_gap</span>

        
    </div>
    <a class="headerlink" href="#EconomicConditions.output_gap"></a>
    
    

                            </div>
                            <div id="EconomicConditions.at_zlb" class="classattr">
                                <div class="attr variable">
            <span class="name">at_zlb</span>

        
    </div>
    <a class="headerlink" href="#EconomicConditions.at_zlb"></a>
    
    

                            </div>
                            <div id="EconomicConditions.debt_to_gdp" class="classattr">
                                <div class="attr variable">
            <span class="name">debt_to_gdp</span>

        
    </div>
    <a class="headerlink" href="#EconomicConditions.debt_to_gdp"></a>
    
    

                            </div>
                            <div id="EconomicConditions.unemployment_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">unemployment_rate</span>

        
    </div>
    <a class="headerlink" href="#EconomicConditions.unemployment_rate"></a>
    
    

                            </div>
                            <div id="EconomicConditions.normal_times" class="classattr">
                                        <input id="EconomicConditions.normal_times-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">normal_times</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span></span><span class="return-annotation">) -> <span class="n"><a href="#EconomicConditions">EconomicConditions</a></span>:</span></span>

                <label class="view-source-button" for="EconomicConditions.normal_times-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicConditions.normal_times"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicConditions.normal_times-85"><a href="#EconomicConditions.normal_times-85"><span class="linenos">85</span></a>    <span class="nd">@classmethod</span>
</span><span id="EconomicConditions.normal_times-86"><a href="#EconomicConditions.normal_times-86"><span class="linenos">86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">normal_times</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EconomicConditions&#39;</span><span class="p">:</span>
</span><span id="EconomicConditions.normal_times-87"><a href="#EconomicConditions.normal_times-87"><span class="linenos">87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Normal economic conditions (near full employment).&quot;&quot;&quot;</span>
</span><span id="EconomicConditions.normal_times-88"><a href="#EconomicConditions.normal_times-88"><span class="linenos">88</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_gap</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">at_zero_lower_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
</span><span id="EconomicConditions.normal_times-89"><a href="#EconomicConditions.normal_times-89"><span class="linenos">89</span></a>                   <span class="n">debt_to_gdp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">unemployment_rate</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Normal economic conditions (near full employment).</p>
</div>


                            </div>
                            <div id="EconomicConditions.recession" class="classattr">
                                        <input id="EconomicConditions.recession-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">recession</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span></span><span class="return-annotation">) -> <span class="n"><a href="#EconomicConditions">EconomicConditions</a></span>:</span></span>

                <label class="view-source-button" for="EconomicConditions.recession-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicConditions.recession"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicConditions.recession-91"><a href="#EconomicConditions.recession-91"><span class="linenos">91</span></a>    <span class="nd">@classmethod</span>
</span><span id="EconomicConditions.recession-92"><a href="#EconomicConditions.recession-92"><span class="linenos">92</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">recession</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EconomicConditions&#39;</span><span class="p">:</span>
</span><span id="EconomicConditions.recession-93"><a href="#EconomicConditions.recession-93"><span class="linenos">93</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recession conditions (significant slack).&quot;&quot;&quot;</span>
</span><span id="EconomicConditions.recession-94"><a href="#EconomicConditions.recession-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_gap</span><span class="o">=-</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">at_zero_lower_bound</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EconomicConditions.recession-95"><a href="#EconomicConditions.recession-95"><span class="linenos">95</span></a>                   <span class="n">debt_to_gdp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">unemployment_rate</span><span class="o">=</span><span class="mf">0.07</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Recession conditions (significant slack).</p>
</div>


                            </div>
                            <div id="EconomicConditions.deep_recession" class="classattr">
                                        <input id="EconomicConditions.deep_recession-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">deep_recession</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span></span><span class="return-annotation">) -> <span class="n"><a href="#EconomicConditions">EconomicConditions</a></span>:</span></span>

                <label class="view-source-button" for="EconomicConditions.deep_recession-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicConditions.deep_recession"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicConditions.deep_recession-97"><a href="#EconomicConditions.deep_recession-97"><span class="linenos"> 97</span></a>    <span class="nd">@classmethod</span>
</span><span id="EconomicConditions.deep_recession-98"><a href="#EconomicConditions.deep_recession-98"><span class="linenos"> 98</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deep_recession</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EconomicConditions&#39;</span><span class="p">:</span>
</span><span id="EconomicConditions.deep_recession-99"><a href="#EconomicConditions.deep_recession-99"><span class="linenos"> 99</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deep recession (severe slack, like 2009).&quot;&quot;&quot;</span>
</span><span id="EconomicConditions.deep_recession-100"><a href="#EconomicConditions.deep_recession-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_gap</span><span class="o">=-</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">at_zero_lower_bound</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EconomicConditions.deep_recession-101"><a href="#EconomicConditions.deep_recession-101"><span class="linenos">101</span></a>                   <span class="n">debt_to_gdp</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">unemployment_rate</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Deep recession (severe slack, like 2009).</p>
</div>


                            </div>
                            <div id="EconomicConditions.overheating" class="classattr">
                                        <input id="EconomicConditions.overheating-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">overheating</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span></span><span class="return-annotation">) -> <span class="n"><a href="#EconomicConditions">EconomicConditions</a></span>:</span></span>

                <label class="view-source-button" for="EconomicConditions.overheating-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EconomicConditions.overheating"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EconomicConditions.overheating-103"><a href="#EconomicConditions.overheating-103"><span class="linenos">103</span></a>    <span class="nd">@classmethod</span>
</span><span id="EconomicConditions.overheating-104"><a href="#EconomicConditions.overheating-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">overheating</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EconomicConditions&#39;</span><span class="p">:</span>
</span><span id="EconomicConditions.overheating-105"><a href="#EconomicConditions.overheating-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Overheating economy (above potential).&quot;&quot;&quot;</span>
</span><span id="EconomicConditions.overheating-106"><a href="#EconomicConditions.overheating-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_gap</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">at_zero_lower_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EconomicConditions.overheating-107"><a href="#EconomicConditions.overheating-107"><span class="linenos">107</span></a>                   <span class="n">debt_to_gdp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">unemployment_rate</span><span class="o">=</span><span class="mf">0.035</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Overheating economy (above potential).</p>
</div>


                            </div>
                </section>
                <section id="DynamicEffects">
                            <input id="DynamicEffects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">DynamicEffects</span>:

                <label class="view-source-button" for="DynamicEffects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DynamicEffects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DynamicEffects-17"><a href="#DynamicEffects-17"><span class="linenos">17</span></a><span class="nd">@dataclass</span>
</span><span id="DynamicEffects-18"><a href="#DynamicEffects-18"><span class="linenos">18</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DynamicEffects</span><span class="p">:</span>
</span><span id="DynamicEffects-19"><a href="#DynamicEffects-19"><span class="linenos">19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicEffects-20"><a href="#DynamicEffects-20"><span class="linenos">20</span></a><span class="sd">    Container for dynamic/macroeconomic effects of a policy.</span>
</span><span id="DynamicEffects-21"><a href="#DynamicEffects-21"><span class="linenos">21</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicEffects-22"><a href="#DynamicEffects-22"><span class="linenos">22</span></a>    <span class="n">years</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="DynamicEffects-23"><a href="#DynamicEffects-23"><span class="linenos">23</span></a>    
</span><span id="DynamicEffects-24"><a href="#DynamicEffects-24"><span class="linenos">24</span></a>    <span class="c1"># GDP effects</span>
</span><span id="DynamicEffects-25"><a href="#DynamicEffects-25"><span class="linenos">25</span></a>    <span class="n">gdp_level_change</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Change in GDP level (billions)</span>
</span><span id="DynamicEffects-26"><a href="#DynamicEffects-26"><span class="linenos">26</span></a>    <span class="n">gdp_percent_change</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Percent change from baseline</span>
</span><span id="DynamicEffects-27"><a href="#DynamicEffects-27"><span class="linenos">27</span></a>    
</span><span id="DynamicEffects-28"><a href="#DynamicEffects-28"><span class="linenos">28</span></a>    <span class="c1"># Labor market effects</span>
</span><span id="DynamicEffects-29"><a href="#DynamicEffects-29"><span class="linenos">29</span></a>    <span class="n">employment_change</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Change in employment (thousands)</span>
</span><span id="DynamicEffects-30"><a href="#DynamicEffects-30"><span class="linenos">30</span></a>    <span class="n">hours_worked_change</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Percent change in hours worked</span>
</span><span id="DynamicEffects-31"><a href="#DynamicEffects-31"><span class="linenos">31</span></a>    <span class="n">labor_force_change</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Change in labor force participation</span>
</span><span id="DynamicEffects-32"><a href="#DynamicEffects-32"><span class="linenos">32</span></a>    
</span><span id="DynamicEffects-33"><a href="#DynamicEffects-33"><span class="linenos">33</span></a>    <span class="c1"># Capital effects</span>
</span><span id="DynamicEffects-34"><a href="#DynamicEffects-34"><span class="linenos">34</span></a>    <span class="n">capital_stock_change</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Percent change in capital stock</span>
</span><span id="DynamicEffects-35"><a href="#DynamicEffects-35"><span class="linenos">35</span></a>    <span class="n">investment_change</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Change in investment (billions)</span>
</span><span id="DynamicEffects-36"><a href="#DynamicEffects-36"><span class="linenos">36</span></a>    
</span><span id="DynamicEffects-37"><a href="#DynamicEffects-37"><span class="linenos">37</span></a>    <span class="c1"># Interest rate effects</span>
</span><span id="DynamicEffects-38"><a href="#DynamicEffects-38"><span class="linenos">38</span></a>    <span class="n">interest_rate_change</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Change in interest rate (percentage points)</span>
</span><span id="DynamicEffects-39"><a href="#DynamicEffects-39"><span class="linenos">39</span></a>    
</span><span id="DynamicEffects-40"><a href="#DynamicEffects-40"><span class="linenos">40</span></a>    <span class="c1"># Revenue feedback</span>
</span><span id="DynamicEffects-41"><a href="#DynamicEffects-41"><span class="linenos">41</span></a>    <span class="n">revenue_feedback</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Additional revenue from economic growth (billions)</span>
</span><span id="DynamicEffects-42"><a href="#DynamicEffects-42"><span class="linenos">42</span></a>    
</span><span id="DynamicEffects-43"><a href="#DynamicEffects-43"><span class="linenos">43</span></a>    <span class="nd">@property</span>
</span><span id="DynamicEffects-44"><a href="#DynamicEffects-44"><span class="linenos">44</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cumulative_gdp_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DynamicEffects-45"><a href="#DynamicEffects-45"><span class="linenos">45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total GDP effect over the window.&quot;&quot;&quot;</span>
</span><span id="DynamicEffects-46"><a href="#DynamicEffects-46"><span class="linenos">46</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">)</span>
</span><span id="DynamicEffects-47"><a href="#DynamicEffects-47"><span class="linenos">47</span></a>    
</span><span id="DynamicEffects-48"><a href="#DynamicEffects-48"><span class="linenos">48</span></a>    <span class="nd">@property</span>
</span><span id="DynamicEffects-49"><a href="#DynamicEffects-49"><span class="linenos">49</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cumulative_revenue_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DynamicEffects-50"><a href="#DynamicEffects-50"><span class="linenos">50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total revenue feedback over the window.&quot;&quot;&quot;</span>
</span><span id="DynamicEffects-51"><a href="#DynamicEffects-51"><span class="linenos">51</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">)</span>
</span><span id="DynamicEffects-52"><a href="#DynamicEffects-52"><span class="linenos">52</span></a>    
</span><span id="DynamicEffects-53"><a href="#DynamicEffects-53"><span class="linenos">53</span></a>    <span class="nd">@property</span>
</span><span id="DynamicEffects-54"><a href="#DynamicEffects-54"><span class="linenos">54</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">average_employment_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DynamicEffects-55"><a href="#DynamicEffects-55"><span class="linenos">55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Average employment change over the window.&quot;&quot;&quot;</span>
</span><span id="DynamicEffects-56"><a href="#DynamicEffects-56"><span class="linenos">56</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">employment_change</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Container for dynamic/macroeconomic effects of a policy.</p>
</div>


                            <div id="DynamicEffects.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">DynamicEffects</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">years</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">gdp_level_change</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">gdp_percent_change</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">employment_change</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">hours_worked_change</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">labor_force_change</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">capital_stock_change</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">investment_change</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">interest_rate_change</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">revenue_feedback</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.__init__"></a>
    
    

                            </div>
                            <div id="DynamicEffects.years" class="classattr">
                                <div class="attr variable">
            <span class="name">years</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.years"></a>
    
    

                            </div>
                            <div id="DynamicEffects.gdp_level_change" class="classattr">
                                <div class="attr variable">
            <span class="name">gdp_level_change</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.gdp_level_change"></a>
    
    

                            </div>
                            <div id="DynamicEffects.gdp_percent_change" class="classattr">
                                <div class="attr variable">
            <span class="name">gdp_percent_change</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.gdp_percent_change"></a>
    
    

                            </div>
                            <div id="DynamicEffects.employment_change" class="classattr">
                                <div class="attr variable">
            <span class="name">employment_change</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.employment_change"></a>
    
    

                            </div>
                            <div id="DynamicEffects.hours_worked_change" class="classattr">
                                <div class="attr variable">
            <span class="name">hours_worked_change</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.hours_worked_change"></a>
    
    

                            </div>
                            <div id="DynamicEffects.labor_force_change" class="classattr">
                                <div class="attr variable">
            <span class="name">labor_force_change</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.labor_force_change"></a>
    
    

                            </div>
                            <div id="DynamicEffects.capital_stock_change" class="classattr">
                                <div class="attr variable">
            <span class="name">capital_stock_change</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.capital_stock_change"></a>
    
    

                            </div>
                            <div id="DynamicEffects.investment_change" class="classattr">
                                <div class="attr variable">
            <span class="name">investment_change</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.investment_change"></a>
    
    

                            </div>
                            <div id="DynamicEffects.interest_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">interest_rate_change</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.interest_rate_change"></a>
    
    

                            </div>
                            <div id="DynamicEffects.revenue_feedback" class="classattr">
                                <div class="attr variable">
            <span class="name">revenue_feedback</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#DynamicEffects.revenue_feedback"></a>
    
    

                            </div>
                            <div id="DynamicEffects.cumulative_gdp_effect" class="classattr">
                                        <input id="DynamicEffects.cumulative_gdp_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">cumulative_gdp_effect</span><span class="annotation">: float</span>

                <label class="view-source-button" for="DynamicEffects.cumulative_gdp_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DynamicEffects.cumulative_gdp_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DynamicEffects.cumulative_gdp_effect-43"><a href="#DynamicEffects.cumulative_gdp_effect-43"><span class="linenos">43</span></a>    <span class="nd">@property</span>
</span><span id="DynamicEffects.cumulative_gdp_effect-44"><a href="#DynamicEffects.cumulative_gdp_effect-44"><span class="linenos">44</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cumulative_gdp_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DynamicEffects.cumulative_gdp_effect-45"><a href="#DynamicEffects.cumulative_gdp_effect-45"><span class="linenos">45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total GDP effect over the window.&quot;&quot;&quot;</span>
</span><span id="DynamicEffects.cumulative_gdp_effect-46"><a href="#DynamicEffects.cumulative_gdp_effect-46"><span class="linenos">46</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Total GDP effect over the window.</p>
</div>


                            </div>
                            <div id="DynamicEffects.cumulative_revenue_feedback" class="classattr">
                                        <input id="DynamicEffects.cumulative_revenue_feedback-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">cumulative_revenue_feedback</span><span class="annotation">: float</span>

                <label class="view-source-button" for="DynamicEffects.cumulative_revenue_feedback-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DynamicEffects.cumulative_revenue_feedback"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DynamicEffects.cumulative_revenue_feedback-48"><a href="#DynamicEffects.cumulative_revenue_feedback-48"><span class="linenos">48</span></a>    <span class="nd">@property</span>
</span><span id="DynamicEffects.cumulative_revenue_feedback-49"><a href="#DynamicEffects.cumulative_revenue_feedback-49"><span class="linenos">49</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cumulative_revenue_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DynamicEffects.cumulative_revenue_feedback-50"><a href="#DynamicEffects.cumulative_revenue_feedback-50"><span class="linenos">50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total revenue feedback over the window.&quot;&quot;&quot;</span>
</span><span id="DynamicEffects.cumulative_revenue_feedback-51"><a href="#DynamicEffects.cumulative_revenue_feedback-51"><span class="linenos">51</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Total revenue feedback over the window.</p>
</div>


                            </div>
                            <div id="DynamicEffects.average_employment_effect" class="classattr">
                                        <input id="DynamicEffects.average_employment_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">average_employment_effect</span><span class="annotation">: float</span>

                <label class="view-source-button" for="DynamicEffects.average_employment_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DynamicEffects.average_employment_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DynamicEffects.average_employment_effect-53"><a href="#DynamicEffects.average_employment_effect-53"><span class="linenos">53</span></a>    <span class="nd">@property</span>
</span><span id="DynamicEffects.average_employment_effect-54"><a href="#DynamicEffects.average_employment_effect-54"><span class="linenos">54</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">average_employment_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DynamicEffects.average_employment_effect-55"><a href="#DynamicEffects.average_employment_effect-55"><span class="linenos">55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Average employment change over the window.&quot;&quot;&quot;</span>
</span><span id="DynamicEffects.average_employment_effect-56"><a href="#DynamicEffects.average_employment_effect-56"><span class="linenos">56</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">employment_change</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Average employment change over the window.</p>
</div>


                            </div>
                </section>
                <section id="UncertaintyAnalysis">
                            <input id="UncertaintyAnalysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">UncertaintyAnalysis</span>:

                <label class="view-source-button" for="UncertaintyAnalysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UncertaintyAnalysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UncertaintyAnalysis-59"><a href="#UncertaintyAnalysis-59"><span class="linenos"> 59</span></a><span class="k">class</span><span class="w"> </span><span class="nc">UncertaintyAnalysis</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-60"><a href="#UncertaintyAnalysis-60"><span class="linenos"> 60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-61"><a href="#UncertaintyAnalysis-61"><span class="linenos"> 61</span></a><span class="sd">    Comprehensive uncertainty analysis for fiscal projections.</span>
</span><span id="UncertaintyAnalysis-62"><a href="#UncertaintyAnalysis-62"><span class="linenos"> 62</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-63"><a href="#UncertaintyAnalysis-63"><span class="linenos"> 63</span></a>    
</span><span id="UncertaintyAnalysis-64"><a href="#UncertaintyAnalysis-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UncertaintyFactors</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-65"><a href="#UncertaintyAnalysis-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">factors</span> <span class="o">=</span> <span class="n">factors</span> <span class="ow">or</span> <span class="n">UncertaintyFactors</span><span class="p">()</span>
</span><span id="UncertaintyAnalysis-66"><a href="#UncertaintyAnalysis-66"><span class="linenos"> 66</span></a>        
</span><span id="UncertaintyAnalysis-67"><a href="#UncertaintyAnalysis-67"><span class="linenos"> 67</span></a>        <span class="c1"># Correlation matrix for economic variables</span>
</span><span id="UncertaintyAnalysis-68"><a href="#UncertaintyAnalysis-68"><span class="linenos"> 68</span></a>        <span class="c1"># (GDP, inflation, unemployment, interest rates)</span>
</span><span id="UncertaintyAnalysis-69"><a href="#UncertaintyAnalysis-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">econ_correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
</span><span id="UncertaintyAnalysis-70"><a href="#UncertaintyAnalysis-70"><span class="linenos"> 70</span></a>            <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
</span><span id="UncertaintyAnalysis-71"><a href="#UncertaintyAnalysis-71"><span class="linenos"> 71</span></a>            <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
</span><span id="UncertaintyAnalysis-72"><a href="#UncertaintyAnalysis-72"><span class="linenos"> 72</span></a>            <span class="p">[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
</span><span id="UncertaintyAnalysis-73"><a href="#UncertaintyAnalysis-73"><span class="linenos"> 73</span></a>            <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis-74"><a href="#UncertaintyAnalysis-74"><span class="linenos"> 74</span></a>        <span class="p">])</span>
</span><span id="UncertaintyAnalysis-75"><a href="#UncertaintyAnalysis-75"><span class="linenos"> 75</span></a>    
</span><span id="UncertaintyAnalysis-76"><a href="#UncertaintyAnalysis-76"><span class="linenos"> 76</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_baseline_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="UncertaintyAnalysis-77"><a href="#UncertaintyAnalysis-77"><span class="linenos"> 77</span></a>                                       <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineProjection</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-78"><a href="#UncertaintyAnalysis-78"><span class="linenos"> 78</span></a>                                       <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-79"><a href="#UncertaintyAnalysis-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-80"><a href="#UncertaintyAnalysis-80"><span class="linenos"> 80</span></a><span class="sd">        Calculate uncertainty ranges for baseline projections.</span>
</span><span id="UncertaintyAnalysis-81"><a href="#UncertaintyAnalysis-81"><span class="linenos"> 81</span></a><span class="sd">        </span>
</span><span id="UncertaintyAnalysis-82"><a href="#UncertaintyAnalysis-82"><span class="linenos"> 82</span></a><span class="sd">        Args:</span>
</span><span id="UncertaintyAnalysis-83"><a href="#UncertaintyAnalysis-83"><span class="linenos"> 83</span></a><span class="sd">            baseline: Baseline projection</span>
</span><span id="UncertaintyAnalysis-84"><a href="#UncertaintyAnalysis-84"><span class="linenos"> 84</span></a><span class="sd">            percentile: Percentile for confidence interval (default 90%)</span>
</span><span id="UncertaintyAnalysis-85"><a href="#UncertaintyAnalysis-85"><span class="linenos"> 85</span></a><span class="sd">            </span>
</span><span id="UncertaintyAnalysis-86"><a href="#UncertaintyAnalysis-86"><span class="linenos"> 86</span></a><span class="sd">        Returns:</span>
</span><span id="UncertaintyAnalysis-87"><a href="#UncertaintyAnalysis-87"><span class="linenos"> 87</span></a><span class="sd">            Dictionary with low/high estimates for major categories</span>
</span><span id="UncertaintyAnalysis-88"><a href="#UncertaintyAnalysis-88"><span class="linenos"> 88</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-89"><a href="#UncertaintyAnalysis-89"><span class="linenos"> 89</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-90"><a href="#UncertaintyAnalysis-90"><span class="linenos"> 90</span></a>        <span class="n">z_score</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">percentile</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-91"><a href="#UncertaintyAnalysis-91"><span class="linenos"> 91</span></a>        
</span><span id="UncertaintyAnalysis-92"><a href="#UncertaintyAnalysis-92"><span class="linenos"> 92</span></a>        <span class="c1"># Time-increasing uncertainty</span>
</span><span id="UncertaintyAnalysis-93"><a href="#UncertaintyAnalysis-93"><span class="linenos"> 93</span></a>        <span class="n">time_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_years</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="UncertaintyAnalysis-94"><a href="#UncertaintyAnalysis-94"><span class="linenos"> 94</span></a>        
</span><span id="UncertaintyAnalysis-95"><a href="#UncertaintyAnalysis-95"><span class="linenos"> 95</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="UncertaintyAnalysis-96"><a href="#UncertaintyAnalysis-96"><span class="linenos"> 96</span></a>        
</span><span id="UncertaintyAnalysis-97"><a href="#UncertaintyAnalysis-97"><span class="linenos"> 97</span></a>        <span class="c1"># Revenue uncertainty</span>
</span><span id="UncertaintyAnalysis-98"><a href="#UncertaintyAnalysis-98"><span class="linenos"> 98</span></a>        <span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">cv</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="UncertaintyAnalysis-99"><a href="#UncertaintyAnalysis-99"><span class="linenos"> 99</span></a>            <span class="p">(</span><span class="s1">&#39;individual_income_tax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">individual_tax_cv</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-100"><a href="#UncertaintyAnalysis-100"><span class="linenos">100</span></a>            <span class="p">(</span><span class="s1">&#39;corporate_income_tax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">corporate_tax_cv</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-101"><a href="#UncertaintyAnalysis-101"><span class="linenos">101</span></a>            <span class="p">(</span><span class="s1">&#39;payroll_taxes&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">payroll_tax_cv</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-102"><a href="#UncertaintyAnalysis-102"><span class="linenos">102</span></a>        <span class="p">]:</span>
</span><span id="UncertaintyAnalysis-103"><a href="#UncertaintyAnalysis-103"><span class="linenos">103</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">cat</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-104"><a href="#UncertaintyAnalysis-104"><span class="linenos">104</span></a>            <span class="n">std</span> <span class="o">=</span> <span class="n">values</span> <span class="o">*</span> <span class="n">cv</span> <span class="o">*</span> <span class="n">time_factor</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-105"><a href="#UncertaintyAnalysis-105"><span class="linenos">105</span></a>            <span class="n">results</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis-106"><a href="#UncertaintyAnalysis-106"><span class="linenos">106</span></a>                <span class="s1">&#39;central&#39;</span><span class="p">:</span> <span class="n">values</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-107"><a href="#UncertaintyAnalysis-107"><span class="linenos">107</span></a>                <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">values</span> <span class="o">-</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-108"><a href="#UncertaintyAnalysis-108"><span class="linenos">108</span></a>                <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">values</span> <span class="o">+</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-109"><a href="#UncertaintyAnalysis-109"><span class="linenos">109</span></a>            <span class="p">}</span>
</span><span id="UncertaintyAnalysis-110"><a href="#UncertaintyAnalysis-110"><span class="linenos">110</span></a>        
</span><span id="UncertaintyAnalysis-111"><a href="#UncertaintyAnalysis-111"><span class="linenos">111</span></a>        <span class="c1"># Spending uncertainty</span>
</span><span id="UncertaintyAnalysis-112"><a href="#UncertaintyAnalysis-112"><span class="linenos">112</span></a>        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;total_mandatory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_mandatory_uncertainty</span><span class="p">(</span>
</span><span id="UncertaintyAnalysis-113"><a href="#UncertaintyAnalysis-113"><span class="linenos">113</span></a>            <span class="n">baseline</span><span class="p">,</span> <span class="n">z_score</span><span class="p">,</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis-114"><a href="#UncertaintyAnalysis-114"><span class="linenos">114</span></a>        <span class="p">)</span>
</span><span id="UncertaintyAnalysis-115"><a href="#UncertaintyAnalysis-115"><span class="linenos">115</span></a>        
</span><span id="UncertaintyAnalysis-116"><a href="#UncertaintyAnalysis-116"><span class="linenos">116</span></a>        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;net_interest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis-117"><a href="#UncertaintyAnalysis-117"><span class="linenos">117</span></a>            <span class="s1">&#39;central&#39;</span><span class="p">:</span> <span class="n">baseline</span><span class="o">.</span><span class="n">net_interest</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-118"><a href="#UncertaintyAnalysis-118"><span class="linenos">118</span></a>            <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">baseline</span><span class="o">.</span><span class="n">net_interest</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">interest_cv</span> <span class="o">*</span> <span class="n">z_score</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-119"><a href="#UncertaintyAnalysis-119"><span class="linenos">119</span></a>            <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">baseline</span><span class="o">.</span><span class="n">net_interest</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">interest_cv</span> <span class="o">*</span> <span class="n">z_score</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-120"><a href="#UncertaintyAnalysis-120"><span class="linenos">120</span></a>        <span class="p">}</span>
</span><span id="UncertaintyAnalysis-121"><a href="#UncertaintyAnalysis-121"><span class="linenos">121</span></a>        
</span><span id="UncertaintyAnalysis-122"><a href="#UncertaintyAnalysis-122"><span class="linenos">122</span></a>        <span class="c1"># Aggregate</span>
</span><span id="UncertaintyAnalysis-123"><a href="#UncertaintyAnalysis-123"><span class="linenos">123</span></a>        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;total_deficit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_uncertainty</span><span class="p">(</span>
</span><span id="UncertaintyAnalysis-124"><a href="#UncertaintyAnalysis-124"><span class="linenos">124</span></a>            <span class="n">baseline</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">z_score</span><span class="p">,</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis-125"><a href="#UncertaintyAnalysis-125"><span class="linenos">125</span></a>        <span class="p">)</span>
</span><span id="UncertaintyAnalysis-126"><a href="#UncertaintyAnalysis-126"><span class="linenos">126</span></a>        
</span><span id="UncertaintyAnalysis-127"><a href="#UncertaintyAnalysis-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="UncertaintyAnalysis-128"><a href="#UncertaintyAnalysis-128"><span class="linenos">128</span></a>    
</span><span id="UncertaintyAnalysis-129"><a href="#UncertaintyAnalysis-129"><span class="linenos">129</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_policy_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-130"><a href="#UncertaintyAnalysis-130"><span class="linenos">130</span></a>                                    <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-131"><a href="#UncertaintyAnalysis-131"><span class="linenos">131</span></a>                                    <span class="n">central_estimate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-132"><a href="#UncertaintyAnalysis-132"><span class="linenos">132</span></a>                                    <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-133"><a href="#UncertaintyAnalysis-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-134"><a href="#UncertaintyAnalysis-134"><span class="linenos">134</span></a><span class="sd">        Calculate uncertainty specific to a policy proposal.</span>
</span><span id="UncertaintyAnalysis-135"><a href="#UncertaintyAnalysis-135"><span class="linenos">135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-136"><a href="#UncertaintyAnalysis-136"><span class="linenos">136</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-137"><a href="#UncertaintyAnalysis-137"><span class="linenos">137</span></a>        <span class="n">z_score</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">percentile</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-138"><a href="#UncertaintyAnalysis-138"><span class="linenos">138</span></a>        
</span><span id="UncertaintyAnalysis-139"><a href="#UncertaintyAnalysis-139"><span class="linenos">139</span></a>        <span class="c1"># Base CV depends on policy type</span>
</span><span id="UncertaintyAnalysis-140"><a href="#UncertaintyAnalysis-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-141"><a href="#UncertaintyAnalysis-141"><span class="linenos">141</span></a>            <span class="n">base_cv</span> <span class="o">=</span> <span class="mf">0.15</span>
</span><span id="UncertaintyAnalysis-142"><a href="#UncertaintyAnalysis-142"><span class="linenos">142</span></a>            <span class="n">behavioral_cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">behavioral_response_cv</span>
</span><span id="UncertaintyAnalysis-143"><a href="#UncertaintyAnalysis-143"><span class="linenos">143</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">SpendingPolicy</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-144"><a href="#UncertaintyAnalysis-144"><span class="linenos">144</span></a>            <span class="n">base_cv</span> <span class="o">=</span> <span class="mf">0.10</span>
</span><span id="UncertaintyAnalysis-145"><a href="#UncertaintyAnalysis-145"><span class="linenos">145</span></a>            <span class="n">behavioral_cv</span> <span class="o">=</span> <span class="mf">0.10</span>
</span><span id="UncertaintyAnalysis-146"><a href="#UncertaintyAnalysis-146"><span class="linenos">146</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TransferPolicy</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-147"><a href="#UncertaintyAnalysis-147"><span class="linenos">147</span></a>            <span class="n">base_cv</span> <span class="o">=</span> <span class="mf">0.12</span>
</span><span id="UncertaintyAnalysis-148"><a href="#UncertaintyAnalysis-148"><span class="linenos">148</span></a>            <span class="n">behavioral_cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">participation_cv</span>
</span><span id="UncertaintyAnalysis-149"><a href="#UncertaintyAnalysis-149"><span class="linenos">149</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-150"><a href="#UncertaintyAnalysis-150"><span class="linenos">150</span></a>            <span class="n">base_cv</span> <span class="o">=</span> <span class="mf">0.15</span>
</span><span id="UncertaintyAnalysis-151"><a href="#UncertaintyAnalysis-151"><span class="linenos">151</span></a>            <span class="n">behavioral_cv</span> <span class="o">=</span> <span class="mf">0.20</span>
</span><span id="UncertaintyAnalysis-152"><a href="#UncertaintyAnalysis-152"><span class="linenos">152</span></a>        
</span><span id="UncertaintyAnalysis-153"><a href="#UncertaintyAnalysis-153"><span class="linenos">153</span></a>        <span class="c1"># Time-increasing uncertainty</span>
</span><span id="UncertaintyAnalysis-154"><a href="#UncertaintyAnalysis-154"><span class="linenos">154</span></a>        <span class="n">time_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">)])</span>
</span><span id="UncertaintyAnalysis-155"><a href="#UncertaintyAnalysis-155"><span class="linenos">155</span></a>        
</span><span id="UncertaintyAnalysis-156"><a href="#UncertaintyAnalysis-156"><span class="linenos">156</span></a>        <span class="c1"># Combine sources</span>
</span><span id="UncertaintyAnalysis-157"><a href="#UncertaintyAnalysis-157"><span class="linenos">157</span></a>        <span class="n">total_cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">base_cv</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">behavioral_cv</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis-158"><a href="#UncertaintyAnalysis-158"><span class="linenos">158</span></a>        
</span><span id="UncertaintyAnalysis-159"><a href="#UncertaintyAnalysis-159"><span class="linenos">159</span></a>        <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)</span> <span class="o">*</span> <span class="n">total_cv</span>
</span><span id="UncertaintyAnalysis-160"><a href="#UncertaintyAnalysis-160"><span class="linenos">160</span></a>        
</span><span id="UncertaintyAnalysis-161"><a href="#UncertaintyAnalysis-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis-162"><a href="#UncertaintyAnalysis-162"><span class="linenos">162</span></a>            <span class="s1">&#39;central&#39;</span><span class="p">:</span> <span class="n">central_estimate</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-163"><a href="#UncertaintyAnalysis-163"><span class="linenos">163</span></a>            <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">-</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-164"><a href="#UncertaintyAnalysis-164"><span class="linenos">164</span></a>            <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">+</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-165"><a href="#UncertaintyAnalysis-165"><span class="linenos">165</span></a>            <span class="s1">&#39;10th&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">-</span> <span class="mf">1.28</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-166"><a href="#UncertaintyAnalysis-166"><span class="linenos">166</span></a>            <span class="s1">&#39;25th&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">-</span> <span class="mf">0.67</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-167"><a href="#UncertaintyAnalysis-167"><span class="linenos">167</span></a>            <span class="s1">&#39;75th&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">+</span> <span class="mf">0.67</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-168"><a href="#UncertaintyAnalysis-168"><span class="linenos">168</span></a>            <span class="s1">&#39;90th&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">+</span> <span class="mf">1.28</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-169"><a href="#UncertaintyAnalysis-169"><span class="linenos">169</span></a>        <span class="p">}</span>
</span><span id="UncertaintyAnalysis-170"><a href="#UncertaintyAnalysis-170"><span class="linenos">170</span></a>    
</span><span id="UncertaintyAnalysis-171"><a href="#UncertaintyAnalysis-171"><span class="linenos">171</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">monte_carlo_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-172"><a href="#UncertaintyAnalysis-172"><span class="linenos">172</span></a>                              <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-173"><a href="#UncertaintyAnalysis-173"><span class="linenos">173</span></a>                              <span class="n">central_estimate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-174"><a href="#UncertaintyAnalysis-174"><span class="linenos">174</span></a>                              <span class="n">n_simulations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-175"><a href="#UncertaintyAnalysis-175"><span class="linenos">175</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-176"><a href="#UncertaintyAnalysis-176"><span class="linenos">176</span></a><span class="sd">        Run Monte Carlo simulation for more detailed uncertainty analysis.</span>
</span><span id="UncertaintyAnalysis-177"><a href="#UncertaintyAnalysis-177"><span class="linenos">177</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-178"><a href="#UncertaintyAnalysis-178"><span class="linenos">178</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-179"><a href="#UncertaintyAnalysis-179"><span class="linenos">179</span></a>        <span class="n">simulations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_simulations</span><span class="p">,</span> <span class="n">n_years</span><span class="p">))</span>
</span><span id="UncertaintyAnalysis-180"><a href="#UncertaintyAnalysis-180"><span class="linenos">180</span></a>        
</span><span id="UncertaintyAnalysis-181"><a href="#UncertaintyAnalysis-181"><span class="linenos">181</span></a>        <span class="c1"># Generate correlated economic shocks</span>
</span><span id="UncertaintyAnalysis-182"><a href="#UncertaintyAnalysis-182"><span class="linenos">182</span></a>        <span class="n">econ_shocks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_correlated_shocks</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-183"><a href="#UncertaintyAnalysis-183"><span class="linenos">183</span></a>        
</span><span id="UncertaintyAnalysis-184"><a href="#UncertaintyAnalysis-184"><span class="linenos">184</span></a>        <span class="k">for</span> <span class="n">sim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-185"><a href="#UncertaintyAnalysis-185"><span class="linenos">185</span></a>            <span class="c1"># Economic uncertainty</span>
</span><span id="UncertaintyAnalysis-186"><a href="#UncertaintyAnalysis-186"><span class="linenos">186</span></a>            <span class="n">gdp_shock</span> <span class="o">=</span> <span class="n">econ_shocks</span><span class="p">[</span><span class="n">sim</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis-187"><a href="#UncertaintyAnalysis-187"><span class="linenos">187</span></a>            
</span><span id="UncertaintyAnalysis-188"><a href="#UncertaintyAnalysis-188"><span class="linenos">188</span></a>            <span class="c1"># Policy-specific uncertainty</span>
</span><span id="UncertaintyAnalysis-189"><a href="#UncertaintyAnalysis-189"><span class="linenos">189</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-190"><a href="#UncertaintyAnalysis-190"><span class="linenos">190</span></a>                <span class="n">policy_shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-191"><a href="#UncertaintyAnalysis-191"><span class="linenos">191</span></a>                <span class="n">behavioral_shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-192"><a href="#UncertaintyAnalysis-192"><span class="linenos">192</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-193"><a href="#UncertaintyAnalysis-193"><span class="linenos">193</span></a>                <span class="n">policy_shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-194"><a href="#UncertaintyAnalysis-194"><span class="linenos">194</span></a>                <span class="n">behavioral_shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-195"><a href="#UncertaintyAnalysis-195"><span class="linenos">195</span></a>            
</span><span id="UncertaintyAnalysis-196"><a href="#UncertaintyAnalysis-196"><span class="linenos">196</span></a>            <span class="c1"># Combine shocks</span>
</span><span id="UncertaintyAnalysis-197"><a href="#UncertaintyAnalysis-197"><span class="linenos">197</span></a>            <span class="n">total_shock</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">gdp_shock</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">policy_shock</span> <span class="o">+</span> <span class="n">behavioral_shock</span>
</span><span id="UncertaintyAnalysis-198"><a href="#UncertaintyAnalysis-198"><span class="linenos">198</span></a>            
</span><span id="UncertaintyAnalysis-199"><a href="#UncertaintyAnalysis-199"><span class="linenos">199</span></a>            <span class="c1"># Time-cumulating effect for persistent shocks</span>
</span><span id="UncertaintyAnalysis-200"><a href="#UncertaintyAnalysis-200"><span class="linenos">200</span></a>            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_years</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-201"><a href="#UncertaintyAnalysis-201"><span class="linenos">201</span></a>                <span class="n">total_shock</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_shock</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">+</span> <span class="n">total_shock</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.7</span>
</span><span id="UncertaintyAnalysis-202"><a href="#UncertaintyAnalysis-202"><span class="linenos">202</span></a>            
</span><span id="UncertaintyAnalysis-203"><a href="#UncertaintyAnalysis-203"><span class="linenos">203</span></a>            <span class="n">simulations</span><span class="p">[</span><span class="n">sim</span><span class="p">]</span> <span class="o">=</span> <span class="n">central_estimate</span> <span class="o">*</span> <span class="n">total_shock</span>
</span><span id="UncertaintyAnalysis-204"><a href="#UncertaintyAnalysis-204"><span class="linenos">204</span></a>        
</span><span id="UncertaintyAnalysis-205"><a href="#UncertaintyAnalysis-205"><span class="linenos">205</span></a>        <span class="c1"># Calculate statistics</span>
</span><span id="UncertaintyAnalysis-206"><a href="#UncertaintyAnalysis-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis-207"><a href="#UncertaintyAnalysis-207"><span class="linenos">207</span></a>            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-208"><a href="#UncertaintyAnalysis-208"><span class="linenos">208</span></a>            <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-209"><a href="#UncertaintyAnalysis-209"><span class="linenos">209</span></a>            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-210"><a href="#UncertaintyAnalysis-210"><span class="linenos">210</span></a>            <span class="s1">&#39;p10&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-211"><a href="#UncertaintyAnalysis-211"><span class="linenos">211</span></a>            <span class="s1">&#39;p25&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-212"><a href="#UncertaintyAnalysis-212"><span class="linenos">212</span></a>            <span class="s1">&#39;p75&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-213"><a href="#UncertaintyAnalysis-213"><span class="linenos">213</span></a>            <span class="s1">&#39;p90&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis-214"><a href="#UncertaintyAnalysis-214"><span class="linenos">214</span></a>            <span class="s1">&#39;simulations&#39;</span><span class="p">:</span> <span class="n">simulations</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-215"><a href="#UncertaintyAnalysis-215"><span class="linenos">215</span></a>        <span class="p">}</span>
</span><span id="UncertaintyAnalysis-216"><a href="#UncertaintyAnalysis-216"><span class="linenos">216</span></a>    
</span><span id="UncertaintyAnalysis-217"><a href="#UncertaintyAnalysis-217"><span class="linenos">217</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sensitivity_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-218"><a href="#UncertaintyAnalysis-218"><span class="linenos">218</span></a>                            <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-219"><a href="#UncertaintyAnalysis-219"><span class="linenos">219</span></a>                            <span class="n">central_estimate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-220"><a href="#UncertaintyAnalysis-220"><span class="linenos">220</span></a>                            <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-221"><a href="#UncertaintyAnalysis-221"><span class="linenos">221</span></a>                            <span class="n">range_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SensitivityResult</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-222"><a href="#UncertaintyAnalysis-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-223"><a href="#UncertaintyAnalysis-223"><span class="linenos">223</span></a><span class="sd">        Analyze sensitivity to a specific parameter.</span>
</span><span id="UncertaintyAnalysis-224"><a href="#UncertaintyAnalysis-224"><span class="linenos">224</span></a><span class="sd">        </span>
</span><span id="UncertaintyAnalysis-225"><a href="#UncertaintyAnalysis-225"><span class="linenos">225</span></a><span class="sd">        Args:</span>
</span><span id="UncertaintyAnalysis-226"><a href="#UncertaintyAnalysis-226"><span class="linenos">226</span></a><span class="sd">            policy: Policy being analyzed</span>
</span><span id="UncertaintyAnalysis-227"><a href="#UncertaintyAnalysis-227"><span class="linenos">227</span></a><span class="sd">            central_estimate: Central cost estimate</span>
</span><span id="UncertaintyAnalysis-228"><a href="#UncertaintyAnalysis-228"><span class="linenos">228</span></a><span class="sd">            parameter: Parameter name to vary</span>
</span><span id="UncertaintyAnalysis-229"><a href="#UncertaintyAnalysis-229"><span class="linenos">229</span></a><span class="sd">            range_pct: Percentage range to test (e.g., 0.5 = 50%)</span>
</span><span id="UncertaintyAnalysis-230"><a href="#UncertaintyAnalysis-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-231"><a href="#UncertaintyAnalysis-231"><span class="linenos">231</span></a>        <span class="n">n_points</span> <span class="o">=</span> <span class="mi">11</span>
</span><span id="UncertaintyAnalysis-232"><a href="#UncertaintyAnalysis-232"><span class="linenos">232</span></a>        <span class="n">multipliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">range_pct</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">range_pct</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-233"><a href="#UncertaintyAnalysis-233"><span class="linenos">233</span></a>        
</span><span id="UncertaintyAnalysis-234"><a href="#UncertaintyAnalysis-234"><span class="linenos">234</span></a>        <span class="c1"># Map parameter to effect type</span>
</span><span id="UncertaintyAnalysis-235"><a href="#UncertaintyAnalysis-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;gdp_growth&#39;</span><span class="p">,</span> <span class="s1">&#39;economic_growth&#39;</span><span class="p">]:</span>
</span><span id="UncertaintyAnalysis-236"><a href="#UncertaintyAnalysis-236"><span class="linenos">236</span></a>            <span class="c1"># Higher growth -&gt; lower costs for transfers, higher revenue</span>
</span><span id="UncertaintyAnalysis-237"><a href="#UncertaintyAnalysis-237"><span class="linenos">237</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
</span><span id="UncertaintyAnalysis-238"><a href="#UncertaintyAnalysis-238"><span class="linenos">238</span></a>        <span class="k">elif</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;interest_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;inflation&#39;</span><span class="p">]:</span>
</span><span id="UncertaintyAnalysis-239"><a href="#UncertaintyAnalysis-239"><span class="linenos">239</span></a>            <span class="c1"># Higher rates -&gt; higher interest costs</span>
</span><span id="UncertaintyAnalysis-240"><a href="#UncertaintyAnalysis-240"><span class="linenos">240</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="mf">0.3</span>
</span><span id="UncertaintyAnalysis-241"><a href="#UncertaintyAnalysis-241"><span class="linenos">241</span></a>        <span class="k">elif</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s1">&#39;behavioral_elasticity&#39;</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-242"><a href="#UncertaintyAnalysis-242"><span class="linenos">242</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="mf">0.4</span>
</span><span id="UncertaintyAnalysis-243"><a href="#UncertaintyAnalysis-243"><span class="linenos">243</span></a>        <span class="k">elif</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s1">&#39;participation_rate&#39;</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-244"><a href="#UncertaintyAnalysis-244"><span class="linenos">244</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="mf">0.8</span>
</span><span id="UncertaintyAnalysis-245"><a href="#UncertaintyAnalysis-245"><span class="linenos">245</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-246"><a href="#UncertaintyAnalysis-246"><span class="linenos">246</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="mf">0.2</span>
</span><span id="UncertaintyAnalysis-247"><a href="#UncertaintyAnalysis-247"><span class="linenos">247</span></a>        
</span><span id="UncertaintyAnalysis-248"><a href="#UncertaintyAnalysis-248"><span class="linenos">248</span></a>        <span class="c1"># Calculate effects at each point</span>
</span><span id="UncertaintyAnalysis-249"><a href="#UncertaintyAnalysis-249"><span class="linenos">249</span></a>        <span class="n">effects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_points</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)))</span>
</span><span id="UncertaintyAnalysis-250"><a href="#UncertaintyAnalysis-250"><span class="linenos">250</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mult</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multipliers</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-251"><a href="#UncertaintyAnalysis-251"><span class="linenos">251</span></a>            <span class="n">shock</span> <span class="o">=</span> <span class="p">(</span><span class="n">mult</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">effect_factor</span>
</span><span id="UncertaintyAnalysis-252"><a href="#UncertaintyAnalysis-252"><span class="linenos">252</span></a>            <span class="n">effects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">central_estimate</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">shock</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-253"><a href="#UncertaintyAnalysis-253"><span class="linenos">253</span></a>        
</span><span id="UncertaintyAnalysis-254"><a href="#UncertaintyAnalysis-254"><span class="linenos">254</span></a>        <span class="c1"># 10-year totals</span>
</span><span id="UncertaintyAnalysis-255"><a href="#UncertaintyAnalysis-255"><span class="linenos">255</span></a>        <span class="n">totals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">effects</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-256"><a href="#UncertaintyAnalysis-256"><span class="linenos">256</span></a>        <span class="n">central_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-257"><a href="#UncertaintyAnalysis-257"><span class="linenos">257</span></a>        
</span><span id="UncertaintyAnalysis-258"><a href="#UncertaintyAnalysis-258"><span class="linenos">258</span></a>        <span class="c1"># Elasticity</span>
</span><span id="UncertaintyAnalysis-259"><a href="#UncertaintyAnalysis-259"><span class="linenos">259</span></a>        <span class="n">elasticity</span> <span class="o">=</span> <span class="p">((</span><span class="n">totals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">totals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">central_total</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">range_pct</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-260"><a href="#UncertaintyAnalysis-260"><span class="linenos">260</span></a>        
</span><span id="UncertaintyAnalysis-261"><a href="#UncertaintyAnalysis-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">SensitivityResult</span><span class="p">(</span>
</span><span id="UncertaintyAnalysis-262"><a href="#UncertaintyAnalysis-262"><span class="linenos">262</span></a>            <span class="n">parameter_name</span><span class="o">=</span><span class="n">parameter</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-263"><a href="#UncertaintyAnalysis-263"><span class="linenos">263</span></a>            <span class="n">parameter_values</span><span class="o">=</span><span class="n">multipliers</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-264"><a href="#UncertaintyAnalysis-264"><span class="linenos">264</span></a>            <span class="n">deficit_effects</span><span class="o">=</span><span class="n">totals</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-265"><a href="#UncertaintyAnalysis-265"><span class="linenos">265</span></a>            <span class="n">elasticity</span><span class="o">=</span><span class="n">elasticity</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-266"><a href="#UncertaintyAnalysis-266"><span class="linenos">266</span></a>        <span class="p">)</span>
</span><span id="UncertaintyAnalysis-267"><a href="#UncertaintyAnalysis-267"><span class="linenos">267</span></a>    
</span><span id="UncertaintyAnalysis-268"><a href="#UncertaintyAnalysis-268"><span class="linenos">268</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calc_mandatory_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline</span><span class="p">,</span> <span class="n">z_score</span><span class="p">,</span> <span class="n">time_factor</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-269"><a href="#UncertaintyAnalysis-269"><span class="linenos">269</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate uncertainty for mandatory spending.&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-270"><a href="#UncertaintyAnalysis-270"><span class="linenos">270</span></a>        <span class="n">mandatory</span> <span class="o">=</span> <span class="p">(</span><span class="n">baseline</span><span class="o">.</span><span class="n">social_security</span> <span class="o">+</span> <span class="n">baseline</span><span class="o">.</span><span class="n">medicare</span> <span class="o">+</span> 
</span><span id="UncertaintyAnalysis-271"><a href="#UncertaintyAnalysis-271"><span class="linenos">271</span></a>                    <span class="n">baseline</span><span class="o">.</span><span class="n">medicaid</span> <span class="o">+</span> <span class="n">baseline</span><span class="o">.</span><span class="n">other_mandatory</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-272"><a href="#UncertaintyAnalysis-272"><span class="linenos">272</span></a>        
</span><span id="UncertaintyAnalysis-273"><a href="#UncertaintyAnalysis-273"><span class="linenos">273</span></a>        <span class="c1"># Different CVs for different programs</span>
</span><span id="UncertaintyAnalysis-274"><a href="#UncertaintyAnalysis-274"><span class="linenos">274</span></a>        <span class="n">ss_std</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">social_security</span> <span class="o">*</span> <span class="mf">0.03</span> <span class="o">*</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis-275"><a href="#UncertaintyAnalysis-275"><span class="linenos">275</span></a>        <span class="n">medicare_std</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">medicare</span> <span class="o">*</span> <span class="mf">0.08</span> <span class="o">*</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis-276"><a href="#UncertaintyAnalysis-276"><span class="linenos">276</span></a>        <span class="n">medicaid_std</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">medicaid</span> <span class="o">*</span> <span class="mf">0.10</span> <span class="o">*</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis-277"><a href="#UncertaintyAnalysis-277"><span class="linenos">277</span></a>        <span class="n">other_std</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">other_mandatory</span> <span class="o">*</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis-278"><a href="#UncertaintyAnalysis-278"><span class="linenos">278</span></a>        
</span><span id="UncertaintyAnalysis-279"><a href="#UncertaintyAnalysis-279"><span class="linenos">279</span></a>        <span class="c1"># Combined (assuming some correlation)</span>
</span><span id="UncertaintyAnalysis-280"><a href="#UncertaintyAnalysis-280"><span class="linenos">280</span></a>        <span class="n">total_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ss_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">medicare_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> 
</span><span id="UncertaintyAnalysis-281"><a href="#UncertaintyAnalysis-281"><span class="linenos">281</span></a>                           <span class="n">medicaid_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">other_std</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-282"><a href="#UncertaintyAnalysis-282"><span class="linenos">282</span></a>        
</span><span id="UncertaintyAnalysis-283"><a href="#UncertaintyAnalysis-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis-284"><a href="#UncertaintyAnalysis-284"><span class="linenos">284</span></a>            <span class="s1">&#39;central&#39;</span><span class="p">:</span> <span class="n">mandatory</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-285"><a href="#UncertaintyAnalysis-285"><span class="linenos">285</span></a>            <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">mandatory</span> <span class="o">-</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">total_std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-286"><a href="#UncertaintyAnalysis-286"><span class="linenos">286</span></a>            <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">mandatory</span> <span class="o">+</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">total_std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-287"><a href="#UncertaintyAnalysis-287"><span class="linenos">287</span></a>        <span class="p">}</span>
</span><span id="UncertaintyAnalysis-288"><a href="#UncertaintyAnalysis-288"><span class="linenos">288</span></a>    
</span><span id="UncertaintyAnalysis-289"><a href="#UncertaintyAnalysis-289"><span class="linenos">289</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_aggregate_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline</span><span class="p">,</span> <span class="n">component_results</span><span class="p">,</span> <span class="n">z_score</span><span class="p">,</span> <span class="n">time_factor</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-290"><a href="#UncertaintyAnalysis-290"><span class="linenos">290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Aggregate uncertainty accounting for correlations.&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-291"><a href="#UncertaintyAnalysis-291"><span class="linenos">291</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-292"><a href="#UncertaintyAnalysis-292"><span class="linenos">292</span></a>        
</span><span id="UncertaintyAnalysis-293"><a href="#UncertaintyAnalysis-293"><span class="linenos">293</span></a>        <span class="n">central</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">deficit</span>
</span><span id="UncertaintyAnalysis-294"><a href="#UncertaintyAnalysis-294"><span class="linenos">294</span></a>        
</span><span id="UncertaintyAnalysis-295"><a href="#UncertaintyAnalysis-295"><span class="linenos">295</span></a>        <span class="c1"># Simplified aggregation (conservative)</span>
</span><span id="UncertaintyAnalysis-296"><a href="#UncertaintyAnalysis-296"><span class="linenos">296</span></a>        <span class="n">revenue_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
</span><span id="UncertaintyAnalysis-297"><a href="#UncertaintyAnalysis-297"><span class="linenos">297</span></a>            <span class="p">(</span><span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;individual_income_tax&#39;</span><span class="p">][</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">-</span> 
</span><span id="UncertaintyAnalysis-298"><a href="#UncertaintyAnalysis-298"><span class="linenos">298</span></a>             <span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;individual_income_tax&#39;</span><span class="p">][</span><span class="s1">&#39;central&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
</span><span id="UncertaintyAnalysis-299"><a href="#UncertaintyAnalysis-299"><span class="linenos">299</span></a>            <span class="p">(</span><span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;corporate_income_tax&#39;</span><span class="p">][</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">-</span> 
</span><span id="UncertaintyAnalysis-300"><a href="#UncertaintyAnalysis-300"><span class="linenos">300</span></a>             <span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;corporate_income_tax&#39;</span><span class="p">][</span><span class="s1">&#39;central&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
</span><span id="UncertaintyAnalysis-301"><a href="#UncertaintyAnalysis-301"><span class="linenos">301</span></a>            <span class="p">(</span><span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;payroll_taxes&#39;</span><span class="p">][</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">-</span> 
</span><span id="UncertaintyAnalysis-302"><a href="#UncertaintyAnalysis-302"><span class="linenos">302</span></a>             <span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;payroll_taxes&#39;</span><span class="p">][</span><span class="s1">&#39;central&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
</span><span id="UncertaintyAnalysis-303"><a href="#UncertaintyAnalysis-303"><span class="linenos">303</span></a>        <span class="p">)</span>
</span><span id="UncertaintyAnalysis-304"><a href="#UncertaintyAnalysis-304"><span class="linenos">304</span></a>        
</span><span id="UncertaintyAnalysis-305"><a href="#UncertaintyAnalysis-305"><span class="linenos">305</span></a>        <span class="n">spending_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;total_mandatory&#39;</span><span class="p">][</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">-</span> 
</span><span id="UncertaintyAnalysis-306"><a href="#UncertaintyAnalysis-306"><span class="linenos">306</span></a>                       <span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;total_mandatory&#39;</span><span class="p">][</span><span class="s1">&#39;central&#39;</span><span class="p">])</span>
</span><span id="UncertaintyAnalysis-307"><a href="#UncertaintyAnalysis-307"><span class="linenos">307</span></a>        
</span><span id="UncertaintyAnalysis-308"><a href="#UncertaintyAnalysis-308"><span class="linenos">308</span></a>        <span class="n">interest_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;net_interest&#39;</span><span class="p">][</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">-</span> 
</span><span id="UncertaintyAnalysis-309"><a href="#UncertaintyAnalysis-309"><span class="linenos">309</span></a>                       <span class="n">component_results</span><span class="p">[</span><span class="s1">&#39;net_interest&#39;</span><span class="p">][</span><span class="s1">&#39;central&#39;</span><span class="p">])</span>
</span><span id="UncertaintyAnalysis-310"><a href="#UncertaintyAnalysis-310"><span class="linenos">310</span></a>        
</span><span id="UncertaintyAnalysis-311"><a href="#UncertaintyAnalysis-311"><span class="linenos">311</span></a>        <span class="c1"># Total (assuming some correlation between revenue and spending)</span>
</span><span id="UncertaintyAnalysis-312"><a href="#UncertaintyAnalysis-312"><span class="linenos">312</span></a>        <span class="n">total_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">revenue_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">spending_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> 
</span><span id="UncertaintyAnalysis-313"><a href="#UncertaintyAnalysis-313"><span class="linenos">313</span></a>                           <span class="n">interest_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">revenue_std</span> <span class="o">*</span> <span class="n">spending_std</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-314"><a href="#UncertaintyAnalysis-314"><span class="linenos">314</span></a>        
</span><span id="UncertaintyAnalysis-315"><a href="#UncertaintyAnalysis-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis-316"><a href="#UncertaintyAnalysis-316"><span class="linenos">316</span></a>            <span class="s1">&#39;central&#39;</span><span class="p">:</span> <span class="n">central</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-317"><a href="#UncertaintyAnalysis-317"><span class="linenos">317</span></a>            <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">central</span> <span class="o">-</span> <span class="n">total_std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-318"><a href="#UncertaintyAnalysis-318"><span class="linenos">318</span></a>            <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">central</span> <span class="o">+</span> <span class="n">total_std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-319"><a href="#UncertaintyAnalysis-319"><span class="linenos">319</span></a>        <span class="p">}</span>
</span><span id="UncertaintyAnalysis-320"><a href="#UncertaintyAnalysis-320"><span class="linenos">320</span></a>    
</span><span id="UncertaintyAnalysis-321"><a href="#UncertaintyAnalysis-321"><span class="linenos">321</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_correlated_shocks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_sims</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_years</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-322"><a href="#UncertaintyAnalysis-322"><span class="linenos">322</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate correlated economic shocks.&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-323"><a href="#UncertaintyAnalysis-323"><span class="linenos">323</span></a>        <span class="c1"># 4 economic variables: GDP, inflation, unemployment, interest</span>
</span><span id="UncertaintyAnalysis-324"><a href="#UncertaintyAnalysis-324"><span class="linenos">324</span></a>        <span class="n">shocks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sims</span><span class="p">,</span> <span class="n">n_years</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="UncertaintyAnalysis-325"><a href="#UncertaintyAnalysis-325"><span class="linenos">325</span></a>        
</span><span id="UncertaintyAnalysis-326"><a href="#UncertaintyAnalysis-326"><span class="linenos">326</span></a>        <span class="c1"># Cholesky decomposition for correlation</span>
</span><span id="UncertaintyAnalysis-327"><a href="#UncertaintyAnalysis-327"><span class="linenos">327</span></a>        <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">econ_correlation</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-328"><a href="#UncertaintyAnalysis-328"><span class="linenos">328</span></a>        
</span><span id="UncertaintyAnalysis-329"><a href="#UncertaintyAnalysis-329"><span class="linenos">329</span></a>        <span class="n">stds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="UncertaintyAnalysis-330"><a href="#UncertaintyAnalysis-330"><span class="linenos">330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">gdp_growth_std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-331"><a href="#UncertaintyAnalysis-331"><span class="linenos">331</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">inflation_std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-332"><a href="#UncertaintyAnalysis-332"><span class="linenos">332</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">unemployment_std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-333"><a href="#UncertaintyAnalysis-333"><span class="linenos">333</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">interest_rate_std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis-334"><a href="#UncertaintyAnalysis-334"><span class="linenos">334</span></a>        <span class="p">]</span>
</span><span id="UncertaintyAnalysis-335"><a href="#UncertaintyAnalysis-335"><span class="linenos">335</span></a>        
</span><span id="UncertaintyAnalysis-336"><a href="#UncertaintyAnalysis-336"><span class="linenos">336</span></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis-337"><a href="#UncertaintyAnalysis-337"><span class="linenos">337</span></a>            <span class="n">uncorrelated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_sims</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="UncertaintyAnalysis-338"><a href="#UncertaintyAnalysis-338"><span class="linenos">338</span></a>            <span class="n">correlated</span> <span class="o">=</span> <span class="n">uncorrelated</span> <span class="o">@</span> <span class="n">L</span><span class="o">.</span><span class="n">T</span>
</span><span id="UncertaintyAnalysis-339"><a href="#UncertaintyAnalysis-339"><span class="linenos">339</span></a>            <span class="n">shocks</span><span class="p">[:,</span> <span class="n">t</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">correlated</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stds</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-340"><a href="#UncertaintyAnalysis-340"><span class="linenos">340</span></a>        
</span><span id="UncertaintyAnalysis-341"><a href="#UncertaintyAnalysis-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="n">shocks</span>
</span><span id="UncertaintyAnalysis-342"><a href="#UncertaintyAnalysis-342"><span class="linenos">342</span></a>    
</span><span id="UncertaintyAnalysis-343"><a href="#UncertaintyAnalysis-343"><span class="linenos">343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">format_uncertainty_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uncertainty_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-344"><a href="#UncertaintyAnalysis-344"><span class="linenos">344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format uncertainty results as readable text.&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis-345"><a href="#UncertaintyAnalysis-345"><span class="linenos">345</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Uncertainty Analysis Summary&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis-346"><a href="#UncertaintyAnalysis-346"><span class="linenos">346</span></a>        
</span><span id="UncertaintyAnalysis-347"><a href="#UncertaintyAnalysis-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="s1">&#39;total_deficit&#39;</span> <span class="ow">in</span> <span class="n">uncertainty_dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-348"><a href="#UncertaintyAnalysis-348"><span class="linenos">348</span></a>            <span class="n">deficit</span> <span class="o">=</span> <span class="n">uncertainty_dict</span><span class="p">[</span><span class="s1">&#39;total_deficit&#39;</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis-349"><a href="#UncertaintyAnalysis-349"><span class="linenos">349</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">10-Year Deficit Range:&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-350"><a href="#UncertaintyAnalysis-350"><span class="linenos">350</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Low (10th percentile):  $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">deficit</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-351"><a href="#UncertaintyAnalysis-351"><span class="linenos">351</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Central estimate:       $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">deficit</span><span class="p">[</span><span class="s1">&#39;central&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-352"><a href="#UncertaintyAnalysis-352"><span class="linenos">352</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  High (90th percentile): $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">deficit</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-353"><a href="#UncertaintyAnalysis-353"><span class="linenos">353</span></a>        
</span><span id="UncertaintyAnalysis-354"><a href="#UncertaintyAnalysis-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="s1">&#39;simulations&#39;</span> <span class="ow">in</span> <span class="n">uncertainty_dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis-355"><a href="#UncertaintyAnalysis-355"><span class="linenos">355</span></a>            <span class="n">sims</span> <span class="o">=</span> <span class="n">uncertainty_dict</span><span class="p">[</span><span class="s1">&#39;simulations&#39;</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis-356"><a href="#UncertaintyAnalysis-356"><span class="linenos">356</span></a>            <span class="n">totals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sims</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-357"><a href="#UncertaintyAnalysis-357"><span class="linenos">357</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Monte Carlo Results (10-year total):&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-358"><a href="#UncertaintyAnalysis-358"><span class="linenos">358</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean:   $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-359"><a href="#UncertaintyAnalysis-359"><span class="linenos">359</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Median: $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-360"><a href="#UncertaintyAnalysis-360"><span class="linenos">360</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Std:    $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-361"><a href="#UncertaintyAnalysis-361"><span class="linenos">361</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  10th:   $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">totals</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-362"><a href="#UncertaintyAnalysis-362"><span class="linenos">362</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  90th:   $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">totals</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis-363"><a href="#UncertaintyAnalysis-363"><span class="linenos">363</span></a>        
</span><span id="UncertaintyAnalysis-364"><a href="#UncertaintyAnalysis-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Comprehensive uncertainty analysis for fiscal projections.</p>
</div>


                            <div id="UncertaintyAnalysis.__init__" class="classattr">
                                        <input id="UncertaintyAnalysis.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">UncertaintyAnalysis</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">factors</span><span class="p">:</span> <span class="n">fiscal_model</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">UncertaintyFactors</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="UncertaintyAnalysis.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UncertaintyAnalysis.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UncertaintyAnalysis.__init__-64"><a href="#UncertaintyAnalysis.__init__-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UncertaintyFactors</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis.__init__-65"><a href="#UncertaintyAnalysis.__init__-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">factors</span> <span class="o">=</span> <span class="n">factors</span> <span class="ow">or</span> <span class="n">UncertaintyFactors</span><span class="p">()</span>
</span><span id="UncertaintyAnalysis.__init__-66"><a href="#UncertaintyAnalysis.__init__-66"><span class="linenos">66</span></a>        
</span><span id="UncertaintyAnalysis.__init__-67"><a href="#UncertaintyAnalysis.__init__-67"><span class="linenos">67</span></a>        <span class="c1"># Correlation matrix for economic variables</span>
</span><span id="UncertaintyAnalysis.__init__-68"><a href="#UncertaintyAnalysis.__init__-68"><span class="linenos">68</span></a>        <span class="c1"># (GDP, inflation, unemployment, interest rates)</span>
</span><span id="UncertaintyAnalysis.__init__-69"><a href="#UncertaintyAnalysis.__init__-69"><span class="linenos">69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">econ_correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
</span><span id="UncertaintyAnalysis.__init__-70"><a href="#UncertaintyAnalysis.__init__-70"><span class="linenos">70</span></a>            <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
</span><span id="UncertaintyAnalysis.__init__-71"><a href="#UncertaintyAnalysis.__init__-71"><span class="linenos">71</span></a>            <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
</span><span id="UncertaintyAnalysis.__init__-72"><a href="#UncertaintyAnalysis.__init__-72"><span class="linenos">72</span></a>            <span class="p">[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
</span><span id="UncertaintyAnalysis.__init__-73"><a href="#UncertaintyAnalysis.__init__-73"><span class="linenos">73</span></a>            <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis.__init__-74"><a href="#UncertaintyAnalysis.__init__-74"><span class="linenos">74</span></a>        <span class="p">])</span>
</span></pre></div>


    

                            </div>
                            <div id="UncertaintyAnalysis.factors" class="classattr">
                                <div class="attr variable">
            <span class="name">factors</span>

        
    </div>
    <a class="headerlink" href="#UncertaintyAnalysis.factors"></a>
    
    

                            </div>
                            <div id="UncertaintyAnalysis.econ_correlation" class="classattr">
                                <div class="attr variable">
            <span class="name">econ_correlation</span>

        
    </div>
    <a class="headerlink" href="#UncertaintyAnalysis.econ_correlation"></a>
    
    

                            </div>
                            <div id="UncertaintyAnalysis.calculate_baseline_uncertainty" class="classattr">
                                        <input id="UncertaintyAnalysis.calculate_baseline_uncertainty-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_baseline_uncertainty</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">baseline</span><span class="p">:</span> <span class="n"><a href="#BaselineProjection">BaselineProjection</a></span>,</span><span class="param">	<span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="UncertaintyAnalysis.calculate_baseline_uncertainty-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UncertaintyAnalysis.calculate_baseline_uncertainty"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-76"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-76"><span class="linenos"> 76</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_baseline_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-77"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-77"><span class="linenos"> 77</span></a>                                       <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineProjection</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-78"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-78"><span class="linenos"> 78</span></a>                                       <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-79"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-79"><span class="linenos"> 79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-80"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-80"><span class="linenos"> 80</span></a><span class="sd">        Calculate uncertainty ranges for baseline projections.</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-81"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-81"><span class="linenos"> 81</span></a><span class="sd">        </span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-82"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-82"><span class="linenos"> 82</span></a><span class="sd">        Args:</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-83"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-83"><span class="linenos"> 83</span></a><span class="sd">            baseline: Baseline projection</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-84"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-84"><span class="linenos"> 84</span></a><span class="sd">            percentile: Percentile for confidence interval (default 90%)</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-85"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-85"><span class="linenos"> 85</span></a><span class="sd">            </span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-86"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-86"><span class="linenos"> 86</span></a><span class="sd">        Returns:</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-87"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-87"><span class="linenos"> 87</span></a><span class="sd">            Dictionary with low/high estimates for major categories</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-88"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-88"><span class="linenos"> 88</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-89"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-89"><span class="linenos"> 89</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">baseline</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-90"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-90"><span class="linenos"> 90</span></a>        <span class="n">z_score</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">percentile</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-91"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-91"><span class="linenos"> 91</span></a>        
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-92"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-92"><span class="linenos"> 92</span></a>        <span class="c1"># Time-increasing uncertainty</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-93"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-93"><span class="linenos"> 93</span></a>        <span class="n">time_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_years</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-94"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-94"><span class="linenos"> 94</span></a>        
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-95"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-95"><span class="linenos"> 95</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-96"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-96"><span class="linenos"> 96</span></a>        
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-97"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-97"><span class="linenos"> 97</span></a>        <span class="c1"># Revenue uncertainty</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-98"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-98"><span class="linenos"> 98</span></a>        <span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">cv</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-99"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-99"><span class="linenos"> 99</span></a>            <span class="p">(</span><span class="s1">&#39;individual_income_tax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">individual_tax_cv</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-100"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-100"><span class="linenos">100</span></a>            <span class="p">(</span><span class="s1">&#39;corporate_income_tax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">corporate_tax_cv</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-101"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-101"><span class="linenos">101</span></a>            <span class="p">(</span><span class="s1">&#39;payroll_taxes&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">payroll_tax_cv</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-102"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-102"><span class="linenos">102</span></a>        <span class="p">]:</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-103"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-103"><span class="linenos">103</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">cat</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-104"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-104"><span class="linenos">104</span></a>            <span class="n">std</span> <span class="o">=</span> <span class="n">values</span> <span class="o">*</span> <span class="n">cv</span> <span class="o">*</span> <span class="n">time_factor</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-105"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-105"><span class="linenos">105</span></a>            <span class="n">results</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-106"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-106"><span class="linenos">106</span></a>                <span class="s1">&#39;central&#39;</span><span class="p">:</span> <span class="n">values</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-107"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-107"><span class="linenos">107</span></a>                <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">values</span> <span class="o">-</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-108"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-108"><span class="linenos">108</span></a>                <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">values</span> <span class="o">+</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-109"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-109"><span class="linenos">109</span></a>            <span class="p">}</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-110"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-110"><span class="linenos">110</span></a>        
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-111"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-111"><span class="linenos">111</span></a>        <span class="c1"># Spending uncertainty</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-112"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-112"><span class="linenos">112</span></a>        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;total_mandatory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_mandatory_uncertainty</span><span class="p">(</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-113"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-113"><span class="linenos">113</span></a>            <span class="n">baseline</span><span class="p">,</span> <span class="n">z_score</span><span class="p">,</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-114"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-114"><span class="linenos">114</span></a>        <span class="p">)</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-115"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-115"><span class="linenos">115</span></a>        
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-116"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-116"><span class="linenos">116</span></a>        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;net_interest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-117"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-117"><span class="linenos">117</span></a>            <span class="s1">&#39;central&#39;</span><span class="p">:</span> <span class="n">baseline</span><span class="o">.</span><span class="n">net_interest</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-118"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-118"><span class="linenos">118</span></a>            <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">baseline</span><span class="o">.</span><span class="n">net_interest</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">interest_cv</span> <span class="o">*</span> <span class="n">z_score</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-119"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-119"><span class="linenos">119</span></a>            <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">baseline</span><span class="o">.</span><span class="n">net_interest</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">interest_cv</span> <span class="o">*</span> <span class="n">z_score</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-120"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-120"><span class="linenos">120</span></a>        <span class="p">}</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-121"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-121"><span class="linenos">121</span></a>        
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-122"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-122"><span class="linenos">122</span></a>        <span class="c1"># Aggregate</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-123"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-123"><span class="linenos">123</span></a>        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;total_deficit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_uncertainty</span><span class="p">(</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-124"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-124"><span class="linenos">124</span></a>            <span class="n">baseline</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">z_score</span><span class="p">,</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-125"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-125"><span class="linenos">125</span></a>        <span class="p">)</span>
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-126"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-126"><span class="linenos">126</span></a>        
</span><span id="UncertaintyAnalysis.calculate_baseline_uncertainty-127"><a href="#UncertaintyAnalysis.calculate_baseline_uncertainty-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="n">results</span>
</span></pre></div>


            <div class="docstring"><p>Calculate uncertainty ranges for baseline projections.</p>

<p>Args:
    baseline: Baseline projection
    percentile: Percentile for confidence interval (default 90%)</p>

<p>Returns:
    Dictionary with low/high estimates for major categories</p>
</div>


                            </div>
                            <div id="UncertaintyAnalysis.calculate_policy_uncertainty" class="classattr">
                                        <input id="UncertaintyAnalysis.calculate_policy_uncertainty-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_policy_uncertainty</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">central_estimate</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="UncertaintyAnalysis.calculate_policy_uncertainty-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UncertaintyAnalysis.calculate_policy_uncertainty"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-129"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-129"><span class="linenos">129</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_policy_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-130"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-130"><span class="linenos">130</span></a>                                    <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-131"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-131"><span class="linenos">131</span></a>                                    <span class="n">central_estimate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-132"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-132"><span class="linenos">132</span></a>                                    <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-133"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-134"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-134"><span class="linenos">134</span></a><span class="sd">        Calculate uncertainty specific to a policy proposal.</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-135"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-135"><span class="linenos">135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-136"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-136"><span class="linenos">136</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-137"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-137"><span class="linenos">137</span></a>        <span class="n">z_score</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">percentile</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-138"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-138"><span class="linenos">138</span></a>        
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-139"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-139"><span class="linenos">139</span></a>        <span class="c1"># Base CV depends on policy type</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-140"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-141"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-141"><span class="linenos">141</span></a>            <span class="n">base_cv</span> <span class="o">=</span> <span class="mf">0.15</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-142"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-142"><span class="linenos">142</span></a>            <span class="n">behavioral_cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">behavioral_response_cv</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-143"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-143"><span class="linenos">143</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">SpendingPolicy</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-144"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-144"><span class="linenos">144</span></a>            <span class="n">base_cv</span> <span class="o">=</span> <span class="mf">0.10</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-145"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-145"><span class="linenos">145</span></a>            <span class="n">behavioral_cv</span> <span class="o">=</span> <span class="mf">0.10</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-146"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-146"><span class="linenos">146</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TransferPolicy</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-147"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-147"><span class="linenos">147</span></a>            <span class="n">base_cv</span> <span class="o">=</span> <span class="mf">0.12</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-148"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-148"><span class="linenos">148</span></a>            <span class="n">behavioral_cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">participation_cv</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-149"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-149"><span class="linenos">149</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-150"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-150"><span class="linenos">150</span></a>            <span class="n">base_cv</span> <span class="o">=</span> <span class="mf">0.15</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-151"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-151"><span class="linenos">151</span></a>            <span class="n">behavioral_cv</span> <span class="o">=</span> <span class="mf">0.20</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-152"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-152"><span class="linenos">152</span></a>        
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-153"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-153"><span class="linenos">153</span></a>        <span class="c1"># Time-increasing uncertainty</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-154"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-154"><span class="linenos">154</span></a>        <span class="n">time_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_years</span><span class="p">)])</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-155"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-155"><span class="linenos">155</span></a>        
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-156"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-156"><span class="linenos">156</span></a>        <span class="c1"># Combine sources</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-157"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-157"><span class="linenos">157</span></a>        <span class="n">total_cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">base_cv</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">behavioral_cv</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">time_factor</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-158"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-158"><span class="linenos">158</span></a>        
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-159"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-159"><span class="linenos">159</span></a>        <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)</span> <span class="o">*</span> <span class="n">total_cv</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-160"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-160"><span class="linenos">160</span></a>        
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-161"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-162"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-162"><span class="linenos">162</span></a>            <span class="s1">&#39;central&#39;</span><span class="p">:</span> <span class="n">central_estimate</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-163"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-163"><span class="linenos">163</span></a>            <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">-</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-164"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-164"><span class="linenos">164</span></a>            <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">+</span> <span class="n">z_score</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-165"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-165"><span class="linenos">165</span></a>            <span class="s1">&#39;10th&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">-</span> <span class="mf">1.28</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-166"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-166"><span class="linenos">166</span></a>            <span class="s1">&#39;25th&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">-</span> <span class="mf">0.67</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-167"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-167"><span class="linenos">167</span></a>            <span class="s1">&#39;75th&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">+</span> <span class="mf">0.67</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-168"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-168"><span class="linenos">168</span></a>            <span class="s1">&#39;90th&#39;</span><span class="p">:</span> <span class="n">central_estimate</span> <span class="o">+</span> <span class="mf">1.28</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.calculate_policy_uncertainty-169"><a href="#UncertaintyAnalysis.calculate_policy_uncertainty-169"><span class="linenos">169</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Calculate uncertainty specific to a policy proposal.</p>
</div>


                            </div>
                            <div id="UncertaintyAnalysis.monte_carlo_simulation" class="classattr">
                                        <input id="UncertaintyAnalysis.monte_carlo_simulation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">monte_carlo_simulation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">central_estimate</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">n_simulations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="UncertaintyAnalysis.monte_carlo_simulation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UncertaintyAnalysis.monte_carlo_simulation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UncertaintyAnalysis.monte_carlo_simulation-171"><a href="#UncertaintyAnalysis.monte_carlo_simulation-171"><span class="linenos">171</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">monte_carlo_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-172"><a href="#UncertaintyAnalysis.monte_carlo_simulation-172"><span class="linenos">172</span></a>                              <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-173"><a href="#UncertaintyAnalysis.monte_carlo_simulation-173"><span class="linenos">173</span></a>                              <span class="n">central_estimate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-174"><a href="#UncertaintyAnalysis.monte_carlo_simulation-174"><span class="linenos">174</span></a>                              <span class="n">n_simulations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-175"><a href="#UncertaintyAnalysis.monte_carlo_simulation-175"><span class="linenos">175</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-176"><a href="#UncertaintyAnalysis.monte_carlo_simulation-176"><span class="linenos">176</span></a><span class="sd">        Run Monte Carlo simulation for more detailed uncertainty analysis.</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-177"><a href="#UncertaintyAnalysis.monte_carlo_simulation-177"><span class="linenos">177</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-178"><a href="#UncertaintyAnalysis.monte_carlo_simulation-178"><span class="linenos">178</span></a>        <span class="n">n_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-179"><a href="#UncertaintyAnalysis.monte_carlo_simulation-179"><span class="linenos">179</span></a>        <span class="n">simulations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_simulations</span><span class="p">,</span> <span class="n">n_years</span><span class="p">))</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-180"><a href="#UncertaintyAnalysis.monte_carlo_simulation-180"><span class="linenos">180</span></a>        
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-181"><a href="#UncertaintyAnalysis.monte_carlo_simulation-181"><span class="linenos">181</span></a>        <span class="c1"># Generate correlated economic shocks</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-182"><a href="#UncertaintyAnalysis.monte_carlo_simulation-182"><span class="linenos">182</span></a>        <span class="n">econ_shocks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_correlated_shocks</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-183"><a href="#UncertaintyAnalysis.monte_carlo_simulation-183"><span class="linenos">183</span></a>        
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-184"><a href="#UncertaintyAnalysis.monte_carlo_simulation-184"><span class="linenos">184</span></a>        <span class="k">for</span> <span class="n">sim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-185"><a href="#UncertaintyAnalysis.monte_carlo_simulation-185"><span class="linenos">185</span></a>            <span class="c1"># Economic uncertainty</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-186"><a href="#UncertaintyAnalysis.monte_carlo_simulation-186"><span class="linenos">186</span></a>            <span class="n">gdp_shock</span> <span class="o">=</span> <span class="n">econ_shocks</span><span class="p">[</span><span class="n">sim</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-187"><a href="#UncertaintyAnalysis.monte_carlo_simulation-187"><span class="linenos">187</span></a>            
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-188"><a href="#UncertaintyAnalysis.monte_carlo_simulation-188"><span class="linenos">188</span></a>            <span class="c1"># Policy-specific uncertainty</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-189"><a href="#UncertaintyAnalysis.monte_carlo_simulation-189"><span class="linenos">189</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-190"><a href="#UncertaintyAnalysis.monte_carlo_simulation-190"><span class="linenos">190</span></a>                <span class="n">policy_shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-191"><a href="#UncertaintyAnalysis.monte_carlo_simulation-191"><span class="linenos">191</span></a>                <span class="n">behavioral_shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-192"><a href="#UncertaintyAnalysis.monte_carlo_simulation-192"><span class="linenos">192</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-193"><a href="#UncertaintyAnalysis.monte_carlo_simulation-193"><span class="linenos">193</span></a>                <span class="n">policy_shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-194"><a href="#UncertaintyAnalysis.monte_carlo_simulation-194"><span class="linenos">194</span></a>                <span class="n">behavioral_shock</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">n_years</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-195"><a href="#UncertaintyAnalysis.monte_carlo_simulation-195"><span class="linenos">195</span></a>            
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-196"><a href="#UncertaintyAnalysis.monte_carlo_simulation-196"><span class="linenos">196</span></a>            <span class="c1"># Combine shocks</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-197"><a href="#UncertaintyAnalysis.monte_carlo_simulation-197"><span class="linenos">197</span></a>            <span class="n">total_shock</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">gdp_shock</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">policy_shock</span> <span class="o">+</span> <span class="n">behavioral_shock</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-198"><a href="#UncertaintyAnalysis.monte_carlo_simulation-198"><span class="linenos">198</span></a>            
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-199"><a href="#UncertaintyAnalysis.monte_carlo_simulation-199"><span class="linenos">199</span></a>            <span class="c1"># Time-cumulating effect for persistent shocks</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-200"><a href="#UncertaintyAnalysis.monte_carlo_simulation-200"><span class="linenos">200</span></a>            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_years</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-201"><a href="#UncertaintyAnalysis.monte_carlo_simulation-201"><span class="linenos">201</span></a>                <span class="n">total_shock</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_shock</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">+</span> <span class="n">total_shock</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.7</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-202"><a href="#UncertaintyAnalysis.monte_carlo_simulation-202"><span class="linenos">202</span></a>            
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-203"><a href="#UncertaintyAnalysis.monte_carlo_simulation-203"><span class="linenos">203</span></a>            <span class="n">simulations</span><span class="p">[</span><span class="n">sim</span><span class="p">]</span> <span class="o">=</span> <span class="n">central_estimate</span> <span class="o">*</span> <span class="n">total_shock</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-204"><a href="#UncertaintyAnalysis.monte_carlo_simulation-204"><span class="linenos">204</span></a>        
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-205"><a href="#UncertaintyAnalysis.monte_carlo_simulation-205"><span class="linenos">205</span></a>        <span class="c1"># Calculate statistics</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-206"><a href="#UncertaintyAnalysis.monte_carlo_simulation-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-207"><a href="#UncertaintyAnalysis.monte_carlo_simulation-207"><span class="linenos">207</span></a>            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-208"><a href="#UncertaintyAnalysis.monte_carlo_simulation-208"><span class="linenos">208</span></a>            <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-209"><a href="#UncertaintyAnalysis.monte_carlo_simulation-209"><span class="linenos">209</span></a>            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-210"><a href="#UncertaintyAnalysis.monte_carlo_simulation-210"><span class="linenos">210</span></a>            <span class="s1">&#39;p10&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-211"><a href="#UncertaintyAnalysis.monte_carlo_simulation-211"><span class="linenos">211</span></a>            <span class="s1">&#39;p25&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-212"><a href="#UncertaintyAnalysis.monte_carlo_simulation-212"><span class="linenos">212</span></a>            <span class="s1">&#39;p75&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-213"><a href="#UncertaintyAnalysis.monte_carlo_simulation-213"><span class="linenos">213</span></a>            <span class="s1">&#39;p90&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-214"><a href="#UncertaintyAnalysis.monte_carlo_simulation-214"><span class="linenos">214</span></a>            <span class="s1">&#39;simulations&#39;</span><span class="p">:</span> <span class="n">simulations</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.monte_carlo_simulation-215"><a href="#UncertaintyAnalysis.monte_carlo_simulation-215"><span class="linenos">215</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Run Monte Carlo simulation for more detailed uncertainty analysis.</p>
</div>


                            </div>
                            <div id="UncertaintyAnalysis.sensitivity_analysis" class="classattr">
                                        <input id="UncertaintyAnalysis.sensitivity_analysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sensitivity_analysis</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">central_estimate</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">range_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span></span><span class="return-annotation">) -> <span class="n">fiscal_model</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">SensitivityResult</span>:</span></span>

                <label class="view-source-button" for="UncertaintyAnalysis.sensitivity_analysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UncertaintyAnalysis.sensitivity_analysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UncertaintyAnalysis.sensitivity_analysis-217"><a href="#UncertaintyAnalysis.sensitivity_analysis-217"><span class="linenos">217</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sensitivity_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-218"><a href="#UncertaintyAnalysis.sensitivity_analysis-218"><span class="linenos">218</span></a>                            <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-219"><a href="#UncertaintyAnalysis.sensitivity_analysis-219"><span class="linenos">219</span></a>                            <span class="n">central_estimate</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-220"><a href="#UncertaintyAnalysis.sensitivity_analysis-220"><span class="linenos">220</span></a>                            <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-221"><a href="#UncertaintyAnalysis.sensitivity_analysis-221"><span class="linenos">221</span></a>                            <span class="n">range_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SensitivityResult</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-222"><a href="#UncertaintyAnalysis.sensitivity_analysis-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-223"><a href="#UncertaintyAnalysis.sensitivity_analysis-223"><span class="linenos">223</span></a><span class="sd">        Analyze sensitivity to a specific parameter.</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-224"><a href="#UncertaintyAnalysis.sensitivity_analysis-224"><span class="linenos">224</span></a><span class="sd">        </span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-225"><a href="#UncertaintyAnalysis.sensitivity_analysis-225"><span class="linenos">225</span></a><span class="sd">        Args:</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-226"><a href="#UncertaintyAnalysis.sensitivity_analysis-226"><span class="linenos">226</span></a><span class="sd">            policy: Policy being analyzed</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-227"><a href="#UncertaintyAnalysis.sensitivity_analysis-227"><span class="linenos">227</span></a><span class="sd">            central_estimate: Central cost estimate</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-228"><a href="#UncertaintyAnalysis.sensitivity_analysis-228"><span class="linenos">228</span></a><span class="sd">            parameter: Parameter name to vary</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-229"><a href="#UncertaintyAnalysis.sensitivity_analysis-229"><span class="linenos">229</span></a><span class="sd">            range_pct: Percentage range to test (e.g., 0.5 = 50%)</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-230"><a href="#UncertaintyAnalysis.sensitivity_analysis-230"><span class="linenos">230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-231"><a href="#UncertaintyAnalysis.sensitivity_analysis-231"><span class="linenos">231</span></a>        <span class="n">n_points</span> <span class="o">=</span> <span class="mi">11</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-232"><a href="#UncertaintyAnalysis.sensitivity_analysis-232"><span class="linenos">232</span></a>        <span class="n">multipliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">range_pct</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">range_pct</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-233"><a href="#UncertaintyAnalysis.sensitivity_analysis-233"><span class="linenos">233</span></a>        
</span><span id="UncertaintyAnalysis.sensitivity_analysis-234"><a href="#UncertaintyAnalysis.sensitivity_analysis-234"><span class="linenos">234</span></a>        <span class="c1"># Map parameter to effect type</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-235"><a href="#UncertaintyAnalysis.sensitivity_analysis-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;gdp_growth&#39;</span><span class="p">,</span> <span class="s1">&#39;economic_growth&#39;</span><span class="p">]:</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-236"><a href="#UncertaintyAnalysis.sensitivity_analysis-236"><span class="linenos">236</span></a>            <span class="c1"># Higher growth -&gt; lower costs for transfers, higher revenue</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-237"><a href="#UncertaintyAnalysis.sensitivity_analysis-237"><span class="linenos">237</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-238"><a href="#UncertaintyAnalysis.sensitivity_analysis-238"><span class="linenos">238</span></a>        <span class="k">elif</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;interest_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;inflation&#39;</span><span class="p">]:</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-239"><a href="#UncertaintyAnalysis.sensitivity_analysis-239"><span class="linenos">239</span></a>            <span class="c1"># Higher rates -&gt; higher interest costs</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-240"><a href="#UncertaintyAnalysis.sensitivity_analysis-240"><span class="linenos">240</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="mf">0.3</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-241"><a href="#UncertaintyAnalysis.sensitivity_analysis-241"><span class="linenos">241</span></a>        <span class="k">elif</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s1">&#39;behavioral_elasticity&#39;</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-242"><a href="#UncertaintyAnalysis.sensitivity_analysis-242"><span class="linenos">242</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="mf">0.4</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-243"><a href="#UncertaintyAnalysis.sensitivity_analysis-243"><span class="linenos">243</span></a>        <span class="k">elif</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s1">&#39;participation_rate&#39;</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-244"><a href="#UncertaintyAnalysis.sensitivity_analysis-244"><span class="linenos">244</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="mf">0.8</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-245"><a href="#UncertaintyAnalysis.sensitivity_analysis-245"><span class="linenos">245</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-246"><a href="#UncertaintyAnalysis.sensitivity_analysis-246"><span class="linenos">246</span></a>            <span class="n">effect_factor</span> <span class="o">=</span> <span class="mf">0.2</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-247"><a href="#UncertaintyAnalysis.sensitivity_analysis-247"><span class="linenos">247</span></a>        
</span><span id="UncertaintyAnalysis.sensitivity_analysis-248"><a href="#UncertaintyAnalysis.sensitivity_analysis-248"><span class="linenos">248</span></a>        <span class="c1"># Calculate effects at each point</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-249"><a href="#UncertaintyAnalysis.sensitivity_analysis-249"><span class="linenos">249</span></a>        <span class="n">effects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_points</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)))</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-250"><a href="#UncertaintyAnalysis.sensitivity_analysis-250"><span class="linenos">250</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mult</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multipliers</span><span class="p">):</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-251"><a href="#UncertaintyAnalysis.sensitivity_analysis-251"><span class="linenos">251</span></a>            <span class="n">shock</span> <span class="o">=</span> <span class="p">(</span><span class="n">mult</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">effect_factor</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-252"><a href="#UncertaintyAnalysis.sensitivity_analysis-252"><span class="linenos">252</span></a>            <span class="n">effects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">central_estimate</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">shock</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-253"><a href="#UncertaintyAnalysis.sensitivity_analysis-253"><span class="linenos">253</span></a>        
</span><span id="UncertaintyAnalysis.sensitivity_analysis-254"><a href="#UncertaintyAnalysis.sensitivity_analysis-254"><span class="linenos">254</span></a>        <span class="c1"># 10-year totals</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-255"><a href="#UncertaintyAnalysis.sensitivity_analysis-255"><span class="linenos">255</span></a>        <span class="n">totals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">effects</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-256"><a href="#UncertaintyAnalysis.sensitivity_analysis-256"><span class="linenos">256</span></a>        <span class="n">central_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">central_estimate</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-257"><a href="#UncertaintyAnalysis.sensitivity_analysis-257"><span class="linenos">257</span></a>        
</span><span id="UncertaintyAnalysis.sensitivity_analysis-258"><a href="#UncertaintyAnalysis.sensitivity_analysis-258"><span class="linenos">258</span></a>        <span class="c1"># Elasticity</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-259"><a href="#UncertaintyAnalysis.sensitivity_analysis-259"><span class="linenos">259</span></a>        <span class="n">elasticity</span> <span class="o">=</span> <span class="p">((</span><span class="n">totals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">totals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">central_total</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">range_pct</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-260"><a href="#UncertaintyAnalysis.sensitivity_analysis-260"><span class="linenos">260</span></a>        
</span><span id="UncertaintyAnalysis.sensitivity_analysis-261"><a href="#UncertaintyAnalysis.sensitivity_analysis-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">SensitivityResult</span><span class="p">(</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-262"><a href="#UncertaintyAnalysis.sensitivity_analysis-262"><span class="linenos">262</span></a>            <span class="n">parameter_name</span><span class="o">=</span><span class="n">parameter</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-263"><a href="#UncertaintyAnalysis.sensitivity_analysis-263"><span class="linenos">263</span></a>            <span class="n">parameter_values</span><span class="o">=</span><span class="n">multipliers</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-264"><a href="#UncertaintyAnalysis.sensitivity_analysis-264"><span class="linenos">264</span></a>            <span class="n">deficit_effects</span><span class="o">=</span><span class="n">totals</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-265"><a href="#UncertaintyAnalysis.sensitivity_analysis-265"><span class="linenos">265</span></a>            <span class="n">elasticity</span><span class="o">=</span><span class="n">elasticity</span><span class="p">,</span>
</span><span id="UncertaintyAnalysis.sensitivity_analysis-266"><a href="#UncertaintyAnalysis.sensitivity_analysis-266"><span class="linenos">266</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Analyze sensitivity to a specific parameter.</p>

<p>Args:
    policy: Policy being analyzed
    central_estimate: Central cost estimate
    parameter: Parameter name to vary
    range_pct: Percentage range to test (e.g., 0.5 = 50%)</p>
</div>


                            </div>
                            <div id="UncertaintyAnalysis.format_uncertainty_summary" class="classattr">
                                        <input id="UncertaintyAnalysis.format_uncertainty_summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">format_uncertainty_summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">uncertainty_dict</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="UncertaintyAnalysis.format_uncertainty_summary-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#UncertaintyAnalysis.format_uncertainty_summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="UncertaintyAnalysis.format_uncertainty_summary-343"><a href="#UncertaintyAnalysis.format_uncertainty_summary-343"><span class="linenos">343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">format_uncertainty_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uncertainty_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-344"><a href="#UncertaintyAnalysis.format_uncertainty_summary-344"><span class="linenos">344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format uncertainty results as readable text.&quot;&quot;&quot;</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-345"><a href="#UncertaintyAnalysis.format_uncertainty_summary-345"><span class="linenos">345</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Uncertainty Analysis Summary&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-346"><a href="#UncertaintyAnalysis.format_uncertainty_summary-346"><span class="linenos">346</span></a>        
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-347"><a href="#UncertaintyAnalysis.format_uncertainty_summary-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="s1">&#39;total_deficit&#39;</span> <span class="ow">in</span> <span class="n">uncertainty_dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-348"><a href="#UncertaintyAnalysis.format_uncertainty_summary-348"><span class="linenos">348</span></a>            <span class="n">deficit</span> <span class="o">=</span> <span class="n">uncertainty_dict</span><span class="p">[</span><span class="s1">&#39;total_deficit&#39;</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-349"><a href="#UncertaintyAnalysis.format_uncertainty_summary-349"><span class="linenos">349</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">10-Year Deficit Range:&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-350"><a href="#UncertaintyAnalysis.format_uncertainty_summary-350"><span class="linenos">350</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Low (10th percentile):  $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">deficit</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-351"><a href="#UncertaintyAnalysis.format_uncertainty_summary-351"><span class="linenos">351</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Central estimate:       $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">deficit</span><span class="p">[</span><span class="s1">&#39;central&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-352"><a href="#UncertaintyAnalysis.format_uncertainty_summary-352"><span class="linenos">352</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  High (90th percentile): $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">deficit</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-353"><a href="#UncertaintyAnalysis.format_uncertainty_summary-353"><span class="linenos">353</span></a>        
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-354"><a href="#UncertaintyAnalysis.format_uncertainty_summary-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="s1">&#39;simulations&#39;</span> <span class="ow">in</span> <span class="n">uncertainty_dict</span><span class="p">:</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-355"><a href="#UncertaintyAnalysis.format_uncertainty_summary-355"><span class="linenos">355</span></a>            <span class="n">sims</span> <span class="o">=</span> <span class="n">uncertainty_dict</span><span class="p">[</span><span class="s1">&#39;simulations&#39;</span><span class="p">]</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-356"><a href="#UncertaintyAnalysis.format_uncertainty_summary-356"><span class="linenos">356</span></a>            <span class="n">totals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sims</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-357"><a href="#UncertaintyAnalysis.format_uncertainty_summary-357"><span class="linenos">357</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Monte Carlo Results (10-year total):&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-358"><a href="#UncertaintyAnalysis.format_uncertainty_summary-358"><span class="linenos">358</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean:   $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-359"><a href="#UncertaintyAnalysis.format_uncertainty_summary-359"><span class="linenos">359</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Median: $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-360"><a href="#UncertaintyAnalysis.format_uncertainty_summary-360"><span class="linenos">360</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Std:    $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-361"><a href="#UncertaintyAnalysis.format_uncertainty_summary-361"><span class="linenos">361</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  10th:   $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">totals</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-362"><a href="#UncertaintyAnalysis.format_uncertainty_summary-362"><span class="linenos">362</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  90th:   $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">totals</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">)</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-363"><a href="#UncertaintyAnalysis.format_uncertainty_summary-363"><span class="linenos">363</span></a>        
</span><span id="UncertaintyAnalysis.format_uncertainty_summary-364"><a href="#UncertaintyAnalysis.format_uncertainty_summary-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Format uncertainty results as readable text.</p>
</div>


                            </div>
                </section>
                <section id="BudgetReport">
                            <input id="BudgetReport-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BudgetReport</span>:

                <label class="view-source-button" for="BudgetReport-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BudgetReport"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BudgetReport-18"><a href="#BudgetReport-18"><span class="linenos"> 18</span></a><span class="k">class</span><span class="w"> </span><span class="nc">BudgetReport</span><span class="p">:</span>
</span><span id="BudgetReport-19"><a href="#BudgetReport-19"><span class="linenos"> 19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BudgetReport-20"><a href="#BudgetReport-20"><span class="linenos"> 20</span></a><span class="sd">    Generate comprehensive budget reports for fiscal policy analysis.</span>
</span><span id="BudgetReport-21"><a href="#BudgetReport-21"><span class="linenos"> 21</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BudgetReport-22"><a href="#BudgetReport-22"><span class="linenos"> 22</span></a>    
</span><span id="BudgetReport-23"><a href="#BudgetReport-23"><span class="linenos"> 23</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">ScoringResult</span><span class="p">):</span>
</span><span id="BudgetReport-24"><a href="#BudgetReport-24"><span class="linenos"> 24</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="BudgetReport-25"><a href="#BudgetReport-25"><span class="linenos"> 25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">years</span>
</span><span id="BudgetReport-26"><a href="#BudgetReport-26"><span class="linenos"> 26</span></a>    
</span><span id="BudgetReport-27"><a href="#BudgetReport-27"><span class="linenos"> 27</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_text_report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="BudgetReport-28"><a href="#BudgetReport-28"><span class="linenos"> 28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a detailed text report.&quot;&quot;&quot;</span>
</span><span id="BudgetReport-29"><a href="#BudgetReport-29"><span class="linenos"> 29</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="BudgetReport-30"><a href="#BudgetReport-30"><span class="linenos"> 30</span></a>        
</span><span id="BudgetReport-31"><a href="#BudgetReport-31"><span class="linenos"> 31</span></a>        <span class="c1"># Header</span>
</span><span id="BudgetReport-32"><a href="#BudgetReport-32"><span class="linenos"> 32</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport-33"><a href="#BudgetReport-33"><span class="linenos"> 33</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;FISCAL POLICY SCORING REPORT&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-34"><a href="#BudgetReport-34"><span class="linenos"> 34</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport-35"><a href="#BudgetReport-35"><span class="linenos"> 35</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-36"><a href="#BudgetReport-36"><span class="linenos"> 36</span></a>        
</span><span id="BudgetReport-37"><a href="#BudgetReport-37"><span class="linenos"> 37</span></a>        <span class="c1"># Policy summary</span>
</span><span id="BudgetReport-38"><a href="#BudgetReport-38"><span class="linenos"> 38</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;POLICY SUMMARY&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-39"><a href="#BudgetReport-39"><span class="linenos"> 39</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="BudgetReport-40"><a href="#BudgetReport-40"><span class="linenos"> 40</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-41"><a href="#BudgetReport-41"><span class="linenos"> 41</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Description: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-42"><a href="#BudgetReport-42"><span class="linenos"> 42</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Effective: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">start_year</span><span class="si">}</span><span class="s2"> - &quot;</span>
</span><span id="BudgetReport-43"><a href="#BudgetReport-43"><span class="linenos"> 43</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">start_year</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">duration_years</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-44"><a href="#BudgetReport-44"><span class="linenos"> 44</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-45"><a href="#BudgetReport-45"><span class="linenos"> 45</span></a>        
</span><span id="BudgetReport-46"><a href="#BudgetReport-46"><span class="linenos"> 46</span></a>        <span class="c1"># Key metrics</span>
</span><span id="BudgetReport-47"><a href="#BudgetReport-47"><span class="linenos"> 47</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;KEY BUDGET METRICS ($ billions)&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-48"><a href="#BudgetReport-48"><span class="linenos"> 48</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="BudgetReport-49"><a href="#BudgetReport-49"><span class="linenos"> 49</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10-Year Static Cost:        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_static_cost</span><span class="si">:</span><span class="s2">&gt;12,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-50"><a href="#BudgetReport-50"><span class="linenos"> 50</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Behavioral Offset:          </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;12,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-51"><a href="#BudgetReport-51"><span class="linenos"> 51</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport-52"><a href="#BudgetReport-52"><span class="linenos"> 52</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Economic Feedback:          </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span><span class="si">:</span><span class="s2">&gt;12,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-53"><a href="#BudgetReport-53"><span class="linenos"> 53</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10-Year Net Cost:           </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="si">:</span><span class="s2">&gt;12,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-54"><a href="#BudgetReport-54"><span class="linenos"> 54</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-55"><a href="#BudgetReport-55"><span class="linenos"> 55</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uncertainty Range (90% CI): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> to &quot;</span>
</span><span id="BudgetReport-56"><a href="#BudgetReport-56"><span class="linenos"> 56</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-57"><a href="#BudgetReport-57"><span class="linenos"> 57</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-58"><a href="#BudgetReport-58"><span class="linenos"> 58</span></a>        
</span><span id="BudgetReport-59"><a href="#BudgetReport-59"><span class="linenos"> 59</span></a>        <span class="c1"># Year-by-year table</span>
</span><span id="BudgetReport-60"><a href="#BudgetReport-60"><span class="linenos"> 60</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;YEAR-BY-YEAR EFFECTS ($ billions)&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-61"><a href="#BudgetReport-61"><span class="linenos"> 61</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport-62"><a href="#BudgetReport-62"><span class="linenos"> 62</span></a>        
</span><span id="BudgetReport-63"><a href="#BudgetReport-63"><span class="linenos"> 63</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Year&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Revenue&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Spending&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Static&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-64"><a href="#BudgetReport-64"><span class="linenos"> 64</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport-65"><a href="#BudgetReport-65"><span class="linenos"> 65</span></a>            <span class="n">header</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Feedback&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-66"><a href="#BudgetReport-66"><span class="linenos"> 66</span></a>        <span class="n">header</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Final&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Range&#39;</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BudgetReport-67"><a href="#BudgetReport-67"><span class="linenos"> 67</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
</span><span id="BudgetReport-68"><a href="#BudgetReport-68"><span class="linenos"> 68</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport-69"><a href="#BudgetReport-69"><span class="linenos"> 69</span></a>        
</span><span id="BudgetReport-70"><a href="#BudgetReport-70"><span class="linenos"> 70</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">):</span>
</span><span id="BudgetReport-71"><a href="#BudgetReport-71"><span class="linenos"> 71</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-72"><a href="#BudgetReport-72"><span class="linenos"> 72</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-73"><a href="#BudgetReport-73"><span class="linenos"> 73</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-74"><a href="#BudgetReport-74"><span class="linenos"> 74</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-75"><a href="#BudgetReport-75"><span class="linenos"> 75</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport-76"><a href="#BudgetReport-76"><span class="linenos"> 76</span></a>                <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-77"><a href="#BudgetReport-77"><span class="linenos"> 77</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-78"><a href="#BudgetReport-78"><span class="linenos"> 78</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;8,.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;8,.1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BudgetReport-79"><a href="#BudgetReport-79"><span class="linenos"> 79</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="BudgetReport-80"><a href="#BudgetReport-80"><span class="linenos"> 80</span></a>        
</span><span id="BudgetReport-81"><a href="#BudgetReport-81"><span class="linenos"> 81</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport-82"><a href="#BudgetReport-82"><span class="linenos"> 82</span></a>        <span class="n">total_row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;TOTAL&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-83"><a href="#BudgetReport-83"><span class="linenos"> 83</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-84"><a href="#BudgetReport-84"><span class="linenos"> 84</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-85"><a href="#BudgetReport-85"><span class="linenos"> 85</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_static_cost</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-86"><a href="#BudgetReport-86"><span class="linenos"> 86</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport-87"><a href="#BudgetReport-87"><span class="linenos"> 87</span></a>            <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-88"><a href="#BudgetReport-88"><span class="linenos"> 88</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport-89"><a href="#BudgetReport-89"><span class="linenos"> 89</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;8,.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;8,.1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BudgetReport-90"><a href="#BudgetReport-90"><span class="linenos"> 90</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_row</span><span class="p">)</span>
</span><span id="BudgetReport-91"><a href="#BudgetReport-91"><span class="linenos"> 91</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-92"><a href="#BudgetReport-92"><span class="linenos"> 92</span></a>        
</span><span id="BudgetReport-93"><a href="#BudgetReport-93"><span class="linenos"> 93</span></a>        <span class="c1"># Economic effects if dynamic</span>
</span><span id="BudgetReport-94"><a href="#BudgetReport-94"><span class="linenos"> 94</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport-95"><a href="#BudgetReport-95"><span class="linenos"> 95</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ECONOMIC EFFECTS&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-96"><a href="#BudgetReport-96"><span class="linenos"> 96</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="BudgetReport-97"><a href="#BudgetReport-97"><span class="linenos"> 97</span></a>            <span class="n">de</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span>
</span><span id="BudgetReport-98"><a href="#BudgetReport-98"><span class="linenos"> 98</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average GDP Effect:     </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">de</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-99"><a href="#BudgetReport-99"><span class="linenos"> 99</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak GDP Effect:        </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">de</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-100"><a href="#BudgetReport-100"><span class="linenos">100</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Avg Employment Change:  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">de</span><span class="o">.</span><span class="n">employment_change</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.0f</span><span class="si">}</span><span class="s2"> thousand&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-101"><a href="#BudgetReport-101"><span class="linenos">101</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cumulative GDP Effect:  $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">de</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-102"><a href="#BudgetReport-102"><span class="linenos">102</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-103"><a href="#BudgetReport-103"><span class="linenos">103</span></a>        
</span><span id="BudgetReport-104"><a href="#BudgetReport-104"><span class="linenos">104</span></a>        <span class="c1"># Notes</span>
</span><span id="BudgetReport-105"><a href="#BudgetReport-105"><span class="linenos">105</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NOTES&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-106"><a href="#BudgetReport-106"><span class="linenos">106</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="BudgetReport-107"><a href="#BudgetReport-107"><span class="linenos">107</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;- Positive values indicate increases in deficit/costs&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-108"><a href="#BudgetReport-108"><span class="linenos">108</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;- Revenue effects are shown as changes from baseline&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-109"><a href="#BudgetReport-109"><span class="linenos">109</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;- Uncertainty range represents 90</span><span class="si">% c</span><span class="s2">onfidence interval&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-110"><a href="#BudgetReport-110"><span class="linenos">110</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport-111"><a href="#BudgetReport-111"><span class="linenos">111</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;- Economic feedback includes GDP effects on revenues&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-112"><a href="#BudgetReport-112"><span class="linenos">112</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-113"><a href="#BudgetReport-113"><span class="linenos">113</span></a>        
</span><span id="BudgetReport-114"><a href="#BudgetReport-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span><span id="BudgetReport-115"><a href="#BudgetReport-115"><span class="linenos">115</span></a>    
</span><span id="BudgetReport-116"><a href="#BudgetReport-116"><span class="linenos">116</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_budget_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="BudgetReport-117"><a href="#BudgetReport-117"><span class="linenos">117</span></a>                           <span class="n">save_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BudgetReport-118"><a href="#BudgetReport-118"><span class="linenos">118</span></a>                           <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
</span><span id="BudgetReport-119"><a href="#BudgetReport-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BudgetReport-120"><a href="#BudgetReport-120"><span class="linenos">120</span></a><span class="sd">        Create visualization of budget effects over time.</span>
</span><span id="BudgetReport-121"><a href="#BudgetReport-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BudgetReport-122"><a href="#BudgetReport-122"><span class="linenos">122</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="BudgetReport-123"><a href="#BudgetReport-123"><span class="linenos">123</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Budget Effects: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
</span><span id="BudgetReport-124"><a href="#BudgetReport-124"><span class="linenos">124</span></a>                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-125"><a href="#BudgetReport-125"><span class="linenos">125</span></a>        
</span><span id="BudgetReport-126"><a href="#BudgetReport-126"><span class="linenos">126</span></a>        <span class="c1"># 1. Deficit effect over time with uncertainty</span>
</span><span id="BudgetReport-127"><a href="#BudgetReport-127"><span class="linenos">127</span></a>        <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="BudgetReport-128"><a href="#BudgetReport-128"><span class="linenos">128</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">,</span> 
</span><span id="BudgetReport-129"><a href="#BudgetReport-129"><span class="linenos">129</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-130"><a href="#BudgetReport-130"><span class="linenos">130</span></a>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;90% CI&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-131"><a href="#BudgetReport-131"><span class="linenos">131</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">,</span> 
</span><span id="BudgetReport-132"><a href="#BudgetReport-132"><span class="linenos">132</span></a>                <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Central estimate&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-133"><a href="#BudgetReport-133"><span class="linenos">133</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">,</span> 
</span><span id="BudgetReport-134"><a href="#BudgetReport-134"><span class="linenos">134</span></a>                <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Static estimate&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-135"><a href="#BudgetReport-135"><span class="linenos">135</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport-136"><a href="#BudgetReport-136"><span class="linenos">136</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-137"><a href="#BudgetReport-137"><span class="linenos">137</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Deficit Effect ($ billions)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-138"><a href="#BudgetReport-138"><span class="linenos">138</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Annual Deficit Impact&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-139"><a href="#BudgetReport-139"><span class="linenos">139</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-140"><a href="#BudgetReport-140"><span class="linenos">140</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="BudgetReport-141"><a href="#BudgetReport-141"><span class="linenos">141</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="BudgetReport-142"><a href="#BudgetReport-142"><span class="linenos">142</span></a>        
</span><span id="BudgetReport-143"><a href="#BudgetReport-143"><span class="linenos">143</span></a>        <span class="c1"># 2. Cumulative effect</span>
</span><span id="BudgetReport-144"><a href="#BudgetReport-144"><span class="linenos">144</span></a>        <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="BudgetReport-145"><a href="#BudgetReport-145"><span class="linenos">145</span></a>        <span class="n">cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">)</span>
</span><span id="BudgetReport-146"><a href="#BudgetReport-146"><span class="linenos">146</span></a>        <span class="n">cumulative_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span>
</span><span id="BudgetReport-147"><a href="#BudgetReport-147"><span class="linenos">147</span></a>        <span class="n">cumulative_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span>
</span><span id="BudgetReport-148"><a href="#BudgetReport-148"><span class="linenos">148</span></a>        
</span><span id="BudgetReport-149"><a href="#BudgetReport-149"><span class="linenos">149</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="n">cumulative_low</span><span class="p">,</span> <span class="n">cumulative_high</span><span class="p">,</span> 
</span><span id="BudgetReport-150"><a href="#BudgetReport-150"><span class="linenos">150</span></a>                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-151"><a href="#BudgetReport-151"><span class="linenos">151</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="n">cumulative</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="BudgetReport-152"><a href="#BudgetReport-152"><span class="linenos">152</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport-153"><a href="#BudgetReport-153"><span class="linenos">153</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-154"><a href="#BudgetReport-154"><span class="linenos">154</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative Effect ($ billions)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-155"><a href="#BudgetReport-155"><span class="linenos">155</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cumulative Deficit Impact&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-156"><a href="#BudgetReport-156"><span class="linenos">156</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="BudgetReport-157"><a href="#BudgetReport-157"><span class="linenos">157</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="BudgetReport-158"><a href="#BudgetReport-158"><span class="linenos">158</span></a>        
</span><span id="BudgetReport-159"><a href="#BudgetReport-159"><span class="linenos">159</span></a>        <span class="c1"># 3. Components breakdown</span>
</span><span id="BudgetReport-160"><a href="#BudgetReport-160"><span class="linenos">160</span></a>        <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="BudgetReport-161"><a href="#BudgetReport-161"><span class="linenos">161</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>
</span><span id="BudgetReport-162"><a href="#BudgetReport-162"><span class="linenos">162</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">))</span>
</span><span id="BudgetReport-163"><a href="#BudgetReport-163"><span class="linenos">163</span></a>        
</span><span id="BudgetReport-164"><a href="#BudgetReport-164"><span class="linenos">164</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> 
</span><span id="BudgetReport-165"><a href="#BudgetReport-165"><span class="linenos">165</span></a>               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spending&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="BudgetReport-166"><a href="#BudgetReport-166"><span class="linenos">166</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span>
</span><span id="BudgetReport-167"><a href="#BudgetReport-167"><span class="linenos">167</span></a>               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Revenue Change&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="BudgetReport-168"><a href="#BudgetReport-168"><span class="linenos">168</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-169"><a href="#BudgetReport-169"><span class="linenos">169</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$ billions&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-170"><a href="#BudgetReport-170"><span class="linenos">170</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Revenue vs Spending Effects&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-171"><a href="#BudgetReport-171"><span class="linenos">171</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="BudgetReport-172"><a href="#BudgetReport-172"><span class="linenos">172</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="BudgetReport-173"><a href="#BudgetReport-173"><span class="linenos">173</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="BudgetReport-174"><a href="#BudgetReport-174"><span class="linenos">174</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport-175"><a href="#BudgetReport-175"><span class="linenos">175</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-176"><a href="#BudgetReport-176"><span class="linenos">176</span></a>        
</span><span id="BudgetReport-177"><a href="#BudgetReport-177"><span class="linenos">177</span></a>        <span class="c1"># 4. Economic effects (if dynamic) or summary pie</span>
</span><span id="BudgetReport-178"><a href="#BudgetReport-178"><span class="linenos">178</span></a>        <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="BudgetReport-179"><a href="#BudgetReport-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport-180"><a href="#BudgetReport-180"><span class="linenos">180</span></a>            <span class="n">ax4_twin</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span><span id="BudgetReport-181"><a href="#BudgetReport-181"><span class="linenos">181</span></a>            
</span><span id="BudgetReport-182"><a href="#BudgetReport-182"><span class="linenos">182</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">,</span>
</span><span id="BudgetReport-183"><a href="#BudgetReport-183"><span class="linenos">183</span></a>                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;GDP Effect (%)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-184"><a href="#BudgetReport-184"><span class="linenos">184</span></a>            <span class="n">ax4_twin</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">,</span>
</span><span id="BudgetReport-185"><a href="#BudgetReport-185"><span class="linenos">185</span></a>                         <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Employment&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-186"><a href="#BudgetReport-186"><span class="linenos">186</span></a>            
</span><span id="BudgetReport-187"><a href="#BudgetReport-187"><span class="linenos">187</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-188"><a href="#BudgetReport-188"><span class="linenos">188</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;GDP Effect (%)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-189"><a href="#BudgetReport-189"><span class="linenos">189</span></a>            <span class="n">ax4_twin</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Employment Change (thousands)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-190"><a href="#BudgetReport-190"><span class="linenos">190</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Economic Effects&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-191"><a href="#BudgetReport-191"><span class="linenos">191</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport-192"><a href="#BudgetReport-192"><span class="linenos">192</span></a>            
</span><span id="BudgetReport-193"><a href="#BudgetReport-193"><span class="linenos">193</span></a>            <span class="c1"># Combined legend</span>
</span><span id="BudgetReport-194"><a href="#BudgetReport-194"><span class="linenos">194</span></a>            <span class="n">lines1</span><span class="p">,</span> <span class="n">labels1</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span><span id="BudgetReport-195"><a href="#BudgetReport-195"><span class="linenos">195</span></a>            <span class="n">lines2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax4_twin</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span><span id="BudgetReport-196"><a href="#BudgetReport-196"><span class="linenos">196</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines1</span> <span class="o">+</span> <span class="n">lines2</span><span class="p">,</span> <span class="n">labels1</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-197"><a href="#BudgetReport-197"><span class="linenos">197</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BudgetReport-198"><a href="#BudgetReport-198"><span class="linenos">198</span></a>            <span class="c1"># Summary breakdown</span>
</span><span id="BudgetReport-199"><a href="#BudgetReport-199"><span class="linenos">199</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Static</span><span class="se">\n</span><span class="s1">Revenue&#39;</span><span class="p">,</span> <span class="s1">&#39;Static</span><span class="se">\n</span><span class="s1">Spending&#39;</span><span class="p">,</span> <span class="s1">&#39;Behavioral</span><span class="se">\n</span><span class="s1">Offset&#39;</span><span class="p">]</span>
</span><span id="BudgetReport-200"><a href="#BudgetReport-200"><span class="linenos">200</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="BudgetReport-201"><a href="#BudgetReport-201"><span class="linenos">201</span></a>                <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">)),</span>
</span><span id="BudgetReport-202"><a href="#BudgetReport-202"><span class="linenos">202</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">),</span>
</span><span id="BudgetReport-203"><a href="#BudgetReport-203"><span class="linenos">203</span></a>                <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">))</span>
</span><span id="BudgetReport-204"><a href="#BudgetReport-204"><span class="linenos">204</span></a>            <span class="p">]</span>
</span><span id="BudgetReport-205"><a href="#BudgetReport-205"><span class="linenos">205</span></a>            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>
</span><span id="BudgetReport-206"><a href="#BudgetReport-206"><span class="linenos">206</span></a>            
</span><span id="BudgetReport-207"><a href="#BudgetReport-207"><span class="linenos">207</span></a>            <span class="c1"># Filter out zero values</span>
</span><span id="BudgetReport-208"><a href="#BudgetReport-208"><span class="linenos">208</span></a>            <span class="n">non_zero</span> <span class="o">=</span> <span class="p">[(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="BudgetReport-209"><a href="#BudgetReport-209"><span class="linenos">209</span></a>            <span class="k">if</span> <span class="n">non_zero</span><span class="p">:</span>
</span><span id="BudgetReport-210"><a href="#BudgetReport-210"><span class="linenos">210</span></a>                <span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">non_zero</span><span class="p">)</span>
</span><span id="BudgetReport-211"><a href="#BudgetReport-211"><span class="linenos">211</span></a>                <span class="n">ax4</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-212"><a href="#BudgetReport-212"><span class="linenos">212</span></a>                       <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="BudgetReport-213"><a href="#BudgetReport-213"><span class="linenos">213</span></a>                <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cost Components&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-214"><a href="#BudgetReport-214"><span class="linenos">214</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BudgetReport-215"><a href="#BudgetReport-215"><span class="linenos">215</span></a>                <span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;No significant components&#39;</span><span class="p">,</span> 
</span><span id="BudgetReport-216"><a href="#BudgetReport-216"><span class="linenos">216</span></a>                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax4</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
</span><span id="BudgetReport-217"><a href="#BudgetReport-217"><span class="linenos">217</span></a>        
</span><span id="BudgetReport-218"><a href="#BudgetReport-218"><span class="linenos">218</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="BudgetReport-219"><a href="#BudgetReport-219"><span class="linenos">219</span></a>        
</span><span id="BudgetReport-220"><a href="#BudgetReport-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">save_path</span><span class="p">:</span>
</span><span id="BudgetReport-221"><a href="#BudgetReport-221"><span class="linenos">221</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-222"><a href="#BudgetReport-222"><span class="linenos">222</span></a>        
</span><span id="BudgetReport-223"><a href="#BudgetReport-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
</span><span id="BudgetReport-224"><a href="#BudgetReport-224"><span class="linenos">224</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="BudgetReport-225"><a href="#BudgetReport-225"><span class="linenos">225</span></a>        
</span><span id="BudgetReport-226"><a href="#BudgetReport-226"><span class="linenos">226</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span><span id="BudgetReport-227"><a href="#BudgetReport-227"><span class="linenos">227</span></a>    
</span><span id="BudgetReport-228"><a href="#BudgetReport-228"><span class="linenos">228</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_comparison</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="BudgetReport-229"><a href="#BudgetReport-229"><span class="linenos">229</span></a>                       <span class="n">other_results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ScoringResult</span><span class="p">],</span>
</span><span id="BudgetReport-230"><a href="#BudgetReport-230"><span class="linenos">230</span></a>                       <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BudgetReport-231"><a href="#BudgetReport-231"><span class="linenos">231</span></a>                       <span class="n">save_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
</span><span id="BudgetReport-232"><a href="#BudgetReport-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BudgetReport-233"><a href="#BudgetReport-233"><span class="linenos">233</span></a><span class="sd">        Compare multiple policy scoring results.</span>
</span><span id="BudgetReport-234"><a href="#BudgetReport-234"><span class="linenos">234</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BudgetReport-235"><a href="#BudgetReport-235"><span class="linenos">235</span></a>        <span class="n">all_results</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">]</span> <span class="o">+</span> <span class="n">other_results</span>
</span><span id="BudgetReport-236"><a href="#BudgetReport-236"><span class="linenos">236</span></a>        <span class="n">n_policies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_results</span><span class="p">)</span>
</span><span id="BudgetReport-237"><a href="#BudgetReport-237"><span class="linenos">237</span></a>        
</span><span id="BudgetReport-238"><a href="#BudgetReport-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BudgetReport-239"><a href="#BudgetReport-239"><span class="linenos">239</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">]</span>
</span><span id="BudgetReport-240"><a href="#BudgetReport-240"><span class="linenos">240</span></a>        
</span><span id="BudgetReport-241"><a href="#BudgetReport-241"><span class="linenos">241</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="BudgetReport-242"><a href="#BudgetReport-242"><span class="linenos">242</span></a>        
</span><span id="BudgetReport-243"><a href="#BudgetReport-243"><span class="linenos">243</span></a>        <span class="c1"># 1. 10-year totals comparison</span>
</span><span id="BudgetReport-244"><a href="#BudgetReport-244"><span class="linenos">244</span></a>        <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BudgetReport-245"><a href="#BudgetReport-245"><span class="linenos">245</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_policies</span><span class="p">)</span>
</span><span id="BudgetReport-246"><a href="#BudgetReport-246"><span class="linenos">246</span></a>        <span class="n">totals</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">total_10_year_cost</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">]</span>
</span><span id="BudgetReport-247"><a href="#BudgetReport-247"><span class="linenos">247</span></a>        <span class="n">lows</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">]</span>
</span><span id="BudgetReport-248"><a href="#BudgetReport-248"><span class="linenos">248</span></a>        <span class="n">highs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">]</span>
</span><span id="BudgetReport-249"><a href="#BudgetReport-249"><span class="linenos">249</span></a>        
</span><span id="BudgetReport-250"><a href="#BudgetReport-250"><span class="linenos">250</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Set2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_policies</span><span class="p">))</span>
</span><span id="BudgetReport-251"><a href="#BudgetReport-251"><span class="linenos">251</span></a>        <span class="n">bars</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">totals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</span><span id="BudgetReport-252"><a href="#BudgetReport-252"><span class="linenos">252</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">totals</span><span class="p">,</span> 
</span><span id="BudgetReport-253"><a href="#BudgetReport-253"><span class="linenos">253</span></a>                    <span class="n">yerr</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lows</span><span class="p">),</span> 
</span><span id="BudgetReport-254"><a href="#BudgetReport-254"><span class="linenos">254</span></a>                          <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">highs</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">totals</span><span class="p">)],</span>
</span><span id="BudgetReport-255"><a href="#BudgetReport-255"><span class="linenos">255</span></a>                    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="BudgetReport-256"><a href="#BudgetReport-256"><span class="linenos">256</span></a>        
</span><span id="BudgetReport-257"><a href="#BudgetReport-257"><span class="linenos">257</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Policy&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-258"><a href="#BudgetReport-258"><span class="linenos">258</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;10-Year Cost ($ billions)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-259"><a href="#BudgetReport-259"><span class="linenos">259</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Total 10-Year Budget Impact&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-260"><a href="#BudgetReport-260"><span class="linenos">260</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="BudgetReport-261"><a href="#BudgetReport-261"><span class="linenos">261</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-262"><a href="#BudgetReport-262"><span class="linenos">262</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport-263"><a href="#BudgetReport-263"><span class="linenos">263</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="BudgetReport-264"><a href="#BudgetReport-264"><span class="linenos">264</span></a>        
</span><span id="BudgetReport-265"><a href="#BudgetReport-265"><span class="linenos">265</span></a>        <span class="c1"># Add value labels</span>
</span><span id="BudgetReport-266"><a href="#BudgetReport-266"><span class="linenos">266</span></a>        <span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">total</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">totals</span><span class="p">):</span>
</span><span id="BudgetReport-267"><a href="#BudgetReport-267"><span class="linenos">267</span></a>            <span class="n">height</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
</span><span id="BudgetReport-268"><a href="#BudgetReport-268"><span class="linenos">268</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$</span><span class="si">{</span><span class="n">total</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">B&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-269"><a href="#BudgetReport-269"><span class="linenos">269</span></a>                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span>
</span><span id="BudgetReport-270"><a href="#BudgetReport-270"><span class="linenos">270</span></a>                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span><span id="BudgetReport-271"><a href="#BudgetReport-271"><span class="linenos">271</span></a>                        <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
</span><span id="BudgetReport-272"><a href="#BudgetReport-272"><span class="linenos">272</span></a>                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span><span id="BudgetReport-273"><a href="#BudgetReport-273"><span class="linenos">273</span></a>        
</span><span id="BudgetReport-274"><a href="#BudgetReport-274"><span class="linenos">274</span></a>        <span class="c1"># 2. Time series comparison</span>
</span><span id="BudgetReport-275"><a href="#BudgetReport-275"><span class="linenos">275</span></a>        <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="BudgetReport-276"><a href="#BudgetReport-276"><span class="linenos">276</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">all_results</span><span class="p">,</span> <span class="n">labels</span><span class="p">)):</span>
</span><span id="BudgetReport-277"><a href="#BudgetReport-277"><span class="linenos">277</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">,</span> 
</span><span id="BudgetReport-278"><a href="#BudgetReport-278"><span class="linenos">278</span></a>                    <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="BudgetReport-279"><a href="#BudgetReport-279"><span class="linenos">279</span></a>        
</span><span id="BudgetReport-280"><a href="#BudgetReport-280"><span class="linenos">280</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-281"><a href="#BudgetReport-281"><span class="linenos">281</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Annual Deficit Effect ($ billions)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-282"><a href="#BudgetReport-282"><span class="linenos">282</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Year-by-Year Comparison&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-283"><a href="#BudgetReport-283"><span class="linenos">283</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-284"><a href="#BudgetReport-284"><span class="linenos">284</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport-285"><a href="#BudgetReport-285"><span class="linenos">285</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="BudgetReport-286"><a href="#BudgetReport-286"><span class="linenos">286</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="BudgetReport-287"><a href="#BudgetReport-287"><span class="linenos">287</span></a>        
</span><span id="BudgetReport-288"><a href="#BudgetReport-288"><span class="linenos">288</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="BudgetReport-289"><a href="#BudgetReport-289"><span class="linenos">289</span></a>        
</span><span id="BudgetReport-290"><a href="#BudgetReport-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="n">save_path</span><span class="p">:</span>
</span><span id="BudgetReport-291"><a href="#BudgetReport-291"><span class="linenos">291</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</span><span id="BudgetReport-292"><a href="#BudgetReport-292"><span class="linenos">292</span></a>        
</span><span id="BudgetReport-293"><a href="#BudgetReport-293"><span class="linenos">293</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="BudgetReport-294"><a href="#BudgetReport-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span><span id="BudgetReport-295"><a href="#BudgetReport-295"><span class="linenos">295</span></a>    
</span><span id="BudgetReport-296"><a href="#BudgetReport-296"><span class="linenos">296</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">export_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BudgetReport-297"><a href="#BudgetReport-297"><span class="linenos">297</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export results to CSV file.&quot;&quot;&quot;</span>
</span><span id="BudgetReport-298"><a href="#BudgetReport-298"><span class="linenos">298</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span><span id="BudgetReport-299"><a href="#BudgetReport-299"><span class="linenos">299</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BudgetReport-300"><a href="#BudgetReport-300"><span class="linenos">300</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results exported to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport-301"><a href="#BudgetReport-301"><span class="linenos">301</span></a>    
</span><span id="BudgetReport-302"><a href="#BudgetReport-302"><span class="linenos">302</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">export_to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BudgetReport-303"><a href="#BudgetReport-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export results to Excel file with multiple sheets.&quot;&quot;&quot;</span>
</span><span id="BudgetReport-304"><a href="#BudgetReport-304"><span class="linenos">304</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="BudgetReport-305"><a href="#BudgetReport-305"><span class="linenos">305</span></a>        
</span><span id="BudgetReport-306"><a href="#BudgetReport-306"><span class="linenos">306</span></a>        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
</span><span id="BudgetReport-307"><a href="#BudgetReport-307"><span class="linenos">307</span></a>            <span class="c1"># Main results</span>
</span><span id="BudgetReport-308"><a href="#BudgetReport-308"><span class="linenos">308</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span><span id="BudgetReport-309"><a href="#BudgetReport-309"><span class="linenos">309</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Budget Effects&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BudgetReport-310"><a href="#BudgetReport-310"><span class="linenos">310</span></a>            
</span><span id="BudgetReport-311"><a href="#BudgetReport-311"><span class="linenos">311</span></a>            <span class="c1"># Summary</span>
</span><span id="BudgetReport-312"><a href="#BudgetReport-312"><span class="linenos">312</span></a>            <span class="n">summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="BudgetReport-313"><a href="#BudgetReport-313"><span class="linenos">313</span></a>                <span class="s1">&#39;Metric&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="BudgetReport-314"><a href="#BudgetReport-314"><span class="linenos">314</span></a>                    <span class="s1">&#39;10-Year Static Cost&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-315"><a href="#BudgetReport-315"><span class="linenos">315</span></a>                    <span class="s1">&#39;Behavioral Offset&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-316"><a href="#BudgetReport-316"><span class="linenos">316</span></a>                    <span class="s1">&#39;Revenue Feedback&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span> <span class="k">else</span> <span class="s1">&#39;N/A&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-317"><a href="#BudgetReport-317"><span class="linenos">317</span></a>                    <span class="s1">&#39;10-Year Net Cost&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-318"><a href="#BudgetReport-318"><span class="linenos">318</span></a>                    <span class="s1">&#39;Low Estimate&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-319"><a href="#BudgetReport-319"><span class="linenos">319</span></a>                    <span class="s1">&#39;High Estimate&#39;</span><span class="p">,</span>
</span><span id="BudgetReport-320"><a href="#BudgetReport-320"><span class="linenos">320</span></a>                <span class="p">],</span>
</span><span id="BudgetReport-321"><a href="#BudgetReport-321"><span class="linenos">321</span></a>                <span class="s1">&#39;Value ($ billions)&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="BudgetReport-322"><a href="#BudgetReport-322"><span class="linenos">322</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_static_cost</span><span class="p">,</span>
</span><span id="BudgetReport-323"><a href="#BudgetReport-323"><span class="linenos">323</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">),</span>
</span><span id="BudgetReport-324"><a href="#BudgetReport-324"><span class="linenos">324</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="BudgetReport-325"><a href="#BudgetReport-325"><span class="linenos">325</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="p">,</span>
</span><span id="BudgetReport-326"><a href="#BudgetReport-326"><span class="linenos">326</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">),</span>
</span><span id="BudgetReport-327"><a href="#BudgetReport-327"><span class="linenos">327</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">),</span>
</span><span id="BudgetReport-328"><a href="#BudgetReport-328"><span class="linenos">328</span></a>                <span class="p">]</span>
</span><span id="BudgetReport-329"><a href="#BudgetReport-329"><span class="linenos">329</span></a>            <span class="p">})</span>
</span><span id="BudgetReport-330"><a href="#BudgetReport-330"><span class="linenos">330</span></a>            <span class="n">summary</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Summary&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BudgetReport-331"><a href="#BudgetReport-331"><span class="linenos">331</span></a>            
</span><span id="BudgetReport-332"><a href="#BudgetReport-332"><span class="linenos">332</span></a>            <span class="c1"># Economic effects if available</span>
</span><span id="BudgetReport-333"><a href="#BudgetReport-333"><span class="linenos">333</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport-334"><a href="#BudgetReport-334"><span class="linenos">334</span></a>                <span class="n">econ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="BudgetReport-335"><a href="#BudgetReport-335"><span class="linenos">335</span></a>                    <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span>
</span><span id="BudgetReport-336"><a href="#BudgetReport-336"><span class="linenos">336</span></a>                    <span class="s1">&#39;GDP Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">,</span>
</span><span id="BudgetReport-337"><a href="#BudgetReport-337"><span class="linenos">337</span></a>                    <span class="s1">&#39;GDP Effect (%)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">,</span>
</span><span id="BudgetReport-338"><a href="#BudgetReport-338"><span class="linenos">338</span></a>                    <span class="s1">&#39;Employment (thousands)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">,</span>
</span><span id="BudgetReport-339"><a href="#BudgetReport-339"><span class="linenos">339</span></a>                    <span class="s1">&#39;Revenue Feedback ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">,</span>
</span><span id="BudgetReport-340"><a href="#BudgetReport-340"><span class="linenos">340</span></a>                <span class="p">})</span>
</span><span id="BudgetReport-341"><a href="#BudgetReport-341"><span class="linenos">341</span></a>                <span class="n">econ</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Economic Effects&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BudgetReport-342"><a href="#BudgetReport-342"><span class="linenos">342</span></a>        
</span><span id="BudgetReport-343"><a href="#BudgetReport-343"><span class="linenos">343</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results exported to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate comprehensive budget reports for fiscal policy analysis.</p>
</div>


                            <div id="BudgetReport.__init__" class="classattr">
                                        <input id="BudgetReport.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">BudgetReport</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">result</span><span class="p">:</span> <span class="n"><a href="#ScoringResult">ScoringResult</a></span></span>)</span>

                <label class="view-source-button" for="BudgetReport.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BudgetReport.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BudgetReport.__init__-23"><a href="#BudgetReport.__init__-23"><span class="linenos">23</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">ScoringResult</span><span class="p">):</span>
</span><span id="BudgetReport.__init__-24"><a href="#BudgetReport.__init__-24"><span class="linenos">24</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="BudgetReport.__init__-25"><a href="#BudgetReport.__init__-25"><span class="linenos">25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">years</span>
</span></pre></div>


    

                            </div>
                            <div id="BudgetReport.result" class="classattr">
                                <div class="attr variable">
            <span class="name">result</span>

        
    </div>
    <a class="headerlink" href="#BudgetReport.result"></a>
    
    

                            </div>
                            <div id="BudgetReport.years" class="classattr">
                                <div class="attr variable">
            <span class="name">years</span>

        
    </div>
    <a class="headerlink" href="#BudgetReport.years"></a>
    
    

                            </div>
                            <div id="BudgetReport.generate_text_report" class="classattr">
                                        <input id="BudgetReport.generate_text_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_text_report</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="BudgetReport.generate_text_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BudgetReport.generate_text_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BudgetReport.generate_text_report-27"><a href="#BudgetReport.generate_text_report-27"><span class="linenos"> 27</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_text_report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="BudgetReport.generate_text_report-28"><a href="#BudgetReport.generate_text_report-28"><span class="linenos"> 28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a detailed text report.&quot;&quot;&quot;</span>
</span><span id="BudgetReport.generate_text_report-29"><a href="#BudgetReport.generate_text_report-29"><span class="linenos"> 29</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="BudgetReport.generate_text_report-30"><a href="#BudgetReport.generate_text_report-30"><span class="linenos"> 30</span></a>        
</span><span id="BudgetReport.generate_text_report-31"><a href="#BudgetReport.generate_text_report-31"><span class="linenos"> 31</span></a>        <span class="c1"># Header</span>
</span><span id="BudgetReport.generate_text_report-32"><a href="#BudgetReport.generate_text_report-32"><span class="linenos"> 32</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-33"><a href="#BudgetReport.generate_text_report-33"><span class="linenos"> 33</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;FISCAL POLICY SCORING REPORT&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-34"><a href="#BudgetReport.generate_text_report-34"><span class="linenos"> 34</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-35"><a href="#BudgetReport.generate_text_report-35"><span class="linenos"> 35</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-36"><a href="#BudgetReport.generate_text_report-36"><span class="linenos"> 36</span></a>        
</span><span id="BudgetReport.generate_text_report-37"><a href="#BudgetReport.generate_text_report-37"><span class="linenos"> 37</span></a>        <span class="c1"># Policy summary</span>
</span><span id="BudgetReport.generate_text_report-38"><a href="#BudgetReport.generate_text_report-38"><span class="linenos"> 38</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;POLICY SUMMARY&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-39"><a href="#BudgetReport.generate_text_report-39"><span class="linenos"> 39</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-40"><a href="#BudgetReport.generate_text_report-40"><span class="linenos"> 40</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-41"><a href="#BudgetReport.generate_text_report-41"><span class="linenos"> 41</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Description: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-42"><a href="#BudgetReport.generate_text_report-42"><span class="linenos"> 42</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Effective: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">start_year</span><span class="si">}</span><span class="s2"> - &quot;</span>
</span><span id="BudgetReport.generate_text_report-43"><a href="#BudgetReport.generate_text_report-43"><span class="linenos"> 43</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">start_year</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">duration_years</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-44"><a href="#BudgetReport.generate_text_report-44"><span class="linenos"> 44</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-45"><a href="#BudgetReport.generate_text_report-45"><span class="linenos"> 45</span></a>        
</span><span id="BudgetReport.generate_text_report-46"><a href="#BudgetReport.generate_text_report-46"><span class="linenos"> 46</span></a>        <span class="c1"># Key metrics</span>
</span><span id="BudgetReport.generate_text_report-47"><a href="#BudgetReport.generate_text_report-47"><span class="linenos"> 47</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;KEY BUDGET METRICS ($ billions)&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-48"><a href="#BudgetReport.generate_text_report-48"><span class="linenos"> 48</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-49"><a href="#BudgetReport.generate_text_report-49"><span class="linenos"> 49</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10-Year Static Cost:        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_static_cost</span><span class="si">:</span><span class="s2">&gt;12,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-50"><a href="#BudgetReport.generate_text_report-50"><span class="linenos"> 50</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Behavioral Offset:          </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;12,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-51"><a href="#BudgetReport.generate_text_report-51"><span class="linenos"> 51</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport.generate_text_report-52"><a href="#BudgetReport.generate_text_report-52"><span class="linenos"> 52</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Economic Feedback:          </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span><span class="si">:</span><span class="s2">&gt;12,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-53"><a href="#BudgetReport.generate_text_report-53"><span class="linenos"> 53</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10-Year Net Cost:           </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="si">:</span><span class="s2">&gt;12,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-54"><a href="#BudgetReport.generate_text_report-54"><span class="linenos"> 54</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-55"><a href="#BudgetReport.generate_text_report-55"><span class="linenos"> 55</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uncertainty Range (90% CI): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> to &quot;</span>
</span><span id="BudgetReport.generate_text_report-56"><a href="#BudgetReport.generate_text_report-56"><span class="linenos"> 56</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-57"><a href="#BudgetReport.generate_text_report-57"><span class="linenos"> 57</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-58"><a href="#BudgetReport.generate_text_report-58"><span class="linenos"> 58</span></a>        
</span><span id="BudgetReport.generate_text_report-59"><a href="#BudgetReport.generate_text_report-59"><span class="linenos"> 59</span></a>        <span class="c1"># Year-by-year table</span>
</span><span id="BudgetReport.generate_text_report-60"><a href="#BudgetReport.generate_text_report-60"><span class="linenos"> 60</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;YEAR-BY-YEAR EFFECTS ($ billions)&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-61"><a href="#BudgetReport.generate_text_report-61"><span class="linenos"> 61</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-62"><a href="#BudgetReport.generate_text_report-62"><span class="linenos"> 62</span></a>        
</span><span id="BudgetReport.generate_text_report-63"><a href="#BudgetReport.generate_text_report-63"><span class="linenos"> 63</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Year&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Revenue&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Spending&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Static&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-64"><a href="#BudgetReport.generate_text_report-64"><span class="linenos"> 64</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport.generate_text_report-65"><a href="#BudgetReport.generate_text_report-65"><span class="linenos"> 65</span></a>            <span class="n">header</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Feedback&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-66"><a href="#BudgetReport.generate_text_report-66"><span class="linenos"> 66</span></a>        <span class="n">header</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Final&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Range&#39;</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BudgetReport.generate_text_report-67"><a href="#BudgetReport.generate_text_report-67"><span class="linenos"> 67</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-68"><a href="#BudgetReport.generate_text_report-68"><span class="linenos"> 68</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-69"><a href="#BudgetReport.generate_text_report-69"><span class="linenos"> 69</span></a>        
</span><span id="BudgetReport.generate_text_report-70"><a href="#BudgetReport.generate_text_report-70"><span class="linenos"> 70</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">):</span>
</span><span id="BudgetReport.generate_text_report-71"><a href="#BudgetReport.generate_text_report-71"><span class="linenos"> 71</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-72"><a href="#BudgetReport.generate_text_report-72"><span class="linenos"> 72</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-73"><a href="#BudgetReport.generate_text_report-73"><span class="linenos"> 73</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-74"><a href="#BudgetReport.generate_text_report-74"><span class="linenos"> 74</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-75"><a href="#BudgetReport.generate_text_report-75"><span class="linenos"> 75</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport.generate_text_report-76"><a href="#BudgetReport.generate_text_report-76"><span class="linenos"> 76</span></a>                <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-77"><a href="#BudgetReport.generate_text_report-77"><span class="linenos"> 77</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-78"><a href="#BudgetReport.generate_text_report-78"><span class="linenos"> 78</span></a>            <span class="n">row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;8,.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;8,.1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BudgetReport.generate_text_report-79"><a href="#BudgetReport.generate_text_report-79"><span class="linenos"> 79</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-80"><a href="#BudgetReport.generate_text_report-80"><span class="linenos"> 80</span></a>        
</span><span id="BudgetReport.generate_text_report-81"><a href="#BudgetReport.generate_text_report-81"><span class="linenos"> 81</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-82"><a href="#BudgetReport.generate_text_report-82"><span class="linenos"> 82</span></a>        <span class="n">total_row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;TOTAL&#39;</span><span class="si">:</span><span class="s2">&gt;6</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-83"><a href="#BudgetReport.generate_text_report-83"><span class="linenos"> 83</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-84"><a href="#BudgetReport.generate_text_report-84"><span class="linenos"> 84</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-85"><a href="#BudgetReport.generate_text_report-85"><span class="linenos"> 85</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_static_cost</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-86"><a href="#BudgetReport.generate_text_report-86"><span class="linenos"> 86</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport.generate_text_report-87"><a href="#BudgetReport.generate_text_report-87"><span class="linenos"> 87</span></a>            <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-88"><a href="#BudgetReport.generate_text_report-88"><span class="linenos"> 88</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="si">:</span><span class="s2">&gt;10,.1f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="BudgetReport.generate_text_report-89"><a href="#BudgetReport.generate_text_report-89"><span class="linenos"> 89</span></a>        <span class="n">total_row</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;8,.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;8,.1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BudgetReport.generate_text_report-90"><a href="#BudgetReport.generate_text_report-90"><span class="linenos"> 90</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_row</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-91"><a href="#BudgetReport.generate_text_report-91"><span class="linenos"> 91</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-92"><a href="#BudgetReport.generate_text_report-92"><span class="linenos"> 92</span></a>        
</span><span id="BudgetReport.generate_text_report-93"><a href="#BudgetReport.generate_text_report-93"><span class="linenos"> 93</span></a>        <span class="c1"># Economic effects if dynamic</span>
</span><span id="BudgetReport.generate_text_report-94"><a href="#BudgetReport.generate_text_report-94"><span class="linenos"> 94</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport.generate_text_report-95"><a href="#BudgetReport.generate_text_report-95"><span class="linenos"> 95</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ECONOMIC EFFECTS&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-96"><a href="#BudgetReport.generate_text_report-96"><span class="linenos"> 96</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-97"><a href="#BudgetReport.generate_text_report-97"><span class="linenos"> 97</span></a>            <span class="n">de</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span>
</span><span id="BudgetReport.generate_text_report-98"><a href="#BudgetReport.generate_text_report-98"><span class="linenos"> 98</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average GDP Effect:     </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">de</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-99"><a href="#BudgetReport.generate_text_report-99"><span class="linenos"> 99</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak GDP Effect:        </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">de</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-100"><a href="#BudgetReport.generate_text_report-100"><span class="linenos">100</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Avg Employment Change:  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">de</span><span class="o">.</span><span class="n">employment_change</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.0f</span><span class="si">}</span><span class="s2"> thousand&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-101"><a href="#BudgetReport.generate_text_report-101"><span class="linenos">101</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cumulative GDP Effect:  $</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">de</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;10,.0f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-102"><a href="#BudgetReport.generate_text_report-102"><span class="linenos">102</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-103"><a href="#BudgetReport.generate_text_report-103"><span class="linenos">103</span></a>        
</span><span id="BudgetReport.generate_text_report-104"><a href="#BudgetReport.generate_text_report-104"><span class="linenos">104</span></a>        <span class="c1"># Notes</span>
</span><span id="BudgetReport.generate_text_report-105"><a href="#BudgetReport.generate_text_report-105"><span class="linenos">105</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NOTES&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-106"><a href="#BudgetReport.generate_text_report-106"><span class="linenos">106</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-107"><a href="#BudgetReport.generate_text_report-107"><span class="linenos">107</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;- Positive values indicate increases in deficit/costs&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-108"><a href="#BudgetReport.generate_text_report-108"><span class="linenos">108</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;- Revenue effects are shown as changes from baseline&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-109"><a href="#BudgetReport.generate_text_report-109"><span class="linenos">109</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;- Uncertainty range represents 90</span><span class="si">% c</span><span class="s2">onfidence interval&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-110"><a href="#BudgetReport.generate_text_report-110"><span class="linenos">110</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport.generate_text_report-111"><a href="#BudgetReport.generate_text_report-111"><span class="linenos">111</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;- Economic feedback includes GDP effects on revenues&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-112"><a href="#BudgetReport.generate_text_report-112"><span class="linenos">112</span></a>        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="BudgetReport.generate_text_report-113"><a href="#BudgetReport.generate_text_report-113"><span class="linenos">113</span></a>        
</span><span id="BudgetReport.generate_text_report-114"><a href="#BudgetReport.generate_text_report-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate a detailed text report.</p>
</div>


                            </div>
                            <div id="BudgetReport.plot_budget_effects" class="classattr">
                                        <input id="BudgetReport.plot_budget_effects-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_budget_effects</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span>:</span></span>

                <label class="view-source-button" for="BudgetReport.plot_budget_effects-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BudgetReport.plot_budget_effects"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BudgetReport.plot_budget_effects-116"><a href="#BudgetReport.plot_budget_effects-116"><span class="linenos">116</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_budget_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_budget_effects-117"><a href="#BudgetReport.plot_budget_effects-117"><span class="linenos">117</span></a>                           <span class="n">save_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BudgetReport.plot_budget_effects-118"><a href="#BudgetReport.plot_budget_effects-118"><span class="linenos">118</span></a>                           <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
</span><span id="BudgetReport.plot_budget_effects-119"><a href="#BudgetReport.plot_budget_effects-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BudgetReport.plot_budget_effects-120"><a href="#BudgetReport.plot_budget_effects-120"><span class="linenos">120</span></a><span class="sd">        Create visualization of budget effects over time.</span>
</span><span id="BudgetReport.plot_budget_effects-121"><a href="#BudgetReport.plot_budget_effects-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BudgetReport.plot_budget_effects-122"><a href="#BudgetReport.plot_budget_effects-122"><span class="linenos">122</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="BudgetReport.plot_budget_effects-123"><a href="#BudgetReport.plot_budget_effects-123"><span class="linenos">123</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Budget Effects: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_budget_effects-124"><a href="#BudgetReport.plot_budget_effects-124"><span class="linenos">124</span></a>                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-125"><a href="#BudgetReport.plot_budget_effects-125"><span class="linenos">125</span></a>        
</span><span id="BudgetReport.plot_budget_effects-126"><a href="#BudgetReport.plot_budget_effects-126"><span class="linenos">126</span></a>        <span class="c1"># 1. Deficit effect over time with uncertainty</span>
</span><span id="BudgetReport.plot_budget_effects-127"><a href="#BudgetReport.plot_budget_effects-127"><span class="linenos">127</span></a>        <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="BudgetReport.plot_budget_effects-128"><a href="#BudgetReport.plot_budget_effects-128"><span class="linenos">128</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_budget_effects-129"><a href="#BudgetReport.plot_budget_effects-129"><span class="linenos">129</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.plot_budget_effects-130"><a href="#BudgetReport.plot_budget_effects-130"><span class="linenos">130</span></a>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;90% CI&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-131"><a href="#BudgetReport.plot_budget_effects-131"><span class="linenos">131</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_budget_effects-132"><a href="#BudgetReport.plot_budget_effects-132"><span class="linenos">132</span></a>                <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Central estimate&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-133"><a href="#BudgetReport.plot_budget_effects-133"><span class="linenos">133</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_deficit_effect</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_budget_effects-134"><a href="#BudgetReport.plot_budget_effects-134"><span class="linenos">134</span></a>                <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Static estimate&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-135"><a href="#BudgetReport.plot_budget_effects-135"><span class="linenos">135</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-136"><a href="#BudgetReport.plot_budget_effects-136"><span class="linenos">136</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-137"><a href="#BudgetReport.plot_budget_effects-137"><span class="linenos">137</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Deficit Effect ($ billions)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-138"><a href="#BudgetReport.plot_budget_effects-138"><span class="linenos">138</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Annual Deficit Impact&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-139"><a href="#BudgetReport.plot_budget_effects-139"><span class="linenos">139</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-140"><a href="#BudgetReport.plot_budget_effects-140"><span class="linenos">140</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="BudgetReport.plot_budget_effects-141"><a href="#BudgetReport.plot_budget_effects-141"><span class="linenos">141</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-142"><a href="#BudgetReport.plot_budget_effects-142"><span class="linenos">142</span></a>        
</span><span id="BudgetReport.plot_budget_effects-143"><a href="#BudgetReport.plot_budget_effects-143"><span class="linenos">143</span></a>        <span class="c1"># 2. Cumulative effect</span>
</span><span id="BudgetReport.plot_budget_effects-144"><a href="#BudgetReport.plot_budget_effects-144"><span class="linenos">144</span></a>        <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="BudgetReport.plot_budget_effects-145"><a href="#BudgetReport.plot_budget_effects-145"><span class="linenos">145</span></a>        <span class="n">cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-146"><a href="#BudgetReport.plot_budget_effects-146"><span class="linenos">146</span></a>        <span class="n">cumulative_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-147"><a href="#BudgetReport.plot_budget_effects-147"><span class="linenos">147</span></a>        <span class="n">cumulative_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-148"><a href="#BudgetReport.plot_budget_effects-148"><span class="linenos">148</span></a>        
</span><span id="BudgetReport.plot_budget_effects-149"><a href="#BudgetReport.plot_budget_effects-149"><span class="linenos">149</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="n">cumulative_low</span><span class="p">,</span> <span class="n">cumulative_high</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_budget_effects-150"><a href="#BudgetReport.plot_budget_effects-150"><span class="linenos">150</span></a>                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-151"><a href="#BudgetReport.plot_budget_effects-151"><span class="linenos">151</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="n">cumulative</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-152"><a href="#BudgetReport.plot_budget_effects-152"><span class="linenos">152</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-153"><a href="#BudgetReport.plot_budget_effects-153"><span class="linenos">153</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-154"><a href="#BudgetReport.plot_budget_effects-154"><span class="linenos">154</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative Effect ($ billions)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-155"><a href="#BudgetReport.plot_budget_effects-155"><span class="linenos">155</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cumulative Deficit Impact&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-156"><a href="#BudgetReport.plot_budget_effects-156"><span class="linenos">156</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="BudgetReport.plot_budget_effects-157"><a href="#BudgetReport.plot_budget_effects-157"><span class="linenos">157</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-158"><a href="#BudgetReport.plot_budget_effects-158"><span class="linenos">158</span></a>        
</span><span id="BudgetReport.plot_budget_effects-159"><a href="#BudgetReport.plot_budget_effects-159"><span class="linenos">159</span></a>        <span class="c1"># 3. Components breakdown</span>
</span><span id="BudgetReport.plot_budget_effects-160"><a href="#BudgetReport.plot_budget_effects-160"><span class="linenos">160</span></a>        <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="BudgetReport.plot_budget_effects-161"><a href="#BudgetReport.plot_budget_effects-161"><span class="linenos">161</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>
</span><span id="BudgetReport.plot_budget_effects-162"><a href="#BudgetReport.plot_budget_effects-162"><span class="linenos">162</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">))</span>
</span><span id="BudgetReport.plot_budget_effects-163"><a href="#BudgetReport.plot_budget_effects-163"><span class="linenos">163</span></a>        
</span><span id="BudgetReport.plot_budget_effects-164"><a href="#BudgetReport.plot_budget_effects-164"><span class="linenos">164</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_budget_effects-165"><a href="#BudgetReport.plot_budget_effects-165"><span class="linenos">165</span></a>               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spending&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-166"><a href="#BudgetReport.plot_budget_effects-166"><span class="linenos">166</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span>
</span><span id="BudgetReport.plot_budget_effects-167"><a href="#BudgetReport.plot_budget_effects-167"><span class="linenos">167</span></a>               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Revenue Change&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-168"><a href="#BudgetReport.plot_budget_effects-168"><span class="linenos">168</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-169"><a href="#BudgetReport.plot_budget_effects-169"><span class="linenos">169</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$ billions&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-170"><a href="#BudgetReport.plot_budget_effects-170"><span class="linenos">170</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Revenue vs Spending Effects&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-171"><a href="#BudgetReport.plot_budget_effects-171"><span class="linenos">171</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-172"><a href="#BudgetReport.plot_budget_effects-172"><span class="linenos">172</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-173"><a href="#BudgetReport.plot_budget_effects-173"><span class="linenos">173</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="BudgetReport.plot_budget_effects-174"><a href="#BudgetReport.plot_budget_effects-174"><span class="linenos">174</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-175"><a href="#BudgetReport.plot_budget_effects-175"><span class="linenos">175</span></a>        <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-176"><a href="#BudgetReport.plot_budget_effects-176"><span class="linenos">176</span></a>        
</span><span id="BudgetReport.plot_budget_effects-177"><a href="#BudgetReport.plot_budget_effects-177"><span class="linenos">177</span></a>        <span class="c1"># 4. Economic effects (if dynamic) or summary pie</span>
</span><span id="BudgetReport.plot_budget_effects-178"><a href="#BudgetReport.plot_budget_effects-178"><span class="linenos">178</span></a>        <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="BudgetReport.plot_budget_effects-179"><a href="#BudgetReport.plot_budget_effects-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport.plot_budget_effects-180"><a href="#BudgetReport.plot_budget_effects-180"><span class="linenos">180</span></a>            <span class="n">ax4_twin</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span><span id="BudgetReport.plot_budget_effects-181"><a href="#BudgetReport.plot_budget_effects-181"><span class="linenos">181</span></a>            
</span><span id="BudgetReport.plot_budget_effects-182"><a href="#BudgetReport.plot_budget_effects-182"><span class="linenos">182</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">,</span>
</span><span id="BudgetReport.plot_budget_effects-183"><a href="#BudgetReport.plot_budget_effects-183"><span class="linenos">183</span></a>                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;GDP Effect (%)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-184"><a href="#BudgetReport.plot_budget_effects-184"><span class="linenos">184</span></a>            <span class="n">ax4_twin</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">,</span>
</span><span id="BudgetReport.plot_budget_effects-185"><a href="#BudgetReport.plot_budget_effects-185"><span class="linenos">185</span></a>                         <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Employment&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-186"><a href="#BudgetReport.plot_budget_effects-186"><span class="linenos">186</span></a>            
</span><span id="BudgetReport.plot_budget_effects-187"><a href="#BudgetReport.plot_budget_effects-187"><span class="linenos">187</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-188"><a href="#BudgetReport.plot_budget_effects-188"><span class="linenos">188</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;GDP Effect (%)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-189"><a href="#BudgetReport.plot_budget_effects-189"><span class="linenos">189</span></a>            <span class="n">ax4_twin</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Employment Change (thousands)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-190"><a href="#BudgetReport.plot_budget_effects-190"><span class="linenos">190</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Economic Effects&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-191"><a href="#BudgetReport.plot_budget_effects-191"><span class="linenos">191</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-192"><a href="#BudgetReport.plot_budget_effects-192"><span class="linenos">192</span></a>            
</span><span id="BudgetReport.plot_budget_effects-193"><a href="#BudgetReport.plot_budget_effects-193"><span class="linenos">193</span></a>            <span class="c1"># Combined legend</span>
</span><span id="BudgetReport.plot_budget_effects-194"><a href="#BudgetReport.plot_budget_effects-194"><span class="linenos">194</span></a>            <span class="n">lines1</span><span class="p">,</span> <span class="n">labels1</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span><span id="BudgetReport.plot_budget_effects-195"><a href="#BudgetReport.plot_budget_effects-195"><span class="linenos">195</span></a>            <span class="n">lines2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax4_twin</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
</span><span id="BudgetReport.plot_budget_effects-196"><a href="#BudgetReport.plot_budget_effects-196"><span class="linenos">196</span></a>            <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines1</span> <span class="o">+</span> <span class="n">lines2</span><span class="p">,</span> <span class="n">labels1</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-197"><a href="#BudgetReport.plot_budget_effects-197"><span class="linenos">197</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BudgetReport.plot_budget_effects-198"><a href="#BudgetReport.plot_budget_effects-198"><span class="linenos">198</span></a>            <span class="c1"># Summary breakdown</span>
</span><span id="BudgetReport.plot_budget_effects-199"><a href="#BudgetReport.plot_budget_effects-199"><span class="linenos">199</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Static</span><span class="se">\n</span><span class="s1">Revenue&#39;</span><span class="p">,</span> <span class="s1">&#39;Static</span><span class="se">\n</span><span class="s1">Spending&#39;</span><span class="p">,</span> <span class="s1">&#39;Behavioral</span><span class="se">\n</span><span class="s1">Offset&#39;</span><span class="p">]</span>
</span><span id="BudgetReport.plot_budget_effects-200"><a href="#BudgetReport.plot_budget_effects-200"><span class="linenos">200</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="BudgetReport.plot_budget_effects-201"><a href="#BudgetReport.plot_budget_effects-201"><span class="linenos">201</span></a>                <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_revenue_effect</span><span class="p">)),</span>
</span><span id="BudgetReport.plot_budget_effects-202"><a href="#BudgetReport.plot_budget_effects-202"><span class="linenos">202</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">static_spending_effect</span><span class="p">),</span>
</span><span id="BudgetReport.plot_budget_effects-203"><a href="#BudgetReport.plot_budget_effects-203"><span class="linenos">203</span></a>                <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">))</span>
</span><span id="BudgetReport.plot_budget_effects-204"><a href="#BudgetReport.plot_budget_effects-204"><span class="linenos">204</span></a>            <span class="p">]</span>
</span><span id="BudgetReport.plot_budget_effects-205"><a href="#BudgetReport.plot_budget_effects-205"><span class="linenos">205</span></a>            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>
</span><span id="BudgetReport.plot_budget_effects-206"><a href="#BudgetReport.plot_budget_effects-206"><span class="linenos">206</span></a>            
</span><span id="BudgetReport.plot_budget_effects-207"><a href="#BudgetReport.plot_budget_effects-207"><span class="linenos">207</span></a>            <span class="c1"># Filter out zero values</span>
</span><span id="BudgetReport.plot_budget_effects-208"><a href="#BudgetReport.plot_budget_effects-208"><span class="linenos">208</span></a>            <span class="n">non_zero</span> <span class="o">=</span> <span class="p">[(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="BudgetReport.plot_budget_effects-209"><a href="#BudgetReport.plot_budget_effects-209"><span class="linenos">209</span></a>            <span class="k">if</span> <span class="n">non_zero</span><span class="p">:</span>
</span><span id="BudgetReport.plot_budget_effects-210"><a href="#BudgetReport.plot_budget_effects-210"><span class="linenos">210</span></a>                <span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">non_zero</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-211"><a href="#BudgetReport.plot_budget_effects-211"><span class="linenos">211</span></a>                <span class="n">ax4</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.plot_budget_effects-212"><a href="#BudgetReport.plot_budget_effects-212"><span class="linenos">212</span></a>                       <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-213"><a href="#BudgetReport.plot_budget_effects-213"><span class="linenos">213</span></a>                <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cost Components&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-214"><a href="#BudgetReport.plot_budget_effects-214"><span class="linenos">214</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BudgetReport.plot_budget_effects-215"><a href="#BudgetReport.plot_budget_effects-215"><span class="linenos">215</span></a>                <span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;No significant components&#39;</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_budget_effects-216"><a href="#BudgetReport.plot_budget_effects-216"><span class="linenos">216</span></a>                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax4</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-217"><a href="#BudgetReport.plot_budget_effects-217"><span class="linenos">217</span></a>        
</span><span id="BudgetReport.plot_budget_effects-218"><a href="#BudgetReport.plot_budget_effects-218"><span class="linenos">218</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="BudgetReport.plot_budget_effects-219"><a href="#BudgetReport.plot_budget_effects-219"><span class="linenos">219</span></a>        
</span><span id="BudgetReport.plot_budget_effects-220"><a href="#BudgetReport.plot_budget_effects-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">save_path</span><span class="p">:</span>
</span><span id="BudgetReport.plot_budget_effects-221"><a href="#BudgetReport.plot_budget_effects-221"><span class="linenos">221</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_budget_effects-222"><a href="#BudgetReport.plot_budget_effects-222"><span class="linenos">222</span></a>        
</span><span id="BudgetReport.plot_budget_effects-223"><a href="#BudgetReport.plot_budget_effects-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
</span><span id="BudgetReport.plot_budget_effects-224"><a href="#BudgetReport.plot_budget_effects-224"><span class="linenos">224</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="BudgetReport.plot_budget_effects-225"><a href="#BudgetReport.plot_budget_effects-225"><span class="linenos">225</span></a>        
</span><span id="BudgetReport.plot_budget_effects-226"><a href="#BudgetReport.plot_budget_effects-226"><span class="linenos">226</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span></pre></div>


            <div class="docstring"><p>Create visualization of budget effects over time.</p>
</div>


                            </div>
                            <div id="BudgetReport.plot_comparison" class="classattr">
                                        <input id="BudgetReport.plot_comparison-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_comparison</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">other_results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="#ScoringResult">ScoringResult</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span>:</span></span>

                <label class="view-source-button" for="BudgetReport.plot_comparison-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BudgetReport.plot_comparison"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BudgetReport.plot_comparison-228"><a href="#BudgetReport.plot_comparison-228"><span class="linenos">228</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_comparison</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_comparison-229"><a href="#BudgetReport.plot_comparison-229"><span class="linenos">229</span></a>                       <span class="n">other_results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ScoringResult</span><span class="p">],</span>
</span><span id="BudgetReport.plot_comparison-230"><a href="#BudgetReport.plot_comparison-230"><span class="linenos">230</span></a>                       <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BudgetReport.plot_comparison-231"><a href="#BudgetReport.plot_comparison-231"><span class="linenos">231</span></a>                       <span class="n">save_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
</span><span id="BudgetReport.plot_comparison-232"><a href="#BudgetReport.plot_comparison-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BudgetReport.plot_comparison-233"><a href="#BudgetReport.plot_comparison-233"><span class="linenos">233</span></a><span class="sd">        Compare multiple policy scoring results.</span>
</span><span id="BudgetReport.plot_comparison-234"><a href="#BudgetReport.plot_comparison-234"><span class="linenos">234</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BudgetReport.plot_comparison-235"><a href="#BudgetReport.plot_comparison-235"><span class="linenos">235</span></a>        <span class="n">all_results</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">]</span> <span class="o">+</span> <span class="n">other_results</span>
</span><span id="BudgetReport.plot_comparison-236"><a href="#BudgetReport.plot_comparison-236"><span class="linenos">236</span></a>        <span class="n">n_policies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_results</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-237"><a href="#BudgetReport.plot_comparison-237"><span class="linenos">237</span></a>        
</span><span id="BudgetReport.plot_comparison-238"><a href="#BudgetReport.plot_comparison-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BudgetReport.plot_comparison-239"><a href="#BudgetReport.plot_comparison-239"><span class="linenos">239</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">]</span>
</span><span id="BudgetReport.plot_comparison-240"><a href="#BudgetReport.plot_comparison-240"><span class="linenos">240</span></a>        
</span><span id="BudgetReport.plot_comparison-241"><a href="#BudgetReport.plot_comparison-241"><span class="linenos">241</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="BudgetReport.plot_comparison-242"><a href="#BudgetReport.plot_comparison-242"><span class="linenos">242</span></a>        
</span><span id="BudgetReport.plot_comparison-243"><a href="#BudgetReport.plot_comparison-243"><span class="linenos">243</span></a>        <span class="c1"># 1. 10-year totals comparison</span>
</span><span id="BudgetReport.plot_comparison-244"><a href="#BudgetReport.plot_comparison-244"><span class="linenos">244</span></a>        <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BudgetReport.plot_comparison-245"><a href="#BudgetReport.plot_comparison-245"><span class="linenos">245</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_policies</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-246"><a href="#BudgetReport.plot_comparison-246"><span class="linenos">246</span></a>        <span class="n">totals</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">total_10_year_cost</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">]</span>
</span><span id="BudgetReport.plot_comparison-247"><a href="#BudgetReport.plot_comparison-247"><span class="linenos">247</span></a>        <span class="n">lows</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">]</span>
</span><span id="BudgetReport.plot_comparison-248"><a href="#BudgetReport.plot_comparison-248"><span class="linenos">248</span></a>        <span class="n">highs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">]</span>
</span><span id="BudgetReport.plot_comparison-249"><a href="#BudgetReport.plot_comparison-249"><span class="linenos">249</span></a>        
</span><span id="BudgetReport.plot_comparison-250"><a href="#BudgetReport.plot_comparison-250"><span class="linenos">250</span></a>        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Set2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_policies</span><span class="p">))</span>
</span><span id="BudgetReport.plot_comparison-251"><a href="#BudgetReport.plot_comparison-251"><span class="linenos">251</span></a>        <span class="n">bars</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">totals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-252"><a href="#BudgetReport.plot_comparison-252"><span class="linenos">252</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">totals</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_comparison-253"><a href="#BudgetReport.plot_comparison-253"><span class="linenos">253</span></a>                    <span class="n">yerr</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lows</span><span class="p">),</span> 
</span><span id="BudgetReport.plot_comparison-254"><a href="#BudgetReport.plot_comparison-254"><span class="linenos">254</span></a>                          <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">highs</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">totals</span><span class="p">)],</span>
</span><span id="BudgetReport.plot_comparison-255"><a href="#BudgetReport.plot_comparison-255"><span class="linenos">255</span></a>                    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-256"><a href="#BudgetReport.plot_comparison-256"><span class="linenos">256</span></a>        
</span><span id="BudgetReport.plot_comparison-257"><a href="#BudgetReport.plot_comparison-257"><span class="linenos">257</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Policy&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-258"><a href="#BudgetReport.plot_comparison-258"><span class="linenos">258</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;10-Year Cost ($ billions)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-259"><a href="#BudgetReport.plot_comparison-259"><span class="linenos">259</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Total 10-Year Budget Impact&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-260"><a href="#BudgetReport.plot_comparison-260"><span class="linenos">260</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-261"><a href="#BudgetReport.plot_comparison-261"><span class="linenos">261</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-262"><a href="#BudgetReport.plot_comparison-262"><span class="linenos">262</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-263"><a href="#BudgetReport.plot_comparison-263"><span class="linenos">263</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="BudgetReport.plot_comparison-264"><a href="#BudgetReport.plot_comparison-264"><span class="linenos">264</span></a>        
</span><span id="BudgetReport.plot_comparison-265"><a href="#BudgetReport.plot_comparison-265"><span class="linenos">265</span></a>        <span class="c1"># Add value labels</span>
</span><span id="BudgetReport.plot_comparison-266"><a href="#BudgetReport.plot_comparison-266"><span class="linenos">266</span></a>        <span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">total</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">totals</span><span class="p">):</span>
</span><span id="BudgetReport.plot_comparison-267"><a href="#BudgetReport.plot_comparison-267"><span class="linenos">267</span></a>            <span class="n">height</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
</span><span id="BudgetReport.plot_comparison-268"><a href="#BudgetReport.plot_comparison-268"><span class="linenos">268</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$</span><span class="si">{</span><span class="n">total</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">B&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.plot_comparison-269"><a href="#BudgetReport.plot_comparison-269"><span class="linenos">269</span></a>                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span>
</span><span id="BudgetReport.plot_comparison-270"><a href="#BudgetReport.plot_comparison-270"><span class="linenos">270</span></a>                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span><span id="BudgetReport.plot_comparison-271"><a href="#BudgetReport.plot_comparison-271"><span class="linenos">271</span></a>                        <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
</span><span id="BudgetReport.plot_comparison-272"><a href="#BudgetReport.plot_comparison-272"><span class="linenos">272</span></a>                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-273"><a href="#BudgetReport.plot_comparison-273"><span class="linenos">273</span></a>        
</span><span id="BudgetReport.plot_comparison-274"><a href="#BudgetReport.plot_comparison-274"><span class="linenos">274</span></a>        <span class="c1"># 2. Time series comparison</span>
</span><span id="BudgetReport.plot_comparison-275"><a href="#BudgetReport.plot_comparison-275"><span class="linenos">275</span></a>        <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="BudgetReport.plot_comparison-276"><a href="#BudgetReport.plot_comparison-276"><span class="linenos">276</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">all_results</span><span class="p">,</span> <span class="n">labels</span><span class="p">)):</span>
</span><span id="BudgetReport.plot_comparison-277"><a href="#BudgetReport.plot_comparison-277"><span class="linenos">277</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">years</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">final_deficit_effect</span><span class="p">,</span> 
</span><span id="BudgetReport.plot_comparison-278"><a href="#BudgetReport.plot_comparison-278"><span class="linenos">278</span></a>                    <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="BudgetReport.plot_comparison-279"><a href="#BudgetReport.plot_comparison-279"><span class="linenos">279</span></a>        
</span><span id="BudgetReport.plot_comparison-280"><a href="#BudgetReport.plot_comparison-280"><span class="linenos">280</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-281"><a href="#BudgetReport.plot_comparison-281"><span class="linenos">281</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Annual Deficit Effect ($ billions)&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-282"><a href="#BudgetReport.plot_comparison-282"><span class="linenos">282</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Year-by-Year Comparison&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-283"><a href="#BudgetReport.plot_comparison-283"><span class="linenos">283</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-284"><a href="#BudgetReport.plot_comparison-284"><span class="linenos">284</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-285"><a href="#BudgetReport.plot_comparison-285"><span class="linenos">285</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{x:,.0f}</span><span class="s1">&#39;</span><span class="p">))</span>
</span><span id="BudgetReport.plot_comparison-286"><a href="#BudgetReport.plot_comparison-286"><span class="linenos">286</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-287"><a href="#BudgetReport.plot_comparison-287"><span class="linenos">287</span></a>        
</span><span id="BudgetReport.plot_comparison-288"><a href="#BudgetReport.plot_comparison-288"><span class="linenos">288</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="BudgetReport.plot_comparison-289"><a href="#BudgetReport.plot_comparison-289"><span class="linenos">289</span></a>        
</span><span id="BudgetReport.plot_comparison-290"><a href="#BudgetReport.plot_comparison-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="n">save_path</span><span class="p">:</span>
</span><span id="BudgetReport.plot_comparison-291"><a href="#BudgetReport.plot_comparison-291"><span class="linenos">291</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</span><span id="BudgetReport.plot_comparison-292"><a href="#BudgetReport.plot_comparison-292"><span class="linenos">292</span></a>        
</span><span id="BudgetReport.plot_comparison-293"><a href="#BudgetReport.plot_comparison-293"><span class="linenos">293</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="BudgetReport.plot_comparison-294"><a href="#BudgetReport.plot_comparison-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span></pre></div>


            <div class="docstring"><p>Compare multiple policy scoring results.</p>
</div>


                            </div>
                            <div id="BudgetReport.export_to_csv" class="classattr">
                                        <input id="BudgetReport.export_to_csv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">export_to_csv</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BudgetReport.export_to_csv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BudgetReport.export_to_csv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BudgetReport.export_to_csv-296"><a href="#BudgetReport.export_to_csv-296"><span class="linenos">296</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">export_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BudgetReport.export_to_csv-297"><a href="#BudgetReport.export_to_csv-297"><span class="linenos">297</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export results to CSV file.&quot;&quot;&quot;</span>
</span><span id="BudgetReport.export_to_csv-298"><a href="#BudgetReport.export_to_csv-298"><span class="linenos">298</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span><span id="BudgetReport.export_to_csv-299"><a href="#BudgetReport.export_to_csv-299"><span class="linenos">299</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BudgetReport.export_to_csv-300"><a href="#BudgetReport.export_to_csv-300"><span class="linenos">300</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results exported to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Export results to CSV file.</p>
</div>


                            </div>
                            <div id="BudgetReport.export_to_excel" class="classattr">
                                        <input id="BudgetReport.export_to_excel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">export_to_excel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BudgetReport.export_to_excel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BudgetReport.export_to_excel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BudgetReport.export_to_excel-302"><a href="#BudgetReport.export_to_excel-302"><span class="linenos">302</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">export_to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BudgetReport.export_to_excel-303"><a href="#BudgetReport.export_to_excel-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export results to Excel file with multiple sheets.&quot;&quot;&quot;</span>
</span><span id="BudgetReport.export_to_excel-304"><a href="#BudgetReport.export_to_excel-304"><span class="linenos">304</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="BudgetReport.export_to_excel-305"><a href="#BudgetReport.export_to_excel-305"><span class="linenos">305</span></a>        
</span><span id="BudgetReport.export_to_excel-306"><a href="#BudgetReport.export_to_excel-306"><span class="linenos">306</span></a>        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
</span><span id="BudgetReport.export_to_excel-307"><a href="#BudgetReport.export_to_excel-307"><span class="linenos">307</span></a>            <span class="c1"># Main results</span>
</span><span id="BudgetReport.export_to_excel-308"><a href="#BudgetReport.export_to_excel-308"><span class="linenos">308</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span><span id="BudgetReport.export_to_excel-309"><a href="#BudgetReport.export_to_excel-309"><span class="linenos">309</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Budget Effects&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BudgetReport.export_to_excel-310"><a href="#BudgetReport.export_to_excel-310"><span class="linenos">310</span></a>            
</span><span id="BudgetReport.export_to_excel-311"><a href="#BudgetReport.export_to_excel-311"><span class="linenos">311</span></a>            <span class="c1"># Summary</span>
</span><span id="BudgetReport.export_to_excel-312"><a href="#BudgetReport.export_to_excel-312"><span class="linenos">312</span></a>            <span class="n">summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="BudgetReport.export_to_excel-313"><a href="#BudgetReport.export_to_excel-313"><span class="linenos">313</span></a>                <span class="s1">&#39;Metric&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="BudgetReport.export_to_excel-314"><a href="#BudgetReport.export_to_excel-314"><span class="linenos">314</span></a>                    <span class="s1">&#39;10-Year Static Cost&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-315"><a href="#BudgetReport.export_to_excel-315"><span class="linenos">315</span></a>                    <span class="s1">&#39;Behavioral Offset&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-316"><a href="#BudgetReport.export_to_excel-316"><span class="linenos">316</span></a>                    <span class="s1">&#39;Revenue Feedback&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span> <span class="k">else</span> <span class="s1">&#39;N/A&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-317"><a href="#BudgetReport.export_to_excel-317"><span class="linenos">317</span></a>                    <span class="s1">&#39;10-Year Net Cost&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-318"><a href="#BudgetReport.export_to_excel-318"><span class="linenos">318</span></a>                    <span class="s1">&#39;Low Estimate&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-319"><a href="#BudgetReport.export_to_excel-319"><span class="linenos">319</span></a>                    <span class="s1">&#39;High Estimate&#39;</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-320"><a href="#BudgetReport.export_to_excel-320"><span class="linenos">320</span></a>                <span class="p">],</span>
</span><span id="BudgetReport.export_to_excel-321"><a href="#BudgetReport.export_to_excel-321"><span class="linenos">321</span></a>                <span class="s1">&#39;Value ($ billions)&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="BudgetReport.export_to_excel-322"><a href="#BudgetReport.export_to_excel-322"><span class="linenos">322</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_static_cost</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-323"><a href="#BudgetReport.export_to_excel-323"><span class="linenos">323</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">behavioral_offset</span><span class="p">),</span>
</span><span id="BudgetReport.export_to_excel-324"><a href="#BudgetReport.export_to_excel-324"><span class="linenos">324</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">revenue_feedback_10yr</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-325"><a href="#BudgetReport.export_to_excel-325"><span class="linenos">325</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">total_10_year_cost</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-326"><a href="#BudgetReport.export_to_excel-326"><span class="linenos">326</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">low_estimate</span><span class="p">),</span>
</span><span id="BudgetReport.export_to_excel-327"><a href="#BudgetReport.export_to_excel-327"><span class="linenos">327</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">high_estimate</span><span class="p">),</span>
</span><span id="BudgetReport.export_to_excel-328"><a href="#BudgetReport.export_to_excel-328"><span class="linenos">328</span></a>                <span class="p">]</span>
</span><span id="BudgetReport.export_to_excel-329"><a href="#BudgetReport.export_to_excel-329"><span class="linenos">329</span></a>            <span class="p">})</span>
</span><span id="BudgetReport.export_to_excel-330"><a href="#BudgetReport.export_to_excel-330"><span class="linenos">330</span></a>            <span class="n">summary</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Summary&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BudgetReport.export_to_excel-331"><a href="#BudgetReport.export_to_excel-331"><span class="linenos">331</span></a>            
</span><span id="BudgetReport.export_to_excel-332"><a href="#BudgetReport.export_to_excel-332"><span class="linenos">332</span></a>            <span class="c1"># Economic effects if available</span>
</span><span id="BudgetReport.export_to_excel-333"><a href="#BudgetReport.export_to_excel-333"><span class="linenos">333</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
</span><span id="BudgetReport.export_to_excel-334"><a href="#BudgetReport.export_to_excel-334"><span class="linenos">334</span></a>                <span class="n">econ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="BudgetReport.export_to_excel-335"><a href="#BudgetReport.export_to_excel-335"><span class="linenos">335</span></a>                    <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-336"><a href="#BudgetReport.export_to_excel-336"><span class="linenos">336</span></a>                    <span class="s1">&#39;GDP Effect ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_level_change</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-337"><a href="#BudgetReport.export_to_excel-337"><span class="linenos">337</span></a>                    <span class="s1">&#39;GDP Effect (%)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">gdp_percent_change</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-338"><a href="#BudgetReport.export_to_excel-338"><span class="linenos">338</span></a>                    <span class="s1">&#39;Employment (thousands)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">employment_change</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-339"><a href="#BudgetReport.export_to_excel-339"><span class="linenos">339</span></a>                    <span class="s1">&#39;Revenue Feedback ($B)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">dynamic_effects</span><span class="o">.</span><span class="n">revenue_feedback</span><span class="p">,</span>
</span><span id="BudgetReport.export_to_excel-340"><a href="#BudgetReport.export_to_excel-340"><span class="linenos">340</span></a>                <span class="p">})</span>
</span><span id="BudgetReport.export_to_excel-341"><a href="#BudgetReport.export_to_excel-341"><span class="linenos">341</span></a>                <span class="n">econ</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Economic Effects&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BudgetReport.export_to_excel-342"><a href="#BudgetReport.export_to_excel-342"><span class="linenos">342</span></a>        
</span><span id="BudgetReport.export_to_excel-343"><a href="#BudgetReport.export_to_excel-343"><span class="linenos">343</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results exported to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Export results to Excel file with multiple sheets.</p>
</div>


                            </div>
                </section>
                <section id="TCJAExtensionPolicy">
                            <input id="TCJAExtensionPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">TCJAExtensionPolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="TCJAExtensionPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TCJAExtensionPolicy-201"><a href="#TCJAExtensionPolicy-201"><span class="linenos">201</span></a><span class="nd">@dataclass</span>
</span><span id="TCJAExtensionPolicy-202"><a href="#TCJAExtensionPolicy-202"><span class="linenos">202</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TCJAExtensionPolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="TCJAExtensionPolicy-203"><a href="#TCJAExtensionPolicy-203"><span class="linenos">203</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-204"><a href="#TCJAExtensionPolicy-204"><span class="linenos">204</span></a><span class="sd">    Policy for extending TCJA provisions beyond 2025 sunset.</span>
</span><span id="TCJAExtensionPolicy-205"><a href="#TCJAExtensionPolicy-205"><span class="linenos">205</span></a>
</span><span id="TCJAExtensionPolicy-206"><a href="#TCJAExtensionPolicy-206"><span class="linenos">206</span></a><span class="sd">    This models the COST of extension relative to current-law baseline</span>
</span><span id="TCJAExtensionPolicy-207"><a href="#TCJAExtensionPolicy-207"><span class="linenos">207</span></a><span class="sd">    where TCJA provisions expire.</span>
</span><span id="TCJAExtensionPolicy-208"><a href="#TCJAExtensionPolicy-208"><span class="linenos">208</span></a>
</span><span id="TCJAExtensionPolicy-209"><a href="#TCJAExtensionPolicy-209"><span class="linenos">209</span></a><span class="sd">    Scoring methodology:</span>
</span><span id="TCJAExtensionPolicy-210"><a href="#TCJAExtensionPolicy-210"><span class="linenos">210</span></a><span class="sd">    - Uses CBO&#39;s $4.6T 10-year estimate as calibration target</span>
</span><span id="TCJAExtensionPolicy-211"><a href="#TCJAExtensionPolicy-211"><span class="linenos">211</span></a><span class="sd">    - Breaks down into components for analysis</span>
</span><span id="TCJAExtensionPolicy-212"><a href="#TCJAExtensionPolicy-212"><span class="linenos">212</span></a><span class="sd">    - Allows selective extension (e.g., extend rate cuts but not SALT cap)</span>
</span><span id="TCJAExtensionPolicy-213"><a href="#TCJAExtensionPolicy-213"><span class="linenos">213</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-214"><a href="#TCJAExtensionPolicy-214"><span class="linenos">214</span></a>
</span><span id="TCJAExtensionPolicy-215"><a href="#TCJAExtensionPolicy-215"><span class="linenos">215</span></a>    <span class="c1"># Which components to extend</span>
</span><span id="TCJAExtensionPolicy-216"><a href="#TCJAExtensionPolicy-216"><span class="linenos">216</span></a>    <span class="n">extend_rate_cuts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TCJAExtensionPolicy-217"><a href="#TCJAExtensionPolicy-217"><span class="linenos">217</span></a>    <span class="n">extend_standard_deduction</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TCJAExtensionPolicy-218"><a href="#TCJAExtensionPolicy-218"><span class="linenos">218</span></a>    <span class="n">keep_exemption_elimination</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Keep = maintain TCJA (no exemptions)</span>
</span><span id="TCJAExtensionPolicy-219"><a href="#TCJAExtensionPolicy-219"><span class="linenos">219</span></a>    <span class="n">keep_salt_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Keep = maintain TCJA ($10K cap)</span>
</span><span id="TCJAExtensionPolicy-220"><a href="#TCJAExtensionPolicy-220"><span class="linenos">220</span></a>    <span class="n">extend_ctc_expansion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TCJAExtensionPolicy-221"><a href="#TCJAExtensionPolicy-221"><span class="linenos">221</span></a>    <span class="n">extend_passthrough_deduction</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TCJAExtensionPolicy-222"><a href="#TCJAExtensionPolicy-222"><span class="linenos">222</span></a>    <span class="n">extend_estate_exemption</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TCJAExtensionPolicy-223"><a href="#TCJAExtensionPolicy-223"><span class="linenos">223</span></a>    <span class="n">extend_amt_relief</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TCJAExtensionPolicy-224"><a href="#TCJAExtensionPolicy-224"><span class="linenos">224</span></a>
</span><span id="TCJAExtensionPolicy-225"><a href="#TCJAExtensionPolicy-225"><span class="linenos">225</span></a>    <span class="c1"># Calibration to CBO estimate</span>
</span><span id="TCJAExtensionPolicy-226"><a href="#TCJAExtensionPolicy-226"><span class="linenos">226</span></a>    <span class="c1"># Fixed calibration factor based on FULL extension matching CBO $4.6T</span>
</span><span id="TCJAExtensionPolicy-227"><a href="#TCJAExtensionPolicy-227"><span class="linenos">227</span></a>    <span class="c1"># Raw component total for full extension: ~$2,600B</span>
</span><span id="TCJAExtensionPolicy-228"><a href="#TCJAExtensionPolicy-228"><span class="linenos">228</span></a>    <span class="c1"># CBO target: $4,600B</span>
</span><span id="TCJAExtensionPolicy-229"><a href="#TCJAExtensionPolicy-229"><span class="linenos">229</span></a>    <span class="c1"># Calibration factor: 4600 / 2600 = 1.77</span>
</span><span id="TCJAExtensionPolicy-230"><a href="#TCJAExtensionPolicy-230"><span class="linenos">230</span></a>    <span class="n">calibration_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.77</span>  <span class="c1"># Fixed multiplier to match CBO</span>
</span><span id="TCJAExtensionPolicy-231"><a href="#TCJAExtensionPolicy-231"><span class="linenos">231</span></a>
</span><span id="TCJAExtensionPolicy-232"><a href="#TCJAExtensionPolicy-232"><span class="linenos">232</span></a>    <span class="c1"># Dynamic scoring adjustment (CBO estimates ~10% offset from growth)</span>
</span><span id="TCJAExtensionPolicy-233"><a href="#TCJAExtensionPolicy-233"><span class="linenos">233</span></a>    <span class="n">dynamic_offset_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Set &gt;0 for dynamic scoring</span>
</span><span id="TCJAExtensionPolicy-234"><a href="#TCJAExtensionPolicy-234"><span class="linenos">234</span></a>
</span><span id="TCJAExtensionPolicy-235"><a href="#TCJAExtensionPolicy-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_raw_10yr_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-236"><a href="#TCJAExtensionPolicy-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get raw 10-year cost from components (before calibration).&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-237"><a href="#TCJAExtensionPolicy-237"><span class="linenos">237</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TCJAExtensionPolicy-238"><a href="#TCJAExtensionPolicy-238"><span class="linenos">238</span></a>
</span><span id="TCJAExtensionPolicy-239"><a href="#TCJAExtensionPolicy-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_rate_cuts</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-240"><a href="#TCJAExtensionPolicy-240"><span class="linenos">240</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">TCJA_RATE_CUTS</span><span class="o">.</span><span class="n">ten_year_cost_billions</span>
</span><span id="TCJAExtensionPolicy-241"><a href="#TCJAExtensionPolicy-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_standard_deduction</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-242"><a href="#TCJAExtensionPolicy-242"><span class="linenos">242</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">TCJA_STANDARD_DEDUCTION</span><span class="o">.</span><span class="n">ten_year_cost_billions</span>
</span><span id="TCJAExtensionPolicy-243"><a href="#TCJAExtensionPolicy-243"><span class="linenos">243</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_exemption_elimination</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-244"><a href="#TCJAExtensionPolicy-244"><span class="linenos">244</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">TCJA_EXEMPTION_ELIMINATION</span><span class="o">.</span><span class="n">ten_year_cost_billions</span>
</span><span id="TCJAExtensionPolicy-245"><a href="#TCJAExtensionPolicy-245"><span class="linenos">245</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_salt_cap</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-246"><a href="#TCJAExtensionPolicy-246"><span class="linenos">246</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">TCJA_SALT_CAP</span><span class="o">.</span><span class="n">ten_year_cost_billions</span>
</span><span id="TCJAExtensionPolicy-247"><a href="#TCJAExtensionPolicy-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_ctc_expansion</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-248"><a href="#TCJAExtensionPolicy-248"><span class="linenos">248</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">TCJA_CTC_EXPANSION</span><span class="o">.</span><span class="n">ten_year_cost_billions</span>
</span><span id="TCJAExtensionPolicy-249"><a href="#TCJAExtensionPolicy-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_passthrough_deduction</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-250"><a href="#TCJAExtensionPolicy-250"><span class="linenos">250</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">TCJA_PASSTHROUGH_DEDUCTION</span><span class="o">.</span><span class="n">ten_year_cost_billions</span>
</span><span id="TCJAExtensionPolicy-251"><a href="#TCJAExtensionPolicy-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_estate_exemption</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-252"><a href="#TCJAExtensionPolicy-252"><span class="linenos">252</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">TCJA_ESTATE_EXEMPTION</span><span class="o">.</span><span class="n">ten_year_cost_billions</span>
</span><span id="TCJAExtensionPolicy-253"><a href="#TCJAExtensionPolicy-253"><span class="linenos">253</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_amt_relief</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-254"><a href="#TCJAExtensionPolicy-254"><span class="linenos">254</span></a>            <span class="n">total</span> <span class="o">+=</span> <span class="n">TCJA_AMT_RELIEF</span><span class="o">.</span><span class="n">ten_year_cost_billions</span>
</span><span id="TCJAExtensionPolicy-255"><a href="#TCJAExtensionPolicy-255"><span class="linenos">255</span></a>
</span><span id="TCJAExtensionPolicy-256"><a href="#TCJAExtensionPolicy-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="n">total</span>
</span><span id="TCJAExtensionPolicy-257"><a href="#TCJAExtensionPolicy-257"><span class="linenos">257</span></a>
</span><span id="TCJAExtensionPolicy-258"><a href="#TCJAExtensionPolicy-258"><span class="linenos">258</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_annual_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-259"><a href="#TCJAExtensionPolicy-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-260"><a href="#TCJAExtensionPolicy-260"><span class="linenos">260</span></a><span class="sd">        Get annual cost for a given year (0-indexed from start_year).</span>
</span><span id="TCJAExtensionPolicy-261"><a href="#TCJAExtensionPolicy-261"><span class="linenos">261</span></a>
</span><span id="TCJAExtensionPolicy-262"><a href="#TCJAExtensionPolicy-262"><span class="linenos">262</span></a><span class="sd">        Costs grow over time due to:</span>
</span><span id="TCJAExtensionPolicy-263"><a href="#TCJAExtensionPolicy-263"><span class="linenos">263</span></a><span class="sd">        - Income growth pushing more people into higher brackets</span>
</span><span id="TCJAExtensionPolicy-264"><a href="#TCJAExtensionPolicy-264"><span class="linenos">264</span></a><span class="sd">        - Population growth</span>
</span><span id="TCJAExtensionPolicy-265"><a href="#TCJAExtensionPolicy-265"><span class="linenos">265</span></a><span class="sd">        - Inflation indexing</span>
</span><span id="TCJAExtensionPolicy-266"><a href="#TCJAExtensionPolicy-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-267"><a href="#TCJAExtensionPolicy-267"><span class="linenos">267</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TCJAExtensionPolicy-268"><a href="#TCJAExtensionPolicy-268"><span class="linenos">268</span></a>
</span><span id="TCJAExtensionPolicy-269"><a href="#TCJAExtensionPolicy-269"><span class="linenos">269</span></a>        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="TCJAExtensionPolicy-270"><a href="#TCJAExtensionPolicy-270"><span class="linenos">270</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extend_rate_cuts</span><span class="p">,</span> <span class="n">TCJA_RATE_CUTS</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-271"><a href="#TCJAExtensionPolicy-271"><span class="linenos">271</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extend_standard_deduction</span><span class="p">,</span> <span class="n">TCJA_STANDARD_DEDUCTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-272"><a href="#TCJAExtensionPolicy-272"><span class="linenos">272</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keep_exemption_elimination</span><span class="p">,</span> <span class="n">TCJA_EXEMPTION_ELIMINATION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-273"><a href="#TCJAExtensionPolicy-273"><span class="linenos">273</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keep_salt_cap</span><span class="p">,</span> <span class="n">TCJA_SALT_CAP</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-274"><a href="#TCJAExtensionPolicy-274"><span class="linenos">274</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extend_ctc_expansion</span><span class="p">,</span> <span class="n">TCJA_CTC_EXPANSION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-275"><a href="#TCJAExtensionPolicy-275"><span class="linenos">275</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extend_passthrough_deduction</span><span class="p">,</span> <span class="n">TCJA_PASSTHROUGH_DEDUCTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-276"><a href="#TCJAExtensionPolicy-276"><span class="linenos">276</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extend_estate_exemption</span><span class="p">,</span> <span class="n">TCJA_ESTATE_EXEMPTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-277"><a href="#TCJAExtensionPolicy-277"><span class="linenos">277</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extend_amt_relief</span><span class="p">,</span> <span class="n">TCJA_AMT_RELIEF</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-278"><a href="#TCJAExtensionPolicy-278"><span class="linenos">278</span></a>        <span class="p">]</span>
</span><span id="TCJAExtensionPolicy-279"><a href="#TCJAExtensionPolicy-279"><span class="linenos">279</span></a>
</span><span id="TCJAExtensionPolicy-280"><a href="#TCJAExtensionPolicy-280"><span class="linenos">280</span></a>        <span class="k">for</span> <span class="n">include</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-281"><a href="#TCJAExtensionPolicy-281"><span class="linenos">281</span></a>            <span class="k">if</span> <span class="n">include</span> <span class="ow">and</span> <span class="n">component</span><span class="o">.</span><span class="n">annual_cost_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-282"><a href="#TCJAExtensionPolicy-282"><span class="linenos">282</span></a>                <span class="c1"># Apply growth rate</span>
</span><span id="TCJAExtensionPolicy-283"><a href="#TCJAExtensionPolicy-283"><span class="linenos">283</span></a>                <span class="n">annual</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">annual_cost_billions</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">component</span><span class="o">.</span><span class="n">growth_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">year_index</span><span class="p">)</span>
</span><span id="TCJAExtensionPolicy-284"><a href="#TCJAExtensionPolicy-284"><span class="linenos">284</span></a>                <span class="n">total</span> <span class="o">+=</span> <span class="n">annual</span>
</span><span id="TCJAExtensionPolicy-285"><a href="#TCJAExtensionPolicy-285"><span class="linenos">285</span></a>
</span><span id="TCJAExtensionPolicy-286"><a href="#TCJAExtensionPolicy-286"><span class="linenos">286</span></a>        <span class="c1"># Apply calibration factor</span>
</span><span id="TCJAExtensionPolicy-287"><a href="#TCJAExtensionPolicy-287"><span class="linenos">287</span></a>        <span class="n">total</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_factor</span>
</span><span id="TCJAExtensionPolicy-288"><a href="#TCJAExtensionPolicy-288"><span class="linenos">288</span></a>
</span><span id="TCJAExtensionPolicy-289"><a href="#TCJAExtensionPolicy-289"><span class="linenos">289</span></a>        <span class="c1"># Apply dynamic offset if specified</span>
</span><span id="TCJAExtensionPolicy-290"><a href="#TCJAExtensionPolicy-290"><span class="linenos">290</span></a>        <span class="n">total</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_offset_pct</span><span class="p">)</span>
</span><span id="TCJAExtensionPolicy-291"><a href="#TCJAExtensionPolicy-291"><span class="linenos">291</span></a>
</span><span id="TCJAExtensionPolicy-292"><a href="#TCJAExtensionPolicy-292"><span class="linenos">292</span></a>        <span class="k">return</span> <span class="n">total</span>
</span><span id="TCJAExtensionPolicy-293"><a href="#TCJAExtensionPolicy-293"><span class="linenos">293</span></a>
</span><span id="TCJAExtensionPolicy-294"><a href="#TCJAExtensionPolicy-294"><span class="linenos">294</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy-295"><a href="#TCJAExtensionPolicy-295"><span class="linenos">295</span></a>                                       <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-296"><a href="#TCJAExtensionPolicy-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-297"><a href="#TCJAExtensionPolicy-297"><span class="linenos">297</span></a><span class="sd">        Estimate annual revenue effect for TCJA extension.</span>
</span><span id="TCJAExtensionPolicy-298"><a href="#TCJAExtensionPolicy-298"><span class="linenos">298</span></a>
</span><span id="TCJAExtensionPolicy-299"><a href="#TCJAExtensionPolicy-299"><span class="linenos">299</span></a><span class="sd">        TCJA extension is a COST (reduces revenue), so returns negative value.</span>
</span><span id="TCJAExtensionPolicy-300"><a href="#TCJAExtensionPolicy-300"><span class="linenos">300</span></a>
</span><span id="TCJAExtensionPolicy-301"><a href="#TCJAExtensionPolicy-301"><span class="linenos">301</span></a><span class="sd">        Note: This is called per-year by the scorer with no year index,</span>
</span><span id="TCJAExtensionPolicy-302"><a href="#TCJAExtensionPolicy-302"><span class="linenos">302</span></a><span class="sd">        so we return the average annual cost.</span>
</span><span id="TCJAExtensionPolicy-303"><a href="#TCJAExtensionPolicy-303"><span class="linenos">303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-304"><a href="#TCJAExtensionPolicy-304"><span class="linenos">304</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">baseline_revenue</span>  <span class="c1"># Not used for TCJA; uses component-based approach</span>
</span><span id="TCJAExtensionPolicy-305"><a href="#TCJAExtensionPolicy-305"><span class="linenos">305</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">use_real_data</span>
</span><span id="TCJAExtensionPolicy-306"><a href="#TCJAExtensionPolicy-306"><span class="linenos">306</span></a>
</span><span id="TCJAExtensionPolicy-307"><a href="#TCJAExtensionPolicy-307"><span class="linenos">307</span></a>        <span class="c1"># Return negative of average annual cost (extension costs money)</span>
</span><span id="TCJAExtensionPolicy-308"><a href="#TCJAExtensionPolicy-308"><span class="linenos">308</span></a>        <span class="n">total_10yr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_10yr_cost</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_factor</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_offset_pct</span><span class="p">)</span>
</span><span id="TCJAExtensionPolicy-309"><a href="#TCJAExtensionPolicy-309"><span class="linenos">309</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">total_10yr</span> <span class="o">/</span> <span class="mi">10</span>
</span><span id="TCJAExtensionPolicy-310"><a href="#TCJAExtensionPolicy-310"><span class="linenos">310</span></a>
</span><span id="TCJAExtensionPolicy-311"><a href="#TCJAExtensionPolicy-311"><span class="linenos">311</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-312"><a href="#TCJAExtensionPolicy-312"><span class="linenos">312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-313"><a href="#TCJAExtensionPolicy-313"><span class="linenos">313</span></a><span class="sd">        TCJA extension behavioral offset is embedded in the calibration.</span>
</span><span id="TCJAExtensionPolicy-314"><a href="#TCJAExtensionPolicy-314"><span class="linenos">314</span></a>
</span><span id="TCJAExtensionPolicy-315"><a href="#TCJAExtensionPolicy-315"><span class="linenos">315</span></a><span class="sd">        CBO&#39;s $4.6T estimate already incorporates behavioral responses.</span>
</span><span id="TCJAExtensionPolicy-316"><a href="#TCJAExtensionPolicy-316"><span class="linenos">316</span></a><span class="sd">        We don&#39;t apply additional ETI offset to avoid double-counting.</span>
</span><span id="TCJAExtensionPolicy-317"><a href="#TCJAExtensionPolicy-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-318"><a href="#TCJAExtensionPolicy-318"><span class="linenos">318</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="TCJAExtensionPolicy-319"><a href="#TCJAExtensionPolicy-319"><span class="linenos">319</span></a>
</span><span id="TCJAExtensionPolicy-320"><a href="#TCJAExtensionPolicy-320"><span class="linenos">320</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_component_breakdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-321"><a href="#TCJAExtensionPolicy-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-322"><a href="#TCJAExtensionPolicy-322"><span class="linenos">322</span></a><span class="sd">        Get detailed breakdown by component.</span>
</span><span id="TCJAExtensionPolicy-323"><a href="#TCJAExtensionPolicy-323"><span class="linenos">323</span></a>
</span><span id="TCJAExtensionPolicy-324"><a href="#TCJAExtensionPolicy-324"><span class="linenos">324</span></a><span class="sd">        Returns dict with annual and 10-year costs per component.</span>
</span><span id="TCJAExtensionPolicy-325"><a href="#TCJAExtensionPolicy-325"><span class="linenos">325</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy-326"><a href="#TCJAExtensionPolicy-326"><span class="linenos">326</span></a>        <span class="n">breakdown</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="TCJAExtensionPolicy-327"><a href="#TCJAExtensionPolicy-327"><span class="linenos">327</span></a>
</span><span id="TCJAExtensionPolicy-328"><a href="#TCJAExtensionPolicy-328"><span class="linenos">328</span></a>        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="TCJAExtensionPolicy-329"><a href="#TCJAExtensionPolicy-329"><span class="linenos">329</span></a>            <span class="p">(</span><span class="s2">&quot;rate_cuts&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_rate_cuts</span><span class="p">,</span> <span class="n">TCJA_RATE_CUTS</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-330"><a href="#TCJAExtensionPolicy-330"><span class="linenos">330</span></a>            <span class="p">(</span><span class="s2">&quot;standard_deduction&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_standard_deduction</span><span class="p">,</span> <span class="n">TCJA_STANDARD_DEDUCTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-331"><a href="#TCJAExtensionPolicy-331"><span class="linenos">331</span></a>            <span class="p">(</span><span class="s2">&quot;exemption_elimination&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_exemption_elimination</span><span class="p">,</span> <span class="n">TCJA_EXEMPTION_ELIMINATION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-332"><a href="#TCJAExtensionPolicy-332"><span class="linenos">332</span></a>            <span class="p">(</span><span class="s2">&quot;salt_cap&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_salt_cap</span><span class="p">,</span> <span class="n">TCJA_SALT_CAP</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-333"><a href="#TCJAExtensionPolicy-333"><span class="linenos">333</span></a>            <span class="p">(</span><span class="s2">&quot;ctc_expansion&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_ctc_expansion</span><span class="p">,</span> <span class="n">TCJA_CTC_EXPANSION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-334"><a href="#TCJAExtensionPolicy-334"><span class="linenos">334</span></a>            <span class="p">(</span><span class="s2">&quot;passthrough_deduction&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_passthrough_deduction</span><span class="p">,</span> <span class="n">TCJA_PASSTHROUGH_DEDUCTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-335"><a href="#TCJAExtensionPolicy-335"><span class="linenos">335</span></a>            <span class="p">(</span><span class="s2">&quot;estate_exemption&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_estate_exemption</span><span class="p">,</span> <span class="n">TCJA_ESTATE_EXEMPTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-336"><a href="#TCJAExtensionPolicy-336"><span class="linenos">336</span></a>            <span class="p">(</span><span class="s2">&quot;amt_relief&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_amt_relief</span><span class="p">,</span> <span class="n">TCJA_AMT_RELIEF</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy-337"><a href="#TCJAExtensionPolicy-337"><span class="linenos">337</span></a>        <span class="p">]</span>
</span><span id="TCJAExtensionPolicy-338"><a href="#TCJAExtensionPolicy-338"><span class="linenos">338</span></a>
</span><span id="TCJAExtensionPolicy-339"><a href="#TCJAExtensionPolicy-339"><span class="linenos">339</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">include</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-340"><a href="#TCJAExtensionPolicy-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy-341"><a href="#TCJAExtensionPolicy-341"><span class="linenos">341</span></a>                <span class="n">calibrated_10yr</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_factor</span>
</span><span id="TCJAExtensionPolicy-342"><a href="#TCJAExtensionPolicy-342"><span class="linenos">342</span></a>                <span class="n">calibrated_annual</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">annual_cost_billions</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_factor</span>
</span><span id="TCJAExtensionPolicy-343"><a href="#TCJAExtensionPolicy-343"><span class="linenos">343</span></a>                <span class="n">breakdown</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TCJAExtensionPolicy-344"><a href="#TCJAExtensionPolicy-344"><span class="linenos">344</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy-345"><a href="#TCJAExtensionPolicy-345"><span class="linenos">345</span></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy-346"><a href="#TCJAExtensionPolicy-346"><span class="linenos">346</span></a>                    <span class="s2">&quot;ten_year_cost&quot;</span><span class="p">:</span> <span class="n">calibrated_10yr</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy-347"><a href="#TCJAExtensionPolicy-347"><span class="linenos">347</span></a>                    <span class="s2">&quot;annual_cost&quot;</span><span class="p">:</span> <span class="n">calibrated_annual</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy-348"><a href="#TCJAExtensionPolicy-348"><span class="linenos">348</span></a>                    <span class="s2">&quot;is_offset&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy-349"><a href="#TCJAExtensionPolicy-349"><span class="linenos">349</span></a>                <span class="p">}</span>
</span><span id="TCJAExtensionPolicy-350"><a href="#TCJAExtensionPolicy-350"><span class="linenos">350</span></a>
</span><span id="TCJAExtensionPolicy-351"><a href="#TCJAExtensionPolicy-351"><span class="linenos">351</span></a>        <span class="k">return</span> <span class="n">breakdown</span>
</span></pre></div>


            <div class="docstring"><p>Policy for extending TCJA provisions beyond 2025 sunset.</p>

<p>This models the COST of extension relative to current-law baseline
where TCJA provisions expire.</p>

<p>Scoring methodology:</p>

<ul>
<li>Uses CBO's $4.6T 10-year estimate as calibration target</li>
<li>Breaks down into components for analysis</li>
<li>Allows selective extension (e.g., extend rate cuts but not SALT cap)</li>
</ul>
</div>


                            <div id="TCJAExtensionPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TCJAExtensionPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">extend_rate_cuts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_standard_deduction</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">keep_exemption_elimination</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">keep_salt_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_ctc_expansion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_passthrough_deduction</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_estate_exemption</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_amt_relief</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">calibration_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.77</span>,</span><span class="param">	<span class="n">dynamic_offset_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.__init__"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.extend_rate_cuts" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_rate_cuts</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.extend_rate_cuts"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.extend_standard_deduction" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_standard_deduction</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.extend_standard_deduction"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.keep_exemption_elimination" class="classattr">
                                <div class="attr variable">
            <span class="name">keep_exemption_elimination</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.keep_exemption_elimination"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.keep_salt_cap" class="classattr">
                                <div class="attr variable">
            <span class="name">keep_salt_cap</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.keep_salt_cap"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.extend_ctc_expansion" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_ctc_expansion</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.extend_ctc_expansion"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.extend_passthrough_deduction" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_passthrough_deduction</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.extend_passthrough_deduction"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.extend_estate_exemption" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_estate_exemption</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.extend_estate_exemption"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.extend_amt_relief" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_amt_relief</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.extend_amt_relief"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.calibration_factor" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_factor</span><span class="annotation">: float</span>        =
<span class="default_value">1.77</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.calibration_factor"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.dynamic_offset_pct" class="classattr">
                                <div class="attr variable">
            <span class="name">dynamic_offset_pct</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.dynamic_offset_pct"></a>
    
    

                            </div>
                            <div id="TCJAExtensionPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="TCJAExtensionPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TCJAExtensionPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-294"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-294"><span class="linenos">294</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-295"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-295"><span class="linenos">295</span></a>                                       <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-296"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-297"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-297"><span class="linenos">297</span></a><span class="sd">        Estimate annual revenue effect for TCJA extension.</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-298"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-298"><span class="linenos">298</span></a>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-299"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-299"><span class="linenos">299</span></a><span class="sd">        TCJA extension is a COST (reduces revenue), so returns negative value.</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-300"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-300"><span class="linenos">300</span></a>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-301"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-301"><span class="linenos">301</span></a><span class="sd">        Note: This is called per-year by the scorer with no year index,</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-302"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-302"><span class="linenos">302</span></a><span class="sd">        so we return the average annual cost.</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-303"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-303"><span class="linenos">303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-304"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-304"><span class="linenos">304</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">baseline_revenue</span>  <span class="c1"># Not used for TCJA; uses component-based approach</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-305"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-305"><span class="linenos">305</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">use_real_data</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-306"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-306"><span class="linenos">306</span></a>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-307"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-307"><span class="linenos">307</span></a>        <span class="c1"># Return negative of average annual cost (extension costs money)</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-308"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-308"><span class="linenos">308</span></a>        <span class="n">total_10yr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_10yr_cost</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_factor</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_offset_pct</span><span class="p">)</span>
</span><span id="TCJAExtensionPolicy.estimate_static_revenue_effect-309"><a href="#TCJAExtensionPolicy.estimate_static_revenue_effect-309"><span class="linenos">309</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">total_10yr</span> <span class="o">/</span> <span class="mi">10</span>
</span></pre></div>


            <div class="docstring"><p>Estimate annual revenue effect for TCJA extension.</p>

<p>TCJA extension is a COST (reduces revenue), so returns negative value.</p>

<p>Note: This is called per-year by the scorer with no year index,
so we return the average annual cost.</p>
</div>


                            </div>
                            <div id="TCJAExtensionPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="TCJAExtensionPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TCJAExtensionPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TCJAExtensionPolicy.estimate_behavioral_offset-311"><a href="#TCJAExtensionPolicy.estimate_behavioral_offset-311"><span class="linenos">311</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy.estimate_behavioral_offset-312"><a href="#TCJAExtensionPolicy.estimate_behavioral_offset-312"><span class="linenos">312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy.estimate_behavioral_offset-313"><a href="#TCJAExtensionPolicy.estimate_behavioral_offset-313"><span class="linenos">313</span></a><span class="sd">        TCJA extension behavioral offset is embedded in the calibration.</span>
</span><span id="TCJAExtensionPolicy.estimate_behavioral_offset-314"><a href="#TCJAExtensionPolicy.estimate_behavioral_offset-314"><span class="linenos">314</span></a>
</span><span id="TCJAExtensionPolicy.estimate_behavioral_offset-315"><a href="#TCJAExtensionPolicy.estimate_behavioral_offset-315"><span class="linenos">315</span></a><span class="sd">        CBO&#39;s $4.6T estimate already incorporates behavioral responses.</span>
</span><span id="TCJAExtensionPolicy.estimate_behavioral_offset-316"><a href="#TCJAExtensionPolicy.estimate_behavioral_offset-316"><span class="linenos">316</span></a><span class="sd">        We don&#39;t apply additional ETI offset to avoid double-counting.</span>
</span><span id="TCJAExtensionPolicy.estimate_behavioral_offset-317"><a href="#TCJAExtensionPolicy.estimate_behavioral_offset-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy.estimate_behavioral_offset-318"><a href="#TCJAExtensionPolicy.estimate_behavioral_offset-318"><span class="linenos">318</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span></pre></div>


            <div class="docstring"><p>TCJA extension behavioral offset is embedded in the calibration.</p>

<p>CBO's $4.6T estimate already incorporates behavioral responses.
We don't apply additional ETI offset to avoid double-counting.</p>
</div>


                            </div>
                            <div id="TCJAExtensionPolicy.get_component_breakdown" class="classattr">
                                        <input id="TCJAExtensionPolicy.get_component_breakdown-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_component_breakdown</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="TCJAExtensionPolicy.get_component_breakdown-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TCJAExtensionPolicy.get_component_breakdown"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TCJAExtensionPolicy.get_component_breakdown-320"><a href="#TCJAExtensionPolicy.get_component_breakdown-320"><span class="linenos">320</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_component_breakdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-321"><a href="#TCJAExtensionPolicy.get_component_breakdown-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-322"><a href="#TCJAExtensionPolicy.get_component_breakdown-322"><span class="linenos">322</span></a><span class="sd">        Get detailed breakdown by component.</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-323"><a href="#TCJAExtensionPolicy.get_component_breakdown-323"><span class="linenos">323</span></a>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-324"><a href="#TCJAExtensionPolicy.get_component_breakdown-324"><span class="linenos">324</span></a><span class="sd">        Returns dict with annual and 10-year costs per component.</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-325"><a href="#TCJAExtensionPolicy.get_component_breakdown-325"><span class="linenos">325</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-326"><a href="#TCJAExtensionPolicy.get_component_breakdown-326"><span class="linenos">326</span></a>        <span class="n">breakdown</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-327"><a href="#TCJAExtensionPolicy.get_component_breakdown-327"><span class="linenos">327</span></a>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-328"><a href="#TCJAExtensionPolicy.get_component_breakdown-328"><span class="linenos">328</span></a>        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-329"><a href="#TCJAExtensionPolicy.get_component_breakdown-329"><span class="linenos">329</span></a>            <span class="p">(</span><span class="s2">&quot;rate_cuts&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_rate_cuts</span><span class="p">,</span> <span class="n">TCJA_RATE_CUTS</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-330"><a href="#TCJAExtensionPolicy.get_component_breakdown-330"><span class="linenos">330</span></a>            <span class="p">(</span><span class="s2">&quot;standard_deduction&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_standard_deduction</span><span class="p">,</span> <span class="n">TCJA_STANDARD_DEDUCTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-331"><a href="#TCJAExtensionPolicy.get_component_breakdown-331"><span class="linenos">331</span></a>            <span class="p">(</span><span class="s2">&quot;exemption_elimination&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_exemption_elimination</span><span class="p">,</span> <span class="n">TCJA_EXEMPTION_ELIMINATION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-332"><a href="#TCJAExtensionPolicy.get_component_breakdown-332"><span class="linenos">332</span></a>            <span class="p">(</span><span class="s2">&quot;salt_cap&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_salt_cap</span><span class="p">,</span> <span class="n">TCJA_SALT_CAP</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-333"><a href="#TCJAExtensionPolicy.get_component_breakdown-333"><span class="linenos">333</span></a>            <span class="p">(</span><span class="s2">&quot;ctc_expansion&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_ctc_expansion</span><span class="p">,</span> <span class="n">TCJA_CTC_EXPANSION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-334"><a href="#TCJAExtensionPolicy.get_component_breakdown-334"><span class="linenos">334</span></a>            <span class="p">(</span><span class="s2">&quot;passthrough_deduction&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_passthrough_deduction</span><span class="p">,</span> <span class="n">TCJA_PASSTHROUGH_DEDUCTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-335"><a href="#TCJAExtensionPolicy.get_component_breakdown-335"><span class="linenos">335</span></a>            <span class="p">(</span><span class="s2">&quot;estate_exemption&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_estate_exemption</span><span class="p">,</span> <span class="n">TCJA_ESTATE_EXEMPTION</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-336"><a href="#TCJAExtensionPolicy.get_component_breakdown-336"><span class="linenos">336</span></a>            <span class="p">(</span><span class="s2">&quot;amt_relief&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_amt_relief</span><span class="p">,</span> <span class="n">TCJA_AMT_RELIEF</span><span class="p">),</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-337"><a href="#TCJAExtensionPolicy.get_component_breakdown-337"><span class="linenos">337</span></a>        <span class="p">]</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-338"><a href="#TCJAExtensionPolicy.get_component_breakdown-338"><span class="linenos">338</span></a>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-339"><a href="#TCJAExtensionPolicy.get_component_breakdown-339"><span class="linenos">339</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">include</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-340"><a href="#TCJAExtensionPolicy.get_component_breakdown-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-341"><a href="#TCJAExtensionPolicy.get_component_breakdown-341"><span class="linenos">341</span></a>                <span class="n">calibrated_10yr</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_factor</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-342"><a href="#TCJAExtensionPolicy.get_component_breakdown-342"><span class="linenos">342</span></a>                <span class="n">calibrated_annual</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">annual_cost_billions</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_factor</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-343"><a href="#TCJAExtensionPolicy.get_component_breakdown-343"><span class="linenos">343</span></a>                <span class="n">breakdown</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-344"><a href="#TCJAExtensionPolicy.get_component_breakdown-344"><span class="linenos">344</span></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-345"><a href="#TCJAExtensionPolicy.get_component_breakdown-345"><span class="linenos">345</span></a>                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-346"><a href="#TCJAExtensionPolicy.get_component_breakdown-346"><span class="linenos">346</span></a>                    <span class="s2">&quot;ten_year_cost&quot;</span><span class="p">:</span> <span class="n">calibrated_10yr</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-347"><a href="#TCJAExtensionPolicy.get_component_breakdown-347"><span class="linenos">347</span></a>                    <span class="s2">&quot;annual_cost&quot;</span><span class="p">:</span> <span class="n">calibrated_annual</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-348"><a href="#TCJAExtensionPolicy.get_component_breakdown-348"><span class="linenos">348</span></a>                    <span class="s2">&quot;is_offset&quot;</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-349"><a href="#TCJAExtensionPolicy.get_component_breakdown-349"><span class="linenos">349</span></a>                <span class="p">}</span>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-350"><a href="#TCJAExtensionPolicy.get_component_breakdown-350"><span class="linenos">350</span></a>
</span><span id="TCJAExtensionPolicy.get_component_breakdown-351"><a href="#TCJAExtensionPolicy.get_component_breakdown-351"><span class="linenos">351</span></a>        <span class="k">return</span> <span class="n">breakdown</span>
</span></pre></div>


            <div class="docstring"><p>Get detailed breakdown by component.</p>

<p>Returns dict with annual and 10-year costs per component.</p>
</div>


                            </div>
                </section>
                <section id="TCJAComponent">
                            <input id="TCJAComponent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">TCJAComponent</span>:

                <label class="view-source-button" for="TCJAComponent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TCJAComponent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TCJAComponent-31"><a href="#TCJAComponent-31"><span class="linenos">31</span></a><span class="nd">@dataclass</span>
</span><span id="TCJAComponent-32"><a href="#TCJAComponent-32"><span class="linenos">32</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TCJAComponent</span><span class="p">:</span>
</span><span id="TCJAComponent-33"><a href="#TCJAComponent-33"><span class="linenos">33</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TCJAComponent-34"><a href="#TCJAComponent-34"><span class="linenos">34</span></a><span class="sd">    Individual component of TCJA extension.</span>
</span><span id="TCJAComponent-35"><a href="#TCJAComponent-35"><span class="linenos">35</span></a>
</span><span id="TCJAComponent-36"><a href="#TCJAComponent-36"><span class="linenos">36</span></a><span class="sd">    Each component represents a specific provision with its</span>
</span><span id="TCJAComponent-37"><a href="#TCJAComponent-37"><span class="linenos">37</span></a><span class="sd">    estimated 10-year cost if extended.</span>
</span><span id="TCJAComponent-38"><a href="#TCJAComponent-38"><span class="linenos">38</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TCJAComponent-39"><a href="#TCJAComponent-39"><span class="linenos">39</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="TCJAComponent-40"><a href="#TCJAComponent-40"><span class="linenos">40</span></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="TCJAComponent-41"><a href="#TCJAComponent-41"><span class="linenos">41</span></a>    <span class="n">ten_year_cost_billions</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># Positive = increases deficit</span>
</span><span id="TCJAComponent-42"><a href="#TCJAComponent-42"><span class="linenos">42</span></a>    <span class="n">annual_cost_billions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># First year cost</span>
</span><span id="TCJAComponent-43"><a href="#TCJAComponent-43"><span class="linenos">43</span></a>    <span class="n">growth_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.03</span>  <span class="c1"># Annual cost growth rate (nominal)</span>
</span><span id="TCJAComponent-44"><a href="#TCJAComponent-44"><span class="linenos">44</span></a>
</span><span id="TCJAComponent-45"><a href="#TCJAComponent-45"><span class="linenos">45</span></a>    <span class="c1"># For validation</span>
</span><span id="TCJAComponent-46"><a href="#TCJAComponent-46"><span class="linenos">46</span></a>    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;JCT/CBO&quot;</span>
</span><span id="TCJAComponent-47"><a href="#TCJAComponent-47"><span class="linenos">47</span></a>    <span class="n">uncertainty_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>  <span class="c1"># Uncertainty range</span>
</span></pre></div>


            <div class="docstring"><p>Individual component of TCJA extension.</p>

<p>Each component represents a specific provision with its
estimated 10-year cost if extended.</p>
</div>


                            <div id="TCJAComponent.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TCJAComponent</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ten_year_cost_billions</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">annual_cost_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">growth_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.03</span>,</span><span class="param">	<span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;JCT/CBO&#39;</span>,</span><span class="param">	<span class="n">uncertainty_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TCJAComponent.__init__"></a>
    
    

                            </div>
                            <div id="TCJAComponent.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#TCJAComponent.name"></a>
    
    

                            </div>
                            <div id="TCJAComponent.description" class="classattr">
                                <div class="attr variable">
            <span class="name">description</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#TCJAComponent.description"></a>
    
    

                            </div>
                            <div id="TCJAComponent.ten_year_cost_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">ten_year_cost_billions</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#TCJAComponent.ten_year_cost_billions"></a>
    
    

                            </div>
                            <div id="TCJAComponent.annual_cost_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_cost_billions</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TCJAComponent.annual_cost_billions"></a>
    
    

                            </div>
                            <div id="TCJAComponent.growth_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">growth_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.03</span>

        
    </div>
    <a class="headerlink" href="#TCJAComponent.growth_rate"></a>
    
    

                            </div>
                            <div id="TCJAComponent.source" class="classattr">
                                <div class="attr variable">
            <span class="name">source</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;JCT/CBO&#39;</span>

        
    </div>
    <a class="headerlink" href="#TCJAComponent.source"></a>
    
    

                            </div>
                            <div id="TCJAComponent.uncertainty_pct" class="classattr">
                                <div class="attr variable">
            <span class="name">uncertainty_pct</span><span class="annotation">: float</span>        =
<span class="default_value">0.15</span>

        
    </div>
    <a class="headerlink" href="#TCJAComponent.uncertainty_pct"></a>
    
    

                            </div>
                </section>
                <section id="TCJA_COMPONENTS">
                    <div class="attr variable">
            <span class="name">TCJA_COMPONENTS</span>        =
<input id="TCJA_COMPONENTS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="TCJA_COMPONENTS-view-value"></label><span class="default_value">[TCJAComponent(name=&#39;Individual Rate Cuts&#39;, description=&#39;Lower marginal tax rates across all brackets (12% vs 15%, 22% vs 25%, etc.)&#39;, ten_year_cost_billions=1800.0, annual_cost_billions=150.0, growth_rate=0.035, source=&#39;CBO/JCT extrapolation&#39;, uncertainty_pct=0.12), TCJAComponent(name=&#39;Doubled Standard Deduction&#39;, description=&#39;Nearly doubled standard deduction ($29,200 vs ~$14,600 MFJ)&#39;, ten_year_cost_billions=720.0, annual_cost_billions=60.0, growth_rate=0.03, source=&#39;JCT&#39;, uncertainty_pct=0.1), TCJAComponent(name=&#39;Personal Exemption Elimination&#39;, description=&#39;Elimination of $4,150 personal exemptions (OFFSETS other costs)&#39;, ten_year_cost_billions=-650.0, annual_cost_billions=-55.0, growth_rate=0.03, source=&#39;JCT&#39;, uncertainty_pct=0.08), TCJAComponent(name=&#39;SALT Deduction Cap&#39;, description=&#39;$10,000 cap on state and local tax deductions (OFFSETS other costs)&#39;, ten_year_cost_billions=-1100.0, annual_cost_billions=-90.0, growth_rate=0.04, source=&#39;JCT&#39;, uncertainty_pct=0.15), TCJAComponent(name=&#39;Child Tax Credit Expansion&#39;, description=&#39;Expanded CTC from $1,000 to $2,000 per child, higher refundability&#39;, ten_year_cost_billions=550.0, annual_cost_billions=50.0, growth_rate=0.02, source=&#39;JCT&#39;, uncertainty_pct=0.12), TCJAComponent(name=&#39;Pass-Through Deduction (199A)&#39;, description=&#39;20% deduction for qualified business income from pass-throughs&#39;, ten_year_cost_billions=700.0, annual_cost_billions=60.0, growth_rate=0.04, source=&#39;JCT&#39;, uncertainty_pct=0.2), TCJAComponent(name=&#39;Estate Tax Exemption Increase&#39;, description=&#39;Doubled estate tax exemption (~$12.9M vs ~$5.5M per person)&#39;, ten_year_cost_billions=130.0, annual_cost_billions=10.0, growth_rate=0.05, source=&#39;JCT&#39;, uncertainty_pct=0.25), TCJAComponent(name=&#39;AMT Exemption Increase&#39;, description=&#39;Higher AMT exemptions, fewer taxpayers subject to AMT&#39;, ten_year_cost_billions=450.0, annual_cost_billions=40.0, growth_rate=0.03, source=&#39;JCT&#39;, uncertainty_pct=0.15)]</span>

        
    </div>
    <a class="headerlink" href="#TCJA_COMPONENTS"></a>
    
    

                </section>
                <section id="create_tcja_extension">
                            <input id="create_tcja_extension-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_tcja_extension</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">extend_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">keep_salt_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_rate_cuts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_standard_deduction</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">keep_exemption_elimination</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_passthrough</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_ctc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_estate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">extend_amt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TCJAExtensionPolicy">TCJAExtensionPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_tcja_extension-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_tcja_extension"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_tcja_extension-354"><a href="#create_tcja_extension-354"><span class="linenos">354</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_tcja_extension</span><span class="p">(</span>
</span><span id="create_tcja_extension-355"><a href="#create_tcja_extension-355"><span class="linenos">355</span></a>    <span class="n">extend_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-356"><a href="#create_tcja_extension-356"><span class="linenos">356</span></a>    <span class="n">keep_salt_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-357"><a href="#create_tcja_extension-357"><span class="linenos">357</span></a>    <span class="n">extend_rate_cuts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-358"><a href="#create_tcja_extension-358"><span class="linenos">358</span></a>    <span class="n">extend_standard_deduction</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-359"><a href="#create_tcja_extension-359"><span class="linenos">359</span></a>    <span class="n">keep_exemption_elimination</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-360"><a href="#create_tcja_extension-360"><span class="linenos">360</span></a>    <span class="n">extend_passthrough</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-361"><a href="#create_tcja_extension-361"><span class="linenos">361</span></a>    <span class="n">extend_ctc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-362"><a href="#create_tcja_extension-362"><span class="linenos">362</span></a>    <span class="n">extend_estate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-363"><a href="#create_tcja_extension-363"><span class="linenos">363</span></a>    <span class="n">extend_amt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-364"><a href="#create_tcja_extension-364"><span class="linenos">364</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_tcja_extension-365"><a href="#create_tcja_extension-365"><span class="linenos">365</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_tcja_extension-366"><a href="#create_tcja_extension-366"><span class="linenos">366</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TCJAExtensionPolicy</span><span class="p">:</span>
</span><span id="create_tcja_extension-367"><a href="#create_tcja_extension-367"><span class="linenos">367</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_tcja_extension-368"><a href="#create_tcja_extension-368"><span class="linenos">368</span></a><span class="sd">    Create a TCJA extension policy.</span>
</span><span id="create_tcja_extension-369"><a href="#create_tcja_extension-369"><span class="linenos">369</span></a>
</span><span id="create_tcja_extension-370"><a href="#create_tcja_extension-370"><span class="linenos">370</span></a><span class="sd">    Args:</span>
</span><span id="create_tcja_extension-371"><a href="#create_tcja_extension-371"><span class="linenos">371</span></a><span class="sd">        extend_all: If True, extend all TCJA provisions (overrides individual flags)</span>
</span><span id="create_tcja_extension-372"><a href="#create_tcja_extension-372"><span class="linenos">372</span></a><span class="sd">        keep_salt_cap: If False, repeal SALT cap (COSTS more)</span>
</span><span id="create_tcja_extension-373"><a href="#create_tcja_extension-373"><span class="linenos">373</span></a><span class="sd">        extend_rate_cuts: Whether to extend rate bracket changes</span>
</span><span id="create_tcja_extension-374"><a href="#create_tcja_extension-374"><span class="linenos">374</span></a><span class="sd">        extend_standard_deduction: Whether to extend doubled standard deduction</span>
</span><span id="create_tcja_extension-375"><a href="#create_tcja_extension-375"><span class="linenos">375</span></a><span class="sd">        keep_exemption_elimination: Whether to maintain personal exemption elimination</span>
</span><span id="create_tcja_extension-376"><a href="#create_tcja_extension-376"><span class="linenos">376</span></a><span class="sd">        extend_passthrough: Whether to extend 199A deduction</span>
</span><span id="create_tcja_extension-377"><a href="#create_tcja_extension-377"><span class="linenos">377</span></a><span class="sd">        extend_ctc: Whether to extend CTC expansion</span>
</span><span id="create_tcja_extension-378"><a href="#create_tcja_extension-378"><span class="linenos">378</span></a><span class="sd">        extend_estate: Whether to extend estate tax exemption increase</span>
</span><span id="create_tcja_extension-379"><a href="#create_tcja_extension-379"><span class="linenos">379</span></a><span class="sd">        extend_amt: Whether to extend AMT relief</span>
</span><span id="create_tcja_extension-380"><a href="#create_tcja_extension-380"><span class="linenos">380</span></a><span class="sd">        start_year: Year extension takes effect (default 2026)</span>
</span><span id="create_tcja_extension-381"><a href="#create_tcja_extension-381"><span class="linenos">381</span></a><span class="sd">        duration_years: Duration of extension</span>
</span><span id="create_tcja_extension-382"><a href="#create_tcja_extension-382"><span class="linenos">382</span></a>
</span><span id="create_tcja_extension-383"><a href="#create_tcja_extension-383"><span class="linenos">383</span></a><span class="sd">    Returns:</span>
</span><span id="create_tcja_extension-384"><a href="#create_tcja_extension-384"><span class="linenos">384</span></a><span class="sd">        TCJAExtensionPolicy configured per parameters</span>
</span><span id="create_tcja_extension-385"><a href="#create_tcja_extension-385"><span class="linenos">385</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_tcja_extension-386"><a href="#create_tcja_extension-386"><span class="linenos">386</span></a>    <span class="k">if</span> <span class="n">extend_all</span><span class="p">:</span>
</span><span id="create_tcja_extension-387"><a href="#create_tcja_extension-387"><span class="linenos">387</span></a>        <span class="k">return</span> <span class="n">TCJAExtensionPolicy</span><span class="p">(</span>
</span><span id="create_tcja_extension-388"><a href="#create_tcja_extension-388"><span class="linenos">388</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;TCJA Full Extension&quot;</span><span class="p">,</span>
</span><span id="create_tcja_extension-389"><a href="#create_tcja_extension-389"><span class="linenos">389</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extend all TCJA individual provisions beyond 2025 sunset&quot;</span><span class="p">,</span>
</span><span id="create_tcja_extension-390"><a href="#create_tcja_extension-390"><span class="linenos">390</span></a>            <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">,</span>
</span><span id="create_tcja_extension-391"><a href="#create_tcja_extension-391"><span class="linenos">391</span></a>            <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_tcja_extension-392"><a href="#create_tcja_extension-392"><span class="linenos">392</span></a>            <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_tcja_extension-393"><a href="#create_tcja_extension-393"><span class="linenos">393</span></a>            <span class="n">extend_rate_cuts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-394"><a href="#create_tcja_extension-394"><span class="linenos">394</span></a>            <span class="n">extend_standard_deduction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-395"><a href="#create_tcja_extension-395"><span class="linenos">395</span></a>            <span class="n">keep_exemption_elimination</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-396"><a href="#create_tcja_extension-396"><span class="linenos">396</span></a>            <span class="n">keep_salt_cap</span><span class="o">=</span><span class="n">keep_salt_cap</span><span class="p">,</span>
</span><span id="create_tcja_extension-397"><a href="#create_tcja_extension-397"><span class="linenos">397</span></a>            <span class="n">extend_ctc_expansion</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-398"><a href="#create_tcja_extension-398"><span class="linenos">398</span></a>            <span class="n">extend_passthrough_deduction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-399"><a href="#create_tcja_extension-399"><span class="linenos">399</span></a>            <span class="n">extend_estate_exemption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-400"><a href="#create_tcja_extension-400"><span class="linenos">400</span></a>            <span class="n">extend_amt_relief</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_extension-401"><a href="#create_tcja_extension-401"><span class="linenos">401</span></a>        <span class="p">)</span>
</span><span id="create_tcja_extension-402"><a href="#create_tcja_extension-402"><span class="linenos">402</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="create_tcja_extension-403"><a href="#create_tcja_extension-403"><span class="linenos">403</span></a>        <span class="k">return</span> <span class="n">TCJAExtensionPolicy</span><span class="p">(</span>
</span><span id="create_tcja_extension-404"><a href="#create_tcja_extension-404"><span class="linenos">404</span></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;TCJA Partial Extension&quot;</span><span class="p">,</span>
</span><span id="create_tcja_extension-405"><a href="#create_tcja_extension-405"><span class="linenos">405</span></a>            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extend selected TCJA provisions&quot;</span><span class="p">,</span>
</span><span id="create_tcja_extension-406"><a href="#create_tcja_extension-406"><span class="linenos">406</span></a>            <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">,</span>
</span><span id="create_tcja_extension-407"><a href="#create_tcja_extension-407"><span class="linenos">407</span></a>            <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_tcja_extension-408"><a href="#create_tcja_extension-408"><span class="linenos">408</span></a>            <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_tcja_extension-409"><a href="#create_tcja_extension-409"><span class="linenos">409</span></a>            <span class="n">extend_rate_cuts</span><span class="o">=</span><span class="n">extend_rate_cuts</span><span class="p">,</span>
</span><span id="create_tcja_extension-410"><a href="#create_tcja_extension-410"><span class="linenos">410</span></a>            <span class="n">extend_standard_deduction</span><span class="o">=</span><span class="n">extend_standard_deduction</span><span class="p">,</span>
</span><span id="create_tcja_extension-411"><a href="#create_tcja_extension-411"><span class="linenos">411</span></a>            <span class="n">keep_exemption_elimination</span><span class="o">=</span><span class="n">keep_exemption_elimination</span><span class="p">,</span>
</span><span id="create_tcja_extension-412"><a href="#create_tcja_extension-412"><span class="linenos">412</span></a>            <span class="n">keep_salt_cap</span><span class="o">=</span><span class="n">keep_salt_cap</span><span class="p">,</span>
</span><span id="create_tcja_extension-413"><a href="#create_tcja_extension-413"><span class="linenos">413</span></a>            <span class="n">extend_ctc_expansion</span><span class="o">=</span><span class="n">extend_ctc</span><span class="p">,</span>
</span><span id="create_tcja_extension-414"><a href="#create_tcja_extension-414"><span class="linenos">414</span></a>            <span class="n">extend_passthrough_deduction</span><span class="o">=</span><span class="n">extend_passthrough</span><span class="p">,</span>
</span><span id="create_tcja_extension-415"><a href="#create_tcja_extension-415"><span class="linenos">415</span></a>            <span class="n">extend_estate_exemption</span><span class="o">=</span><span class="n">extend_estate</span><span class="p">,</span>
</span><span id="create_tcja_extension-416"><a href="#create_tcja_extension-416"><span class="linenos">416</span></a>            <span class="n">extend_amt_relief</span><span class="o">=</span><span class="n">extend_amt</span><span class="p">,</span>
</span><span id="create_tcja_extension-417"><a href="#create_tcja_extension-417"><span class="linenos">417</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a TCJA extension policy.</p>

<p>Args:
    extend_all: If True, extend all TCJA provisions (overrides individual flags)
    keep_salt_cap: If False, repeal SALT cap (COSTS more)
    extend_rate_cuts: Whether to extend rate bracket changes
    extend_standard_deduction: Whether to extend doubled standard deduction
    keep_exemption_elimination: Whether to maintain personal exemption elimination
    extend_passthrough: Whether to extend 199A deduction
    extend_ctc: Whether to extend CTC expansion
    extend_estate: Whether to extend estate tax exemption increase
    extend_amt: Whether to extend AMT relief
    start_year: Year extension takes effect (default 2026)
    duration_years: Duration of extension</p>

<p>Returns:
    TCJAExtensionPolicy configured per parameters</p>
</div>


                </section>
                <section id="create_tcja_repeal_salt_cap">
                            <input id="create_tcja_repeal_salt_cap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_tcja_repeal_salt_cap</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#TCJAExtensionPolicy">TCJAExtensionPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_tcja_repeal_salt_cap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_tcja_repeal_salt_cap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_tcja_repeal_salt_cap-420"><a href="#create_tcja_repeal_salt_cap-420"><span class="linenos">420</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_tcja_repeal_salt_cap</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">TCJAExtensionPolicy</span><span class="p">:</span>
</span><span id="create_tcja_repeal_salt_cap-421"><a href="#create_tcja_repeal_salt_cap-421"><span class="linenos">421</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_tcja_repeal_salt_cap-422"><a href="#create_tcja_repeal_salt_cap-422"><span class="linenos">422</span></a><span class="sd">    Create TCJA extension WITHOUT the SALT cap.</span>
</span><span id="create_tcja_repeal_salt_cap-423"><a href="#create_tcja_repeal_salt_cap-423"><span class="linenos">423</span></a>
</span><span id="create_tcja_repeal_salt_cap-424"><a href="#create_tcja_repeal_salt_cap-424"><span class="linenos">424</span></a><span class="sd">    Popular bipartisan proposal to extend TCJA but repeal the $10K SALT cap.</span>
</span><span id="create_tcja_repeal_salt_cap-425"><a href="#create_tcja_repeal_salt_cap-425"><span class="linenos">425</span></a><span class="sd">    This INCREASES the cost of extension by ~$1.1T over 10 years.</span>
</span><span id="create_tcja_repeal_salt_cap-426"><a href="#create_tcja_repeal_salt_cap-426"><span class="linenos">426</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_tcja_repeal_salt_cap-427"><a href="#create_tcja_repeal_salt_cap-427"><span class="linenos">427</span></a>    <span class="n">policy</span> <span class="o">=</span> <span class="n">create_tcja_extension</span><span class="p">(</span><span class="n">extend_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_salt_cap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="create_tcja_repeal_salt_cap-428"><a href="#create_tcja_repeal_salt_cap-428"><span class="linenos">428</span></a>    <span class="n">policy</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;TCJA Extension (No SALT Cap)&quot;</span>
</span><span id="create_tcja_repeal_salt_cap-429"><a href="#create_tcja_repeal_salt_cap-429"><span class="linenos">429</span></a>    <span class="n">policy</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Extend TCJA provisions but repeal $10K SALT cap&quot;</span>
</span><span id="create_tcja_repeal_salt_cap-430"><a href="#create_tcja_repeal_salt_cap-430"><span class="linenos">430</span></a>    <span class="k">return</span> <span class="n">policy</span>
</span></pre></div>


            <div class="docstring"><p>Create TCJA extension WITHOUT the SALT cap.</p>

<p>Popular bipartisan proposal to extend TCJA but repeal the $10K SALT cap.
This INCREASES the cost of extension by ~$1.1T over 10 years.</p>
</div>


                </section>
                <section id="estimate_tcja_extension_cost">
                            <input id="estimate_tcja_extension_cost-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_tcja_extension_cost</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">include_salt_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">include_passthrough</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">dynamic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="estimate_tcja_extension_cost-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#estimate_tcja_extension_cost"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="estimate_tcja_extension_cost-433"><a href="#estimate_tcja_extension_cost-433"><span class="linenos">433</span></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_tcja_extension_cost</span><span class="p">(</span>
</span><span id="estimate_tcja_extension_cost-434"><a href="#estimate_tcja_extension_cost-434"><span class="linenos">434</span></a>    <span class="n">include_salt_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-435"><a href="#estimate_tcja_extension_cost-435"><span class="linenos">435</span></a>    <span class="n">include_passthrough</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-436"><a href="#estimate_tcja_extension_cost-436"><span class="linenos">436</span></a>    <span class="n">dynamic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-437"><a href="#estimate_tcja_extension_cost-437"><span class="linenos">437</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="estimate_tcja_extension_cost-438"><a href="#estimate_tcja_extension_cost-438"><span class="linenos">438</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="estimate_tcja_extension_cost-439"><a href="#estimate_tcja_extension_cost-439"><span class="linenos">439</span></a><span class="sd">    Quick estimate of TCJA extension cost.</span>
</span><span id="estimate_tcja_extension_cost-440"><a href="#estimate_tcja_extension_cost-440"><span class="linenos">440</span></a>
</span><span id="estimate_tcja_extension_cost-441"><a href="#estimate_tcja_extension_cost-441"><span class="linenos">441</span></a><span class="sd">    Args:</span>
</span><span id="estimate_tcja_extension_cost-442"><a href="#estimate_tcja_extension_cost-442"><span class="linenos">442</span></a><span class="sd">        include_salt_cap: Keep SALT cap (reduces cost) or repeal (increases cost)</span>
</span><span id="estimate_tcja_extension_cost-443"><a href="#estimate_tcja_extension_cost-443"><span class="linenos">443</span></a><span class="sd">        include_passthrough: Include 199A pass-through deduction</span>
</span><span id="estimate_tcja_extension_cost-444"><a href="#estimate_tcja_extension_cost-444"><span class="linenos">444</span></a><span class="sd">        dynamic: Apply dynamic scoring offset (~10% reduction)</span>
</span><span id="estimate_tcja_extension_cost-445"><a href="#estimate_tcja_extension_cost-445"><span class="linenos">445</span></a>
</span><span id="estimate_tcja_extension_cost-446"><a href="#estimate_tcja_extension_cost-446"><span class="linenos">446</span></a><span class="sd">    Returns:</span>
</span><span id="estimate_tcja_extension_cost-447"><a href="#estimate_tcja_extension_cost-447"><span class="linenos">447</span></a><span class="sd">        Dict with 10-year cost and component breakdown</span>
</span><span id="estimate_tcja_extension_cost-448"><a href="#estimate_tcja_extension_cost-448"><span class="linenos">448</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="estimate_tcja_extension_cost-449"><a href="#estimate_tcja_extension_cost-449"><span class="linenos">449</span></a>    <span class="n">policy</span> <span class="o">=</span> <span class="n">TCJAExtensionPolicy</span><span class="p">(</span>
</span><span id="estimate_tcja_extension_cost-450"><a href="#estimate_tcja_extension_cost-450"><span class="linenos">450</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;TCJA Extension&quot;</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-451"><a href="#estimate_tcja_extension_cost-451"><span class="linenos">451</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;TCJA extension estimate&quot;</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-452"><a href="#estimate_tcja_extension_cost-452"><span class="linenos">452</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-453"><a href="#estimate_tcja_extension_cost-453"><span class="linenos">453</span></a>        <span class="n">keep_salt_cap</span><span class="o">=</span><span class="n">include_salt_cap</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-454"><a href="#estimate_tcja_extension_cost-454"><span class="linenos">454</span></a>        <span class="n">extend_passthrough_deduction</span><span class="o">=</span><span class="n">include_passthrough</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-455"><a href="#estimate_tcja_extension_cost-455"><span class="linenos">455</span></a>        <span class="n">dynamic_offset_pct</span><span class="o">=</span><span class="mf">0.10</span> <span class="k">if</span> <span class="n">dynamic</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-456"><a href="#estimate_tcja_extension_cost-456"><span class="linenos">456</span></a>    <span class="p">)</span>
</span><span id="estimate_tcja_extension_cost-457"><a href="#estimate_tcja_extension_cost-457"><span class="linenos">457</span></a>
</span><span id="estimate_tcja_extension_cost-458"><a href="#estimate_tcja_extension_cost-458"><span class="linenos">458</span></a>    <span class="n">total</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">_get_raw_10yr_cost</span><span class="p">()</span> <span class="o">*</span> <span class="n">policy</span><span class="o">.</span><span class="n">calibration_factor</span>
</span><span id="estimate_tcja_extension_cost-459"><a href="#estimate_tcja_extension_cost-459"><span class="linenos">459</span></a>    <span class="k">if</span> <span class="n">dynamic</span><span class="p">:</span>
</span><span id="estimate_tcja_extension_cost-460"><a href="#estimate_tcja_extension_cost-460"><span class="linenos">460</span></a>        <span class="n">total</span> <span class="o">*=</span> <span class="mf">0.90</span>  <span class="c1"># 10% dynamic offset</span>
</span><span id="estimate_tcja_extension_cost-461"><a href="#estimate_tcja_extension_cost-461"><span class="linenos">461</span></a>
</span><span id="estimate_tcja_extension_cost-462"><a href="#estimate_tcja_extension_cost-462"><span class="linenos">462</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="estimate_tcja_extension_cost-463"><a href="#estimate_tcja_extension_cost-463"><span class="linenos">463</span></a>        <span class="s2">&quot;ten_year_cost&quot;</span><span class="p">:</span> <span class="n">total</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-464"><a href="#estimate_tcja_extension_cost-464"><span class="linenos">464</span></a>        <span class="s2">&quot;annual_average&quot;</span><span class="p">:</span> <span class="n">total</span> <span class="o">/</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-465"><a href="#estimate_tcja_extension_cost-465"><span class="linenos">465</span></a>        <span class="s2">&quot;breakdown&quot;</span><span class="p">:</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_component_breakdown</span><span class="p">(),</span>
</span><span id="estimate_tcja_extension_cost-466"><a href="#estimate_tcja_extension_cost-466"><span class="linenos">466</span></a>        <span class="s2">&quot;includes_salt_cap&quot;</span><span class="p">:</span> <span class="n">include_salt_cap</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-467"><a href="#estimate_tcja_extension_cost-467"><span class="linenos">467</span></a>        <span class="s2">&quot;includes_passthrough&quot;</span><span class="p">:</span> <span class="n">include_passthrough</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-468"><a href="#estimate_tcja_extension_cost-468"><span class="linenos">468</span></a>        <span class="s2">&quot;is_dynamic&quot;</span><span class="p">:</span> <span class="n">dynamic</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-469"><a href="#estimate_tcja_extension_cost-469"><span class="linenos">469</span></a>        <span class="s2">&quot;cbo_target&quot;</span><span class="p">:</span> <span class="mf">4600.0</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-470"><a href="#estimate_tcja_extension_cost-470"><span class="linenos">470</span></a>        <span class="s2">&quot;vs_cbo_pct&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">total</span> <span class="o">-</span> <span class="mf">4600.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4600.0</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">include_salt_cap</span> <span class="ow">and</span> <span class="n">include_passthrough</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="estimate_tcja_extension_cost-471"><a href="#estimate_tcja_extension_cost-471"><span class="linenos">471</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Quick estimate of TCJA extension cost.</p>

<p>Args:
    include_salt_cap: Keep SALT cap (reduces cost) or repeal (increases cost)
    include_passthrough: Include 199A pass-through deduction
    dynamic: Apply dynamic scoring offset (~10% reduction)</p>

<p>Returns:
    Dict with 10-year cost and component breakdown</p>
</div>


                </section>
                <section id="get_tcja_component_summary">
                            <input id="get_tcja_component_summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_tcja_component_summary</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="get_tcja_component_summary-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_tcja_component_summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_tcja_component_summary-169"><a href="#get_tcja_component_summary-169"><span class="linenos">169</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_tcja_component_summary</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="get_tcja_component_summary-170"><a href="#get_tcja_component_summary-170"><span class="linenos">170</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_tcja_component_summary-171"><a href="#get_tcja_component_summary-171"><span class="linenos">171</span></a><span class="sd">    Get summary of all TCJA components.</span>
</span><span id="get_tcja_component_summary-172"><a href="#get_tcja_component_summary-172"><span class="linenos">172</span></a>
</span><span id="get_tcja_component_summary-173"><a href="#get_tcja_component_summary-173"><span class="linenos">173</span></a><span class="sd">    Returns dict with:</span>
</span><span id="get_tcja_component_summary-174"><a href="#get_tcja_component_summary-174"><span class="linenos">174</span></a><span class="sd">    - components: List of component details</span>
</span><span id="get_tcja_component_summary-175"><a href="#get_tcja_component_summary-175"><span class="linenos">175</span></a><span class="sd">    - gross_costs: Total costs before offsets</span>
</span><span id="get_tcja_component_summary-176"><a href="#get_tcja_component_summary-176"><span class="linenos">176</span></a><span class="sd">    - offsets: Revenue gains from SALT cap and exemption elimination</span>
</span><span id="get_tcja_component_summary-177"><a href="#get_tcja_component_summary-177"><span class="linenos">177</span></a><span class="sd">    - net_cost: Net 10-year cost</span>
</span><span id="get_tcja_component_summary-178"><a href="#get_tcja_component_summary-178"><span class="linenos">178</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_tcja_component_summary-179"><a href="#get_tcja_component_summary-179"><span class="linenos">179</span></a>    <span class="n">gross_costs</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">TCJA_COMPONENTS</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="get_tcja_component_summary-180"><a href="#get_tcja_component_summary-180"><span class="linenos">180</span></a>    <span class="n">offsets</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">TCJA_COMPONENTS</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="get_tcja_component_summary-181"><a href="#get_tcja_component_summary-181"><span class="linenos">181</span></a>    <span class="n">net_cost</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">TCJA_COMPONENTS</span><span class="p">)</span>
</span><span id="get_tcja_component_summary-182"><a href="#get_tcja_component_summary-182"><span class="linenos">182</span></a>
</span><span id="get_tcja_component_summary-183"><a href="#get_tcja_component_summary-183"><span class="linenos">183</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="get_tcja_component_summary-184"><a href="#get_tcja_component_summary-184"><span class="linenos">184</span></a>        <span class="s2">&quot;components&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="get_tcja_component_summary-185"><a href="#get_tcja_component_summary-185"><span class="linenos">185</span></a>            <span class="p">{</span>
</span><span id="get_tcja_component_summary-186"><a href="#get_tcja_component_summary-186"><span class="linenos">186</span></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-187"><a href="#get_tcja_component_summary-187"><span class="linenos">187</span></a>                <span class="s2">&quot;ten_year_cost&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">ten_year_cost_billions</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-188"><a href="#get_tcja_component_summary-188"><span class="linenos">188</span></a>                <span class="s2">&quot;annual_cost&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">annual_cost_billions</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-189"><a href="#get_tcja_component_summary-189"><span class="linenos">189</span></a>                <span class="s2">&quot;is_offset&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">ten_year_cost_billions</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-190"><a href="#get_tcja_component_summary-190"><span class="linenos">190</span></a>            <span class="p">}</span>
</span><span id="get_tcja_component_summary-191"><a href="#get_tcja_component_summary-191"><span class="linenos">191</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">TCJA_COMPONENTS</span>
</span><span id="get_tcja_component_summary-192"><a href="#get_tcja_component_summary-192"><span class="linenos">192</span></a>        <span class="p">],</span>
</span><span id="get_tcja_component_summary-193"><a href="#get_tcja_component_summary-193"><span class="linenos">193</span></a>        <span class="s2">&quot;gross_costs&quot;</span><span class="p">:</span> <span class="n">gross_costs</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-194"><a href="#get_tcja_component_summary-194"><span class="linenos">194</span></a>        <span class="s2">&quot;offsets&quot;</span><span class="p">:</span> <span class="n">offsets</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-195"><a href="#get_tcja_component_summary-195"><span class="linenos">195</span></a>        <span class="s2">&quot;net_cost&quot;</span><span class="p">:</span> <span class="n">net_cost</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-196"><a href="#get_tcja_component_summary-196"><span class="linenos">196</span></a>        <span class="s2">&quot;cbo_target&quot;</span><span class="p">:</span> <span class="mf">4600.0</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-197"><a href="#get_tcja_component_summary-197"><span class="linenos">197</span></a>        <span class="s2">&quot;calibration_factor&quot;</span><span class="p">:</span> <span class="mf">4600.0</span> <span class="o">/</span> <span class="n">net_cost</span> <span class="k">if</span> <span class="n">net_cost</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="get_tcja_component_summary-198"><a href="#get_tcja_component_summary-198"><span class="linenos">198</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get summary of all TCJA components.</p>

<p>Returns dict with:</p>

<ul>
<li>components: List of component details</li>
<li>gross_costs: Total costs before offsets</li>
<li>offsets: Revenue gains from SALT cap and exemption elimination</li>
<li>net_cost: Net 10-year cost</li>
</ul>
</div>


                </section>
                <section id="CorporateTaxPolicy">
                            <input id="CorporateTaxPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">CorporateTaxPolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="CorporateTaxPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CorporateTaxPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CorporateTaxPolicy-59"><a href="#CorporateTaxPolicy-59"><span class="linenos"> 59</span></a><span class="nd">@dataclass</span>
</span><span id="CorporateTaxPolicy-60"><a href="#CorporateTaxPolicy-60"><span class="linenos"> 60</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CorporateTaxPolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="CorporateTaxPolicy-61"><a href="#CorporateTaxPolicy-61"><span class="linenos"> 61</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-62"><a href="#CorporateTaxPolicy-62"><span class="linenos"> 62</span></a><span class="sd">    Corporate tax policy with detailed corporate-specific parameters.</span>
</span><span id="CorporateTaxPolicy-63"><a href="#CorporateTaxPolicy-63"><span class="linenos"> 63</span></a>
</span><span id="CorporateTaxPolicy-64"><a href="#CorporateTaxPolicy-64"><span class="linenos"> 64</span></a><span class="sd">    Supports:</span>
</span><span id="CorporateTaxPolicy-65"><a href="#CorporateTaxPolicy-65"><span class="linenos"> 65</span></a><span class="sd">    - Corporate rate changes</span>
</span><span id="CorporateTaxPolicy-66"><a href="#CorporateTaxPolicy-66"><span class="linenos"> 66</span></a><span class="sd">    - Pass-through business income effects</span>
</span><span id="CorporateTaxPolicy-67"><a href="#CorporateTaxPolicy-67"><span class="linenos"> 67</span></a><span class="sd">    - International provisions (GILTI/FDII)</span>
</span><span id="CorporateTaxPolicy-68"><a href="#CorporateTaxPolicy-68"><span class="linenos"> 68</span></a><span class="sd">    - R&amp;D and depreciation changes</span>
</span><span id="CorporateTaxPolicy-69"><a href="#CorporateTaxPolicy-69"><span class="linenos"> 69</span></a><span class="sd">    - Book minimum tax</span>
</span><span id="CorporateTaxPolicy-70"><a href="#CorporateTaxPolicy-70"><span class="linenos"> 70</span></a>
</span><span id="CorporateTaxPolicy-71"><a href="#CorporateTaxPolicy-71"><span class="linenos"> 71</span></a><span class="sd">    Behavioral response:</span>
</span><span id="CorporateTaxPolicy-72"><a href="#CorporateTaxPolicy-72"><span class="linenos"> 72</span></a><span class="sd">    - Corporate investment responds to after-tax returns</span>
</span><span id="CorporateTaxPolicy-73"><a href="#CorporateTaxPolicy-73"><span class="linenos"> 73</span></a><span class="sd">    - Elasticity of corporate tax revenue: ~0.3-0.5</span>
</span><span id="CorporateTaxPolicy-74"><a href="#CorporateTaxPolicy-74"><span class="linenos"> 74</span></a><span class="sd">    - Pass-through allocation responds to rate differentials</span>
</span><span id="CorporateTaxPolicy-75"><a href="#CorporateTaxPolicy-75"><span class="linenos"> 75</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-76"><a href="#CorporateTaxPolicy-76"><span class="linenos"> 76</span></a>
</span><span id="CorporateTaxPolicy-77"><a href="#CorporateTaxPolicy-77"><span class="linenos"> 77</span></a>    <span class="c1"># Rate change (additive, e.g., +0.07 for 21%28%)</span>
</span><span id="CorporateTaxPolicy-78"><a href="#CorporateTaxPolicy-78"><span class="linenos"> 78</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="CorporateTaxPolicy-79"><a href="#CorporateTaxPolicy-79"><span class="linenos"> 79</span></a>    <span class="n">baseline_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">CURRENT_CORPORATE_RATE</span>
</span><span id="CorporateTaxPolicy-80"><a href="#CorporateTaxPolicy-80"><span class="linenos"> 80</span></a>    <span class="n">new_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Alternative: specify new rate directly</span>
</span><span id="CorporateTaxPolicy-81"><a href="#CorporateTaxPolicy-81"><span class="linenos"> 81</span></a>
</span><span id="CorporateTaxPolicy-82"><a href="#CorporateTaxPolicy-82"><span class="linenos"> 82</span></a>    <span class="c1"># Behavioral response</span>
</span><span id="CorporateTaxPolicy-83"><a href="#CorporateTaxPolicy-83"><span class="linenos"> 83</span></a>    <span class="c1"># Corporate income elasticity is lower than individual ETI</span>
</span><span id="CorporateTaxPolicy-84"><a href="#CorporateTaxPolicy-84"><span class="linenos"> 84</span></a>    <span class="c1"># CBO/JCT use ~0.2-0.3 for corporate</span>
</span><span id="CorporateTaxPolicy-85"><a href="#CorporateTaxPolicy-85"><span class="linenos"> 85</span></a>    <span class="n">corporate_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>
</span><span id="CorporateTaxPolicy-86"><a href="#CorporateTaxPolicy-86"><span class="linenos"> 86</span></a>
</span><span id="CorporateTaxPolicy-87"><a href="#CorporateTaxPolicy-87"><span class="linenos"> 87</span></a>    <span class="c1"># Revenue base</span>
</span><span id="CorporateTaxPolicy-88"><a href="#CorporateTaxPolicy-88"><span class="linenos"> 88</span></a>    <span class="c1"># If not provided, uses default baseline</span>
</span><span id="CorporateTaxPolicy-89"><a href="#CorporateTaxPolicy-89"><span class="linenos"> 89</span></a>    <span class="n">baseline_revenue_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">BASELINE_CORPORATE_REVENUE_BILLIONS</span>
</span><span id="CorporateTaxPolicy-90"><a href="#CorporateTaxPolicy-90"><span class="linenos"> 90</span></a>    <span class="n">baseline_profits_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">BASELINE_TAXABLE_PROFITS_BILLIONS</span>
</span><span id="CorporateTaxPolicy-91"><a href="#CorporateTaxPolicy-91"><span class="linenos"> 91</span></a>
</span><span id="CorporateTaxPolicy-92"><a href="#CorporateTaxPolicy-92"><span class="linenos"> 92</span></a>    <span class="c1"># Pass-through income effects</span>
</span><span id="CorporateTaxPolicy-93"><a href="#CorporateTaxPolicy-93"><span class="linenos"> 93</span></a>    <span class="c1"># When corporate rate changes, some income shifts to/from pass-through</span>
</span><span id="CorporateTaxPolicy-94"><a href="#CorporateTaxPolicy-94"><span class="linenos"> 94</span></a>    <span class="n">include_passthrough_effects</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CorporateTaxPolicy-95"><a href="#CorporateTaxPolicy-95"><span class="linenos"> 95</span></a>    <span class="n">passthrough_shift_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>  <span class="c1"># Share of pass-through that shifts</span>
</span><span id="CorporateTaxPolicy-96"><a href="#CorporateTaxPolicy-96"><span class="linenos"> 96</span></a>
</span><span id="CorporateTaxPolicy-97"><a href="#CorporateTaxPolicy-97"><span class="linenos"> 97</span></a>    <span class="c1"># International provisions</span>
</span><span id="CorporateTaxPolicy-98"><a href="#CorporateTaxPolicy-98"><span class="linenos"> 98</span></a>    <span class="c1"># GILTI: Global Intangible Low-Taxed Income (anti-offshoring)</span>
</span><span id="CorporateTaxPolicy-99"><a href="#CorporateTaxPolicy-99"><span class="linenos"> 99</span></a>    <span class="c1"># FDII: Foreign-Derived Intangible Income (export incentive)</span>
</span><span id="CorporateTaxPolicy-100"><a href="#CorporateTaxPolicy-100"><span class="linenos">100</span></a>    <span class="n">gilti_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in GILTI rate (currently 10.5%)</span>
</span><span id="CorporateTaxPolicy-101"><a href="#CorporateTaxPolicy-101"><span class="linenos">101</span></a>    <span class="n">fdii_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in FDII rate (currently 13.125%)</span>
</span><span id="CorporateTaxPolicy-102"><a href="#CorporateTaxPolicy-102"><span class="linenos">102</span></a>    <span class="n">eliminate_fdii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Biden proposal to repeal FDII</span>
</span><span id="CorporateTaxPolicy-103"><a href="#CorporateTaxPolicy-103"><span class="linenos">103</span></a>
</span><span id="CorporateTaxPolicy-104"><a href="#CorporateTaxPolicy-104"><span class="linenos">104</span></a>    <span class="c1"># R&amp;D expensing</span>
</span><span id="CorporateTaxPolicy-105"><a href="#CorporateTaxPolicy-105"><span class="linenos">105</span></a>    <span class="c1"># TCJA requires R&amp;D amortization over 5 years starting 2022</span>
</span><span id="CorporateTaxPolicy-106"><a href="#CorporateTaxPolicy-106"><span class="linenos">106</span></a>    <span class="n">restore_rd_expensing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Bipartisan proposal to restore immediate expensing</span>
</span><span id="CorporateTaxPolicy-107"><a href="#CorporateTaxPolicy-107"><span class="linenos">107</span></a>
</span><span id="CorporateTaxPolicy-108"><a href="#CorporateTaxPolicy-108"><span class="linenos">108</span></a>    <span class="c1"># Bonus depreciation</span>
</span><span id="CorporateTaxPolicy-109"><a href="#CorporateTaxPolicy-109"><span class="linenos">109</span></a>    <span class="c1"># TCJA 100% bonus depreciation phasing down: 80% (2023), 60% (2024), 40% (2025), 20% (2026), 0% (2027)</span>
</span><span id="CorporateTaxPolicy-110"><a href="#CorporateTaxPolicy-110"><span class="linenos">110</span></a>    <span class="n">extend_bonus_depreciation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Extend 100% bonus depreciation</span>
</span><span id="CorporateTaxPolicy-111"><a href="#CorporateTaxPolicy-111"><span class="linenos">111</span></a>
</span><span id="CorporateTaxPolicy-112"><a href="#CorporateTaxPolicy-112"><span class="linenos">112</span></a>    <span class="c1"># Book minimum tax (IRA 2022)</span>
</span><span id="CorporateTaxPolicy-113"><a href="#CorporateTaxPolicy-113"><span class="linenos">113</span></a>    <span class="c1"># 15% minimum on adjusted financial statement income for &gt;$1B corps</span>
</span><span id="CorporateTaxPolicy-114"><a href="#CorporateTaxPolicy-114"><span class="linenos">114</span></a>    <span class="n">adjust_book_minimum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CorporateTaxPolicy-115"><a href="#CorporateTaxPolicy-115"><span class="linenos">115</span></a>    <span class="n">book_minimum_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in 15% rate</span>
</span><span id="CorporateTaxPolicy-116"><a href="#CorporateTaxPolicy-116"><span class="linenos">116</span></a>
</span><span id="CorporateTaxPolicy-117"><a href="#CorporateTaxPolicy-117"><span class="linenos">117</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CorporateTaxPolicy-118"><a href="#CorporateTaxPolicy-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set policy type to corporate.&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-119"><a href="#CorporateTaxPolicy-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">=</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span>
</span><span id="CorporateTaxPolicy-120"><a href="#CorporateTaxPolicy-120"><span class="linenos">120</span></a>
</span><span id="CorporateTaxPolicy-121"><a href="#CorporateTaxPolicy-121"><span class="linenos">121</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_reform_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-122"><a href="#CorporateTaxPolicy-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the reform corporate tax rate.&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-123"><a href="#CorporateTaxPolicy-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-124"><a href="#CorporateTaxPolicy-124"><span class="linenos">124</span></a>            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_rate</span><span class="p">)</span>
</span><span id="CorporateTaxPolicy-125"><a href="#CorporateTaxPolicy-125"><span class="linenos">125</span></a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span><span class="p">)</span>
</span><span id="CorporateTaxPolicy-126"><a href="#CorporateTaxPolicy-126"><span class="linenos">126</span></a>
</span><span id="CorporateTaxPolicy-127"><a href="#CorporateTaxPolicy-127"><span class="linenos">127</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy-128"><a href="#CorporateTaxPolicy-128"><span class="linenos">128</span></a>                                       <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-129"><a href="#CorporateTaxPolicy-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-130"><a href="#CorporateTaxPolicy-130"><span class="linenos">130</span></a><span class="sd">        Estimate static revenue effect from corporate rate change.</span>
</span><span id="CorporateTaxPolicy-131"><a href="#CorporateTaxPolicy-131"><span class="linenos">131</span></a>
</span><span id="CorporateTaxPolicy-132"><a href="#CorporateTaxPolicy-132"><span class="linenos">132</span></a><span class="sd">        For corporate tax, the static formula is simpler:</span>
</span><span id="CorporateTaxPolicy-133"><a href="#CorporateTaxPolicy-133"><span class="linenos">133</span></a><span class="sd">            Revenue = Rate  Taxable_Profits</span>
</span><span id="CorporateTaxPolicy-134"><a href="#CorporateTaxPolicy-134"><span class="linenos">134</span></a>
</span><span id="CorporateTaxPolicy-135"><a href="#CorporateTaxPolicy-135"><span class="linenos">135</span></a><span class="sd">        This gives the mechanical revenue change before behavioral responses.</span>
</span><span id="CorporateTaxPolicy-136"><a href="#CorporateTaxPolicy-136"><span class="linenos">136</span></a>
</span><span id="CorporateTaxPolicy-137"><a href="#CorporateTaxPolicy-137"><span class="linenos">137</span></a><span class="sd">        Args:</span>
</span><span id="CorporateTaxPolicy-138"><a href="#CorporateTaxPolicy-138"><span class="linenos">138</span></a><span class="sd">            baseline_revenue: Baseline corporate revenue (can use or override)</span>
</span><span id="CorporateTaxPolicy-139"><a href="#CorporateTaxPolicy-139"><span class="linenos">139</span></a><span class="sd">            use_real_data: Whether to use empirical baseline data</span>
</span><span id="CorporateTaxPolicy-140"><a href="#CorporateTaxPolicy-140"><span class="linenos">140</span></a>
</span><span id="CorporateTaxPolicy-141"><a href="#CorporateTaxPolicy-141"><span class="linenos">141</span></a><span class="sd">        Returns:</span>
</span><span id="CorporateTaxPolicy-142"><a href="#CorporateTaxPolicy-142"><span class="linenos">142</span></a><span class="sd">            Static revenue change in billions (positive = revenue gain)</span>
</span><span id="CorporateTaxPolicy-143"><a href="#CorporateTaxPolicy-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-144"><a href="#CorporateTaxPolicy-144"><span class="linenos">144</span></a>        <span class="c1"># Use stored profits base or estimate from revenue</span>
</span><span id="CorporateTaxPolicy-145"><a href="#CorporateTaxPolicy-145"><span class="linenos">145</span></a>        <span class="n">profits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_profits_billions</span>
</span><span id="CorporateTaxPolicy-146"><a href="#CorporateTaxPolicy-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="n">profits</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-147"><a href="#CorporateTaxPolicy-147"><span class="linenos">147</span></a>            <span class="c1"># Estimate from baseline revenue and current rate</span>
</span><span id="CorporateTaxPolicy-148"><a href="#CorporateTaxPolicy-148"><span class="linenos">148</span></a>            <span class="n">profits</span> <span class="o">=</span> <span class="n">baseline_revenue</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="CorporateTaxPolicy-149"><a href="#CorporateTaxPolicy-149"><span class="linenos">149</span></a>
</span><span id="CorporateTaxPolicy-150"><a href="#CorporateTaxPolicy-150"><span class="linenos">150</span></a>        <span class="c1"># Core rate change effect</span>
</span><span id="CorporateTaxPolicy-151"><a href="#CorporateTaxPolicy-151"><span class="linenos">151</span></a>        <span class="n">rate_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_reform_rate</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span>
</span><span id="CorporateTaxPolicy-152"><a href="#CorporateTaxPolicy-152"><span class="linenos">152</span></a>        <span class="n">static_effect</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">*</span> <span class="n">profits</span>
</span><span id="CorporateTaxPolicy-153"><a href="#CorporateTaxPolicy-153"><span class="linenos">153</span></a>
</span><span id="CorporateTaxPolicy-154"><a href="#CorporateTaxPolicy-154"><span class="linenos">154</span></a>        <span class="c1"># Add international provision effects</span>
</span><span id="CorporateTaxPolicy-155"><a href="#CorporateTaxPolicy-155"><span class="linenos">155</span></a>        <span class="n">static_effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_international_effects</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-156"><a href="#CorporateTaxPolicy-156"><span class="linenos">156</span></a>
</span><span id="CorporateTaxPolicy-157"><a href="#CorporateTaxPolicy-157"><span class="linenos">157</span></a>        <span class="c1"># Add R&amp;D expensing effect</span>
</span><span id="CorporateTaxPolicy-158"><a href="#CorporateTaxPolicy-158"><span class="linenos">158</span></a>        <span class="n">static_effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_rd_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-159"><a href="#CorporateTaxPolicy-159"><span class="linenos">159</span></a>
</span><span id="CorporateTaxPolicy-160"><a href="#CorporateTaxPolicy-160"><span class="linenos">160</span></a>        <span class="c1"># Add bonus depreciation effect</span>
</span><span id="CorporateTaxPolicy-161"><a href="#CorporateTaxPolicy-161"><span class="linenos">161</span></a>        <span class="n">static_effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_bonus_depreciation_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-162"><a href="#CorporateTaxPolicy-162"><span class="linenos">162</span></a>
</span><span id="CorporateTaxPolicy-163"><a href="#CorporateTaxPolicy-163"><span class="linenos">163</span></a>        <span class="c1"># Add book minimum effect</span>
</span><span id="CorporateTaxPolicy-164"><a href="#CorporateTaxPolicy-164"><span class="linenos">164</span></a>        <span class="n">static_effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_book_minimum_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-165"><a href="#CorporateTaxPolicy-165"><span class="linenos">165</span></a>
</span><span id="CorporateTaxPolicy-166"><a href="#CorporateTaxPolicy-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="n">static_effect</span>
</span><span id="CorporateTaxPolicy-167"><a href="#CorporateTaxPolicy-167"><span class="linenos">167</span></a>
</span><span id="CorporateTaxPolicy-168"><a href="#CorporateTaxPolicy-168"><span class="linenos">168</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_estimate_international_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-169"><a href="#CorporateTaxPolicy-169"><span class="linenos">169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Estimate revenue from GILTI/FDII changes.&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-170"><a href="#CorporateTaxPolicy-170"><span class="linenos">170</span></a>        <span class="n">effect</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="CorporateTaxPolicy-171"><a href="#CorporateTaxPolicy-171"><span class="linenos">171</span></a>
</span><span id="CorporateTaxPolicy-172"><a href="#CorporateTaxPolicy-172"><span class="linenos">172</span></a>        <span class="c1"># GILTI rate change (higher rate = more revenue)</span>
</span><span id="CorporateTaxPolicy-173"><a href="#CorporateTaxPolicy-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gilti_rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-174"><a href="#CorporateTaxPolicy-174"><span class="linenos">174</span></a>            <span class="c1"># GILTI base ~$250B, taxed at 10.5%</span>
</span><span id="CorporateTaxPolicy-175"><a href="#CorporateTaxPolicy-175"><span class="linenos">175</span></a>            <span class="n">gilti_base</span> <span class="o">=</span> <span class="mf">250.0</span>
</span><span id="CorporateTaxPolicy-176"><a href="#CorporateTaxPolicy-176"><span class="linenos">176</span></a>            <span class="n">effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gilti_rate_change</span> <span class="o">*</span> <span class="n">gilti_base</span>
</span><span id="CorporateTaxPolicy-177"><a href="#CorporateTaxPolicy-177"><span class="linenos">177</span></a>
</span><span id="CorporateTaxPolicy-178"><a href="#CorporateTaxPolicy-178"><span class="linenos">178</span></a>        <span class="c1"># FDII repeal (eliminating deduction = revenue gain)</span>
</span><span id="CorporateTaxPolicy-179"><a href="#CorporateTaxPolicy-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminate_fdii</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-180"><a href="#CorporateTaxPolicy-180"><span class="linenos">180</span></a>            <span class="c1"># FDII costs ~$20B/year in revenue</span>
</span><span id="CorporateTaxPolicy-181"><a href="#CorporateTaxPolicy-181"><span class="linenos">181</span></a>            <span class="n">effect</span> <span class="o">+=</span> <span class="n">FDII_COST_BILLIONS</span>
</span><span id="CorporateTaxPolicy-182"><a href="#CorporateTaxPolicy-182"><span class="linenos">182</span></a>
</span><span id="CorporateTaxPolicy-183"><a href="#CorporateTaxPolicy-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="n">effect</span>
</span><span id="CorporateTaxPolicy-184"><a href="#CorporateTaxPolicy-184"><span class="linenos">184</span></a>
</span><span id="CorporateTaxPolicy-185"><a href="#CorporateTaxPolicy-185"><span class="linenos">185</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_estimate_rd_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-186"><a href="#CorporateTaxPolicy-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Estimate revenue from R&amp;D expensing changes.&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-187"><a href="#CorporateTaxPolicy-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">restore_rd_expensing</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-188"><a href="#CorporateTaxPolicy-188"><span class="linenos">188</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="CorporateTaxPolicy-189"><a href="#CorporateTaxPolicy-189"><span class="linenos">189</span></a>
</span><span id="CorporateTaxPolicy-190"><a href="#CorporateTaxPolicy-190"><span class="linenos">190</span></a>        <span class="c1"># Restoring R&amp;D expensing costs ~$10-15B/year</span>
</span><span id="CorporateTaxPolicy-191"><a href="#CorporateTaxPolicy-191"><span class="linenos">191</span></a>        <span class="c1"># This is a timing difference that grows over time</span>
</span><span id="CorporateTaxPolicy-192"><a href="#CorporateTaxPolicy-192"><span class="linenos">192</span></a>        <span class="k">return</span> <span class="o">-</span><span class="mf">12.0</span>  <span class="c1"># Costs $12B/year on average</span>
</span><span id="CorporateTaxPolicy-193"><a href="#CorporateTaxPolicy-193"><span class="linenos">193</span></a>
</span><span id="CorporateTaxPolicy-194"><a href="#CorporateTaxPolicy-194"><span class="linenos">194</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_estimate_bonus_depreciation_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-195"><a href="#CorporateTaxPolicy-195"><span class="linenos">195</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Estimate revenue from bonus depreciation changes.&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-196"><a href="#CorporateTaxPolicy-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_bonus_depreciation</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-197"><a href="#CorporateTaxPolicy-197"><span class="linenos">197</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="CorporateTaxPolicy-198"><a href="#CorporateTaxPolicy-198"><span class="linenos">198</span></a>
</span><span id="CorporateTaxPolicy-199"><a href="#CorporateTaxPolicy-199"><span class="linenos">199</span></a>        <span class="c1"># Extending 100% bonus depreciation costs ~$25-30B/year</span>
</span><span id="CorporateTaxPolicy-200"><a href="#CorporateTaxPolicy-200"><span class="linenos">200</span></a>        <span class="c1"># Phaseout schedule: current law raises revenue as bonus % drops</span>
</span><span id="CorporateTaxPolicy-201"><a href="#CorporateTaxPolicy-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="o">-</span><span class="mf">28.0</span>  <span class="c1"># Costs $28B/year on average to extend</span>
</span><span id="CorporateTaxPolicy-202"><a href="#CorporateTaxPolicy-202"><span class="linenos">202</span></a>
</span><span id="CorporateTaxPolicy-203"><a href="#CorporateTaxPolicy-203"><span class="linenos">203</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_estimate_book_minimum_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-204"><a href="#CorporateTaxPolicy-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Estimate revenue from book minimum tax changes.&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-205"><a href="#CorporateTaxPolicy-205"><span class="linenos">205</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjust_book_minimum</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">book_minimum_rate_change</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-206"><a href="#CorporateTaxPolicy-206"><span class="linenos">206</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="CorporateTaxPolicy-207"><a href="#CorporateTaxPolicy-207"><span class="linenos">207</span></a>
</span><span id="CorporateTaxPolicy-208"><a href="#CorporateTaxPolicy-208"><span class="linenos">208</span></a>        <span class="c1"># Book minimum affects ~150 corporations with &gt;$1B AFSI</span>
</span><span id="CorporateTaxPolicy-209"><a href="#CorporateTaxPolicy-209"><span class="linenos">209</span></a>        <span class="c1"># Base: ~$100B in AFSI subject to minimum</span>
</span><span id="CorporateTaxPolicy-210"><a href="#CorporateTaxPolicy-210"><span class="linenos">210</span></a>        <span class="n">book_minimum_base</span> <span class="o">=</span> <span class="mf">100.0</span>
</span><span id="CorporateTaxPolicy-211"><a href="#CorporateTaxPolicy-211"><span class="linenos">211</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">book_minimum_rate_change</span> <span class="o">*</span> <span class="n">book_minimum_base</span>
</span><span id="CorporateTaxPolicy-212"><a href="#CorporateTaxPolicy-212"><span class="linenos">212</span></a>
</span><span id="CorporateTaxPolicy-213"><a href="#CorporateTaxPolicy-213"><span class="linenos">213</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-214"><a href="#CorporateTaxPolicy-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-215"><a href="#CorporateTaxPolicy-215"><span class="linenos">215</span></a><span class="sd">        Estimate behavioral response to corporate tax change.</span>
</span><span id="CorporateTaxPolicy-216"><a href="#CorporateTaxPolicy-216"><span class="linenos">216</span></a>
</span><span id="CorporateTaxPolicy-217"><a href="#CorporateTaxPolicy-217"><span class="linenos">217</span></a><span class="sd">        Corporate behavioral responses include:</span>
</span><span id="CorporateTaxPolicy-218"><a href="#CorporateTaxPolicy-218"><span class="linenos">218</span></a><span class="sd">        1. Investment reduction (lowers profits and future revenue)</span>
</span><span id="CorporateTaxPolicy-219"><a href="#CorporateTaxPolicy-219"><span class="linenos">219</span></a><span class="sd">        2. Profit shifting (international tax planning)</span>
</span><span id="CorporateTaxPolicy-220"><a href="#CorporateTaxPolicy-220"><span class="linenos">220</span></a><span class="sd">        3. Pass-through conversion (shift to/from S-corp/partnership form)</span>
</span><span id="CorporateTaxPolicy-221"><a href="#CorporateTaxPolicy-221"><span class="linenos">221</span></a>
</span><span id="CorporateTaxPolicy-222"><a href="#CorporateTaxPolicy-222"><span class="linenos">222</span></a><span class="sd">        The offset is smaller than individual ETI because:</span>
</span><span id="CorporateTaxPolicy-223"><a href="#CorporateTaxPolicy-223"><span class="linenos">223</span></a><span class="sd">        - Corporate profits are less elastic than taxable income</span>
</span><span id="CorporateTaxPolicy-224"><a href="#CorporateTaxPolicy-224"><span class="linenos">224</span></a><span class="sd">        - Less ability to shift timing (vs individual cap gains)</span>
</span><span id="CorporateTaxPolicy-225"><a href="#CorporateTaxPolicy-225"><span class="linenos">225</span></a>
</span><span id="CorporateTaxPolicy-226"><a href="#CorporateTaxPolicy-226"><span class="linenos">226</span></a><span class="sd">        Returns:</span>
</span><span id="CorporateTaxPolicy-227"><a href="#CorporateTaxPolicy-227"><span class="linenos">227</span></a><span class="sd">            Behavioral offset in billions (positive = revenue lost)</span>
</span><span id="CorporateTaxPolicy-228"><a href="#CorporateTaxPolicy-228"><span class="linenos">228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-229"><a href="#CorporateTaxPolicy-229"><span class="linenos">229</span></a>        <span class="c1"># Base behavioral offset</span>
</span><span id="CorporateTaxPolicy-230"><a href="#CorporateTaxPolicy-230"><span class="linenos">230</span></a>        <span class="n">base_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">corporate_elasticity</span> <span class="o">*</span> <span class="mf">0.5</span>
</span><span id="CorporateTaxPolicy-231"><a href="#CorporateTaxPolicy-231"><span class="linenos">231</span></a>
</span><span id="CorporateTaxPolicy-232"><a href="#CorporateTaxPolicy-232"><span class="linenos">232</span></a>        <span class="c1"># Pass-through shift effect</span>
</span><span id="CorporateTaxPolicy-233"><a href="#CorporateTaxPolicy-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_passthrough_effects</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-234"><a href="#CorporateTaxPolicy-234"><span class="linenos">234</span></a>            <span class="c1"># When corporate rate rises, some businesses convert to pass-through</span>
</span><span id="CorporateTaxPolicy-235"><a href="#CorporateTaxPolicy-235"><span class="linenos">235</span></a>            <span class="c1"># When corporate rate falls, some pass-through converts to C-corp</span>
</span><span id="CorporateTaxPolicy-236"><a href="#CorporateTaxPolicy-236"><span class="linenos">236</span></a>            <span class="n">passthrough_shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_passthrough_shift</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-237"><a href="#CorporateTaxPolicy-237"><span class="linenos">237</span></a>            <span class="n">base_offset</span> <span class="o">+=</span> <span class="n">passthrough_shift</span>
</span><span id="CorporateTaxPolicy-238"><a href="#CorporateTaxPolicy-238"><span class="linenos">238</span></a>
</span><span id="CorporateTaxPolicy-239"><a href="#CorporateTaxPolicy-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="n">base_offset</span>
</span><span id="CorporateTaxPolicy-240"><a href="#CorporateTaxPolicy-240"><span class="linenos">240</span></a>
</span><span id="CorporateTaxPolicy-241"><a href="#CorporateTaxPolicy-241"><span class="linenos">241</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_estimate_passthrough_shift</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-242"><a href="#CorporateTaxPolicy-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-243"><a href="#CorporateTaxPolicy-243"><span class="linenos">243</span></a><span class="sd">        Estimate revenue effect from pass-through/C-corp shifting.</span>
</span><span id="CorporateTaxPolicy-244"><a href="#CorporateTaxPolicy-244"><span class="linenos">244</span></a>
</span><span id="CorporateTaxPolicy-245"><a href="#CorporateTaxPolicy-245"><span class="linenos">245</span></a><span class="sd">        When corporate rate rises relative to individual rates:</span>
</span><span id="CorporateTaxPolicy-246"><a href="#CorporateTaxPolicy-246"><span class="linenos">246</span></a><span class="sd">        - Some C-corps convert to S-corps/partnerships</span>
</span><span id="CorporateTaxPolicy-247"><a href="#CorporateTaxPolicy-247"><span class="linenos">247</span></a><span class="sd">        - Revenue shifts from corporate to individual tax</span>
</span><span id="CorporateTaxPolicy-248"><a href="#CorporateTaxPolicy-248"><span class="linenos">248</span></a>
</span><span id="CorporateTaxPolicy-249"><a href="#CorporateTaxPolicy-249"><span class="linenos">249</span></a><span class="sd">        When corporate rate falls:</span>
</span><span id="CorporateTaxPolicy-250"><a href="#CorporateTaxPolicy-250"><span class="linenos">250</span></a><span class="sd">        - Some pass-throughs convert to C-corps</span>
</span><span id="CorporateTaxPolicy-251"><a href="#CorporateTaxPolicy-251"><span class="linenos">251</span></a><span class="sd">        - Revenue shifts from individual to corporate</span>
</span><span id="CorporateTaxPolicy-252"><a href="#CorporateTaxPolicy-252"><span class="linenos">252</span></a>
</span><span id="CorporateTaxPolicy-253"><a href="#CorporateTaxPolicy-253"><span class="linenos">253</span></a><span class="sd">        The NET revenue effect depends on rate differential.</span>
</span><span id="CorporateTaxPolicy-254"><a href="#CorporateTaxPolicy-254"><span class="linenos">254</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-255"><a href="#CorporateTaxPolicy-255"><span class="linenos">255</span></a>        <span class="c1"># Current individual top rate: 37% (or 29.6% with 199A deduction)</span>
</span><span id="CorporateTaxPolicy-256"><a href="#CorporateTaxPolicy-256"><span class="linenos">256</span></a>        <span class="n">individual_effective_rate</span> <span class="o">=</span> <span class="mf">0.296</span>  <span class="c1"># With 199A deduction</span>
</span><span id="CorporateTaxPolicy-257"><a href="#CorporateTaxPolicy-257"><span class="linenos">257</span></a>        <span class="n">new_corporate_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_reform_rate</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-258"><a href="#CorporateTaxPolicy-258"><span class="linenos">258</span></a>
</span><span id="CorporateTaxPolicy-259"><a href="#CorporateTaxPolicy-259"><span class="linenos">259</span></a>        <span class="c1"># Rate differential drives shifting</span>
</span><span id="CorporateTaxPolicy-260"><a href="#CorporateTaxPolicy-260"><span class="linenos">260</span></a>        <span class="n">rate_differential</span> <span class="o">=</span> <span class="n">new_corporate_rate</span> <span class="o">-</span> <span class="n">individual_effective_rate</span>
</span><span id="CorporateTaxPolicy-261"><a href="#CorporateTaxPolicy-261"><span class="linenos">261</span></a>
</span><span id="CorporateTaxPolicy-262"><a href="#CorporateTaxPolicy-262"><span class="linenos">262</span></a>        <span class="c1"># If corporate rate exceeds individual, income shifts OUT of C-corps</span>
</span><span id="CorporateTaxPolicy-263"><a href="#CorporateTaxPolicy-263"><span class="linenos">263</span></a>        <span class="c1"># Passthrough income is ~$1.4T; assume 5-10% is marginal</span>
</span><span id="CorporateTaxPolicy-264"><a href="#CorporateTaxPolicy-264"><span class="linenos">264</span></a>        <span class="n">marginal_passthrough</span> <span class="o">=</span> <span class="n">BASELINE_PASSTHROUGH_INCOME_BILLIONS</span> <span class="o">*</span> <span class="mf">0.07</span>
</span><span id="CorporateTaxPolicy-265"><a href="#CorporateTaxPolicy-265"><span class="linenos">265</span></a>
</span><span id="CorporateTaxPolicy-266"><a href="#CorporateTaxPolicy-266"><span class="linenos">266</span></a>        <span class="c1"># Shift reduces corporate revenue (lost to individual side)</span>
</span><span id="CorporateTaxPolicy-267"><a href="#CorporateTaxPolicy-267"><span class="linenos">267</span></a>        <span class="c1"># But we only count the NET effect (some is recaptured at individual rates)</span>
</span><span id="CorporateTaxPolicy-268"><a href="#CorporateTaxPolicy-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="n">rate_differential</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-269"><a href="#CorporateTaxPolicy-269"><span class="linenos">269</span></a>            <span class="c1"># Corporate rate &gt; individual: income shifts to pass-through</span>
</span><span id="CorporateTaxPolicy-270"><a href="#CorporateTaxPolicy-270"><span class="linenos">270</span></a>            <span class="n">shift_amount</span> <span class="o">=</span> <span class="n">marginal_passthrough</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">passthrough_shift_elasticity</span>
</span><span id="CorporateTaxPolicy-271"><a href="#CorporateTaxPolicy-271"><span class="linenos">271</span></a>            <span class="c1"># Net revenue loss: lose corporate tax, but gain some at individual rate</span>
</span><span id="CorporateTaxPolicy-272"><a href="#CorporateTaxPolicy-272"><span class="linenos">272</span></a>            <span class="n">net_loss</span> <span class="o">=</span> <span class="n">shift_amount</span> <span class="o">*</span> <span class="p">(</span><span class="n">new_corporate_rate</span> <span class="o">-</span> <span class="n">individual_effective_rate</span><span class="p">)</span>
</span><span id="CorporateTaxPolicy-273"><a href="#CorporateTaxPolicy-273"><span class="linenos">273</span></a>            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">net_loss</span><span class="p">)</span>  <span class="c1"># Return as positive offset (revenue lost)</span>
</span><span id="CorporateTaxPolicy-274"><a href="#CorporateTaxPolicy-274"><span class="linenos">274</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-275"><a href="#CorporateTaxPolicy-275"><span class="linenos">275</span></a>            <span class="c1"># Corporate rate &lt; individual: income shifts TO C-corp</span>
</span><span id="CorporateTaxPolicy-276"><a href="#CorporateTaxPolicy-276"><span class="linenos">276</span></a>            <span class="c1"># This is a revenue GAIN (offset reduces the loss)</span>
</span><span id="CorporateTaxPolicy-277"><a href="#CorporateTaxPolicy-277"><span class="linenos">277</span></a>            <span class="k">return</span> <span class="mf">0.0</span>  <span class="c1"># Captured in base elasticity</span>
</span><span id="CorporateTaxPolicy-278"><a href="#CorporateTaxPolicy-278"><span class="linenos">278</span></a>
</span><span id="CorporateTaxPolicy-279"><a href="#CorporateTaxPolicy-279"><span class="linenos">279</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_component_breakdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy-280"><a href="#CorporateTaxPolicy-280"><span class="linenos">280</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-281"><a href="#CorporateTaxPolicy-281"><span class="linenos">281</span></a><span class="sd">        Get detailed breakdown of corporate tax effects.</span>
</span><span id="CorporateTaxPolicy-282"><a href="#CorporateTaxPolicy-282"><span class="linenos">282</span></a>
</span><span id="CorporateTaxPolicy-283"><a href="#CorporateTaxPolicy-283"><span class="linenos">283</span></a><span class="sd">        Returns dict with:</span>
</span><span id="CorporateTaxPolicy-284"><a href="#CorporateTaxPolicy-284"><span class="linenos">284</span></a><span class="sd">        - rate_change_effect: From core rate change</span>
</span><span id="CorporateTaxPolicy-285"><a href="#CorporateTaxPolicy-285"><span class="linenos">285</span></a><span class="sd">        - international_effect: From GILTI/FDII changes</span>
</span><span id="CorporateTaxPolicy-286"><a href="#CorporateTaxPolicy-286"><span class="linenos">286</span></a><span class="sd">        - rd_effect: From R&amp;D expensing</span>
</span><span id="CorporateTaxPolicy-287"><a href="#CorporateTaxPolicy-287"><span class="linenos">287</span></a><span class="sd">        - depreciation_effect: From bonus depreciation</span>
</span><span id="CorporateTaxPolicy-288"><a href="#CorporateTaxPolicy-288"><span class="linenos">288</span></a><span class="sd">        - book_minimum_effect: From 15% minimum tax</span>
</span><span id="CorporateTaxPolicy-289"><a href="#CorporateTaxPolicy-289"><span class="linenos">289</span></a><span class="sd">        - behavioral_offset: From behavioral responses</span>
</span><span id="CorporateTaxPolicy-290"><a href="#CorporateTaxPolicy-290"><span class="linenos">290</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy-291"><a href="#CorporateTaxPolicy-291"><span class="linenos">291</span></a>        <span class="n">profits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_profits_billions</span>
</span><span id="CorporateTaxPolicy-292"><a href="#CorporateTaxPolicy-292"><span class="linenos">292</span></a>        <span class="n">rate_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_reform_rate</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span>
</span><span id="CorporateTaxPolicy-293"><a href="#CorporateTaxPolicy-293"><span class="linenos">293</span></a>
</span><span id="CorporateTaxPolicy-294"><a href="#CorporateTaxPolicy-294"><span class="linenos">294</span></a>        <span class="n">rate_effect</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">*</span> <span class="n">profits</span>
</span><span id="CorporateTaxPolicy-295"><a href="#CorporateTaxPolicy-295"><span class="linenos">295</span></a>        <span class="n">intl_effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_international_effects</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-296"><a href="#CorporateTaxPolicy-296"><span class="linenos">296</span></a>        <span class="n">rd_effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_rd_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-297"><a href="#CorporateTaxPolicy-297"><span class="linenos">297</span></a>        <span class="n">depreciation_effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_bonus_depreciation_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-298"><a href="#CorporateTaxPolicy-298"><span class="linenos">298</span></a>        <span class="n">book_min_effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_book_minimum_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy-299"><a href="#CorporateTaxPolicy-299"><span class="linenos">299</span></a>
</span><span id="CorporateTaxPolicy-300"><a href="#CorporateTaxPolicy-300"><span class="linenos">300</span></a>        <span class="n">static_total</span> <span class="o">=</span> <span class="n">rate_effect</span> <span class="o">+</span> <span class="n">intl_effect</span> <span class="o">+</span> <span class="n">rd_effect</span> <span class="o">+</span> <span class="n">depreciation_effect</span> <span class="o">+</span> <span class="n">book_min_effect</span>
</span><span id="CorporateTaxPolicy-301"><a href="#CorporateTaxPolicy-301"><span class="linenos">301</span></a>        <span class="n">behavioral</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">static_total</span><span class="p">)</span>
</span><span id="CorporateTaxPolicy-302"><a href="#CorporateTaxPolicy-302"><span class="linenos">302</span></a>
</span><span id="CorporateTaxPolicy-303"><a href="#CorporateTaxPolicy-303"><span class="linenos">303</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="CorporateTaxPolicy-304"><a href="#CorporateTaxPolicy-304"><span class="linenos">304</span></a>            <span class="s2">&quot;rate_change_effect&quot;</span><span class="p">:</span> <span class="n">rate_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy-305"><a href="#CorporateTaxPolicy-305"><span class="linenos">305</span></a>            <span class="s2">&quot;international_effect&quot;</span><span class="p">:</span> <span class="n">intl_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy-306"><a href="#CorporateTaxPolicy-306"><span class="linenos">306</span></a>            <span class="s2">&quot;rd_effect&quot;</span><span class="p">:</span> <span class="n">rd_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy-307"><a href="#CorporateTaxPolicy-307"><span class="linenos">307</span></a>            <span class="s2">&quot;depreciation_effect&quot;</span><span class="p">:</span> <span class="n">depreciation_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy-308"><a href="#CorporateTaxPolicy-308"><span class="linenos">308</span></a>            <span class="s2">&quot;book_minimum_effect&quot;</span><span class="p">:</span> <span class="n">book_min_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy-309"><a href="#CorporateTaxPolicy-309"><span class="linenos">309</span></a>            <span class="s2">&quot;static_total&quot;</span><span class="p">:</span> <span class="n">static_total</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy-310"><a href="#CorporateTaxPolicy-310"><span class="linenos">310</span></a>            <span class="s2">&quot;behavioral_offset&quot;</span><span class="p">:</span> <span class="n">behavioral</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy-311"><a href="#CorporateTaxPolicy-311"><span class="linenos">311</span></a>            <span class="s2">&quot;net_effect&quot;</span><span class="p">:</span> <span class="n">static_total</span> <span class="o">-</span> <span class="n">behavioral</span><span class="p">,</span>  <span class="c1"># Behavioral offset reduces revenue</span>
</span><span id="CorporateTaxPolicy-312"><a href="#CorporateTaxPolicy-312"><span class="linenos">312</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Corporate tax policy with detailed corporate-specific parameters.</p>

<p>Supports:</p>

<ul>
<li>Corporate rate changes</li>
<li>Pass-through business income effects</li>
<li>International provisions (GILTI/FDII)</li>
<li>R&amp;D and depreciation changes</li>
<li>Book minimum tax</li>
</ul>

<p>Behavioral response:</p>

<ul>
<li>Corporate investment responds to after-tax returns</li>
<li>Elasticity of corporate tax revenue: ~0.3-0.5</li>
<li>Pass-through allocation responds to rate differentials</li>
</ul>
</div>


                            <div id="CorporateTaxPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">CorporateTaxPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">baseline_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.21</span>,</span><span class="param">	<span class="n">corporate_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">baseline_revenue_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">475.0</span>,</span><span class="param">	<span class="n">baseline_profits_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1900.0</span>,</span><span class="param">	<span class="n">include_passthrough_effects</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">passthrough_shift_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>,</span><span class="param">	<span class="n">gilti_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">fdii_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">eliminate_fdii</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">restore_rd_expensing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">extend_bonus_depreciation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">adjust_book_minimum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">book_minimum_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.__init__"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.rate_change"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.baseline_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.21</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.baseline_rate"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.new_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">new_rate</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.new_rate"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.corporate_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">corporate_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.25</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.corporate_elasticity"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.baseline_revenue_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_revenue_billions</span><span class="annotation">: float</span>        =
<span class="default_value">475.0</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.baseline_revenue_billions"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.baseline_profits_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_profits_billions</span><span class="annotation">: float</span>        =
<span class="default_value">1900.0</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.baseline_profits_billions"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.include_passthrough_effects" class="classattr">
                                <div class="attr variable">
            <span class="name">include_passthrough_effects</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.include_passthrough_effects"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.passthrough_shift_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">passthrough_shift_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.15</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.passthrough_shift_elasticity"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.gilti_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">gilti_rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.gilti_rate_change"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.fdii_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">fdii_rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.fdii_rate_change"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.eliminate_fdii" class="classattr">
                                <div class="attr variable">
            <span class="name">eliminate_fdii</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.eliminate_fdii"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.restore_rd_expensing" class="classattr">
                                <div class="attr variable">
            <span class="name">restore_rd_expensing</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.restore_rd_expensing"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.extend_bonus_depreciation" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_bonus_depreciation</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.extend_bonus_depreciation"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.adjust_book_minimum" class="classattr">
                                <div class="attr variable">
            <span class="name">adjust_book_minimum</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.adjust_book_minimum"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.book_minimum_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">book_minimum_rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.book_minimum_rate_change"></a>
    
    

                            </div>
                            <div id="CorporateTaxPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="CorporateTaxPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="CorporateTaxPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-127"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-127"><span class="linenos">127</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-128"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-128"><span class="linenos">128</span></a>                                       <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-129"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-130"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-130"><span class="linenos">130</span></a><span class="sd">        Estimate static revenue effect from corporate rate change.</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-131"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-131"><span class="linenos">131</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-132"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-132"><span class="linenos">132</span></a><span class="sd">        For corporate tax, the static formula is simpler:</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-133"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-133"><span class="linenos">133</span></a><span class="sd">            Revenue = Rate  Taxable_Profits</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-134"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-134"><span class="linenos">134</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-135"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-135"><span class="linenos">135</span></a><span class="sd">        This gives the mechanical revenue change before behavioral responses.</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-136"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-136"><span class="linenos">136</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-137"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-137"><span class="linenos">137</span></a><span class="sd">        Args:</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-138"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-138"><span class="linenos">138</span></a><span class="sd">            baseline_revenue: Baseline corporate revenue (can use or override)</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-139"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-139"><span class="linenos">139</span></a><span class="sd">            use_real_data: Whether to use empirical baseline data</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-140"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-140"><span class="linenos">140</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-141"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-141"><span class="linenos">141</span></a><span class="sd">        Returns:</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-142"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-142"><span class="linenos">142</span></a><span class="sd">            Static revenue change in billions (positive = revenue gain)</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-143"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-144"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-144"><span class="linenos">144</span></a>        <span class="c1"># Use stored profits base or estimate from revenue</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-145"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-145"><span class="linenos">145</span></a>        <span class="n">profits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_profits_billions</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-146"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="n">profits</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-147"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-147"><span class="linenos">147</span></a>            <span class="c1"># Estimate from baseline revenue and current rate</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-148"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-148"><span class="linenos">148</span></a>            <span class="n">profits</span> <span class="o">=</span> <span class="n">baseline_revenue</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-149"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-149"><span class="linenos">149</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-150"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-150"><span class="linenos">150</span></a>        <span class="c1"># Core rate change effect</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-151"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-151"><span class="linenos">151</span></a>        <span class="n">rate_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_reform_rate</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-152"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-152"><span class="linenos">152</span></a>        <span class="n">static_effect</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">*</span> <span class="n">profits</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-153"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-153"><span class="linenos">153</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-154"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-154"><span class="linenos">154</span></a>        <span class="c1"># Add international provision effects</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-155"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-155"><span class="linenos">155</span></a>        <span class="n">static_effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_international_effects</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-156"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-156"><span class="linenos">156</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-157"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-157"><span class="linenos">157</span></a>        <span class="c1"># Add R&amp;D expensing effect</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-158"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-158"><span class="linenos">158</span></a>        <span class="n">static_effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_rd_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-159"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-159"><span class="linenos">159</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-160"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-160"><span class="linenos">160</span></a>        <span class="c1"># Add bonus depreciation effect</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-161"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-161"><span class="linenos">161</span></a>        <span class="n">static_effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_bonus_depreciation_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-162"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-162"><span class="linenos">162</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-163"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-163"><span class="linenos">163</span></a>        <span class="c1"># Add book minimum effect</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-164"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-164"><span class="linenos">164</span></a>        <span class="n">static_effect</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_book_minimum_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-165"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-165"><span class="linenos">165</span></a>
</span><span id="CorporateTaxPolicy.estimate_static_revenue_effect-166"><a href="#CorporateTaxPolicy.estimate_static_revenue_effect-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="n">static_effect</span>
</span></pre></div>


            <div class="docstring"><p>Estimate static revenue effect from corporate rate change.</p>

<p>For corporate tax, the static formula is simpler:
    Revenue = Rate  Taxable_Profits</p>

<p>This gives the mechanical revenue change before behavioral responses.</p>

<p>Args:
    baseline_revenue: Baseline corporate revenue (can use or override)
    use_real_data: Whether to use empirical baseline data</p>

<p>Returns:
    Static revenue change in billions (positive = revenue gain)</p>
</div>


                            </div>
                            <div id="CorporateTaxPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="CorporateTaxPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="CorporateTaxPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CorporateTaxPolicy.estimate_behavioral_offset-213"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-213"><span class="linenos">213</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-214"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-215"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-215"><span class="linenos">215</span></a><span class="sd">        Estimate behavioral response to corporate tax change.</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-216"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-216"><span class="linenos">216</span></a>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-217"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-217"><span class="linenos">217</span></a><span class="sd">        Corporate behavioral responses include:</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-218"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-218"><span class="linenos">218</span></a><span class="sd">        1. Investment reduction (lowers profits and future revenue)</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-219"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-219"><span class="linenos">219</span></a><span class="sd">        2. Profit shifting (international tax planning)</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-220"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-220"><span class="linenos">220</span></a><span class="sd">        3. Pass-through conversion (shift to/from S-corp/partnership form)</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-221"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-221"><span class="linenos">221</span></a>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-222"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-222"><span class="linenos">222</span></a><span class="sd">        The offset is smaller than individual ETI because:</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-223"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-223"><span class="linenos">223</span></a><span class="sd">        - Corporate profits are less elastic than taxable income</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-224"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-224"><span class="linenos">224</span></a><span class="sd">        - Less ability to shift timing (vs individual cap gains)</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-225"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-225"><span class="linenos">225</span></a>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-226"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-226"><span class="linenos">226</span></a><span class="sd">        Returns:</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-227"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-227"><span class="linenos">227</span></a><span class="sd">            Behavioral offset in billions (positive = revenue lost)</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-228"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-228"><span class="linenos">228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-229"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-229"><span class="linenos">229</span></a>        <span class="c1"># Base behavioral offset</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-230"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-230"><span class="linenos">230</span></a>        <span class="n">base_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">corporate_elasticity</span> <span class="o">*</span> <span class="mf">0.5</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-231"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-231"><span class="linenos">231</span></a>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-232"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-232"><span class="linenos">232</span></a>        <span class="c1"># Pass-through shift effect</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-233"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_passthrough_effects</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-234"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-234"><span class="linenos">234</span></a>            <span class="c1"># When corporate rate rises, some businesses convert to pass-through</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-235"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-235"><span class="linenos">235</span></a>            <span class="c1"># When corporate rate falls, some pass-through converts to C-corp</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-236"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-236"><span class="linenos">236</span></a>            <span class="n">passthrough_shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_passthrough_shift</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-237"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-237"><span class="linenos">237</span></a>            <span class="n">base_offset</span> <span class="o">+=</span> <span class="n">passthrough_shift</span>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-238"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-238"><span class="linenos">238</span></a>
</span><span id="CorporateTaxPolicy.estimate_behavioral_offset-239"><a href="#CorporateTaxPolicy.estimate_behavioral_offset-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="n">base_offset</span>
</span></pre></div>


            <div class="docstring"><p>Estimate behavioral response to corporate tax change.</p>

<p>Corporate behavioral responses include:</p>

<ol>
<li>Investment reduction (lowers profits and future revenue)</li>
<li>Profit shifting (international tax planning)</li>
<li>Pass-through conversion (shift to/from S-corp/partnership form)</li>
</ol>

<p>The offset is smaller than individual ETI because:</p>

<ul>
<li>Corporate profits are less elastic than taxable income</li>
<li>Less ability to shift timing (vs individual cap gains)</li>
</ul>

<p>Returns:
    Behavioral offset in billions (positive = revenue lost)</p>
</div>


                            </div>
                            <div id="CorporateTaxPolicy.get_component_breakdown" class="classattr">
                                        <input id="CorporateTaxPolicy.get_component_breakdown-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_component_breakdown</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="CorporateTaxPolicy.get_component_breakdown-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CorporateTaxPolicy.get_component_breakdown"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CorporateTaxPolicy.get_component_breakdown-279"><a href="#CorporateTaxPolicy.get_component_breakdown-279"><span class="linenos">279</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_component_breakdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-280"><a href="#CorporateTaxPolicy.get_component_breakdown-280"><span class="linenos">280</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-281"><a href="#CorporateTaxPolicy.get_component_breakdown-281"><span class="linenos">281</span></a><span class="sd">        Get detailed breakdown of corporate tax effects.</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-282"><a href="#CorporateTaxPolicy.get_component_breakdown-282"><span class="linenos">282</span></a>
</span><span id="CorporateTaxPolicy.get_component_breakdown-283"><a href="#CorporateTaxPolicy.get_component_breakdown-283"><span class="linenos">283</span></a><span class="sd">        Returns dict with:</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-284"><a href="#CorporateTaxPolicy.get_component_breakdown-284"><span class="linenos">284</span></a><span class="sd">        - rate_change_effect: From core rate change</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-285"><a href="#CorporateTaxPolicy.get_component_breakdown-285"><span class="linenos">285</span></a><span class="sd">        - international_effect: From GILTI/FDII changes</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-286"><a href="#CorporateTaxPolicy.get_component_breakdown-286"><span class="linenos">286</span></a><span class="sd">        - rd_effect: From R&amp;D expensing</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-287"><a href="#CorporateTaxPolicy.get_component_breakdown-287"><span class="linenos">287</span></a><span class="sd">        - depreciation_effect: From bonus depreciation</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-288"><a href="#CorporateTaxPolicy.get_component_breakdown-288"><span class="linenos">288</span></a><span class="sd">        - book_minimum_effect: From 15% minimum tax</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-289"><a href="#CorporateTaxPolicy.get_component_breakdown-289"><span class="linenos">289</span></a><span class="sd">        - behavioral_offset: From behavioral responses</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-290"><a href="#CorporateTaxPolicy.get_component_breakdown-290"><span class="linenos">290</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-291"><a href="#CorporateTaxPolicy.get_component_breakdown-291"><span class="linenos">291</span></a>        <span class="n">profits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_profits_billions</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-292"><a href="#CorporateTaxPolicy.get_component_breakdown-292"><span class="linenos">292</span></a>        <span class="n">rate_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_reform_rate</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_rate</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-293"><a href="#CorporateTaxPolicy.get_component_breakdown-293"><span class="linenos">293</span></a>
</span><span id="CorporateTaxPolicy.get_component_breakdown-294"><a href="#CorporateTaxPolicy.get_component_breakdown-294"><span class="linenos">294</span></a>        <span class="n">rate_effect</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">*</span> <span class="n">profits</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-295"><a href="#CorporateTaxPolicy.get_component_breakdown-295"><span class="linenos">295</span></a>        <span class="n">intl_effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_international_effects</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-296"><a href="#CorporateTaxPolicy.get_component_breakdown-296"><span class="linenos">296</span></a>        <span class="n">rd_effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_rd_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-297"><a href="#CorporateTaxPolicy.get_component_breakdown-297"><span class="linenos">297</span></a>        <span class="n">depreciation_effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_bonus_depreciation_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-298"><a href="#CorporateTaxPolicy.get_component_breakdown-298"><span class="linenos">298</span></a>        <span class="n">book_min_effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_book_minimum_effect</span><span class="p">()</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-299"><a href="#CorporateTaxPolicy.get_component_breakdown-299"><span class="linenos">299</span></a>
</span><span id="CorporateTaxPolicy.get_component_breakdown-300"><a href="#CorporateTaxPolicy.get_component_breakdown-300"><span class="linenos">300</span></a>        <span class="n">static_total</span> <span class="o">=</span> <span class="n">rate_effect</span> <span class="o">+</span> <span class="n">intl_effect</span> <span class="o">+</span> <span class="n">rd_effect</span> <span class="o">+</span> <span class="n">depreciation_effect</span> <span class="o">+</span> <span class="n">book_min_effect</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-301"><a href="#CorporateTaxPolicy.get_component_breakdown-301"><span class="linenos">301</span></a>        <span class="n">behavioral</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">static_total</span><span class="p">)</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-302"><a href="#CorporateTaxPolicy.get_component_breakdown-302"><span class="linenos">302</span></a>
</span><span id="CorporateTaxPolicy.get_component_breakdown-303"><a href="#CorporateTaxPolicy.get_component_breakdown-303"><span class="linenos">303</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-304"><a href="#CorporateTaxPolicy.get_component_breakdown-304"><span class="linenos">304</span></a>            <span class="s2">&quot;rate_change_effect&quot;</span><span class="p">:</span> <span class="n">rate_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-305"><a href="#CorporateTaxPolicy.get_component_breakdown-305"><span class="linenos">305</span></a>            <span class="s2">&quot;international_effect&quot;</span><span class="p">:</span> <span class="n">intl_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-306"><a href="#CorporateTaxPolicy.get_component_breakdown-306"><span class="linenos">306</span></a>            <span class="s2">&quot;rd_effect&quot;</span><span class="p">:</span> <span class="n">rd_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-307"><a href="#CorporateTaxPolicy.get_component_breakdown-307"><span class="linenos">307</span></a>            <span class="s2">&quot;depreciation_effect&quot;</span><span class="p">:</span> <span class="n">depreciation_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-308"><a href="#CorporateTaxPolicy.get_component_breakdown-308"><span class="linenos">308</span></a>            <span class="s2">&quot;book_minimum_effect&quot;</span><span class="p">:</span> <span class="n">book_min_effect</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-309"><a href="#CorporateTaxPolicy.get_component_breakdown-309"><span class="linenos">309</span></a>            <span class="s2">&quot;static_total&quot;</span><span class="p">:</span> <span class="n">static_total</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-310"><a href="#CorporateTaxPolicy.get_component_breakdown-310"><span class="linenos">310</span></a>            <span class="s2">&quot;behavioral_offset&quot;</span><span class="p">:</span> <span class="n">behavioral</span><span class="p">,</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-311"><a href="#CorporateTaxPolicy.get_component_breakdown-311"><span class="linenos">311</span></a>            <span class="s2">&quot;net_effect&quot;</span><span class="p">:</span> <span class="n">static_total</span> <span class="o">-</span> <span class="n">behavioral</span><span class="p">,</span>  <span class="c1"># Behavioral offset reduces revenue</span>
</span><span id="CorporateTaxPolicy.get_component_breakdown-312"><a href="#CorporateTaxPolicy.get_component_breakdown-312"><span class="linenos">312</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get detailed breakdown of corporate tax effects.</p>

<p>Returns dict with:</p>

<ul>
<li>rate_change_effect: From core rate change</li>
<li>international_effect: From GILTI/FDII changes</li>
<li>rd_effect: From R&amp;D expensing</li>
<li>depreciation_effect: From bonus depreciation</li>
<li>book_minimum_effect: From 15% minimum tax</li>
<li>behavioral_offset: From behavioral responses</li>
</ul>
</div>


                            </div>
                </section>
                <section id="create_corporate_rate_change">
                            <input id="create_corporate_rate_change-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_corporate_rate_change</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Corporate Rate Change&#39;</span>,</span><span class="param">	<span class="n">include_behavioral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">include_passthrough</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#CorporateTaxPolicy">CorporateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_corporate_rate_change-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_corporate_rate_change"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_corporate_rate_change-315"><a href="#create_corporate_rate_change-315"><span class="linenos">315</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_corporate_rate_change</span><span class="p">(</span>
</span><span id="create_corporate_rate_change-316"><a href="#create_corporate_rate_change-316"><span class="linenos">316</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-317"><a href="#create_corporate_rate_change-317"><span class="linenos">317</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Corporate Rate Change&quot;</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-318"><a href="#create_corporate_rate_change-318"><span class="linenos">318</span></a>    <span class="n">include_behavioral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-319"><a href="#create_corporate_rate_change-319"><span class="linenos">319</span></a>    <span class="n">include_passthrough</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-320"><a href="#create_corporate_rate_change-320"><span class="linenos">320</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-321"><a href="#create_corporate_rate_change-321"><span class="linenos">321</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-322"><a href="#create_corporate_rate_change-322"><span class="linenos">322</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CorporateTaxPolicy</span><span class="p">:</span>
</span><span id="create_corporate_rate_change-323"><a href="#create_corporate_rate_change-323"><span class="linenos">323</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_corporate_rate_change-324"><a href="#create_corporate_rate_change-324"><span class="linenos">324</span></a><span class="sd">    Create a simple corporate rate change policy.</span>
</span><span id="create_corporate_rate_change-325"><a href="#create_corporate_rate_change-325"><span class="linenos">325</span></a>
</span><span id="create_corporate_rate_change-326"><a href="#create_corporate_rate_change-326"><span class="linenos">326</span></a><span class="sd">    Args:</span>
</span><span id="create_corporate_rate_change-327"><a href="#create_corporate_rate_change-327"><span class="linenos">327</span></a><span class="sd">        rate_change: Change in corporate rate (e.g., +0.07 for 21%28%)</span>
</span><span id="create_corporate_rate_change-328"><a href="#create_corporate_rate_change-328"><span class="linenos">328</span></a><span class="sd">        name: Policy name</span>
</span><span id="create_corporate_rate_change-329"><a href="#create_corporate_rate_change-329"><span class="linenos">329</span></a><span class="sd">        include_behavioral: Include behavioral response</span>
</span><span id="create_corporate_rate_change-330"><a href="#create_corporate_rate_change-330"><span class="linenos">330</span></a><span class="sd">        include_passthrough: Include pass-through shifting</span>
</span><span id="create_corporate_rate_change-331"><a href="#create_corporate_rate_change-331"><span class="linenos">331</span></a><span class="sd">        start_year: Year policy takes effect</span>
</span><span id="create_corporate_rate_change-332"><a href="#create_corporate_rate_change-332"><span class="linenos">332</span></a><span class="sd">        duration_years: Duration of policy</span>
</span><span id="create_corporate_rate_change-333"><a href="#create_corporate_rate_change-333"><span class="linenos">333</span></a>
</span><span id="create_corporate_rate_change-334"><a href="#create_corporate_rate_change-334"><span class="linenos">334</span></a><span class="sd">    Returns:</span>
</span><span id="create_corporate_rate_change-335"><a href="#create_corporate_rate_change-335"><span class="linenos">335</span></a><span class="sd">        CorporateTaxPolicy configured for rate change</span>
</span><span id="create_corporate_rate_change-336"><a href="#create_corporate_rate_change-336"><span class="linenos">336</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_corporate_rate_change-337"><a href="#create_corporate_rate_change-337"><span class="linenos">337</span></a>    <span class="n">new_rate</span> <span class="o">=</span> <span class="n">CURRENT_CORPORATE_RATE</span> <span class="o">+</span> <span class="n">rate_change</span>
</span><span id="create_corporate_rate_change-338"><a href="#create_corporate_rate_change-338"><span class="linenos">338</span></a>    <span class="k">return</span> <span class="n">CorporateTaxPolicy</span><span class="p">(</span>
</span><span id="create_corporate_rate_change-339"><a href="#create_corporate_rate_change-339"><span class="linenos">339</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-340"><a href="#create_corporate_rate_change-340"><span class="linenos">340</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Change corporate rate from </span><span class="si">{</span><span class="n">CURRENT_CORPORATE_RATE</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% to </span><span class="si">{</span><span class="n">new_rate</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-341"><a href="#create_corporate_rate_change-341"><span class="linenos">341</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-342"><a href="#create_corporate_rate_change-342"><span class="linenos">342</span></a>        <span class="n">rate_change</span><span class="o">=</span><span class="n">rate_change</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-343"><a href="#create_corporate_rate_change-343"><span class="linenos">343</span></a>        <span class="n">baseline_rate</span><span class="o">=</span><span class="n">CURRENT_CORPORATE_RATE</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-344"><a href="#create_corporate_rate_change-344"><span class="linenos">344</span></a>        <span class="n">corporate_elasticity</span><span class="o">=</span><span class="mf">0.25</span> <span class="k">if</span> <span class="n">include_behavioral</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-345"><a href="#create_corporate_rate_change-345"><span class="linenos">345</span></a>        <span class="n">include_passthrough_effects</span><span class="o">=</span><span class="n">include_passthrough</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-346"><a href="#create_corporate_rate_change-346"><span class="linenos">346</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-347"><a href="#create_corporate_rate_change-347"><span class="linenos">347</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_corporate_rate_change-348"><a href="#create_corporate_rate_change-348"><span class="linenos">348</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a simple corporate rate change policy.</p>

<p>Args:
    rate_change: Change in corporate rate (e.g., +0.07 for 21%28%)
    name: Policy name
    include_behavioral: Include behavioral response
    include_passthrough: Include pass-through shifting
    start_year: Year policy takes effect
    duration_years: Duration of policy</p>

<p>Returns:
    CorporateTaxPolicy configured for rate change</p>
</div>


                </section>
                <section id="create_biden_corporate_rate_only">
                            <input id="create_biden_corporate_rate_only-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_biden_corporate_rate_only</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#CorporateTaxPolicy">CorporateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_biden_corporate_rate_only-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_biden_corporate_rate_only"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_biden_corporate_rate_only-351"><a href="#create_biden_corporate_rate_only-351"><span class="linenos">351</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_biden_corporate_rate_only</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">CorporateTaxPolicy</span><span class="p">:</span>
</span><span id="create_biden_corporate_rate_only-352"><a href="#create_biden_corporate_rate_only-352"><span class="linenos">352</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_biden_corporate_rate_only-353"><a href="#create_biden_corporate_rate_only-353"><span class="linenos">353</span></a><span class="sd">    Create Biden&#39;s corporate rate increase (21%28%) without international changes.</span>
</span><span id="create_biden_corporate_rate_only-354"><a href="#create_biden_corporate_rate_only-354"><span class="linenos">354</span></a>
</span><span id="create_biden_corporate_rate_only-355"><a href="#create_biden_corporate_rate_only-355"><span class="linenos">355</span></a><span class="sd">    This matches the CBO/Treasury estimate of ~$1.35T over 10 years for just</span>
</span><span id="create_biden_corporate_rate_only-356"><a href="#create_biden_corporate_rate_only-356"><span class="linenos">356</span></a><span class="sd">    the rate increase component.</span>
</span><span id="create_biden_corporate_rate_only-357"><a href="#create_biden_corporate_rate_only-357"><span class="linenos">357</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_biden_corporate_rate_only-358"><a href="#create_biden_corporate_rate_only-358"><span class="linenos">358</span></a>    <span class="k">return</span> <span class="n">CorporateTaxPolicy</span><span class="p">(</span>
</span><span id="create_biden_corporate_rate_only-359"><a href="#create_biden_corporate_rate_only-359"><span class="linenos">359</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Biden Corporate Rate to 28%&quot;</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-360"><a href="#create_biden_corporate_rate_only-360"><span class="linenos">360</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Biden proposal: raise corporate rate from 21% to 28%&quot;</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-361"><a href="#create_biden_corporate_rate_only-361"><span class="linenos">361</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-362"><a href="#create_biden_corporate_rate_only-362"><span class="linenos">362</span></a>        <span class="n">rate_change</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span>  <span class="c1"># 21%  28%</span>
</span><span id="create_biden_corporate_rate_only-363"><a href="#create_biden_corporate_rate_only-363"><span class="linenos">363</span></a>        <span class="n">baseline_rate</span><span class="o">=</span><span class="n">CURRENT_CORPORATE_RATE</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-364"><a href="#create_biden_corporate_rate_only-364"><span class="linenos">364</span></a>        <span class="n">corporate_elasticity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-365"><a href="#create_biden_corporate_rate_only-365"><span class="linenos">365</span></a>        <span class="n">include_passthrough_effects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-366"><a href="#create_biden_corporate_rate_only-366"><span class="linenos">366</span></a>        <span class="c1"># No international changes - just rate</span>
</span><span id="create_biden_corporate_rate_only-367"><a href="#create_biden_corporate_rate_only-367"><span class="linenos">367</span></a>        <span class="n">gilti_rate_change</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-368"><a href="#create_biden_corporate_rate_only-368"><span class="linenos">368</span></a>        <span class="n">eliminate_fdii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-369"><a href="#create_biden_corporate_rate_only-369"><span class="linenos">369</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2025</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-370"><a href="#create_biden_corporate_rate_only-370"><span class="linenos">370</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_biden_corporate_rate_only-371"><a href="#create_biden_corporate_rate_only-371"><span class="linenos">371</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create Biden's corporate rate increase (21%28%) without international changes.</p>

<p>This matches the CBO/Treasury estimate of ~$1.35T over 10 years for just
the rate increase component.</p>
</div>


                </section>
                <section id="create_biden_corporate_proposal">
                            <input id="create_biden_corporate_proposal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_biden_corporate_proposal</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#CorporateTaxPolicy">CorporateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_biden_corporate_proposal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_biden_corporate_proposal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_biden_corporate_proposal-374"><a href="#create_biden_corporate_proposal-374"><span class="linenos">374</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_biden_corporate_proposal</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">CorporateTaxPolicy</span><span class="p">:</span>
</span><span id="create_biden_corporate_proposal-375"><a href="#create_biden_corporate_proposal-375"><span class="linenos">375</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_biden_corporate_proposal-376"><a href="#create_biden_corporate_proposal-376"><span class="linenos">376</span></a><span class="sd">    Create Biden&#39;s full FY2025 corporate tax proposal.</span>
</span><span id="create_biden_corporate_proposal-377"><a href="#create_biden_corporate_proposal-377"><span class="linenos">377</span></a>
</span><span id="create_biden_corporate_proposal-378"><a href="#create_biden_corporate_proposal-378"><span class="linenos">378</span></a><span class="sd">    Key components:</span>
</span><span id="create_biden_corporate_proposal-379"><a href="#create_biden_corporate_proposal-379"><span class="linenos">379</span></a><span class="sd">    - Raise corporate rate from 21% to 28% (~$1.35T)</span>
</span><span id="create_biden_corporate_proposal-380"><a href="#create_biden_corporate_proposal-380"><span class="linenos">380</span></a><span class="sd">    - Increase GILTI rate from 10.5% to 21% (~$300B)</span>
</span><span id="create_biden_corporate_proposal-381"><a href="#create_biden_corporate_proposal-381"><span class="linenos">381</span></a><span class="sd">    - Eliminate FDII deduction (~$200B)</span>
</span><span id="create_biden_corporate_proposal-382"><a href="#create_biden_corporate_proposal-382"><span class="linenos">382</span></a><span class="sd">    - Other international changes</span>
</span><span id="create_biden_corporate_proposal-383"><a href="#create_biden_corporate_proposal-383"><span class="linenos">383</span></a>
</span><span id="create_biden_corporate_proposal-384"><a href="#create_biden_corporate_proposal-384"><span class="linenos">384</span></a><span class="sd">    Full package estimate: ~$1.8-2.0T over 10 years</span>
</span><span id="create_biden_corporate_proposal-385"><a href="#create_biden_corporate_proposal-385"><span class="linenos">385</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_biden_corporate_proposal-386"><a href="#create_biden_corporate_proposal-386"><span class="linenos">386</span></a>    <span class="k">return</span> <span class="n">CorporateTaxPolicy</span><span class="p">(</span>
</span><span id="create_biden_corporate_proposal-387"><a href="#create_biden_corporate_proposal-387"><span class="linenos">387</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Biden Corporate Package (FY2025)&quot;</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-388"><a href="#create_biden_corporate_proposal-388"><span class="linenos">388</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Biden FY2025 corporate proposals: 28</span><span class="si">% r</span><span class="s2">ate + GILTI increase + FDII repeal&quot;</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-389"><a href="#create_biden_corporate_proposal-389"><span class="linenos">389</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-390"><a href="#create_biden_corporate_proposal-390"><span class="linenos">390</span></a>        <span class="n">rate_change</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span>  <span class="c1"># 21%  28%</span>
</span><span id="create_biden_corporate_proposal-391"><a href="#create_biden_corporate_proposal-391"><span class="linenos">391</span></a>        <span class="n">baseline_rate</span><span class="o">=</span><span class="n">CURRENT_CORPORATE_RATE</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-392"><a href="#create_biden_corporate_proposal-392"><span class="linenos">392</span></a>        <span class="n">corporate_elasticity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-393"><a href="#create_biden_corporate_proposal-393"><span class="linenos">393</span></a>        <span class="n">include_passthrough_effects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-394"><a href="#create_biden_corporate_proposal-394"><span class="linenos">394</span></a>        <span class="c1"># International provisions</span>
</span><span id="create_biden_corporate_proposal-395"><a href="#create_biden_corporate_proposal-395"><span class="linenos">395</span></a>        <span class="n">gilti_rate_change</span><span class="o">=</span><span class="mf">0.105</span><span class="p">,</span>  <span class="c1"># 10.5%  21% (double the rate)</span>
</span><span id="create_biden_corporate_proposal-396"><a href="#create_biden_corporate_proposal-396"><span class="linenos">396</span></a>        <span class="n">eliminate_fdii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-397"><a href="#create_biden_corporate_proposal-397"><span class="linenos">397</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2025</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-398"><a href="#create_biden_corporate_proposal-398"><span class="linenos">398</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_biden_corporate_proposal-399"><a href="#create_biden_corporate_proposal-399"><span class="linenos">399</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create Biden's full FY2025 corporate tax proposal.</p>

<p>Key components:</p>

<ul>
<li>Raise corporate rate from 21% to 28% (~$1.35T)</li>
<li>Increase GILTI rate from 10.5% to 21% (~$300B)</li>
<li>Eliminate FDII deduction (~$200B)</li>
<li>Other international changes</li>
</ul>

<p>Full package estimate: ~$1.8-2.0T over 10 years</p>
</div>


                </section>
                <section id="create_tcja_corporate_repeal">
                            <input id="create_tcja_corporate_repeal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_tcja_corporate_repeal</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#CorporateTaxPolicy">CorporateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_tcja_corporate_repeal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_tcja_corporate_repeal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_tcja_corporate_repeal-402"><a href="#create_tcja_corporate_repeal-402"><span class="linenos">402</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_tcja_corporate_repeal</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">CorporateTaxPolicy</span><span class="p">:</span>
</span><span id="create_tcja_corporate_repeal-403"><a href="#create_tcja_corporate_repeal-403"><span class="linenos">403</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_tcja_corporate_repeal-404"><a href="#create_tcja_corporate_repeal-404"><span class="linenos">404</span></a><span class="sd">    Create policy to repeal TCJA corporate rate cut (restore 35%).</span>
</span><span id="create_tcja_corporate_repeal-405"><a href="#create_tcja_corporate_repeal-405"><span class="linenos">405</span></a>
</span><span id="create_tcja_corporate_repeal-406"><a href="#create_tcja_corporate_repeal-406"><span class="linenos">406</span></a><span class="sd">    This would raise corporate rate from 21% back to 35%.</span>
</span><span id="create_tcja_corporate_repeal-407"><a href="#create_tcja_corporate_repeal-407"><span class="linenos">407</span></a><span class="sd">    Revenue estimate: ~$1.7-2.0T over 10 years (larger than Biden due to higher rate)</span>
</span><span id="create_tcja_corporate_repeal-408"><a href="#create_tcja_corporate_repeal-408"><span class="linenos">408</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_tcja_corporate_repeal-409"><a href="#create_tcja_corporate_repeal-409"><span class="linenos">409</span></a>    <span class="k">return</span> <span class="n">CorporateTaxPolicy</span><span class="p">(</span>
</span><span id="create_tcja_corporate_repeal-410"><a href="#create_tcja_corporate_repeal-410"><span class="linenos">410</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Repeal TCJA Corporate Cut&quot;</span><span class="p">,</span>
</span><span id="create_tcja_corporate_repeal-411"><a href="#create_tcja_corporate_repeal-411"><span class="linenos">411</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Restore corporate rate to pre-TCJA 35%&quot;</span><span class="p">,</span>
</span><span id="create_tcja_corporate_repeal-412"><a href="#create_tcja_corporate_repeal-412"><span class="linenos">412</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span><span class="p">,</span>
</span><span id="create_tcja_corporate_repeal-413"><a href="#create_tcja_corporate_repeal-413"><span class="linenos">413</span></a>        <span class="n">rate_change</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span>  <span class="c1"># 21%  35%</span>
</span><span id="create_tcja_corporate_repeal-414"><a href="#create_tcja_corporate_repeal-414"><span class="linenos">414</span></a>        <span class="n">baseline_rate</span><span class="o">=</span><span class="n">CURRENT_CORPORATE_RATE</span><span class="p">,</span>
</span><span id="create_tcja_corporate_repeal-415"><a href="#create_tcja_corporate_repeal-415"><span class="linenos">415</span></a>        <span class="n">corporate_elasticity</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span>  <span class="c1"># Higher elasticity for larger change</span>
</span><span id="create_tcja_corporate_repeal-416"><a href="#create_tcja_corporate_repeal-416"><span class="linenos">416</span></a>        <span class="n">include_passthrough_effects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_corporate_repeal-417"><a href="#create_tcja_corporate_repeal-417"><span class="linenos">417</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2025</span><span class="p">,</span>
</span><span id="create_tcja_corporate_repeal-418"><a href="#create_tcja_corporate_repeal-418"><span class="linenos">418</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_tcja_corporate_repeal-419"><a href="#create_tcja_corporate_repeal-419"><span class="linenos">419</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to repeal TCJA corporate rate cut (restore 35%).</p>

<p>This would raise corporate rate from 21% back to 35%.
Revenue estimate: ~$1.7-2.0T over 10 years (larger than Biden due to higher rate)</p>
</div>


                </section>
                <section id="create_republican_corporate_cut">
                            <input id="create_republican_corporate_cut-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_republican_corporate_cut</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#CorporateTaxPolicy">CorporateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_republican_corporate_cut-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_republican_corporate_cut"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_republican_corporate_cut-422"><a href="#create_republican_corporate_cut-422"><span class="linenos">422</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_republican_corporate_cut</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">CorporateTaxPolicy</span><span class="p">:</span>
</span><span id="create_republican_corporate_cut-423"><a href="#create_republican_corporate_cut-423"><span class="linenos">423</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_republican_corporate_cut-424"><a href="#create_republican_corporate_cut-424"><span class="linenos">424</span></a><span class="sd">    Create policy for further corporate rate reduction (Trump 2024 proposal).</span>
</span><span id="create_republican_corporate_cut-425"><a href="#create_republican_corporate_cut-425"><span class="linenos">425</span></a>
</span><span id="create_republican_corporate_cut-426"><a href="#create_republican_corporate_cut-426"><span class="linenos">426</span></a><span class="sd">    Lower corporate rate from 21% to 15%.</span>
</span><span id="create_republican_corporate_cut-427"><a href="#create_republican_corporate_cut-427"><span class="linenos">427</span></a><span class="sd">    Revenue estimate: ~-$600-700B over 10 years</span>
</span><span id="create_republican_corporate_cut-428"><a href="#create_republican_corporate_cut-428"><span class="linenos">428</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_republican_corporate_cut-429"><a href="#create_republican_corporate_cut-429"><span class="linenos">429</span></a>    <span class="k">return</span> <span class="n">CorporateTaxPolicy</span><span class="p">(</span>
</span><span id="create_republican_corporate_cut-430"><a href="#create_republican_corporate_cut-430"><span class="linenos">430</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Trump Corporate Rate Cut&quot;</span><span class="p">,</span>
</span><span id="create_republican_corporate_cut-431"><a href="#create_republican_corporate_cut-431"><span class="linenos">431</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Reduce corporate rate from 21% to 15%&quot;</span><span class="p">,</span>
</span><span id="create_republican_corporate_cut-432"><a href="#create_republican_corporate_cut-432"><span class="linenos">432</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span><span class="p">,</span>
</span><span id="create_republican_corporate_cut-433"><a href="#create_republican_corporate_cut-433"><span class="linenos">433</span></a>        <span class="n">rate_change</span><span class="o">=-</span><span class="mf">0.06</span><span class="p">,</span>  <span class="c1"># 21%  15%</span>
</span><span id="create_republican_corporate_cut-434"><a href="#create_republican_corporate_cut-434"><span class="linenos">434</span></a>        <span class="n">baseline_rate</span><span class="o">=</span><span class="n">CURRENT_CORPORATE_RATE</span><span class="p">,</span>
</span><span id="create_republican_corporate_cut-435"><a href="#create_republican_corporate_cut-435"><span class="linenos">435</span></a>        <span class="n">corporate_elasticity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="create_republican_corporate_cut-436"><a href="#create_republican_corporate_cut-436"><span class="linenos">436</span></a>        <span class="n">include_passthrough_effects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_republican_corporate_cut-437"><a href="#create_republican_corporate_cut-437"><span class="linenos">437</span></a>        <span class="n">extend_bonus_depreciation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Usually paired with depreciation extension</span>
</span><span id="create_republican_corporate_cut-438"><a href="#create_republican_corporate_cut-438"><span class="linenos">438</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2025</span><span class="p">,</span>
</span><span id="create_republican_corporate_cut-439"><a href="#create_republican_corporate_cut-439"><span class="linenos">439</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_republican_corporate_cut-440"><a href="#create_republican_corporate_cut-440"><span class="linenos">440</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy for further corporate rate reduction (Trump 2024 proposal).</p>

<p>Lower corporate rate from 21% to 15%.
Revenue estimate: ~-$600-700B over 10 years</p>
</div>


                </section>
                <section id="estimate_corporate_rate_revenue">
                            <input id="estimate_corporate_rate_revenue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_corporate_rate_revenue</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">include_behavioral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="estimate_corporate_rate_revenue-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#estimate_corporate_rate_revenue"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="estimate_corporate_rate_revenue-443"><a href="#estimate_corporate_rate_revenue-443"><span class="linenos">443</span></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_corporate_rate_revenue</span><span class="p">(</span>
</span><span id="estimate_corporate_rate_revenue-444"><a href="#estimate_corporate_rate_revenue-444"><span class="linenos">444</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-445"><a href="#estimate_corporate_rate_revenue-445"><span class="linenos">445</span></a>    <span class="n">include_behavioral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-446"><a href="#estimate_corporate_rate_revenue-446"><span class="linenos">446</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="estimate_corporate_rate_revenue-447"><a href="#estimate_corporate_rate_revenue-447"><span class="linenos">447</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="estimate_corporate_rate_revenue-448"><a href="#estimate_corporate_rate_revenue-448"><span class="linenos">448</span></a><span class="sd">    Quick estimate of corporate rate change revenue.</span>
</span><span id="estimate_corporate_rate_revenue-449"><a href="#estimate_corporate_rate_revenue-449"><span class="linenos">449</span></a>
</span><span id="estimate_corporate_rate_revenue-450"><a href="#estimate_corporate_rate_revenue-450"><span class="linenos">450</span></a><span class="sd">    Args:</span>
</span><span id="estimate_corporate_rate_revenue-451"><a href="#estimate_corporate_rate_revenue-451"><span class="linenos">451</span></a><span class="sd">        rate_change: Change in rate (e.g., +0.07)</span>
</span><span id="estimate_corporate_rate_revenue-452"><a href="#estimate_corporate_rate_revenue-452"><span class="linenos">452</span></a><span class="sd">        include_behavioral: Include behavioral response</span>
</span><span id="estimate_corporate_rate_revenue-453"><a href="#estimate_corporate_rate_revenue-453"><span class="linenos">453</span></a>
</span><span id="estimate_corporate_rate_revenue-454"><a href="#estimate_corporate_rate_revenue-454"><span class="linenos">454</span></a><span class="sd">    Returns:</span>
</span><span id="estimate_corporate_rate_revenue-455"><a href="#estimate_corporate_rate_revenue-455"><span class="linenos">455</span></a><span class="sd">        Dict with 10-year estimate and component breakdown</span>
</span><span id="estimate_corporate_rate_revenue-456"><a href="#estimate_corporate_rate_revenue-456"><span class="linenos">456</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="estimate_corporate_rate_revenue-457"><a href="#estimate_corporate_rate_revenue-457"><span class="linenos">457</span></a>    <span class="n">policy</span> <span class="o">=</span> <span class="n">create_corporate_rate_change</span><span class="p">(</span>
</span><span id="estimate_corporate_rate_revenue-458"><a href="#estimate_corporate_rate_revenue-458"><span class="linenos">458</span></a>        <span class="n">rate_change</span><span class="o">=</span><span class="n">rate_change</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-459"><a href="#estimate_corporate_rate_revenue-459"><span class="linenos">459</span></a>        <span class="n">include_behavioral</span><span class="o">=</span><span class="n">include_behavioral</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-460"><a href="#estimate_corporate_rate_revenue-460"><span class="linenos">460</span></a>    <span class="p">)</span>
</span><span id="estimate_corporate_rate_revenue-461"><a href="#estimate_corporate_rate_revenue-461"><span class="linenos">461</span></a>
</span><span id="estimate_corporate_rate_revenue-462"><a href="#estimate_corporate_rate_revenue-462"><span class="linenos">462</span></a>    <span class="c1"># Get annual effects</span>
</span><span id="estimate_corporate_rate_revenue-463"><a href="#estimate_corporate_rate_revenue-463"><span class="linenos">463</span></a>    <span class="n">static</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span><span class="n">BASELINE_CORPORATE_REVENUE_BILLIONS</span><span class="p">)</span>
</span><span id="estimate_corporate_rate_revenue-464"><a href="#estimate_corporate_rate_revenue-464"><span class="linenos">464</span></a>    <span class="n">behavioral</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">static</span><span class="p">)</span> <span class="k">if</span> <span class="n">include_behavioral</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="estimate_corporate_rate_revenue-465"><a href="#estimate_corporate_rate_revenue-465"><span class="linenos">465</span></a>
</span><span id="estimate_corporate_rate_revenue-466"><a href="#estimate_corporate_rate_revenue-466"><span class="linenos">466</span></a>    <span class="c1"># 10-year projection with growth</span>
</span><span id="estimate_corporate_rate_revenue-467"><a href="#estimate_corporate_rate_revenue-467"><span class="linenos">467</span></a>    <span class="n">annual_net</span> <span class="o">=</span> <span class="n">static</span> <span class="o">-</span> <span class="n">behavioral</span>  <span class="c1"># Behavioral reduces revenue</span>
</span><span id="estimate_corporate_rate_revenue-468"><a href="#estimate_corporate_rate_revenue-468"><span class="linenos">468</span></a>    <span class="n">growth_rate</span> <span class="o">=</span> <span class="mf">0.04</span>  <span class="c1"># ~4% annual growth in corporate profits</span>
</span><span id="estimate_corporate_rate_revenue-469"><a href="#estimate_corporate_rate_revenue-469"><span class="linenos">469</span></a>
</span><span id="estimate_corporate_rate_revenue-470"><a href="#estimate_corporate_rate_revenue-470"><span class="linenos">470</span></a>    <span class="n">ten_year_total</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="estimate_corporate_rate_revenue-471"><a href="#estimate_corporate_rate_revenue-471"><span class="linenos">471</span></a>    <span class="n">annual_effects</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="estimate_corporate_rate_revenue-472"><a href="#estimate_corporate_rate_revenue-472"><span class="linenos">472</span></a>    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span><span id="estimate_corporate_rate_revenue-473"><a href="#estimate_corporate_rate_revenue-473"><span class="linenos">473</span></a>        <span class="n">year_effect</span> <span class="o">=</span> <span class="n">annual_net</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">year</span><span class="p">)</span>
</span><span id="estimate_corporate_rate_revenue-474"><a href="#estimate_corporate_rate_revenue-474"><span class="linenos">474</span></a>        <span class="n">annual_effects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year_effect</span><span class="p">)</span>
</span><span id="estimate_corporate_rate_revenue-475"><a href="#estimate_corporate_rate_revenue-475"><span class="linenos">475</span></a>        <span class="n">ten_year_total</span> <span class="o">+=</span> <span class="n">year_effect</span>
</span><span id="estimate_corporate_rate_revenue-476"><a href="#estimate_corporate_rate_revenue-476"><span class="linenos">476</span></a>
</span><span id="estimate_corporate_rate_revenue-477"><a href="#estimate_corporate_rate_revenue-477"><span class="linenos">477</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="estimate_corporate_rate_revenue-478"><a href="#estimate_corporate_rate_revenue-478"><span class="linenos">478</span></a>        <span class="s2">&quot;rate_change&quot;</span><span class="p">:</span> <span class="n">rate_change</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-479"><a href="#estimate_corporate_rate_revenue-479"><span class="linenos">479</span></a>        <span class="s2">&quot;new_rate&quot;</span><span class="p">:</span> <span class="n">CURRENT_CORPORATE_RATE</span> <span class="o">+</span> <span class="n">rate_change</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-480"><a href="#estimate_corporate_rate_revenue-480"><span class="linenos">480</span></a>        <span class="s2">&quot;static_annual&quot;</span><span class="p">:</span> <span class="n">static</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-481"><a href="#estimate_corporate_rate_revenue-481"><span class="linenos">481</span></a>        <span class="s2">&quot;behavioral_annual&quot;</span><span class="p">:</span> <span class="n">behavioral</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-482"><a href="#estimate_corporate_rate_revenue-482"><span class="linenos">482</span></a>        <span class="s2">&quot;net_annual&quot;</span><span class="p">:</span> <span class="n">annual_net</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-483"><a href="#estimate_corporate_rate_revenue-483"><span class="linenos">483</span></a>        <span class="s2">&quot;ten_year_total&quot;</span><span class="p">:</span> <span class="n">ten_year_total</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-484"><a href="#estimate_corporate_rate_revenue-484"><span class="linenos">484</span></a>        <span class="s2">&quot;annual_effects&quot;</span><span class="p">:</span> <span class="n">annual_effects</span><span class="p">,</span>
</span><span id="estimate_corporate_rate_revenue-485"><a href="#estimate_corporate_rate_revenue-485"><span class="linenos">485</span></a>        <span class="s2">&quot;breakdown&quot;</span><span class="p">:</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_component_breakdown</span><span class="p">(),</span>
</span><span id="estimate_corporate_rate_revenue-486"><a href="#estimate_corporate_rate_revenue-486"><span class="linenos">486</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Quick estimate of corporate rate change revenue.</p>

<p>Args:
    rate_change: Change in rate (e.g., +0.07)
    include_behavioral: Include behavioral response</p>

<p>Returns:
    Dict with 10-year estimate and component breakdown</p>
</div>


                </section>
                <section id="CURRENT_CORPORATE_RATE">
                    <div class="attr variable">
            <span class="name">CURRENT_CORPORATE_RATE</span>        =
<span class="default_value">0.21</span>

        
    </div>
    <a class="headerlink" href="#CURRENT_CORPORATE_RATE"></a>
    
    

                </section>
                <section id="BASELINE_CORPORATE_REVENUE_BILLIONS">
                    <div class="attr variable">
            <span class="name">BASELINE_CORPORATE_REVENUE_BILLIONS</span>        =
<span class="default_value">475.0</span>

        
    </div>
    <a class="headerlink" href="#BASELINE_CORPORATE_REVENUE_BILLIONS"></a>
    
    

                </section>
                <section id="TaxCreditPolicy">
                            <input id="TaxCreditPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">TaxCreditPolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="TaxCreditPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxCreditPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxCreditPolicy-123"><a href="#TaxCreditPolicy-123"><span class="linenos">123</span></a><span class="nd">@dataclass</span>
</span><span id="TaxCreditPolicy-124"><a href="#TaxCreditPolicy-124"><span class="linenos">124</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TaxCreditPolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="TaxCreditPolicy-125"><a href="#TaxCreditPolicy-125"><span class="linenos">125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-126"><a href="#TaxCreditPolicy-126"><span class="linenos">126</span></a><span class="sd">    Tax credit policy with phase-in/phase-out modeling.</span>
</span><span id="TaxCreditPolicy-127"><a href="#TaxCreditPolicy-127"><span class="linenos">127</span></a>
</span><span id="TaxCreditPolicy-128"><a href="#TaxCreditPolicy-128"><span class="linenos">128</span></a><span class="sd">    Supports both refundable and non-refundable credits with income-based</span>
</span><span id="TaxCreditPolicy-129"><a href="#TaxCreditPolicy-129"><span class="linenos">129</span></a><span class="sd">    phase-in and phase-out structures.</span>
</span><span id="TaxCreditPolicy-130"><a href="#TaxCreditPolicy-130"><span class="linenos">130</span></a>
</span><span id="TaxCreditPolicy-131"><a href="#TaxCreditPolicy-131"><span class="linenos">131</span></a><span class="sd">    Key attributes:</span>
</span><span id="TaxCreditPolicy-132"><a href="#TaxCreditPolicy-132"><span class="linenos">132</span></a><span class="sd">        credit_type: Type of credit (CTC, EITC, etc.)</span>
</span><span id="TaxCreditPolicy-133"><a href="#TaxCreditPolicy-133"><span class="linenos">133</span></a><span class="sd">        is_refundable: Whether excess credit is refunded as cash</span>
</span><span id="TaxCreditPolicy-134"><a href="#TaxCreditPolicy-134"><span class="linenos">134</span></a><span class="sd">        max_credit_per_unit: Maximum credit per qualifying unit (child, filer)</span>
</span><span id="TaxCreditPolicy-135"><a href="#TaxCreditPolicy-135"><span class="linenos">135</span></a><span class="sd">        units_affected_millions: Number of qualifying units (children, filers)</span>
</span><span id="TaxCreditPolicy-136"><a href="#TaxCreditPolicy-136"><span class="linenos">136</span></a>
</span><span id="TaxCreditPolicy-137"><a href="#TaxCreditPolicy-137"><span class="linenos">137</span></a><span class="sd">        Phase-in (for EITC-style credits):</span>
</span><span id="TaxCreditPolicy-138"><a href="#TaxCreditPolicy-138"><span class="linenos">138</span></a><span class="sd">        phase_in_rate: Rate at which credit phases in with earned income</span>
</span><span id="TaxCreditPolicy-139"><a href="#TaxCreditPolicy-139"><span class="linenos">139</span></a><span class="sd">        phase_in_threshold: Income at which phase-in begins</span>
</span><span id="TaxCreditPolicy-140"><a href="#TaxCreditPolicy-140"><span class="linenos">140</span></a><span class="sd">        phase_in_end: Income at which maximum credit is reached</span>
</span><span id="TaxCreditPolicy-141"><a href="#TaxCreditPolicy-141"><span class="linenos">141</span></a>
</span><span id="TaxCreditPolicy-142"><a href="#TaxCreditPolicy-142"><span class="linenos">142</span></a><span class="sd">        Phase-out:</span>
</span><span id="TaxCreditPolicy-143"><a href="#TaxCreditPolicy-143"><span class="linenos">143</span></a><span class="sd">        phase_out_threshold: Income at which phase-out begins</span>
</span><span id="TaxCreditPolicy-144"><a href="#TaxCreditPolicy-144"><span class="linenos">144</span></a><span class="sd">        phase_out_rate: Rate at which credit phases out (per dollar of income)</span>
</span><span id="TaxCreditPolicy-145"><a href="#TaxCreditPolicy-145"><span class="linenos">145</span></a>
</span><span id="TaxCreditPolicy-146"><a href="#TaxCreditPolicy-146"><span class="linenos">146</span></a><span class="sd">        Refundability:</span>
</span><span id="TaxCreditPolicy-147"><a href="#TaxCreditPolicy-147"><span class="linenos">147</span></a><span class="sd">        refundable_max: Maximum refundable amount (for partially refundable)</span>
</span><span id="TaxCreditPolicy-148"><a href="#TaxCreditPolicy-148"><span class="linenos">148</span></a><span class="sd">        refund_rate: Rate at which credit becomes refundable with earnings</span>
</span><span id="TaxCreditPolicy-149"><a href="#TaxCreditPolicy-149"><span class="linenos">149</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-150"><a href="#TaxCreditPolicy-150"><span class="linenos">150</span></a>
</span><span id="TaxCreditPolicy-151"><a href="#TaxCreditPolicy-151"><span class="linenos">151</span></a>    <span class="n">credit_type</span><span class="p">:</span> <span class="n">CreditType</span> <span class="o">=</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">OTHER</span>
</span><span id="TaxCreditPolicy-152"><a href="#TaxCreditPolicy-152"><span class="linenos">152</span></a>    <span class="n">is_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TaxCreditPolicy-153"><a href="#TaxCreditPolicy-153"><span class="linenos">153</span></a>    <span class="n">is_partially_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Like current CTC</span>
</span><span id="TaxCreditPolicy-154"><a href="#TaxCreditPolicy-154"><span class="linenos">154</span></a>
</span><span id="TaxCreditPolicy-155"><a href="#TaxCreditPolicy-155"><span class="linenos">155</span></a>    <span class="c1"># Credit amount</span>
</span><span id="TaxCreditPolicy-156"><a href="#TaxCreditPolicy-156"><span class="linenos">156</span></a>    <span class="n">max_credit_per_unit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Maximum credit per child/filer</span>
</span><span id="TaxCreditPolicy-157"><a href="#TaxCreditPolicy-157"><span class="linenos">157</span></a>    <span class="n">credit_change_per_unit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change from current law</span>
</span><span id="TaxCreditPolicy-158"><a href="#TaxCreditPolicy-158"><span class="linenos">158</span></a>    <span class="n">units_affected_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Qualifying children or filers</span>
</span><span id="TaxCreditPolicy-159"><a href="#TaxCreditPolicy-159"><span class="linenos">159</span></a>
</span><span id="TaxCreditPolicy-160"><a href="#TaxCreditPolicy-160"><span class="linenos">160</span></a>    <span class="c1"># Phase-in structure (EITC-style)</span>
</span><span id="TaxCreditPolicy-161"><a href="#TaxCreditPolicy-161"><span class="linenos">161</span></a>    <span class="n">has_phase_in</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TaxCreditPolicy-162"><a href="#TaxCreditPolicy-162"><span class="linenos">162</span></a>    <span class="n">phase_in_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Rate credit phases in</span>
</span><span id="TaxCreditPolicy-163"><a href="#TaxCreditPolicy-163"><span class="linenos">163</span></a>    <span class="n">phase_in_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Income where phase-in starts</span>
</span><span id="TaxCreditPolicy-164"><a href="#TaxCreditPolicy-164"><span class="linenos">164</span></a>    <span class="n">phase_in_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Income where max credit reached</span>
</span><span id="TaxCreditPolicy-165"><a href="#TaxCreditPolicy-165"><span class="linenos">165</span></a>
</span><span id="TaxCreditPolicy-166"><a href="#TaxCreditPolicy-166"><span class="linenos">166</span></a>    <span class="c1"># Phase-out structure</span>
</span><span id="TaxCreditPolicy-167"><a href="#TaxCreditPolicy-167"><span class="linenos">167</span></a>    <span class="n">has_phase_out</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TaxCreditPolicy-168"><a href="#TaxCreditPolicy-168"><span class="linenos">168</span></a>    <span class="n">phase_out_threshold_single</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># AGI where phase-out starts</span>
</span><span id="TaxCreditPolicy-169"><a href="#TaxCreditPolicy-169"><span class="linenos">169</span></a>    <span class="n">phase_out_threshold_married</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TaxCreditPolicy-170"><a href="#TaxCreditPolicy-170"><span class="linenos">170</span></a>    <span class="n">phase_out_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Rate credit phases out</span>
</span><span id="TaxCreditPolicy-171"><a href="#TaxCreditPolicy-171"><span class="linenos">171</span></a>
</span><span id="TaxCreditPolicy-172"><a href="#TaxCreditPolicy-172"><span class="linenos">172</span></a>    <span class="c1"># Partial refundability (CTC-style)</span>
</span><span id="TaxCreditPolicy-173"><a href="#TaxCreditPolicy-173"><span class="linenos">173</span></a>    <span class="n">refundable_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Max refundable portion</span>
</span><span id="TaxCreditPolicy-174"><a href="#TaxCreditPolicy-174"><span class="linenos">174</span></a>    <span class="n">refund_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Rate at which credit becomes refundable</span>
</span><span id="TaxCreditPolicy-175"><a href="#TaxCreditPolicy-175"><span class="linenos">175</span></a>    <span class="n">refund_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Earned income floor for refundability</span>
</span><span id="TaxCreditPolicy-176"><a href="#TaxCreditPolicy-176"><span class="linenos">176</span></a>
</span><span id="TaxCreditPolicy-177"><a href="#TaxCreditPolicy-177"><span class="linenos">177</span></a>    <span class="c1"># Make fully refundable (policy change)</span>
</span><span id="TaxCreditPolicy-178"><a href="#TaxCreditPolicy-178"><span class="linenos">178</span></a>    <span class="n">make_fully_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TaxCreditPolicy-179"><a href="#TaxCreditPolicy-179"><span class="linenos">179</span></a>
</span><span id="TaxCreditPolicy-180"><a href="#TaxCreditPolicy-180"><span class="linenos">180</span></a>    <span class="c1"># Remove phase-out (policy change)</span>
</span><span id="TaxCreditPolicy-181"><a href="#TaxCreditPolicy-181"><span class="linenos">181</span></a>    <span class="n">remove_phase_out</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TaxCreditPolicy-182"><a href="#TaxCreditPolicy-182"><span class="linenos">182</span></a>
</span><span id="TaxCreditPolicy-183"><a href="#TaxCreditPolicy-183"><span class="linenos">183</span></a>    <span class="c1"># Expand qualifying criteria</span>
</span><span id="TaxCreditPolicy-184"><a href="#TaxCreditPolicy-184"><span class="linenos">184</span></a>    <span class="n">expand_qualifying_age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># e.g., 18 instead of 17</span>
</span><span id="TaxCreditPolicy-185"><a href="#TaxCreditPolicy-185"><span class="linenos">185</span></a>    <span class="n">include_childless_adults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># For EITC expansion</span>
</span><span id="TaxCreditPolicy-186"><a href="#TaxCreditPolicy-186"><span class="linenos">186</span></a>
</span><span id="TaxCreditPolicy-187"><a href="#TaxCreditPolicy-187"><span class="linenos">187</span></a>    <span class="c1"># Behavioral parameters</span>
</span><span id="TaxCreditPolicy-188"><a href="#TaxCreditPolicy-188"><span class="linenos">188</span></a>    <span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># EITC has significant labor effects</span>
</span><span id="TaxCreditPolicy-189"><a href="#TaxCreditPolicy-189"><span class="linenos">189</span></a>    <span class="n">participation_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.85</span>  <span class="c1"># Not everyone eligible claims</span>
</span><span id="TaxCreditPolicy-190"><a href="#TaxCreditPolicy-190"><span class="linenos">190</span></a>
</span><span id="TaxCreditPolicy-191"><a href="#TaxCreditPolicy-191"><span class="linenos">191</span></a>    <span class="c1"># Take-up adjustment (some eligible don&#39;t claim)</span>
</span><span id="TaxCreditPolicy-192"><a href="#TaxCreditPolicy-192"><span class="linenos">192</span></a>    <span class="n">take_up_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in participation rate</span>
</span><span id="TaxCreditPolicy-193"><a href="#TaxCreditPolicy-193"><span class="linenos">193</span></a>
</span><span id="TaxCreditPolicy-194"><a href="#TaxCreditPolicy-194"><span class="linenos">194</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TaxCreditPolicy-195"><a href="#TaxCreditPolicy-195"><span class="linenos">195</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set default policy type for credits.&quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-196"><a href="#TaxCreditPolicy-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-197"><a href="#TaxCreditPolicy-197"><span class="linenos">197</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">=</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span>
</span><span id="TaxCreditPolicy-198"><a href="#TaxCreditPolicy-198"><span class="linenos">198</span></a>
</span><span id="TaxCreditPolicy-199"><a href="#TaxCreditPolicy-199"><span class="linenos">199</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_credit_for_income</span><span class="p">(</span>
</span><span id="TaxCreditPolicy-200"><a href="#TaxCreditPolicy-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-201"><a href="#TaxCreditPolicy-201"><span class="linenos">201</span></a>        <span class="n">earned_income</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-202"><a href="#TaxCreditPolicy-202"><span class="linenos">202</span></a>        <span class="n">agi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-203"><a href="#TaxCreditPolicy-203"><span class="linenos">203</span></a>        <span class="n">filing_status</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;single&quot;</span><span class="p">,</span> <span class="s2">&quot;married&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-204"><a href="#TaxCreditPolicy-204"><span class="linenos">204</span></a>        <span class="n">num_children</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-205"><a href="#TaxCreditPolicy-205"><span class="linenos">205</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-206"><a href="#TaxCreditPolicy-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-207"><a href="#TaxCreditPolicy-207"><span class="linenos">207</span></a><span class="sd">        Calculate credit amount for a given income level.</span>
</span><span id="TaxCreditPolicy-208"><a href="#TaxCreditPolicy-208"><span class="linenos">208</span></a>
</span><span id="TaxCreditPolicy-209"><a href="#TaxCreditPolicy-209"><span class="linenos">209</span></a><span class="sd">        Returns dict with:</span>
</span><span id="TaxCreditPolicy-210"><a href="#TaxCreditPolicy-210"><span class="linenos">210</span></a><span class="sd">            - gross_credit: Credit before phase-out</span>
</span><span id="TaxCreditPolicy-211"><a href="#TaxCreditPolicy-211"><span class="linenos">211</span></a><span class="sd">            - net_credit: Credit after phase-out</span>
</span><span id="TaxCreditPolicy-212"><a href="#TaxCreditPolicy-212"><span class="linenos">212</span></a><span class="sd">            - refundable_portion: Amount refundable</span>
</span><span id="TaxCreditPolicy-213"><a href="#TaxCreditPolicy-213"><span class="linenos">213</span></a><span class="sd">            - non_refundable_portion: Amount offsetting tax liability</span>
</span><span id="TaxCreditPolicy-214"><a href="#TaxCreditPolicy-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-215"><a href="#TaxCreditPolicy-215"><span class="linenos">215</span></a>        <span class="c1"># Start with max credit</span>
</span><span id="TaxCreditPolicy-216"><a href="#TaxCreditPolicy-216"><span class="linenos">216</span></a>        <span class="n">gross_credit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_credit_per_unit</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_children</span><span class="p">)</span>
</span><span id="TaxCreditPolicy-217"><a href="#TaxCreditPolicy-217"><span class="linenos">217</span></a>
</span><span id="TaxCreditPolicy-218"><a href="#TaxCreditPolicy-218"><span class="linenos">218</span></a>        <span class="c1"># Apply phase-in (if applicable, like EITC)</span>
</span><span id="TaxCreditPolicy-219"><a href="#TaxCreditPolicy-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_phase_in</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-220"><a href="#TaxCreditPolicy-220"><span class="linenos">220</span></a>            <span class="k">if</span> <span class="n">earned_income</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_threshold</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-221"><a href="#TaxCreditPolicy-221"><span class="linenos">221</span></a>                <span class="n">gross_credit</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TaxCreditPolicy-222"><a href="#TaxCreditPolicy-222"><span class="linenos">222</span></a>            <span class="k">elif</span> <span class="n">earned_income</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_end</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-223"><a href="#TaxCreditPolicy-223"><span class="linenos">223</span></a>                <span class="n">phase_in_income</span> <span class="o">=</span> <span class="n">earned_income</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_threshold</span>
</span><span id="TaxCreditPolicy-224"><a href="#TaxCreditPolicy-224"><span class="linenos">224</span></a>                <span class="n">gross_credit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">gross_credit</span><span class="p">,</span> <span class="n">phase_in_income</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_rate</span><span class="p">)</span>
</span><span id="TaxCreditPolicy-225"><a href="#TaxCreditPolicy-225"><span class="linenos">225</span></a>
</span><span id="TaxCreditPolicy-226"><a href="#TaxCreditPolicy-226"><span class="linenos">226</span></a>        <span class="c1"># Apply phase-out</span>
</span><span id="TaxCreditPolicy-227"><a href="#TaxCreditPolicy-227"><span class="linenos">227</span></a>        <span class="n">net_credit</span> <span class="o">=</span> <span class="n">gross_credit</span>
</span><span id="TaxCreditPolicy-228"><a href="#TaxCreditPolicy-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_phase_out</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_phase_out</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-229"><a href="#TaxCreditPolicy-229"><span class="linenos">229</span></a>            <span class="n">threshold</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_out_threshold_married</span> <span class="k">if</span> <span class="n">filing_status</span> <span class="o">==</span> <span class="s2">&quot;married&quot;</span>
</span><span id="TaxCreditPolicy-230"><a href="#TaxCreditPolicy-230"><span class="linenos">230</span></a>                        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_out_threshold_single</span><span class="p">)</span>
</span><span id="TaxCreditPolicy-231"><a href="#TaxCreditPolicy-231"><span class="linenos">231</span></a>            <span class="k">if</span> <span class="n">agi</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-232"><a href="#TaxCreditPolicy-232"><span class="linenos">232</span></a>                <span class="n">phase_out_amount</span> <span class="o">=</span> <span class="p">(</span><span class="n">agi</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_out_rate</span>
</span><span id="TaxCreditPolicy-233"><a href="#TaxCreditPolicy-233"><span class="linenos">233</span></a>                <span class="n">net_credit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">gross_credit</span> <span class="o">-</span> <span class="n">phase_out_amount</span><span class="p">)</span>
</span><span id="TaxCreditPolicy-234"><a href="#TaxCreditPolicy-234"><span class="linenos">234</span></a>
</span><span id="TaxCreditPolicy-235"><a href="#TaxCreditPolicy-235"><span class="linenos">235</span></a>        <span class="c1"># Calculate refundable vs non-refundable portions</span>
</span><span id="TaxCreditPolicy-236"><a href="#TaxCreditPolicy-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_refundable</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_fully_refundable</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-237"><a href="#TaxCreditPolicy-237"><span class="linenos">237</span></a>            <span class="n">refundable</span> <span class="o">=</span> <span class="n">net_credit</span>
</span><span id="TaxCreditPolicy-238"><a href="#TaxCreditPolicy-238"><span class="linenos">238</span></a>            <span class="n">non_refundable</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TaxCreditPolicy-239"><a href="#TaxCreditPolicy-239"><span class="linenos">239</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_partially_refundable</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-240"><a href="#TaxCreditPolicy-240"><span class="linenos">240</span></a>            <span class="c1"># CTC-style: refundable portion based on earnings</span>
</span><span id="TaxCreditPolicy-241"><a href="#TaxCreditPolicy-241"><span class="linenos">241</span></a>            <span class="n">refundable_earnings</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">earned_income</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">refund_threshold</span><span class="p">)</span>
</span><span id="TaxCreditPolicy-242"><a href="#TaxCreditPolicy-242"><span class="linenos">242</span></a>            <span class="n">potential_refund</span> <span class="o">=</span> <span class="n">refundable_earnings</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">refund_rate</span>
</span><span id="TaxCreditPolicy-243"><a href="#TaxCreditPolicy-243"><span class="linenos">243</span></a>            <span class="n">refundable</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refundable_max</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_children</span><span class="p">),</span>
</span><span id="TaxCreditPolicy-244"><a href="#TaxCreditPolicy-244"><span class="linenos">244</span></a>                           <span class="n">potential_refund</span><span class="p">,</span> <span class="n">net_credit</span><span class="p">)</span>
</span><span id="TaxCreditPolicy-245"><a href="#TaxCreditPolicy-245"><span class="linenos">245</span></a>            <span class="n">non_refundable</span> <span class="o">=</span> <span class="n">net_credit</span> <span class="o">-</span> <span class="n">refundable</span>
</span><span id="TaxCreditPolicy-246"><a href="#TaxCreditPolicy-246"><span class="linenos">246</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-247"><a href="#TaxCreditPolicy-247"><span class="linenos">247</span></a>            <span class="n">refundable</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TaxCreditPolicy-248"><a href="#TaxCreditPolicy-248"><span class="linenos">248</span></a>            <span class="n">non_refundable</span> <span class="o">=</span> <span class="n">net_credit</span>
</span><span id="TaxCreditPolicy-249"><a href="#TaxCreditPolicy-249"><span class="linenos">249</span></a>
</span><span id="TaxCreditPolicy-250"><a href="#TaxCreditPolicy-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="TaxCreditPolicy-251"><a href="#TaxCreditPolicy-251"><span class="linenos">251</span></a>            <span class="s2">&quot;gross_credit&quot;</span><span class="p">:</span> <span class="n">gross_credit</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-252"><a href="#TaxCreditPolicy-252"><span class="linenos">252</span></a>            <span class="s2">&quot;net_credit&quot;</span><span class="p">:</span> <span class="n">net_credit</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-253"><a href="#TaxCreditPolicy-253"><span class="linenos">253</span></a>            <span class="s2">&quot;refundable_portion&quot;</span><span class="p">:</span> <span class="n">refundable</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-254"><a href="#TaxCreditPolicy-254"><span class="linenos">254</span></a>            <span class="s2">&quot;non_refundable_portion&quot;</span><span class="p">:</span> <span class="n">non_refundable</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-255"><a href="#TaxCreditPolicy-255"><span class="linenos">255</span></a>        <span class="p">}</span>
</span><span id="TaxCreditPolicy-256"><a href="#TaxCreditPolicy-256"><span class="linenos">256</span></a>
</span><span id="TaxCreditPolicy-257"><a href="#TaxCreditPolicy-257"><span class="linenos">257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="TaxCreditPolicy-258"><a href="#TaxCreditPolicy-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-259"><a href="#TaxCreditPolicy-259"><span class="linenos">259</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-260"><a href="#TaxCreditPolicy-260"><span class="linenos">260</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TaxCreditPolicy-261"><a href="#TaxCreditPolicy-261"><span class="linenos">261</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-262"><a href="#TaxCreditPolicy-262"><span class="linenos">262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-263"><a href="#TaxCreditPolicy-263"><span class="linenos">263</span></a><span class="sd">        Estimate static revenue effect of credit policy change.</span>
</span><span id="TaxCreditPolicy-264"><a href="#TaxCreditPolicy-264"><span class="linenos">264</span></a>
</span><span id="TaxCreditPolicy-265"><a href="#TaxCreditPolicy-265"><span class="linenos">265</span></a><span class="sd">        For credits, revenue effect = change in credit cost (negative = cost).</span>
</span><span id="TaxCreditPolicy-266"><a href="#TaxCreditPolicy-266"><span class="linenos">266</span></a>
</span><span id="TaxCreditPolicy-267"><a href="#TaxCreditPolicy-267"><span class="linenos">267</span></a><span class="sd">        Args:</span>
</span><span id="TaxCreditPolicy-268"><a href="#TaxCreditPolicy-268"><span class="linenos">268</span></a><span class="sd">            baseline_revenue: Baseline tax revenue (not directly used)</span>
</span><span id="TaxCreditPolicy-269"><a href="#TaxCreditPolicy-269"><span class="linenos">269</span></a><span class="sd">            use_real_data: Whether to use real data (not currently implemented)</span>
</span><span id="TaxCreditPolicy-270"><a href="#TaxCreditPolicy-270"><span class="linenos">270</span></a>
</span><span id="TaxCreditPolicy-271"><a href="#TaxCreditPolicy-271"><span class="linenos">271</span></a><span class="sd">        Returns:</span>
</span><span id="TaxCreditPolicy-272"><a href="#TaxCreditPolicy-272"><span class="linenos">272</span></a><span class="sd">            Revenue change in billions (negative = revenue loss/cost)</span>
</span><span id="TaxCreditPolicy-273"><a href="#TaxCreditPolicy-273"><span class="linenos">273</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-274"><a href="#TaxCreditPolicy-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-275"><a href="#TaxCreditPolicy-275"><span class="linenos">275</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="TaxCreditPolicy-276"><a href="#TaxCreditPolicy-276"><span class="linenos">276</span></a>
</span><span id="TaxCreditPolicy-277"><a href="#TaxCreditPolicy-277"><span class="linenos">277</span></a>        <span class="c1"># Calculate cost from credit change and affected units</span>
</span><span id="TaxCreditPolicy-278"><a href="#TaxCreditPolicy-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_change_per_unit</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">units_affected_millions</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-279"><a href="#TaxCreditPolicy-279"><span class="linenos">279</span></a>            <span class="c1"># Simple calculation: change  units  participation</span>
</span><span id="TaxCreditPolicy-280"><a href="#TaxCreditPolicy-280"><span class="linenos">280</span></a>            <span class="n">static_cost</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="TaxCreditPolicy-281"><a href="#TaxCreditPolicy-281"><span class="linenos">281</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">credit_change_per_unit</span> <span class="o">*</span>
</span><span id="TaxCreditPolicy-282"><a href="#TaxCreditPolicy-282"><span class="linenos">282</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">units_affected_millions</span> <span class="o">*</span>
</span><span id="TaxCreditPolicy-283"><a href="#TaxCreditPolicy-283"><span class="linenos">283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">participation_rate</span> <span class="o">*</span>
</span><span id="TaxCreditPolicy-284"><a href="#TaxCreditPolicy-284"><span class="linenos">284</span></a>                <span class="mf">1e6</span> <span class="o">/</span> <span class="mf">1e9</span>  <span class="c1"># Convert to billions</span>
</span><span id="TaxCreditPolicy-285"><a href="#TaxCreditPolicy-285"><span class="linenos">285</span></a>            <span class="p">)</span>
</span><span id="TaxCreditPolicy-286"><a href="#TaxCreditPolicy-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">static_cost</span>  <span class="c1"># Negative = costs money</span>
</span><span id="TaxCreditPolicy-287"><a href="#TaxCreditPolicy-287"><span class="linenos">287</span></a>
</span><span id="TaxCreditPolicy-288"><a href="#TaxCreditPolicy-288"><span class="linenos">288</span></a>        <span class="c1"># Calculate cost from making credit fully refundable</span>
</span><span id="TaxCreditPolicy-289"><a href="#TaxCreditPolicy-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_fully_refundable</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_type</span> <span class="o">==</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-290"><a href="#TaxCreditPolicy-290"><span class="linenos">290</span></a>            <span class="c1"># Currently ~$32B is refundable, full refundability would add more</span>
</span><span id="TaxCreditPolicy-291"><a href="#TaxCreditPolicy-291"><span class="linenos">291</span></a>            <span class="c1"># Rough estimate: ~60% of CTC is refundable, making rest refundable</span>
</span><span id="TaxCreditPolicy-292"><a href="#TaxCreditPolicy-292"><span class="linenos">292</span></a>            <span class="c1"># adds ~$50B/year</span>
</span><span id="TaxCreditPolicy-293"><a href="#TaxCreditPolicy-293"><span class="linenos">293</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mf">50.0</span>
</span><span id="TaxCreditPolicy-294"><a href="#TaxCreditPolicy-294"><span class="linenos">294</span></a>
</span><span id="TaxCreditPolicy-295"><a href="#TaxCreditPolicy-295"><span class="linenos">295</span></a>        <span class="c1"># Calculate cost from removing phase-out</span>
</span><span id="TaxCreditPolicy-296"><a href="#TaxCreditPolicy-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_phase_out</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-297"><a href="#TaxCreditPolicy-297"><span class="linenos">297</span></a>            <span class="c1"># Depends on credit type and current phase-out parameters</span>
</span><span id="TaxCreditPolicy-298"><a href="#TaxCreditPolicy-298"><span class="linenos">298</span></a>            <span class="c1"># For CTC: removes phase-out for high earners</span>
</span><span id="TaxCreditPolicy-299"><a href="#TaxCreditPolicy-299"><span class="linenos">299</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_type</span> <span class="o">==</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-300"><a href="#TaxCreditPolicy-300"><span class="linenos">300</span></a>                <span class="c1"># ~5% of filers in phase-out range, avg reduction ~$1,000/child</span>
</span><span id="TaxCreditPolicy-301"><a href="#TaxCreditPolicy-301"><span class="linenos">301</span></a>                <span class="k">return</span> <span class="o">-</span><span class="mf">5.0</span>  <span class="c1"># ~$5B/year</span>
</span><span id="TaxCreditPolicy-302"><a href="#TaxCreditPolicy-302"><span class="linenos">302</span></a>
</span><span id="TaxCreditPolicy-303"><a href="#TaxCreditPolicy-303"><span class="linenos">303</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="TaxCreditPolicy-304"><a href="#TaxCreditPolicy-304"><span class="linenos">304</span></a>
</span><span id="TaxCreditPolicy-305"><a href="#TaxCreditPolicy-305"><span class="linenos">305</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-306"><a href="#TaxCreditPolicy-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-307"><a href="#TaxCreditPolicy-307"><span class="linenos">307</span></a><span class="sd">        Estimate behavioral response to credit changes.</span>
</span><span id="TaxCreditPolicy-308"><a href="#TaxCreditPolicy-308"><span class="linenos">308</span></a>
</span><span id="TaxCreditPolicy-309"><a href="#TaxCreditPolicy-309"><span class="linenos">309</span></a><span class="sd">        For refundable credits (especially EITC), there are significant</span>
</span><span id="TaxCreditPolicy-310"><a href="#TaxCreditPolicy-310"><span class="linenos">310</span></a><span class="sd">        labor supply effects:</span>
</span><span id="TaxCreditPolicy-311"><a href="#TaxCreditPolicy-311"><span class="linenos">311</span></a><span class="sd">        - EITC phase-in encourages work (positive labor supply)</span>
</span><span id="TaxCreditPolicy-312"><a href="#TaxCreditPolicy-312"><span class="linenos">312</span></a><span class="sd">        - EITC phase-out discourages work (negative labor supply)</span>
</span><span id="TaxCreditPolicy-313"><a href="#TaxCreditPolicy-313"><span class="linenos">313</span></a><span class="sd">        - Net effect on labor supply and therefore income tax revenue</span>
</span><span id="TaxCreditPolicy-314"><a href="#TaxCreditPolicy-314"><span class="linenos">314</span></a>
</span><span id="TaxCreditPolicy-315"><a href="#TaxCreditPolicy-315"><span class="linenos">315</span></a><span class="sd">        Returns:</span>
</span><span id="TaxCreditPolicy-316"><a href="#TaxCreditPolicy-316"><span class="linenos">316</span></a><span class="sd">            Behavioral offset in billions (positive = revenue lost)</span>
</span><span id="TaxCreditPolicy-317"><a href="#TaxCreditPolicy-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy-318"><a href="#TaxCreditPolicy-318"><span class="linenos">318</span></a>        <span class="c1"># EITC has the largest labor supply effects</span>
</span><span id="TaxCreditPolicy-319"><a href="#TaxCreditPolicy-319"><span class="linenos">319</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_type</span> <span class="o">==</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">EARNED_INCOME_CREDIT</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-320"><a href="#TaxCreditPolicy-320"><span class="linenos">320</span></a>            <span class="c1"># Research shows EITC increases labor force participation</span>
</span><span id="TaxCreditPolicy-321"><a href="#TaxCreditPolicy-321"><span class="linenos">321</span></a>            <span class="c1"># This generates additional income tax + payroll tax revenue</span>
</span><span id="TaxCreditPolicy-322"><a href="#TaxCreditPolicy-322"><span class="linenos">322</span></a>            <span class="c1"># Offsetting ~10-15% of the cost</span>
</span><span id="TaxCreditPolicy-323"><a href="#TaxCreditPolicy-323"><span class="linenos">323</span></a>            <span class="k">return</span> <span class="n">static_effect</span> <span class="o">*</span> <span class="mf">0.12</span>  <span class="c1"># ~12% offset from labor supply</span>
</span><span id="TaxCreditPolicy-324"><a href="#TaxCreditPolicy-324"><span class="linenos">324</span></a>
</span><span id="TaxCreditPolicy-325"><a href="#TaxCreditPolicy-325"><span class="linenos">325</span></a>        <span class="c1"># CTC has smaller labor effects</span>
</span><span id="TaxCreditPolicy-326"><a href="#TaxCreditPolicy-326"><span class="linenos">326</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_type</span> <span class="o">==</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">:</span>
</span><span id="TaxCreditPolicy-327"><a href="#TaxCreditPolicy-327"><span class="linenos">327</span></a>            <span class="c1"># Some income effects on secondary earners, but smaller</span>
</span><span id="TaxCreditPolicy-328"><a href="#TaxCreditPolicy-328"><span class="linenos">328</span></a>            <span class="k">return</span> <span class="n">static_effect</span> <span class="o">*</span> <span class="mf">0.05</span>  <span class="c1"># ~5% offset</span>
</span><span id="TaxCreditPolicy-329"><a href="#TaxCreditPolicy-329"><span class="linenos">329</span></a>
</span><span id="TaxCreditPolicy-330"><a href="#TaxCreditPolicy-330"><span class="linenos">330</span></a>        <span class="c1"># General credits</span>
</span><span id="TaxCreditPolicy-331"><a href="#TaxCreditPolicy-331"><span class="linenos">331</span></a>        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">labor_supply_elasticity</span> <span class="o">*</span> <span class="mf">0.3</span>
</span></pre></div>


            <div class="docstring"><p>Tax credit policy with phase-in/phase-out modeling.</p>

<p>Supports both refundable and non-refundable credits with income-based
phase-in and phase-out structures.</p>

<p>Key attributes:
    credit_type: Type of credit (CTC, EITC, etc.)
    is_refundable: Whether excess credit is refunded as cash
    max_credit_per_unit: Maximum credit per qualifying unit (child, filer)
    units_affected_millions: Number of qualifying units (children, filers)</p>

<pre><code>Phase-in (for EITC-style credits):
phase_in_rate: Rate at which credit phases in with earned income
phase_in_threshold: Income at which phase-in begins
phase_in_end: Income at which maximum credit is reached

Phase-out:
phase_out_threshold: Income at which phase-out begins
phase_out_rate: Rate at which credit phases out (per dollar of income)

Refundability:
refundable_max: Maximum refundable amount (for partially refundable)
refund_rate: Rate at which credit becomes refundable with earnings
</code></pre>
</div>


                            <div id="TaxCreditPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TaxCreditPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_type</span><span class="p">:</span> <span class="n"><a href="#CreditType">CreditType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#CreditType.OTHER">CreditType.OTHER</a></span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">is_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">is_partially_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">max_credit_per_unit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_change_per_unit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">units_affected_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">has_phase_in</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">phase_in_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">phase_in_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">phase_in_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">has_phase_out</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">phase_out_threshold_single</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">phase_out_threshold_married</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">phase_out_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">refundable_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">refund_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">refund_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">make_fully_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">remove_phase_out</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">expand_qualifying_age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">include_childless_adults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">participation_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.85</span>,</span><span class="param">	<span class="n">take_up_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.__init__"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.credit_type" class="classattr">
                                <div class="attr variable">
            <span class="name">credit_type</span><span class="annotation">: <a href="#CreditType">CreditType</a></span>        =
<span class="default_value">&lt;<a href="#CreditType.OTHER">CreditType.OTHER</a>: &#39;other&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.credit_type"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.is_refundable" class="classattr">
                                <div class="attr variable">
            <span class="name">is_refundable</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.is_refundable"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.is_partially_refundable" class="classattr">
                                <div class="attr variable">
            <span class="name">is_partially_refundable</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.is_partially_refundable"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.max_credit_per_unit" class="classattr">
                                <div class="attr variable">
            <span class="name">max_credit_per_unit</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.max_credit_per_unit"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.credit_change_per_unit" class="classattr">
                                <div class="attr variable">
            <span class="name">credit_change_per_unit</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.credit_change_per_unit"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.units_affected_millions" class="classattr">
                                <div class="attr variable">
            <span class="name">units_affected_millions</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.units_affected_millions"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.has_phase_in" class="classattr">
                                <div class="attr variable">
            <span class="name">has_phase_in</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.has_phase_in"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.phase_in_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_in_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.phase_in_rate"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.phase_in_threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_in_threshold</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.phase_in_threshold"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.phase_in_end" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_in_end</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.phase_in_end"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.has_phase_out" class="classattr">
                                <div class="attr variable">
            <span class="name">has_phase_out</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.has_phase_out"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.phase_out_threshold_single" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_out_threshold_single</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.phase_out_threshold_single"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.phase_out_threshold_married" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_out_threshold_married</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.phase_out_threshold_married"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.phase_out_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_out_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.phase_out_rate"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.refundable_max" class="classattr">
                                <div class="attr variable">
            <span class="name">refundable_max</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.refundable_max"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.refund_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">refund_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.refund_rate"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.refund_threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">refund_threshold</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.refund_threshold"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.make_fully_refundable" class="classattr">
                                <div class="attr variable">
            <span class="name">make_fully_refundable</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.make_fully_refundable"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.remove_phase_out" class="classattr">
                                <div class="attr variable">
            <span class="name">remove_phase_out</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.remove_phase_out"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.expand_qualifying_age" class="classattr">
                                <div class="attr variable">
            <span class="name">expand_qualifying_age</span><span class="annotation">: int | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.expand_qualifying_age"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.include_childless_adults" class="classattr">
                                <div class="attr variable">
            <span class="name">include_childless_adults</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.include_childless_adults"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.labor_supply_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">labor_supply_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.1</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.labor_supply_elasticity"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.participation_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">participation_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.85</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.participation_rate"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.take_up_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">take_up_rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxCreditPolicy.take_up_rate_change"></a>
    
    

                            </div>
                            <div id="TaxCreditPolicy.calculate_credit_for_income" class="classattr">
                                        <input id="TaxCreditPolicy.calculate_credit_for_income-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_credit_for_income</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">earned_income</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">agi</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">filing_status</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;married&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span>,</span><span class="param">	<span class="n">num_children</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="TaxCreditPolicy.calculate_credit_for_income-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxCreditPolicy.calculate_credit_for_income"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxCreditPolicy.calculate_credit_for_income-199"><a href="#TaxCreditPolicy.calculate_credit_for_income-199"><span class="linenos">199</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_credit_for_income</span><span class="p">(</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-200"><a href="#TaxCreditPolicy.calculate_credit_for_income-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-201"><a href="#TaxCreditPolicy.calculate_credit_for_income-201"><span class="linenos">201</span></a>        <span class="n">earned_income</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-202"><a href="#TaxCreditPolicy.calculate_credit_for_income-202"><span class="linenos">202</span></a>        <span class="n">agi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-203"><a href="#TaxCreditPolicy.calculate_credit_for_income-203"><span class="linenos">203</span></a>        <span class="n">filing_status</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;single&quot;</span><span class="p">,</span> <span class="s2">&quot;married&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-204"><a href="#TaxCreditPolicy.calculate_credit_for_income-204"><span class="linenos">204</span></a>        <span class="n">num_children</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-205"><a href="#TaxCreditPolicy.calculate_credit_for_income-205"><span class="linenos">205</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-206"><a href="#TaxCreditPolicy.calculate_credit_for_income-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-207"><a href="#TaxCreditPolicy.calculate_credit_for_income-207"><span class="linenos">207</span></a><span class="sd">        Calculate credit amount for a given income level.</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-208"><a href="#TaxCreditPolicy.calculate_credit_for_income-208"><span class="linenos">208</span></a>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-209"><a href="#TaxCreditPolicy.calculate_credit_for_income-209"><span class="linenos">209</span></a><span class="sd">        Returns dict with:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-210"><a href="#TaxCreditPolicy.calculate_credit_for_income-210"><span class="linenos">210</span></a><span class="sd">            - gross_credit: Credit before phase-out</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-211"><a href="#TaxCreditPolicy.calculate_credit_for_income-211"><span class="linenos">211</span></a><span class="sd">            - net_credit: Credit after phase-out</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-212"><a href="#TaxCreditPolicy.calculate_credit_for_income-212"><span class="linenos">212</span></a><span class="sd">            - refundable_portion: Amount refundable</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-213"><a href="#TaxCreditPolicy.calculate_credit_for_income-213"><span class="linenos">213</span></a><span class="sd">            - non_refundable_portion: Amount offsetting tax liability</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-214"><a href="#TaxCreditPolicy.calculate_credit_for_income-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-215"><a href="#TaxCreditPolicy.calculate_credit_for_income-215"><span class="linenos">215</span></a>        <span class="c1"># Start with max credit</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-216"><a href="#TaxCreditPolicy.calculate_credit_for_income-216"><span class="linenos">216</span></a>        <span class="n">gross_credit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_credit_per_unit</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_children</span><span class="p">)</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-217"><a href="#TaxCreditPolicy.calculate_credit_for_income-217"><span class="linenos">217</span></a>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-218"><a href="#TaxCreditPolicy.calculate_credit_for_income-218"><span class="linenos">218</span></a>        <span class="c1"># Apply phase-in (if applicable, like EITC)</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-219"><a href="#TaxCreditPolicy.calculate_credit_for_income-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_phase_in</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-220"><a href="#TaxCreditPolicy.calculate_credit_for_income-220"><span class="linenos">220</span></a>            <span class="k">if</span> <span class="n">earned_income</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_threshold</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-221"><a href="#TaxCreditPolicy.calculate_credit_for_income-221"><span class="linenos">221</span></a>                <span class="n">gross_credit</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-222"><a href="#TaxCreditPolicy.calculate_credit_for_income-222"><span class="linenos">222</span></a>            <span class="k">elif</span> <span class="n">earned_income</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_end</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-223"><a href="#TaxCreditPolicy.calculate_credit_for_income-223"><span class="linenos">223</span></a>                <span class="n">phase_in_income</span> <span class="o">=</span> <span class="n">earned_income</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_threshold</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-224"><a href="#TaxCreditPolicy.calculate_credit_for_income-224"><span class="linenos">224</span></a>                <span class="n">gross_credit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">gross_credit</span><span class="p">,</span> <span class="n">phase_in_income</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_in_rate</span><span class="p">)</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-225"><a href="#TaxCreditPolicy.calculate_credit_for_income-225"><span class="linenos">225</span></a>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-226"><a href="#TaxCreditPolicy.calculate_credit_for_income-226"><span class="linenos">226</span></a>        <span class="c1"># Apply phase-out</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-227"><a href="#TaxCreditPolicy.calculate_credit_for_income-227"><span class="linenos">227</span></a>        <span class="n">net_credit</span> <span class="o">=</span> <span class="n">gross_credit</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-228"><a href="#TaxCreditPolicy.calculate_credit_for_income-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_phase_out</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_phase_out</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-229"><a href="#TaxCreditPolicy.calculate_credit_for_income-229"><span class="linenos">229</span></a>            <span class="n">threshold</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_out_threshold_married</span> <span class="k">if</span> <span class="n">filing_status</span> <span class="o">==</span> <span class="s2">&quot;married&quot;</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-230"><a href="#TaxCreditPolicy.calculate_credit_for_income-230"><span class="linenos">230</span></a>                        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_out_threshold_single</span><span class="p">)</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-231"><a href="#TaxCreditPolicy.calculate_credit_for_income-231"><span class="linenos">231</span></a>            <span class="k">if</span> <span class="n">agi</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-232"><a href="#TaxCreditPolicy.calculate_credit_for_income-232"><span class="linenos">232</span></a>                <span class="n">phase_out_amount</span> <span class="o">=</span> <span class="p">(</span><span class="n">agi</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_out_rate</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-233"><a href="#TaxCreditPolicy.calculate_credit_for_income-233"><span class="linenos">233</span></a>                <span class="n">net_credit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">gross_credit</span> <span class="o">-</span> <span class="n">phase_out_amount</span><span class="p">)</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-234"><a href="#TaxCreditPolicy.calculate_credit_for_income-234"><span class="linenos">234</span></a>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-235"><a href="#TaxCreditPolicy.calculate_credit_for_income-235"><span class="linenos">235</span></a>        <span class="c1"># Calculate refundable vs non-refundable portions</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-236"><a href="#TaxCreditPolicy.calculate_credit_for_income-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_refundable</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_fully_refundable</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-237"><a href="#TaxCreditPolicy.calculate_credit_for_income-237"><span class="linenos">237</span></a>            <span class="n">refundable</span> <span class="o">=</span> <span class="n">net_credit</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-238"><a href="#TaxCreditPolicy.calculate_credit_for_income-238"><span class="linenos">238</span></a>            <span class="n">non_refundable</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-239"><a href="#TaxCreditPolicy.calculate_credit_for_income-239"><span class="linenos">239</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_partially_refundable</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-240"><a href="#TaxCreditPolicy.calculate_credit_for_income-240"><span class="linenos">240</span></a>            <span class="c1"># CTC-style: refundable portion based on earnings</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-241"><a href="#TaxCreditPolicy.calculate_credit_for_income-241"><span class="linenos">241</span></a>            <span class="n">refundable_earnings</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">earned_income</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">refund_threshold</span><span class="p">)</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-242"><a href="#TaxCreditPolicy.calculate_credit_for_income-242"><span class="linenos">242</span></a>            <span class="n">potential_refund</span> <span class="o">=</span> <span class="n">refundable_earnings</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">refund_rate</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-243"><a href="#TaxCreditPolicy.calculate_credit_for_income-243"><span class="linenos">243</span></a>            <span class="n">refundable</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refundable_max</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_children</span><span class="p">),</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-244"><a href="#TaxCreditPolicy.calculate_credit_for_income-244"><span class="linenos">244</span></a>                           <span class="n">potential_refund</span><span class="p">,</span> <span class="n">net_credit</span><span class="p">)</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-245"><a href="#TaxCreditPolicy.calculate_credit_for_income-245"><span class="linenos">245</span></a>            <span class="n">non_refundable</span> <span class="o">=</span> <span class="n">net_credit</span> <span class="o">-</span> <span class="n">refundable</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-246"><a href="#TaxCreditPolicy.calculate_credit_for_income-246"><span class="linenos">246</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-247"><a href="#TaxCreditPolicy.calculate_credit_for_income-247"><span class="linenos">247</span></a>            <span class="n">refundable</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-248"><a href="#TaxCreditPolicy.calculate_credit_for_income-248"><span class="linenos">248</span></a>            <span class="n">non_refundable</span> <span class="o">=</span> <span class="n">net_credit</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-249"><a href="#TaxCreditPolicy.calculate_credit_for_income-249"><span class="linenos">249</span></a>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-250"><a href="#TaxCreditPolicy.calculate_credit_for_income-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-251"><a href="#TaxCreditPolicy.calculate_credit_for_income-251"><span class="linenos">251</span></a>            <span class="s2">&quot;gross_credit&quot;</span><span class="p">:</span> <span class="n">gross_credit</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-252"><a href="#TaxCreditPolicy.calculate_credit_for_income-252"><span class="linenos">252</span></a>            <span class="s2">&quot;net_credit&quot;</span><span class="p">:</span> <span class="n">net_credit</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-253"><a href="#TaxCreditPolicy.calculate_credit_for_income-253"><span class="linenos">253</span></a>            <span class="s2">&quot;refundable_portion&quot;</span><span class="p">:</span> <span class="n">refundable</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-254"><a href="#TaxCreditPolicy.calculate_credit_for_income-254"><span class="linenos">254</span></a>            <span class="s2">&quot;non_refundable_portion&quot;</span><span class="p">:</span> <span class="n">non_refundable</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.calculate_credit_for_income-255"><a href="#TaxCreditPolicy.calculate_credit_for_income-255"><span class="linenos">255</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Calculate credit amount for a given income level.</p>

<p>Returns dict with:
    - gross_credit: Credit before phase-out
    - net_credit: Credit after phase-out
    - refundable_portion: Amount refundable
    - non_refundable_portion: Amount offsetting tax liability</p>
</div>


                            </div>
                            <div id="TaxCreditPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="TaxCreditPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TaxCreditPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxCreditPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxCreditPolicy.estimate_static_revenue_effect-257"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-257"><span class="linenos">257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-258"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-259"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-259"><span class="linenos">259</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-260"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-260"><span class="linenos">260</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-261"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-261"><span class="linenos">261</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-262"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-262"><span class="linenos">262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-263"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-263"><span class="linenos">263</span></a><span class="sd">        Estimate static revenue effect of credit policy change.</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-264"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-264"><span class="linenos">264</span></a>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-265"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-265"><span class="linenos">265</span></a><span class="sd">        For credits, revenue effect = change in credit cost (negative = cost).</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-266"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-266"><span class="linenos">266</span></a>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-267"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-267"><span class="linenos">267</span></a><span class="sd">        Args:</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-268"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-268"><span class="linenos">268</span></a><span class="sd">            baseline_revenue: Baseline tax revenue (not directly used)</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-269"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-269"><span class="linenos">269</span></a><span class="sd">            use_real_data: Whether to use real data (not currently implemented)</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-270"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-270"><span class="linenos">270</span></a>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-271"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-271"><span class="linenos">271</span></a><span class="sd">        Returns:</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-272"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-272"><span class="linenos">272</span></a><span class="sd">            Revenue change in billions (negative = revenue loss/cost)</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-273"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-273"><span class="linenos">273</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-274"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-275"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-275"><span class="linenos">275</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-276"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-276"><span class="linenos">276</span></a>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-277"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-277"><span class="linenos">277</span></a>        <span class="c1"># Calculate cost from credit change and affected units</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-278"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_change_per_unit</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">units_affected_millions</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-279"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-279"><span class="linenos">279</span></a>            <span class="c1"># Simple calculation: change  units  participation</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-280"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-280"><span class="linenos">280</span></a>            <span class="n">static_cost</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-281"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-281"><span class="linenos">281</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">credit_change_per_unit</span> <span class="o">*</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-282"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-282"><span class="linenos">282</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">units_affected_millions</span> <span class="o">*</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-283"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-283"><span class="linenos">283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">participation_rate</span> <span class="o">*</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-284"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-284"><span class="linenos">284</span></a>                <span class="mf">1e6</span> <span class="o">/</span> <span class="mf">1e9</span>  <span class="c1"># Convert to billions</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-285"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-285"><span class="linenos">285</span></a>            <span class="p">)</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-286"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">static_cost</span>  <span class="c1"># Negative = costs money</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-287"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-287"><span class="linenos">287</span></a>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-288"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-288"><span class="linenos">288</span></a>        <span class="c1"># Calculate cost from making credit fully refundable</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-289"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_fully_refundable</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_type</span> <span class="o">==</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-290"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-290"><span class="linenos">290</span></a>            <span class="c1"># Currently ~$32B is refundable, full refundability would add more</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-291"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-291"><span class="linenos">291</span></a>            <span class="c1"># Rough estimate: ~60% of CTC is refundable, making rest refundable</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-292"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-292"><span class="linenos">292</span></a>            <span class="c1"># adds ~$50B/year</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-293"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-293"><span class="linenos">293</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mf">50.0</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-294"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-294"><span class="linenos">294</span></a>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-295"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-295"><span class="linenos">295</span></a>        <span class="c1"># Calculate cost from removing phase-out</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-296"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_phase_out</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-297"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-297"><span class="linenos">297</span></a>            <span class="c1"># Depends on credit type and current phase-out parameters</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-298"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-298"><span class="linenos">298</span></a>            <span class="c1"># For CTC: removes phase-out for high earners</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-299"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-299"><span class="linenos">299</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_type</span> <span class="o">==</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-300"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-300"><span class="linenos">300</span></a>                <span class="c1"># ~5% of filers in phase-out range, avg reduction ~$1,000/child</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-301"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-301"><span class="linenos">301</span></a>                <span class="k">return</span> <span class="o">-</span><span class="mf">5.0</span>  <span class="c1"># ~$5B/year</span>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-302"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-302"><span class="linenos">302</span></a>
</span><span id="TaxCreditPolicy.estimate_static_revenue_effect-303"><a href="#TaxCreditPolicy.estimate_static_revenue_effect-303"><span class="linenos">303</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span></pre></div>


            <div class="docstring"><p>Estimate static revenue effect of credit policy change.</p>

<p>For credits, revenue effect = change in credit cost (negative = cost).</p>

<p>Args:
    baseline_revenue: Baseline tax revenue (not directly used)
    use_real_data: Whether to use real data (not currently implemented)</p>

<p>Returns:
    Revenue change in billions (negative = revenue loss/cost)</p>
</div>


                            </div>
                            <div id="TaxCreditPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="TaxCreditPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TaxCreditPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxCreditPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxCreditPolicy.estimate_behavioral_offset-305"><a href="#TaxCreditPolicy.estimate_behavioral_offset-305"><span class="linenos">305</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-306"><a href="#TaxCreditPolicy.estimate_behavioral_offset-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-307"><a href="#TaxCreditPolicy.estimate_behavioral_offset-307"><span class="linenos">307</span></a><span class="sd">        Estimate behavioral response to credit changes.</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-308"><a href="#TaxCreditPolicy.estimate_behavioral_offset-308"><span class="linenos">308</span></a>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-309"><a href="#TaxCreditPolicy.estimate_behavioral_offset-309"><span class="linenos">309</span></a><span class="sd">        For refundable credits (especially EITC), there are significant</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-310"><a href="#TaxCreditPolicy.estimate_behavioral_offset-310"><span class="linenos">310</span></a><span class="sd">        labor supply effects:</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-311"><a href="#TaxCreditPolicy.estimate_behavioral_offset-311"><span class="linenos">311</span></a><span class="sd">        - EITC phase-in encourages work (positive labor supply)</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-312"><a href="#TaxCreditPolicy.estimate_behavioral_offset-312"><span class="linenos">312</span></a><span class="sd">        - EITC phase-out discourages work (negative labor supply)</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-313"><a href="#TaxCreditPolicy.estimate_behavioral_offset-313"><span class="linenos">313</span></a><span class="sd">        - Net effect on labor supply and therefore income tax revenue</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-314"><a href="#TaxCreditPolicy.estimate_behavioral_offset-314"><span class="linenos">314</span></a>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-315"><a href="#TaxCreditPolicy.estimate_behavioral_offset-315"><span class="linenos">315</span></a><span class="sd">        Returns:</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-316"><a href="#TaxCreditPolicy.estimate_behavioral_offset-316"><span class="linenos">316</span></a><span class="sd">            Behavioral offset in billions (positive = revenue lost)</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-317"><a href="#TaxCreditPolicy.estimate_behavioral_offset-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-318"><a href="#TaxCreditPolicy.estimate_behavioral_offset-318"><span class="linenos">318</span></a>        <span class="c1"># EITC has the largest labor supply effects</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-319"><a href="#TaxCreditPolicy.estimate_behavioral_offset-319"><span class="linenos">319</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_type</span> <span class="o">==</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">EARNED_INCOME_CREDIT</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-320"><a href="#TaxCreditPolicy.estimate_behavioral_offset-320"><span class="linenos">320</span></a>            <span class="c1"># Research shows EITC increases labor force participation</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-321"><a href="#TaxCreditPolicy.estimate_behavioral_offset-321"><span class="linenos">321</span></a>            <span class="c1"># This generates additional income tax + payroll tax revenue</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-322"><a href="#TaxCreditPolicy.estimate_behavioral_offset-322"><span class="linenos">322</span></a>            <span class="c1"># Offsetting ~10-15% of the cost</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-323"><a href="#TaxCreditPolicy.estimate_behavioral_offset-323"><span class="linenos">323</span></a>            <span class="k">return</span> <span class="n">static_effect</span> <span class="o">*</span> <span class="mf">0.12</span>  <span class="c1"># ~12% offset from labor supply</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-324"><a href="#TaxCreditPolicy.estimate_behavioral_offset-324"><span class="linenos">324</span></a>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-325"><a href="#TaxCreditPolicy.estimate_behavioral_offset-325"><span class="linenos">325</span></a>        <span class="c1"># CTC has smaller labor effects</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-326"><a href="#TaxCreditPolicy.estimate_behavioral_offset-326"><span class="linenos">326</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">credit_type</span> <span class="o">==</span> <span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">:</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-327"><a href="#TaxCreditPolicy.estimate_behavioral_offset-327"><span class="linenos">327</span></a>            <span class="c1"># Some income effects on secondary earners, but smaller</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-328"><a href="#TaxCreditPolicy.estimate_behavioral_offset-328"><span class="linenos">328</span></a>            <span class="k">return</span> <span class="n">static_effect</span> <span class="o">*</span> <span class="mf">0.05</span>  <span class="c1"># ~5% offset</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-329"><a href="#TaxCreditPolicy.estimate_behavioral_offset-329"><span class="linenos">329</span></a>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-330"><a href="#TaxCreditPolicy.estimate_behavioral_offset-330"><span class="linenos">330</span></a>        <span class="c1"># General credits</span>
</span><span id="TaxCreditPolicy.estimate_behavioral_offset-331"><a href="#TaxCreditPolicy.estimate_behavioral_offset-331"><span class="linenos">331</span></a>        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">labor_supply_elasticity</span> <span class="o">*</span> <span class="mf">0.3</span>
</span></pre></div>


            <div class="docstring"><p>Estimate behavioral response to credit changes.</p>

<p>For refundable credits (especially EITC), there are significant
labor supply effects:</p>

<ul>
<li>EITC phase-in encourages work (positive labor supply)</li>
<li>EITC phase-out discourages work (negative labor supply)</li>
<li>Net effect on labor supply and therefore income tax revenue</li>
</ul>

<p>Returns:
    Behavioral offset in billions (positive = revenue lost)</p>
</div>


                            </div>
                </section>
                <section id="CreditType">
                            <input id="CreditType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CreditType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="CreditType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CreditType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CreditType-31"><a href="#CreditType-31"><span class="linenos">31</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CreditType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="CreditType-32"><a href="#CreditType-32"><span class="linenos">32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Types of tax credits.&quot;&quot;&quot;</span>
</span><span id="CreditType-33"><a href="#CreditType-33"><span class="linenos">33</span></a>    <span class="n">CHILD_TAX_CREDIT</span> <span class="o">=</span> <span class="s2">&quot;ctc&quot;</span>
</span><span id="CreditType-34"><a href="#CreditType-34"><span class="linenos">34</span></a>    <span class="n">EARNED_INCOME_CREDIT</span> <span class="o">=</span> <span class="s2">&quot;eitc&quot;</span>
</span><span id="CreditType-35"><a href="#CreditType-35"><span class="linenos">35</span></a>    <span class="n">PREMIUM_TAX_CREDIT</span> <span class="o">=</span> <span class="s2">&quot;ptc&quot;</span>
</span><span id="CreditType-36"><a href="#CreditType-36"><span class="linenos">36</span></a>    <span class="n">EDUCATION_CREDIT</span> <span class="o">=</span> <span class="s2">&quot;education&quot;</span>
</span><span id="CreditType-37"><a href="#CreditType-37"><span class="linenos">37</span></a>    <span class="n">OTHER</span> <span class="o">=</span> <span class="s2">&quot;other&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Types of tax credits.</p>
</div>


                            <div id="CreditType.CHILD_TAX_CREDIT" class="classattr">
                                <div class="attr variable">
            <span class="name">CHILD_TAX_CREDIT</span>        =
<span class="default_value">&lt;<a href="#CreditType.CHILD_TAX_CREDIT">CreditType.CHILD_TAX_CREDIT</a>: &#39;ctc&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#CreditType.CHILD_TAX_CREDIT"></a>
    
    

                            </div>
                            <div id="CreditType.EARNED_INCOME_CREDIT" class="classattr">
                                <div class="attr variable">
            <span class="name">EARNED_INCOME_CREDIT</span>        =
<span class="default_value">&lt;<a href="#CreditType.EARNED_INCOME_CREDIT">CreditType.EARNED_INCOME_CREDIT</a>: &#39;eitc&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#CreditType.EARNED_INCOME_CREDIT"></a>
    
    

                            </div>
                            <div id="CreditType.PREMIUM_TAX_CREDIT" class="classattr">
                                <div class="attr variable">
            <span class="name">PREMIUM_TAX_CREDIT</span>        =
<span class="default_value">&lt;<a href="#CreditType.PREMIUM_TAX_CREDIT">CreditType.PREMIUM_TAX_CREDIT</a>: &#39;ptc&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#CreditType.PREMIUM_TAX_CREDIT"></a>
    
    

                            </div>
                            <div id="CreditType.EDUCATION_CREDIT" class="classattr">
                                <div class="attr variable">
            <span class="name">EDUCATION_CREDIT</span>        =
<span class="default_value">&lt;<a href="#CreditType.EDUCATION_CREDIT">CreditType.EDUCATION_CREDIT</a>: &#39;education&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#CreditType.EDUCATION_CREDIT"></a>
    
    

                            </div>
                            <div id="CreditType.OTHER" class="classattr">
                                <div class="attr variable">
            <span class="name">OTHER</span>        =
<span class="default_value">&lt;<a href="#CreditType.OTHER">CreditType.OTHER</a>: &#39;other&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#CreditType.OTHER"></a>
    
    

                            </div>
                </section>
                <section id="CTC_CURRENT_LAW">
                    <div class="attr variable">
            <span class="name">CTC_CURRENT_LAW</span>        =
<input id="CTC_CURRENT_LAW-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="CTC_CURRENT_LAW-view-value"></label><span class="default_value">{&#39;credit_per_child&#39;: 2000.0, &#39;refundable_max&#39;: 1700.0, &#39;refund_rate&#39;: 0.15, &#39;refund_threshold&#39;: 2500.0, &#39;phase_out_start_single&#39;: 200000.0, &#39;phase_out_start_married&#39;: 400000.0, &#39;phase_out_rate&#39;: 0.05, &#39;qualifying_age&#39;: 17, &#39;pre_tcja_credit&#39;: 1000.0, &#39;pre_tcja_refundable_max&#39;: 1000.0, &#39;pre_tcja_phase_out_single&#39;: 75000.0, &#39;pre_tcja_phase_out_married&#39;: 110000.0}</span>

        
    </div>
    <a class="headerlink" href="#CTC_CURRENT_LAW"></a>
    
    

                </section>
                <section id="EITC_CURRENT_LAW">
                    <div class="attr variable">
            <span class="name">EITC_CURRENT_LAW</span>        =
<input id="EITC_CURRENT_LAW-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="EITC_CURRENT_LAW-view-value"></label><span class="default_value">{0: {&#39;phase_in_rate&#39;: 0.0765, &#39;max_credit&#39;: 632.0, &#39;phase_in_end&#39;: 8260.0, &#39;phase_out_start_single&#39;: 10330.0, &#39;phase_out_start_married&#39;: 17580.0, &#39;phase_out_rate&#39;: 0.0765, &#39;income_limit_single&#39;: 18591.0, &#39;income_limit_married&#39;: 25511.0}, 1: {&#39;phase_in_rate&#39;: 0.34, &#39;max_credit&#39;: 4213.0, &#39;phase_in_end&#39;: 12390.0, &#39;phase_out_start_single&#39;: 22720.0, &#39;phase_out_start_married&#39;: 29970.0, &#39;phase_out_rate&#39;: 0.1598, &#39;income_limit_single&#39;: 49084.0, &#39;income_limit_married&#39;: 56004.0}, 2: {&#39;phase_in_rate&#39;: 0.4, &#39;max_credit&#39;: 6960.0, &#39;phase_in_end&#39;: 17400.0, &#39;phase_out_start_single&#39;: 22720.0, &#39;phase_out_start_married&#39;: 29970.0, &#39;phase_out_rate&#39;: 0.2106, &#39;income_limit_single&#39;: 55768.0, &#39;income_limit_married&#39;: 62688.0}, 3: {&#39;phase_in_rate&#39;: 0.45, &#39;max_credit&#39;: 7830.0, &#39;phase_in_end&#39;: 17400.0, &#39;phase_out_start_single&#39;: 22720.0, &#39;phase_out_start_married&#39;: 29970.0, &#39;phase_out_rate&#39;: 0.2106, &#39;income_limit_single&#39;: 59899.0, &#39;income_limit_married&#39;: 66819.0}}</span>

        
    </div>
    <a class="headerlink" href="#EITC_CURRENT_LAW"></a>
    
    

                </section>
                <section id="BASELINE_CREDIT_COSTS">
                    <div class="attr variable">
            <span class="name">BASELINE_CREDIT_COSTS</span>        =
<span class="default_value">{&#39;ctc_total&#39;: 120.0, &#39;ctc_refundable&#39;: 32.0, &#39;eitc_total&#39;: 70.0}</span>

        
    </div>
    <a class="headerlink" href="#BASELINE_CREDIT_COSTS"></a>
    
    

                </section>
                <section id="create_ctc_expansion">
                            <input id="create_ctc_expansion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_ctc_expansion</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">credit_per_child</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">fully_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">remove_phase_out</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxCreditPolicy">TaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_ctc_expansion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_ctc_expansion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_ctc_expansion-338"><a href="#create_ctc_expansion-338"><span class="linenos">338</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_ctc_expansion</span><span class="p">(</span>
</span><span id="create_ctc_expansion-339"><a href="#create_ctc_expansion-339"><span class="linenos">339</span></a>    <span class="n">credit_per_child</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_ctc_expansion-340"><a href="#create_ctc_expansion-340"><span class="linenos">340</span></a>    <span class="n">fully_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="create_ctc_expansion-341"><a href="#create_ctc_expansion-341"><span class="linenos">341</span></a>    <span class="n">remove_phase_out</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="create_ctc_expansion-342"><a href="#create_ctc_expansion-342"><span class="linenos">342</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_ctc_expansion-343"><a href="#create_ctc_expansion-343"><span class="linenos">343</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_ctc_expansion-344"><a href="#create_ctc_expansion-344"><span class="linenos">344</span></a>    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="create_ctc_expansion-345"><a href="#create_ctc_expansion-345"><span class="linenos">345</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_ctc_expansion-346"><a href="#create_ctc_expansion-346"><span class="linenos">346</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_ctc_expansion-347"><a href="#create_ctc_expansion-347"><span class="linenos">347</span></a><span class="sd">    Create a Child Tax Credit expansion policy.</span>
</span><span id="create_ctc_expansion-348"><a href="#create_ctc_expansion-348"><span class="linenos">348</span></a>
</span><span id="create_ctc_expansion-349"><a href="#create_ctc_expansion-349"><span class="linenos">349</span></a><span class="sd">    Args:</span>
</span><span id="create_ctc_expansion-350"><a href="#create_ctc_expansion-350"><span class="linenos">350</span></a><span class="sd">        credit_per_child: New credit amount per child</span>
</span><span id="create_ctc_expansion-351"><a href="#create_ctc_expansion-351"><span class="linenos">351</span></a><span class="sd">        fully_refundable: Whether to make credit fully refundable</span>
</span><span id="create_ctc_expansion-352"><a href="#create_ctc_expansion-352"><span class="linenos">352</span></a><span class="sd">        remove_phase_out: Whether to remove income phase-out</span>
</span><span id="create_ctc_expansion-353"><a href="#create_ctc_expansion-353"><span class="linenos">353</span></a><span class="sd">        start_year: First year of policy</span>
</span><span id="create_ctc_expansion-354"><a href="#create_ctc_expansion-354"><span class="linenos">354</span></a><span class="sd">        duration_years: Duration of policy</span>
</span><span id="create_ctc_expansion-355"><a href="#create_ctc_expansion-355"><span class="linenos">355</span></a><span class="sd">        name: Optional custom name</span>
</span><span id="create_ctc_expansion-356"><a href="#create_ctc_expansion-356"><span class="linenos">356</span></a>
</span><span id="create_ctc_expansion-357"><a href="#create_ctc_expansion-357"><span class="linenos">357</span></a><span class="sd">    Returns:</span>
</span><span id="create_ctc_expansion-358"><a href="#create_ctc_expansion-358"><span class="linenos">358</span></a><span class="sd">        TaxCreditPolicy configured for CTC expansion</span>
</span><span id="create_ctc_expansion-359"><a href="#create_ctc_expansion-359"><span class="linenos">359</span></a>
</span><span id="create_ctc_expansion-360"><a href="#create_ctc_expansion-360"><span class="linenos">360</span></a><span class="sd">    Example:</span>
</span><span id="create_ctc_expansion-361"><a href="#create_ctc_expansion-361"><span class="linenos">361</span></a><span class="sd">        # Biden 2021 ARP-style expansion</span>
</span><span id="create_ctc_expansion-362"><a href="#create_ctc_expansion-362"><span class="linenos">362</span></a><span class="sd">        policy = create_ctc_expansion(</span>
</span><span id="create_ctc_expansion-363"><a href="#create_ctc_expansion-363"><span class="linenos">363</span></a><span class="sd">            credit_per_child=3600,  # Was $2,000</span>
</span><span id="create_ctc_expansion-364"><a href="#create_ctc_expansion-364"><span class="linenos">364</span></a><span class="sd">            fully_refundable=True,</span>
</span><span id="create_ctc_expansion-365"><a href="#create_ctc_expansion-365"><span class="linenos">365</span></a><span class="sd">            name=&quot;Biden CTC Expansion&quot;</span>
</span><span id="create_ctc_expansion-366"><a href="#create_ctc_expansion-366"><span class="linenos">366</span></a><span class="sd">        )</span>
</span><span id="create_ctc_expansion-367"><a href="#create_ctc_expansion-367"><span class="linenos">367</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_ctc_expansion-368"><a href="#create_ctc_expansion-368"><span class="linenos">368</span></a>    <span class="n">current_credit</span> <span class="o">=</span> <span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;credit_per_child&quot;</span><span class="p">]</span>
</span><span id="create_ctc_expansion-369"><a href="#create_ctc_expansion-369"><span class="linenos">369</span></a>    <span class="n">credit_change</span> <span class="o">=</span> <span class="n">credit_per_child</span> <span class="o">-</span> <span class="n">current_credit</span>
</span><span id="create_ctc_expansion-370"><a href="#create_ctc_expansion-370"><span class="linenos">370</span></a>
</span><span id="create_ctc_expansion-371"><a href="#create_ctc_expansion-371"><span class="linenos">371</span></a>    <span class="k">return</span> <span class="n">TaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_ctc_expansion-372"><a href="#create_ctc_expansion-372"><span class="linenos">372</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;CTC Expansion to $</span><span class="si">{</span><span class="n">credit_per_child</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_ctc_expansion-373"><a href="#create_ctc_expansion-373"><span class="linenos">373</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Expand Child Tax Credit from $</span><span class="si">{</span><span class="n">current_credit</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> to &quot;</span>
</span><span id="create_ctc_expansion-374"><a href="#create_ctc_expansion-374"><span class="linenos">374</span></a>                   <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">credit_per_child</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> per child&quot;</span>
</span><span id="create_ctc_expansion-375"><a href="#create_ctc_expansion-375"><span class="linenos">375</span></a>                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, fully refundable&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">fully_refundable</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="create_ctc_expansion-376"><a href="#create_ctc_expansion-376"><span class="linenos">376</span></a>                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, remove phase-out&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">remove_phase_out</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_ctc_expansion-377"><a href="#create_ctc_expansion-377"><span class="linenos">377</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_ctc_expansion-378"><a href="#create_ctc_expansion-378"><span class="linenos">378</span></a>        <span class="n">credit_type</span><span class="o">=</span><span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_ctc_expansion-379"><a href="#create_ctc_expansion-379"><span class="linenos">379</span></a>        <span class="n">is_partially_refundable</span><span class="o">=</span><span class="ow">not</span> <span class="n">fully_refundable</span><span class="p">,</span>
</span><span id="create_ctc_expansion-380"><a href="#create_ctc_expansion-380"><span class="linenos">380</span></a>        <span class="n">max_credit_per_unit</span><span class="o">=</span><span class="n">credit_per_child</span><span class="p">,</span>
</span><span id="create_ctc_expansion-381"><a href="#create_ctc_expansion-381"><span class="linenos">381</span></a>        <span class="n">credit_change_per_unit</span><span class="o">=</span><span class="n">credit_change</span><span class="p">,</span>
</span><span id="create_ctc_expansion-382"><a href="#create_ctc_expansion-382"><span class="linenos">382</span></a>        <span class="n">units_affected_millions</span><span class="o">=</span><span class="n">CREDIT_RECIPIENT_COUNTS</span><span class="p">[</span><span class="s2">&quot;ctc_children&quot;</span><span class="p">],</span>
</span><span id="create_ctc_expansion-383"><a href="#create_ctc_expansion-383"><span class="linenos">383</span></a>        <span class="n">has_phase_out</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_ctc_expansion-384"><a href="#create_ctc_expansion-384"><span class="linenos">384</span></a>        <span class="n">phase_out_threshold_single</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;phase_out_start_single&quot;</span><span class="p">],</span>
</span><span id="create_ctc_expansion-385"><a href="#create_ctc_expansion-385"><span class="linenos">385</span></a>        <span class="n">phase_out_threshold_married</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;phase_out_start_married&quot;</span><span class="p">],</span>
</span><span id="create_ctc_expansion-386"><a href="#create_ctc_expansion-386"><span class="linenos">386</span></a>        <span class="n">phase_out_rate</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;phase_out_rate&quot;</span><span class="p">],</span>
</span><span id="create_ctc_expansion-387"><a href="#create_ctc_expansion-387"><span class="linenos">387</span></a>        <span class="n">refundable_max</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;refundable_max&quot;</span><span class="p">],</span>
</span><span id="create_ctc_expansion-388"><a href="#create_ctc_expansion-388"><span class="linenos">388</span></a>        <span class="n">refund_rate</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;refund_rate&quot;</span><span class="p">],</span>
</span><span id="create_ctc_expansion-389"><a href="#create_ctc_expansion-389"><span class="linenos">389</span></a>        <span class="n">refund_threshold</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;refund_threshold&quot;</span><span class="p">],</span>
</span><span id="create_ctc_expansion-390"><a href="#create_ctc_expansion-390"><span class="linenos">390</span></a>        <span class="n">make_fully_refundable</span><span class="o">=</span><span class="n">fully_refundable</span><span class="p">,</span>
</span><span id="create_ctc_expansion-391"><a href="#create_ctc_expansion-391"><span class="linenos">391</span></a>        <span class="n">remove_phase_out</span><span class="o">=</span><span class="n">remove_phase_out</span><span class="p">,</span>
</span><span id="create_ctc_expansion-392"><a href="#create_ctc_expansion-392"><span class="linenos">392</span></a>        <span class="n">participation_rate</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span>  <span class="c1"># CTC has high take-up</span>
</span><span id="create_ctc_expansion-393"><a href="#create_ctc_expansion-393"><span class="linenos">393</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_ctc_expansion-394"><a href="#create_ctc_expansion-394"><span class="linenos">394</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_ctc_expansion-395"><a href="#create_ctc_expansion-395"><span class="linenos">395</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a Child Tax Credit expansion policy.</p>

<p>Args:
    credit_per_child: New credit amount per child
    fully_refundable: Whether to make credit fully refundable
    remove_phase_out: Whether to remove income phase-out
    start_year: First year of policy
    duration_years: Duration of policy
    name: Optional custom name</p>

<p>Returns:
    TaxCreditPolicy configured for CTC expansion</p>

<p>Example:
    # Biden 2021 ARP-style expansion
    policy = create_ctc_expansion(
        credit_per_child=3600,  # Was $2,000
        fully_refundable=True,
        name="Biden CTC Expansion"
    )</p>
</div>


                </section>
                <section id="create_biden_ctc_2021">
                            <input id="create_biden_ctc_2021-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_biden_ctc_2021</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#TaxCreditPolicy">TaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_biden_ctc_2021-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_biden_ctc_2021"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_biden_ctc_2021-398"><a href="#create_biden_ctc_2021-398"><span class="linenos">398</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_biden_ctc_2021</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">TaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_biden_ctc_2021-399"><a href="#create_biden_ctc_2021-399"><span class="linenos">399</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_biden_ctc_2021-400"><a href="#create_biden_ctc_2021-400"><span class="linenos">400</span></a><span class="sd">    Create the Biden 2021 American Rescue Plan CTC expansion.</span>
</span><span id="create_biden_ctc_2021-401"><a href="#create_biden_ctc_2021-401"><span class="linenos">401</span></a>
</span><span id="create_biden_ctc_2021-402"><a href="#create_biden_ctc_2021-402"><span class="linenos">402</span></a><span class="sd">    Key features:</span>
</span><span id="create_biden_ctc_2021-403"><a href="#create_biden_ctc_2021-403"><span class="linenos">403</span></a><span class="sd">    - $3,600 per child under 6, $3,000 per child 6-17</span>
</span><span id="create_biden_ctc_2021-404"><a href="#create_biden_ctc_2021-404"><span class="linenos">404</span></a><span class="sd">    - Fully refundable (no earnings requirement)</span>
</span><span id="create_biden_ctc_2021-405"><a href="#create_biden_ctc_2021-405"><span class="linenos">405</span></a><span class="sd">    - Monthly advance payments</span>
</span><span id="create_biden_ctc_2021-406"><a href="#create_biden_ctc_2021-406"><span class="linenos">406</span></a>
</span><span id="create_biden_ctc_2021-407"><a href="#create_biden_ctc_2021-407"><span class="linenos">407</span></a><span class="sd">    CBO estimated 1-year cost: ~$110B (for 2021)</span>
</span><span id="create_biden_ctc_2021-408"><a href="#create_biden_ctc_2021-408"><span class="linenos">408</span></a><span class="sd">    Permanent expansion would cost ~$1.6T over 10 years</span>
</span><span id="create_biden_ctc_2021-409"><a href="#create_biden_ctc_2021-409"><span class="linenos">409</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_biden_ctc_2021-410"><a href="#create_biden_ctc_2021-410"><span class="linenos">410</span></a>    <span class="c1"># Use average credit (weighted by child age distribution)</span>
</span><span id="create_biden_ctc_2021-411"><a href="#create_biden_ctc_2021-411"><span class="linenos">411</span></a>    <span class="n">avg_credit</span> <span class="o">=</span> <span class="mi">3300</span>  <span class="c1"># Weighted average of $3,600 and $3,000</span>
</span><span id="create_biden_ctc_2021-412"><a href="#create_biden_ctc_2021-412"><span class="linenos">412</span></a>
</span><span id="create_biden_ctc_2021-413"><a href="#create_biden_ctc_2021-413"><span class="linenos">413</span></a>    <span class="k">return</span> <span class="n">TaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_biden_ctc_2021-414"><a href="#create_biden_ctc_2021-414"><span class="linenos">414</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Biden CTC 2021 (ARP-style)&quot;</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-415"><a href="#create_biden_ctc_2021-415"><span class="linenos">415</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Expand CTC to $3,600 (under 6) / $3,000 (6-17), fully refundable&quot;</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-416"><a href="#create_biden_ctc_2021-416"><span class="linenos">416</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-417"><a href="#create_biden_ctc_2021-417"><span class="linenos">417</span></a>        <span class="n">credit_type</span><span class="o">=</span><span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-418"><a href="#create_biden_ctc_2021-418"><span class="linenos">418</span></a>        <span class="n">is_refundable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-419"><a href="#create_biden_ctc_2021-419"><span class="linenos">419</span></a>        <span class="n">max_credit_per_unit</span><span class="o">=</span><span class="n">avg_credit</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-420"><a href="#create_biden_ctc_2021-420"><span class="linenos">420</span></a>        <span class="n">credit_change_per_unit</span><span class="o">=</span><span class="n">avg_credit</span> <span class="o">-</span> <span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;credit_per_child&quot;</span><span class="p">],</span>
</span><span id="create_biden_ctc_2021-421"><a href="#create_biden_ctc_2021-421"><span class="linenos">421</span></a>        <span class="n">units_affected_millions</span><span class="o">=</span><span class="n">CREDIT_RECIPIENT_COUNTS</span><span class="p">[</span><span class="s2">&quot;ctc_children&quot;</span><span class="p">],</span>
</span><span id="create_biden_ctc_2021-422"><a href="#create_biden_ctc_2021-422"><span class="linenos">422</span></a>        <span class="n">has_phase_out</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-423"><a href="#create_biden_ctc_2021-423"><span class="linenos">423</span></a>        <span class="n">phase_out_threshold_single</span><span class="o">=</span><span class="mf">75000.0</span><span class="p">,</span>  <span class="c1"># ARP lowered thresholds</span>
</span><span id="create_biden_ctc_2021-424"><a href="#create_biden_ctc_2021-424"><span class="linenos">424</span></a>        <span class="n">phase_out_threshold_married</span><span class="o">=</span><span class="mf">150000.0</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-425"><a href="#create_biden_ctc_2021-425"><span class="linenos">425</span></a>        <span class="n">phase_out_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-426"><a href="#create_biden_ctc_2021-426"><span class="linenos">426</span></a>        <span class="n">make_fully_refundable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-427"><a href="#create_biden_ctc_2021-427"><span class="linenos">427</span></a>        <span class="n">participation_rate</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span>  <span class="c1"># High due to advance payments</span>
</span><span id="create_biden_ctc_2021-428"><a href="#create_biden_ctc_2021-428"><span class="linenos">428</span></a>        <span class="c1"># Calibrated to match CBO ~$1.6T over 10 years permanent</span>
</span><span id="create_biden_ctc_2021-429"><a href="#create_biden_ctc_2021-429"><span class="linenos">429</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">160.0</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-430"><a href="#create_biden_ctc_2021-430"><span class="linenos">430</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2025</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-431"><a href="#create_biden_ctc_2021-431"><span class="linenos">431</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_biden_ctc_2021-432"><a href="#create_biden_ctc_2021-432"><span class="linenos">432</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create the Biden 2021 American Rescue Plan CTC expansion.</p>

<p>Key features:</p>

<ul>
<li>$3,600 per child under 6, $3,000 per child 6-17</li>
<li>Fully refundable (no earnings requirement)</li>
<li>Monthly advance payments</li>
</ul>

<p>CBO estimated 1-year cost: ~$110B (for 2021)
Permanent expansion would cost ~$1.6T over 10 years</p>
</div>


                </section>
                <section id="create_ctc_permanent_extension">
                            <input id="create_ctc_permanent_extension-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_ctc_permanent_extension</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#TaxCreditPolicy">TaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_ctc_permanent_extension-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_ctc_permanent_extension"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_ctc_permanent_extension-435"><a href="#create_ctc_permanent_extension-435"><span class="linenos">435</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_ctc_permanent_extension</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">TaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_ctc_permanent_extension-436"><a href="#create_ctc_permanent_extension-436"><span class="linenos">436</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_ctc_permanent_extension-437"><a href="#create_ctc_permanent_extension-437"><span class="linenos">437</span></a><span class="sd">    Extend current CTC provisions beyond 2025 sunset.</span>
</span><span id="create_ctc_permanent_extension-438"><a href="#create_ctc_permanent_extension-438"><span class="linenos">438</span></a>
</span><span id="create_ctc_permanent_extension-439"><a href="#create_ctc_permanent_extension-439"><span class="linenos">439</span></a><span class="sd">    Without extension, CTC reverts to:</span>
</span><span id="create_ctc_permanent_extension-440"><a href="#create_ctc_permanent_extension-440"><span class="linenos">440</span></a><span class="sd">    - $1,000 per child (from $2,000)</span>
</span><span id="create_ctc_permanent_extension-441"><a href="#create_ctc_permanent_extension-441"><span class="linenos">441</span></a><span class="sd">    - Lower phase-out thresholds</span>
</span><span id="create_ctc_permanent_extension-442"><a href="#create_ctc_permanent_extension-442"><span class="linenos">442</span></a><span class="sd">    - Less refundability</span>
</span><span id="create_ctc_permanent_extension-443"><a href="#create_ctc_permanent_extension-443"><span class="linenos">443</span></a>
</span><span id="create_ctc_permanent_extension-444"><a href="#create_ctc_permanent_extension-444"><span class="linenos">444</span></a><span class="sd">    CBO estimate: Extension costs ~$600B over 10 years</span>
</span><span id="create_ctc_permanent_extension-445"><a href="#create_ctc_permanent_extension-445"><span class="linenos">445</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_ctc_permanent_extension-446"><a href="#create_ctc_permanent_extension-446"><span class="linenos">446</span></a>    <span class="k">return</span> <span class="n">TaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_ctc_permanent_extension-447"><a href="#create_ctc_permanent_extension-447"><span class="linenos">447</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;CTC Permanent Extension&quot;</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-448"><a href="#create_ctc_permanent_extension-448"><span class="linenos">448</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extend current $2,000 CTC beyond 2025 sunset&quot;</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-449"><a href="#create_ctc_permanent_extension-449"><span class="linenos">449</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-450"><a href="#create_ctc_permanent_extension-450"><span class="linenos">450</span></a>        <span class="n">credit_type</span><span class="o">=</span><span class="n">CreditType</span><span class="o">.</span><span class="n">CHILD_TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-451"><a href="#create_ctc_permanent_extension-451"><span class="linenos">451</span></a>        <span class="n">is_partially_refundable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-452"><a href="#create_ctc_permanent_extension-452"><span class="linenos">452</span></a>        <span class="n">max_credit_per_unit</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;credit_per_child&quot;</span><span class="p">],</span>
</span><span id="create_ctc_permanent_extension-453"><a href="#create_ctc_permanent_extension-453"><span class="linenos">453</span></a>        <span class="c1"># Change from pre-TCJA baseline</span>
</span><span id="create_ctc_permanent_extension-454"><a href="#create_ctc_permanent_extension-454"><span class="linenos">454</span></a>        <span class="n">credit_change_per_unit</span><span class="o">=</span><span class="p">(</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;credit_per_child&quot;</span><span class="p">]</span> <span class="o">-</span>
</span><span id="create_ctc_permanent_extension-455"><a href="#create_ctc_permanent_extension-455"><span class="linenos">455</span></a>                               <span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;pre_tcja_credit&quot;</span><span class="p">]),</span>
</span><span id="create_ctc_permanent_extension-456"><a href="#create_ctc_permanent_extension-456"><span class="linenos">456</span></a>        <span class="n">units_affected_millions</span><span class="o">=</span><span class="n">CREDIT_RECIPIENT_COUNTS</span><span class="p">[</span><span class="s2">&quot;ctc_children&quot;</span><span class="p">],</span>
</span><span id="create_ctc_permanent_extension-457"><a href="#create_ctc_permanent_extension-457"><span class="linenos">457</span></a>        <span class="n">has_phase_out</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-458"><a href="#create_ctc_permanent_extension-458"><span class="linenos">458</span></a>        <span class="n">phase_out_threshold_single</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;phase_out_start_single&quot;</span><span class="p">],</span>
</span><span id="create_ctc_permanent_extension-459"><a href="#create_ctc_permanent_extension-459"><span class="linenos">459</span></a>        <span class="n">phase_out_threshold_married</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;phase_out_start_married&quot;</span><span class="p">],</span>
</span><span id="create_ctc_permanent_extension-460"><a href="#create_ctc_permanent_extension-460"><span class="linenos">460</span></a>        <span class="n">phase_out_rate</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;phase_out_rate&quot;</span><span class="p">],</span>
</span><span id="create_ctc_permanent_extension-461"><a href="#create_ctc_permanent_extension-461"><span class="linenos">461</span></a>        <span class="n">refundable_max</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;refundable_max&quot;</span><span class="p">],</span>
</span><span id="create_ctc_permanent_extension-462"><a href="#create_ctc_permanent_extension-462"><span class="linenos">462</span></a>        <span class="n">refund_rate</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;refund_rate&quot;</span><span class="p">],</span>
</span><span id="create_ctc_permanent_extension-463"><a href="#create_ctc_permanent_extension-463"><span class="linenos">463</span></a>        <span class="n">refund_threshold</span><span class="o">=</span><span class="n">CTC_CURRENT_LAW</span><span class="p">[</span><span class="s2">&quot;refund_threshold&quot;</span><span class="p">],</span>
</span><span id="create_ctc_permanent_extension-464"><a href="#create_ctc_permanent_extension-464"><span class="linenos">464</span></a>        <span class="n">participation_rate</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-465"><a href="#create_ctc_permanent_extension-465"><span class="linenos">465</span></a>        <span class="c1"># Calibrated to CBO ~$600B over 10 years</span>
</span><span id="create_ctc_permanent_extension-466"><a href="#create_ctc_permanent_extension-466"><span class="linenos">466</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">60.0</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-467"><a href="#create_ctc_permanent_extension-467"><span class="linenos">467</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2026</span><span class="p">,</span>  <span class="c1"># After sunset</span>
</span><span id="create_ctc_permanent_extension-468"><a href="#create_ctc_permanent_extension-468"><span class="linenos">468</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_ctc_permanent_extension-469"><a href="#create_ctc_permanent_extension-469"><span class="linenos">469</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Extend current CTC provisions beyond 2025 sunset.</p>

<p>Without extension, CTC reverts to:</p>

<ul>
<li>$1,000 per child (from $2,000)</li>
<li>Lower phase-out thresholds</li>
<li>Less refundability</li>
</ul>

<p>CBO estimate: Extension costs ~$600B over 10 years</p>
</div>


                </section>
                <section id="create_eitc_expansion">
                            <input id="create_eitc_expansion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_eitc_expansion</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">childless_max_increase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">with_children_increase_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">expand_age_range</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxCreditPolicy">TaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_eitc_expansion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_eitc_expansion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_eitc_expansion-472"><a href="#create_eitc_expansion-472"><span class="linenos">472</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_eitc_expansion</span><span class="p">(</span>
</span><span id="create_eitc_expansion-473"><a href="#create_eitc_expansion-473"><span class="linenos">473</span></a>    <span class="n">childless_max_increase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_eitc_expansion-474"><a href="#create_eitc_expansion-474"><span class="linenos">474</span></a>    <span class="n">with_children_increase_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_eitc_expansion-475"><a href="#create_eitc_expansion-475"><span class="linenos">475</span></a>    <span class="n">expand_age_range</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="create_eitc_expansion-476"><a href="#create_eitc_expansion-476"><span class="linenos">476</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_eitc_expansion-477"><a href="#create_eitc_expansion-477"><span class="linenos">477</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_eitc_expansion-478"><a href="#create_eitc_expansion-478"><span class="linenos">478</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_eitc_expansion-479"><a href="#create_eitc_expansion-479"><span class="linenos">479</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_eitc_expansion-480"><a href="#create_eitc_expansion-480"><span class="linenos">480</span></a><span class="sd">    Create an EITC expansion policy.</span>
</span><span id="create_eitc_expansion-481"><a href="#create_eitc_expansion-481"><span class="linenos">481</span></a>
</span><span id="create_eitc_expansion-482"><a href="#create_eitc_expansion-482"><span class="linenos">482</span></a><span class="sd">    Args:</span>
</span><span id="create_eitc_expansion-483"><a href="#create_eitc_expansion-483"><span class="linenos">483</span></a><span class="sd">        childless_max_increase: Dollar increase in max credit for childless</span>
</span><span id="create_eitc_expansion-484"><a href="#create_eitc_expansion-484"><span class="linenos">484</span></a><span class="sd">        with_children_increase_pct: Percent increase in max credit with children</span>
</span><span id="create_eitc_expansion-485"><a href="#create_eitc_expansion-485"><span class="linenos">485</span></a><span class="sd">        expand_age_range: Include ages 19-24 and 65+ (currently 25-64 for childless)</span>
</span><span id="create_eitc_expansion-486"><a href="#create_eitc_expansion-486"><span class="linenos">486</span></a><span class="sd">        start_year: First year of policy</span>
</span><span id="create_eitc_expansion-487"><a href="#create_eitc_expansion-487"><span class="linenos">487</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_eitc_expansion-488"><a href="#create_eitc_expansion-488"><span class="linenos">488</span></a>
</span><span id="create_eitc_expansion-489"><a href="#create_eitc_expansion-489"><span class="linenos">489</span></a><span class="sd">    Returns:</span>
</span><span id="create_eitc_expansion-490"><a href="#create_eitc_expansion-490"><span class="linenos">490</span></a><span class="sd">        TaxCreditPolicy for EITC expansion</span>
</span><span id="create_eitc_expansion-491"><a href="#create_eitc_expansion-491"><span class="linenos">491</span></a>
</span><span id="create_eitc_expansion-492"><a href="#create_eitc_expansion-492"><span class="linenos">492</span></a><span class="sd">    Example:</span>
</span><span id="create_eitc_expansion-493"><a href="#create_eitc_expansion-493"><span class="linenos">493</span></a><span class="sd">        # Biden childless worker expansion</span>
</span><span id="create_eitc_expansion-494"><a href="#create_eitc_expansion-494"><span class="linenos">494</span></a><span class="sd">        policy = create_eitc_expansion(</span>
</span><span id="create_eitc_expansion-495"><a href="#create_eitc_expansion-495"><span class="linenos">495</span></a><span class="sd">            childless_max_increase=1100,  # Roughly triple current</span>
</span><span id="create_eitc_expansion-496"><a href="#create_eitc_expansion-496"><span class="linenos">496</span></a><span class="sd">            expand_age_range=True,</span>
</span><span id="create_eitc_expansion-497"><a href="#create_eitc_expansion-497"><span class="linenos">497</span></a><span class="sd">        )</span>
</span><span id="create_eitc_expansion-498"><a href="#create_eitc_expansion-498"><span class="linenos">498</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_eitc_expansion-499"><a href="#create_eitc_expansion-499"><span class="linenos">499</span></a>    <span class="c1"># Calculate cost based on parameters</span>
</span><span id="create_eitc_expansion-500"><a href="#create_eitc_expansion-500"><span class="linenos">500</span></a>    <span class="k">if</span> <span class="n">childless_max_increase</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="create_eitc_expansion-501"><a href="#create_eitc_expansion-501"><span class="linenos">501</span></a>        <span class="c1"># ~9M childless EITC recipients, avg credit ~$600</span>
</span><span id="create_eitc_expansion-502"><a href="#create_eitc_expansion-502"><span class="linenos">502</span></a>        <span class="n">childless_cost</span> <span class="o">=</span> <span class="p">(</span><span class="n">childless_max_increase</span> <span class="o">*</span>
</span><span id="create_eitc_expansion-503"><a href="#create_eitc_expansion-503"><span class="linenos">503</span></a>                         <span class="n">CREDIT_RECIPIENT_COUNTS</span><span class="p">[</span><span class="s2">&quot;eitc_childless&quot;</span><span class="p">]</span> <span class="o">*</span>
</span><span id="create_eitc_expansion-504"><a href="#create_eitc_expansion-504"><span class="linenos">504</span></a>                         <span class="mf">0.85</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># billions</span>
</span><span id="create_eitc_expansion-505"><a href="#create_eitc_expansion-505"><span class="linenos">505</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="create_eitc_expansion-506"><a href="#create_eitc_expansion-506"><span class="linenos">506</span></a>        <span class="n">childless_cost</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="create_eitc_expansion-507"><a href="#create_eitc_expansion-507"><span class="linenos">507</span></a>
</span><span id="create_eitc_expansion-508"><a href="#create_eitc_expansion-508"><span class="linenos">508</span></a>    <span class="k">if</span> <span class="n">with_children_increase_pct</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="create_eitc_expansion-509"><a href="#create_eitc_expansion-509"><span class="linenos">509</span></a>        <span class="c1"># ~22M filers with children, avg credit ~$3,000</span>
</span><span id="create_eitc_expansion-510"><a href="#create_eitc_expansion-510"><span class="linenos">510</span></a>        <span class="n">current_with_children_cost</span> <span class="o">=</span> <span class="mf">22.0</span> <span class="o">*</span> <span class="mf">3.0</span>  <span class="c1"># ~$66B</span>
</span><span id="create_eitc_expansion-511"><a href="#create_eitc_expansion-511"><span class="linenos">511</span></a>        <span class="n">with_children_cost</span> <span class="o">=</span> <span class="n">current_with_children_cost</span> <span class="o">*</span> <span class="n">with_children_increase_pct</span>
</span><span id="create_eitc_expansion-512"><a href="#create_eitc_expansion-512"><span class="linenos">512</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="create_eitc_expansion-513"><a href="#create_eitc_expansion-513"><span class="linenos">513</span></a>        <span class="n">with_children_cost</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="create_eitc_expansion-514"><a href="#create_eitc_expansion-514"><span class="linenos">514</span></a>
</span><span id="create_eitc_expansion-515"><a href="#create_eitc_expansion-515"><span class="linenos">515</span></a>    <span class="k">if</span> <span class="n">expand_age_range</span><span class="p">:</span>
</span><span id="create_eitc_expansion-516"><a href="#create_eitc_expansion-516"><span class="linenos">516</span></a>        <span class="c1"># Adds ~5M eligible filers (ages 19-24 and 65+)</span>
</span><span id="create_eitc_expansion-517"><a href="#create_eitc_expansion-517"><span class="linenos">517</span></a>        <span class="n">age_expansion_cost</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="mi">1</span>  <span class="c1"># ~$1.5B/year</span>
</span><span id="create_eitc_expansion-518"><a href="#create_eitc_expansion-518"><span class="linenos">518</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="create_eitc_expansion-519"><a href="#create_eitc_expansion-519"><span class="linenos">519</span></a>        <span class="n">age_expansion_cost</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="create_eitc_expansion-520"><a href="#create_eitc_expansion-520"><span class="linenos">520</span></a>
</span><span id="create_eitc_expansion-521"><a href="#create_eitc_expansion-521"><span class="linenos">521</span></a>    <span class="n">total_cost</span> <span class="o">=</span> <span class="n">childless_cost</span> <span class="o">+</span> <span class="n">with_children_cost</span> <span class="o">+</span> <span class="n">age_expansion_cost</span>
</span><span id="create_eitc_expansion-522"><a href="#create_eitc_expansion-522"><span class="linenos">522</span></a>
</span><span id="create_eitc_expansion-523"><a href="#create_eitc_expansion-523"><span class="linenos">523</span></a>    <span class="c1"># Build description</span>
</span><span id="create_eitc_expansion-524"><a href="#create_eitc_expansion-524"><span class="linenos">524</span></a>    <span class="n">desc_parts</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="create_eitc_expansion-525"><a href="#create_eitc_expansion-525"><span class="linenos">525</span></a>    <span class="k">if</span> <span class="n">childless_max_increase</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="create_eitc_expansion-526"><a href="#create_eitc_expansion-526"><span class="linenos">526</span></a>        <span class="n">desc_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;+$</span><span class="si">{</span><span class="n">childless_max_increase</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> max for childless&quot;</span><span class="p">)</span>
</span><span id="create_eitc_expansion-527"><a href="#create_eitc_expansion-527"><span class="linenos">527</span></a>    <span class="k">if</span> <span class="n">with_children_increase_pct</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="create_eitc_expansion-528"><a href="#create_eitc_expansion-528"><span class="linenos">528</span></a>        <span class="n">desc_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="n">with_children_increase_pct</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% for families&quot;</span><span class="p">)</span>
</span><span id="create_eitc_expansion-529"><a href="#create_eitc_expansion-529"><span class="linenos">529</span></a>    <span class="k">if</span> <span class="n">expand_age_range</span><span class="p">:</span>
</span><span id="create_eitc_expansion-530"><a href="#create_eitc_expansion-530"><span class="linenos">530</span></a>        <span class="n">desc_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;expand age 19-24/65+&quot;</span><span class="p">)</span>
</span><span id="create_eitc_expansion-531"><a href="#create_eitc_expansion-531"><span class="linenos">531</span></a>
</span><span id="create_eitc_expansion-532"><a href="#create_eitc_expansion-532"><span class="linenos">532</span></a>    <span class="k">return</span> <span class="n">TaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_eitc_expansion-533"><a href="#create_eitc_expansion-533"><span class="linenos">533</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;EITC Expansion&quot;</span><span class="p">,</span>
</span><span id="create_eitc_expansion-534"><a href="#create_eitc_expansion-534"><span class="linenos">534</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Expand EITC: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">desc_parts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_eitc_expansion-535"><a href="#create_eitc_expansion-535"><span class="linenos">535</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_eitc_expansion-536"><a href="#create_eitc_expansion-536"><span class="linenos">536</span></a>        <span class="n">credit_type</span><span class="o">=</span><span class="n">CreditType</span><span class="o">.</span><span class="n">EARNED_INCOME_CREDIT</span><span class="p">,</span>
</span><span id="create_eitc_expansion-537"><a href="#create_eitc_expansion-537"><span class="linenos">537</span></a>        <span class="n">is_refundable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># EITC is fully refundable</span>
</span><span id="create_eitc_expansion-538"><a href="#create_eitc_expansion-538"><span class="linenos">538</span></a>        <span class="n">has_phase_in</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_eitc_expansion-539"><a href="#create_eitc_expansion-539"><span class="linenos">539</span></a>        <span class="n">has_phase_out</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_eitc_expansion-540"><a href="#create_eitc_expansion-540"><span class="linenos">540</span></a>        <span class="n">participation_rate</span><span class="o">=</span><span class="mf">0.80</span><span class="p">,</span>  <span class="c1"># EITC has lower take-up than CTC</span>
</span><span id="create_eitc_expansion-541"><a href="#create_eitc_expansion-541"><span class="linenos">541</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># EITC has strong labor effects</span>
</span><span id="create_eitc_expansion-542"><a href="#create_eitc_expansion-542"><span class="linenos">542</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="n">total_cost</span><span class="p">,</span>
</span><span id="create_eitc_expansion-543"><a href="#create_eitc_expansion-543"><span class="linenos">543</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_eitc_expansion-544"><a href="#create_eitc_expansion-544"><span class="linenos">544</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_eitc_expansion-545"><a href="#create_eitc_expansion-545"><span class="linenos">545</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create an EITC expansion policy.</p>

<p>Args:
    childless_max_increase: Dollar increase in max credit for childless
    with_children_increase_pct: Percent increase in max credit with children
    expand_age_range: Include ages 19-24 and 65+ (currently 25-64 for childless)
    start_year: First year of policy
    duration_years: Duration</p>

<p>Returns:
    TaxCreditPolicy for EITC expansion</p>

<p>Example:
    # Biden childless worker expansion
    policy = create_eitc_expansion(
        childless_max_increase=1100,  # Roughly triple current
        expand_age_range=True,
    )</p>
</div>


                </section>
                <section id="create_biden_eitc_childless">
                            <input id="create_biden_eitc_childless-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_biden_eitc_childless</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#TaxCreditPolicy">TaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_biden_eitc_childless-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_biden_eitc_childless"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_biden_eitc_childless-548"><a href="#create_biden_eitc_childless-548"><span class="linenos">548</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_biden_eitc_childless</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">TaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_biden_eitc_childless-549"><a href="#create_biden_eitc_childless-549"><span class="linenos">549</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_biden_eitc_childless-550"><a href="#create_biden_eitc_childless-550"><span class="linenos">550</span></a><span class="sd">    Create Biden proposal to expand EITC for childless workers.</span>
</span><span id="create_biden_eitc_childless-551"><a href="#create_biden_eitc_childless-551"><span class="linenos">551</span></a>
</span><span id="create_biden_eitc_childless-552"><a href="#create_biden_eitc_childless-552"><span class="linenos">552</span></a><span class="sd">    Key features:</span>
</span><span id="create_biden_eitc_childless-553"><a href="#create_biden_eitc_childless-553"><span class="linenos">553</span></a><span class="sd">    - Nearly triple max credit (~$1,500 from $600)</span>
</span><span id="create_biden_eitc_childless-554"><a href="#create_biden_eitc_childless-554"><span class="linenos">554</span></a><span class="sd">    - Expand age range to 19-24 and 65+</span>
</span><span id="create_biden_eitc_childless-555"><a href="#create_biden_eitc_childless-555"><span class="linenos">555</span></a><span class="sd">    - Lower phase-in start ($9,820 to $2,500)</span>
</span><span id="create_biden_eitc_childless-556"><a href="#create_biden_eitc_childless-556"><span class="linenos">556</span></a>
</span><span id="create_biden_eitc_childless-557"><a href="#create_biden_eitc_childless-557"><span class="linenos">557</span></a><span class="sd">    CBO/Treasury estimate: ~$178B over 10 years</span>
</span><span id="create_biden_eitc_childless-558"><a href="#create_biden_eitc_childless-558"><span class="linenos">558</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_biden_eitc_childless-559"><a href="#create_biden_eitc_childless-559"><span class="linenos">559</span></a>    <span class="k">return</span> <span class="n">TaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_biden_eitc_childless-560"><a href="#create_biden_eitc_childless-560"><span class="linenos">560</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Biden EITC Childless Expansion&quot;</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-561"><a href="#create_biden_eitc_childless-561"><span class="linenos">561</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Triple max credit to ~$1,500, expand age range 19-65+&quot;</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-562"><a href="#create_biden_eitc_childless-562"><span class="linenos">562</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-563"><a href="#create_biden_eitc_childless-563"><span class="linenos">563</span></a>        <span class="n">credit_type</span><span class="o">=</span><span class="n">CreditType</span><span class="o">.</span><span class="n">EARNED_INCOME_CREDIT</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-564"><a href="#create_biden_eitc_childless-564"><span class="linenos">564</span></a>        <span class="n">is_refundable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-565"><a href="#create_biden_eitc_childless-565"><span class="linenos">565</span></a>        <span class="n">max_credit_per_unit</span><span class="o">=</span><span class="mf">1500.0</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-566"><a href="#create_biden_eitc_childless-566"><span class="linenos">566</span></a>        <span class="n">credit_change_per_unit</span><span class="o">=</span><span class="mf">900.0</span><span class="p">,</span>  <span class="c1"># From ~$600</span>
</span><span id="create_biden_eitc_childless-567"><a href="#create_biden_eitc_childless-567"><span class="linenos">567</span></a>        <span class="n">units_affected_millions</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span>  <span class="c1"># Expanded eligible population</span>
</span><span id="create_biden_eitc_childless-568"><a href="#create_biden_eitc_childless-568"><span class="linenos">568</span></a>        <span class="n">has_phase_in</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-569"><a href="#create_biden_eitc_childless-569"><span class="linenos">569</span></a>        <span class="n">phase_in_rate</span><span class="o">=</span><span class="mf">0.153</span><span class="p">,</span>  <span class="c1"># ~15.3% (doubled from current)</span>
</span><span id="create_biden_eitc_childless-570"><a href="#create_biden_eitc_childless-570"><span class="linenos">570</span></a>        <span class="n">phase_in_threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-571"><a href="#create_biden_eitc_childless-571"><span class="linenos">571</span></a>        <span class="n">phase_in_end</span><span class="o">=</span><span class="mf">9820.0</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-572"><a href="#create_biden_eitc_childless-572"><span class="linenos">572</span></a>        <span class="n">has_phase_out</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-573"><a href="#create_biden_eitc_childless-573"><span class="linenos">573</span></a>        <span class="n">phase_out_threshold_single</span><span class="o">=</span><span class="mf">11610.0</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-574"><a href="#create_biden_eitc_childless-574"><span class="linenos">574</span></a>        <span class="n">phase_out_threshold_married</span><span class="o">=</span><span class="mf">17550.0</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-575"><a href="#create_biden_eitc_childless-575"><span class="linenos">575</span></a>        <span class="n">phase_out_rate</span><span class="o">=</span><span class="mf">0.153</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-576"><a href="#create_biden_eitc_childless-576"><span class="linenos">576</span></a>        <span class="n">participation_rate</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>  <span class="c1"># Childless have lower take-up</span>
</span><span id="create_biden_eitc_childless-577"><a href="#create_biden_eitc_childless-577"><span class="linenos">577</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span>  <span class="c1"># Strong labor supply effects</span>
</span><span id="create_biden_eitc_childless-578"><a href="#create_biden_eitc_childless-578"><span class="linenos">578</span></a>        <span class="c1"># Calibrated to CBO ~$178B over 10 years</span>
</span><span id="create_biden_eitc_childless-579"><a href="#create_biden_eitc_childless-579"><span class="linenos">579</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">17.8</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-580"><a href="#create_biden_eitc_childless-580"><span class="linenos">580</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2025</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-581"><a href="#create_biden_eitc_childless-581"><span class="linenos">581</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_biden_eitc_childless-582"><a href="#create_biden_eitc_childless-582"><span class="linenos">582</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create Biden proposal to expand EITC for childless workers.</p>

<p>Key features:</p>

<ul>
<li>Nearly triple max credit (~$1,500 from $600)</li>
<li>Expand age range to 19-24 and 65+</li>
<li>Lower phase-in start ($9,820 to $2,500)</li>
</ul>

<p>CBO/Treasury estimate: ~$178B over 10 years</p>
</div>


                </section>
                <section id="estimate_credit_cost">
                            <input id="estimate_credit_cost-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_credit_cost</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#TaxCreditPolicy">TaxCreditPolicy</a></span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="estimate_credit_cost-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#estimate_credit_cost"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="estimate_credit_cost-614"><a href="#estimate_credit_cost-614"><span class="linenos">614</span></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_credit_cost</span><span class="p">(</span><span class="n">policy</span><span class="p">:</span> <span class="n">TaxCreditPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="estimate_credit_cost-615"><a href="#estimate_credit_cost-615"><span class="linenos">615</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="estimate_credit_cost-616"><a href="#estimate_credit_cost-616"><span class="linenos">616</span></a><span class="sd">    Estimate total cost of a credit policy over 10 years.</span>
</span><span id="estimate_credit_cost-617"><a href="#estimate_credit_cost-617"><span class="linenos">617</span></a>
</span><span id="estimate_credit_cost-618"><a href="#estimate_credit_cost-618"><span class="linenos">618</span></a><span class="sd">    Returns dict with:</span>
</span><span id="estimate_credit_cost-619"><a href="#estimate_credit_cost-619"><span class="linenos">619</span></a><span class="sd">        - annual_cost: Average annual cost</span>
</span><span id="estimate_credit_cost-620"><a href="#estimate_credit_cost-620"><span class="linenos">620</span></a><span class="sd">        - ten_year_cost: Total 10-year cost</span>
</span><span id="estimate_credit_cost-621"><a href="#estimate_credit_cost-621"><span class="linenos">621</span></a><span class="sd">        - behavioral_offset: Labor supply revenue offset</span>
</span><span id="estimate_credit_cost-622"><a href="#estimate_credit_cost-622"><span class="linenos">622</span></a><span class="sd">        - net_cost: Final cost after behavioral offset</span>
</span><span id="estimate_credit_cost-623"><a href="#estimate_credit_cost-623"><span class="linenos">623</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="estimate_credit_cost-624"><a href="#estimate_credit_cost-624"><span class="linenos">624</span></a>    <span class="n">annual_static</span> <span class="o">=</span> <span class="o">-</span><span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="estimate_credit_cost-625"><a href="#estimate_credit_cost-625"><span class="linenos">625</span></a>    <span class="n">behavioral</span> <span class="o">=</span> <span class="o">-</span><span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="o">-</span><span class="n">annual_static</span><span class="p">)</span>
</span><span id="estimate_credit_cost-626"><a href="#estimate_credit_cost-626"><span class="linenos">626</span></a>
</span><span id="estimate_credit_cost-627"><a href="#estimate_credit_cost-627"><span class="linenos">627</span></a>    <span class="c1"># Apply growth (~3%/year)</span>
</span><span id="estimate_credit_cost-628"><a href="#estimate_credit_cost-628"><span class="linenos">628</span></a>    <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="estimate_credit_cost-629"><a href="#estimate_credit_cost-629"><span class="linenos">629</span></a>    <span class="n">annual_costs</span> <span class="o">=</span> <span class="n">annual_static</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.03</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_credit_cost-630"><a href="#estimate_credit_cost-630"><span class="linenos">630</span></a>    <span class="n">behavioral_offsets</span> <span class="o">=</span> <span class="n">behavioral</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.03</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_credit_cost-631"><a href="#estimate_credit_cost-631"><span class="linenos">631</span></a>
</span><span id="estimate_credit_cost-632"><a href="#estimate_credit_cost-632"><span class="linenos">632</span></a>    <span class="n">ten_year_static</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">annual_costs</span><span class="p">)</span>
</span><span id="estimate_credit_cost-633"><a href="#estimate_credit_cost-633"><span class="linenos">633</span></a>    <span class="n">ten_year_behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">behavioral_offsets</span><span class="p">)</span>
</span><span id="estimate_credit_cost-634"><a href="#estimate_credit_cost-634"><span class="linenos">634</span></a>
</span><span id="estimate_credit_cost-635"><a href="#estimate_credit_cost-635"><span class="linenos">635</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="estimate_credit_cost-636"><a href="#estimate_credit_cost-636"><span class="linenos">636</span></a>        <span class="s2">&quot;annual_cost&quot;</span><span class="p">:</span> <span class="n">annual_static</span><span class="p">,</span>
</span><span id="estimate_credit_cost-637"><a href="#estimate_credit_cost-637"><span class="linenos">637</span></a>        <span class="s2">&quot;ten_year_cost&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span><span class="p">,</span>
</span><span id="estimate_credit_cost-638"><a href="#estimate_credit_cost-638"><span class="linenos">638</span></a>        <span class="s2">&quot;behavioral_offset&quot;</span><span class="p">:</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_credit_cost-639"><a href="#estimate_credit_cost-639"><span class="linenos">639</span></a>        <span class="s2">&quot;net_cost&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span> <span class="o">-</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_credit_cost-640"><a href="#estimate_credit_cost-640"><span class="linenos">640</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Estimate total cost of a credit policy over 10 years.</p>

<p>Returns dict with:
    - annual_cost: Average annual cost
    - ten_year_cost: Total 10-year cost
    - behavioral_offset: Labor supply revenue offset
    - net_cost: Final cost after behavioral offset</p>
</div>


                </section>
                <section id="CREDIT_VALIDATION_SCENARIOS">
                    <div class="attr variable">
            <span class="name">CREDIT_VALIDATION_SCENARIOS</span>        =
<input id="CREDIT_VALIDATION_SCENARIOS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="CREDIT_VALIDATION_SCENARIOS-view-value"></label><span class="default_value">{&#39;biden_ctc_2021&#39;: {&#39;description&#39;: &#39;Biden 2021 ARP-style CTC (permanent)&#39;, &#39;policy_factory&#39;: &#39;create_biden_ctc_2021&#39;, &#39;expected_10yr&#39;: -1600.0, &#39;source&#39;: &#39;CBO/JCT 2021&#39;, &#39;notes&#39;: &#39;Actual ARP was 1-year, cost ~$110B&#39;}, &#39;ctc_extension&#39;: {&#39;description&#39;: &#39;Extend current CTC beyond 2025&#39;, &#39;policy_factory&#39;: &#39;create_ctc_permanent_extension&#39;, &#39;expected_10yr&#39;: -600.0, &#39;source&#39;: &#39;CBO 2024&#39;, &#39;notes&#39;: &#39;Part of TCJA extension cost&#39;}, &#39;biden_eitc_childless&#39;: {&#39;description&#39;: &#39;Biden childless EITC expansion&#39;, &#39;policy_factory&#39;: &#39;create_biden_eitc_childless&#39;, &#39;expected_10yr&#39;: -178.0, &#39;source&#39;: &#39;Treasury Green Book 2024&#39;, &#39;notes&#39;: &#39;Expand age range and nearly triple credit&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#CREDIT_VALIDATION_SCENARIOS"></a>
    
    

                </section>
                <section id="EstateTaxPolicy">
                            <input id="EstateTaxPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">EstateTaxPolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="EstateTaxPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EstateTaxPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EstateTaxPolicy-116"><a href="#EstateTaxPolicy-116"><span class="linenos">116</span></a><span class="nd">@dataclass</span>
</span><span id="EstateTaxPolicy-117"><a href="#EstateTaxPolicy-117"><span class="linenos">117</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EstateTaxPolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="EstateTaxPolicy-118"><a href="#EstateTaxPolicy-118"><span class="linenos">118</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-119"><a href="#EstateTaxPolicy-119"><span class="linenos">119</span></a><span class="sd">    Estate tax policy modeling exemption and rate changes.</span>
</span><span id="EstateTaxPolicy-120"><a href="#EstateTaxPolicy-120"><span class="linenos">120</span></a>
</span><span id="EstateTaxPolicy-121"><a href="#EstateTaxPolicy-121"><span class="linenos">121</span></a><span class="sd">    Models the federal estate (and gift) tax which applies to transfers</span>
</span><span id="EstateTaxPolicy-122"><a href="#EstateTaxPolicy-122"><span class="linenos">122</span></a><span class="sd">    of wealth at death above the exemption amount.</span>
</span><span id="EstateTaxPolicy-123"><a href="#EstateTaxPolicy-123"><span class="linenos">123</span></a>
</span><span id="EstateTaxPolicy-124"><a href="#EstateTaxPolicy-124"><span class="linenos">124</span></a><span class="sd">    Key parameters:</span>
</span><span id="EstateTaxPolicy-125"><a href="#EstateTaxPolicy-125"><span class="linenos">125</span></a><span class="sd">        exemption_change: Change in exemption level (dollars)</span>
</span><span id="EstateTaxPolicy-126"><a href="#EstateTaxPolicy-126"><span class="linenos">126</span></a><span class="sd">        new_exemption: New exemption level (overrides exemption_change)</span>
</span><span id="EstateTaxPolicy-127"><a href="#EstateTaxPolicy-127"><span class="linenos">127</span></a><span class="sd">        rate_change: Change in estate tax rate (e.g., 0.05 for 5pp increase)</span>
</span><span id="EstateTaxPolicy-128"><a href="#EstateTaxPolicy-128"><span class="linenos">128</span></a><span class="sd">        new_rate: New estate tax rate (overrides rate_change)</span>
</span><span id="EstateTaxPolicy-129"><a href="#EstateTaxPolicy-129"><span class="linenos">129</span></a>
</span><span id="EstateTaxPolicy-130"><a href="#EstateTaxPolicy-130"><span class="linenos">130</span></a><span class="sd">    Behavioral responses:</span>
</span><span id="EstateTaxPolicy-131"><a href="#EstateTaxPolicy-131"><span class="linenos">131</span></a><span class="sd">        - Higher exemptions reduce taxable estates</span>
</span><span id="EstateTaxPolicy-132"><a href="#EstateTaxPolicy-132"><span class="linenos">132</span></a><span class="sd">        - Lower rates reduce planning/avoidance</span>
</span><span id="EstateTaxPolicy-133"><a href="#EstateTaxPolicy-133"><span class="linenos">133</span></a><span class="sd">        - Lock-in effects similar to capital gains</span>
</span><span id="EstateTaxPolicy-134"><a href="#EstateTaxPolicy-134"><span class="linenos">134</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-135"><a href="#EstateTaxPolicy-135"><span class="linenos">135</span></a>
</span><span id="EstateTaxPolicy-136"><a href="#EstateTaxPolicy-136"><span class="linenos">136</span></a>    <span class="c1"># Exemption changes</span>
</span><span id="EstateTaxPolicy-137"><a href="#EstateTaxPolicy-137"><span class="linenos">137</span></a>    <span class="n">exemption_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Dollar change in exemption</span>
</span><span id="EstateTaxPolicy-138"><a href="#EstateTaxPolicy-138"><span class="linenos">138</span></a>    <span class="n">new_exemption</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Set specific exemption level</span>
</span><span id="EstateTaxPolicy-139"><a href="#EstateTaxPolicy-139"><span class="linenos">139</span></a>    <span class="n">extend_tcja_exemption</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Keep ~$14M exemption beyond 2025</span>
</span><span id="EstateTaxPolicy-140"><a href="#EstateTaxPolicy-140"><span class="linenos">140</span></a>
</span><span id="EstateTaxPolicy-141"><a href="#EstateTaxPolicy-141"><span class="linenos">141</span></a>    <span class="c1"># Rate changes</span>
</span><span id="EstateTaxPolicy-142"><a href="#EstateTaxPolicy-142"><span class="linenos">142</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in estate tax rate</span>
</span><span id="EstateTaxPolicy-143"><a href="#EstateTaxPolicy-143"><span class="linenos">143</span></a>    <span class="n">new_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Set specific rate</span>
</span><span id="EstateTaxPolicy-144"><a href="#EstateTaxPolicy-144"><span class="linenos">144</span></a>
</span><span id="EstateTaxPolicy-145"><a href="#EstateTaxPolicy-145"><span class="linenos">145</span></a>    <span class="c1"># Portability (unused exemption transfers to surviving spouse)</span>
</span><span id="EstateTaxPolicy-146"><a href="#EstateTaxPolicy-146"><span class="linenos">146</span></a>    <span class="n">modify_portability</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EstateTaxPolicy-147"><a href="#EstateTaxPolicy-147"><span class="linenos">147</span></a>    <span class="n">portability_cap</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Cap on portable amount</span>
</span><span id="EstateTaxPolicy-148"><a href="#EstateTaxPolicy-148"><span class="linenos">148</span></a>
</span><span id="EstateTaxPolicy-149"><a href="#EstateTaxPolicy-149"><span class="linenos">149</span></a>    <span class="c1"># Behavioral parameters</span>
</span><span id="EstateTaxPolicy-150"><a href="#EstateTaxPolicy-150"><span class="linenos">150</span></a>    <span class="n">planning_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>  <span class="c1"># Response to policy changes</span>
</span><span id="EstateTaxPolicy-151"><a href="#EstateTaxPolicy-151"><span class="linenos">151</span></a>    <span class="n">gift_shifting_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.10</span>  <span class="c1"># Shifting to inter vivos gifts</span>
</span><span id="EstateTaxPolicy-152"><a href="#EstateTaxPolicy-152"><span class="linenos">152</span></a>
</span><span id="EstateTaxPolicy-153"><a href="#EstateTaxPolicy-153"><span class="linenos">153</span></a>    <span class="c1"># Valuation discounts (family-owned businesses, etc.)</span>
</span><span id="EstateTaxPolicy-154"><a href="#EstateTaxPolicy-154"><span class="linenos">154</span></a>    <span class="n">limit_valuation_discounts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EstateTaxPolicy-155"><a href="#EstateTaxPolicy-155"><span class="linenos">155</span></a>    <span class="n">discount_limit_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Cap discounts at this percent</span>
</span><span id="EstateTaxPolicy-156"><a href="#EstateTaxPolicy-156"><span class="linenos">156</span></a>
</span><span id="EstateTaxPolicy-157"><a href="#EstateTaxPolicy-157"><span class="linenos">157</span></a>    <span class="c1"># Base year for calculations</span>
</span><span id="EstateTaxPolicy-158"><a href="#EstateTaxPolicy-158"><span class="linenos">158</span></a>    <span class="n">base_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2024</span>
</span><span id="EstateTaxPolicy-159"><a href="#EstateTaxPolicy-159"><span class="linenos">159</span></a>
</span><span id="EstateTaxPolicy-160"><a href="#EstateTaxPolicy-160"><span class="linenos">160</span></a>    <span class="c1"># Calibration</span>
</span><span id="EstateTaxPolicy-161"><a href="#EstateTaxPolicy-161"><span class="linenos">161</span></a>    <span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EstateTaxPolicy-162"><a href="#EstateTaxPolicy-162"><span class="linenos">162</span></a>
</span><span id="EstateTaxPolicy-163"><a href="#EstateTaxPolicy-163"><span class="linenos">163</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EstateTaxPolicy-164"><a href="#EstateTaxPolicy-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set default policy type.&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-165"><a href="#EstateTaxPolicy-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-166"><a href="#EstateTaxPolicy-166"><span class="linenos">166</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">=</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">ESTATE_TAX</span>
</span><span id="EstateTaxPolicy-167"><a href="#EstateTaxPolicy-167"><span class="linenos">167</span></a>
</span><span id="EstateTaxPolicy-168"><a href="#EstateTaxPolicy-168"><span class="linenos">168</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_exemption_for_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">policy_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-169"><a href="#EstateTaxPolicy-169"><span class="linenos">169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-170"><a href="#EstateTaxPolicy-170"><span class="linenos">170</span></a><span class="sd">        Get the effective exemption for a given year.</span>
</span><span id="EstateTaxPolicy-171"><a href="#EstateTaxPolicy-171"><span class="linenos">171</span></a>
</span><span id="EstateTaxPolicy-172"><a href="#EstateTaxPolicy-172"><span class="linenos">172</span></a><span class="sd">        Args:</span>
</span><span id="EstateTaxPolicy-173"><a href="#EstateTaxPolicy-173"><span class="linenos">173</span></a><span class="sd">            year: Tax year</span>
</span><span id="EstateTaxPolicy-174"><a href="#EstateTaxPolicy-174"><span class="linenos">174</span></a><span class="sd">            policy_active: Whether policy is in effect</span>
</span><span id="EstateTaxPolicy-175"><a href="#EstateTaxPolicy-175"><span class="linenos">175</span></a>
</span><span id="EstateTaxPolicy-176"><a href="#EstateTaxPolicy-176"><span class="linenos">176</span></a><span class="sd">        Returns:</span>
</span><span id="EstateTaxPolicy-177"><a href="#EstateTaxPolicy-177"><span class="linenos">177</span></a><span class="sd">            Exemption amount in dollars</span>
</span><span id="EstateTaxPolicy-178"><a href="#EstateTaxPolicy-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-179"><a href="#EstateTaxPolicy-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">policy_active</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-180"><a href="#EstateTaxPolicy-180"><span class="linenos">180</span></a>            <span class="c1"># Return baseline (current law)</span>
</span><span id="EstateTaxPolicy-181"><a href="#EstateTaxPolicy-181"><span class="linenos">181</span></a>            <span class="k">return</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="p">[</span><span class="mi">2034</span><span class="p">])</span>
</span><span id="EstateTaxPolicy-182"><a href="#EstateTaxPolicy-182"><span class="linenos">182</span></a>
</span><span id="EstateTaxPolicy-183"><a href="#EstateTaxPolicy-183"><span class="linenos">183</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-184"><a href="#EstateTaxPolicy-184"><span class="linenos">184</span></a>            <span class="c1"># Specific exemption set</span>
</span><span id="EstateTaxPolicy-185"><a href="#EstateTaxPolicy-185"><span class="linenos">185</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption</span>
</span><span id="EstateTaxPolicy-186"><a href="#EstateTaxPolicy-186"><span class="linenos">186</span></a>
</span><span id="EstateTaxPolicy-187"><a href="#EstateTaxPolicy-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_tcja_exemption</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-188"><a href="#EstateTaxPolicy-188"><span class="linenos">188</span></a>            <span class="c1"># Keep TCJA-level exemptions</span>
</span><span id="EstateTaxPolicy-189"><a href="#EstateTaxPolicy-189"><span class="linenos">189</span></a>            <span class="k">return</span> <span class="n">TCJA_EXTENDED_EXEMPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">TCJA_EXTENDED_EXEMPTIONS</span><span class="p">[</span><span class="mi">2034</span><span class="p">])</span>
</span><span id="EstateTaxPolicy-190"><a href="#EstateTaxPolicy-190"><span class="linenos">190</span></a>
</span><span id="EstateTaxPolicy-191"><a href="#EstateTaxPolicy-191"><span class="linenos">191</span></a>        <span class="c1"># Apply exemption change to baseline</span>
</span><span id="EstateTaxPolicy-192"><a href="#EstateTaxPolicy-192"><span class="linenos">192</span></a>        <span class="n">baseline</span> <span class="o">=</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="p">[</span><span class="mi">2034</span><span class="p">])</span>
</span><span id="EstateTaxPolicy-193"><a href="#EstateTaxPolicy-193"><span class="linenos">193</span></a>        <span class="k">return</span> <span class="n">baseline</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">exemption_change</span>
</span><span id="EstateTaxPolicy-194"><a href="#EstateTaxPolicy-194"><span class="linenos">194</span></a>
</span><span id="EstateTaxPolicy-195"><a href="#EstateTaxPolicy-195"><span class="linenos">195</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rate_for_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-196"><a href="#EstateTaxPolicy-196"><span class="linenos">196</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the effective estate tax rate.&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-197"><a href="#EstateTaxPolicy-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-198"><a href="#EstateTaxPolicy-198"><span class="linenos">198</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_rate</span>
</span><span id="EstateTaxPolicy-199"><a href="#EstateTaxPolicy-199"><span class="linenos">199</span></a>        <span class="k">return</span> <span class="n">CURRENT_ESTATE_TAX_RATE</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span>
</span><span id="EstateTaxPolicy-200"><a href="#EstateTaxPolicy-200"><span class="linenos">200</span></a>
</span><span id="EstateTaxPolicy-201"><a href="#EstateTaxPolicy-201"><span class="linenos">201</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_taxable_estates</span><span class="p">(</span>
</span><span id="EstateTaxPolicy-202"><a href="#EstateTaxPolicy-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="EstateTaxPolicy-203"><a href="#EstateTaxPolicy-203"><span class="linenos">203</span></a>        <span class="n">exemption</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="EstateTaxPolicy-204"><a href="#EstateTaxPolicy-204"><span class="linenos">204</span></a>        <span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="EstateTaxPolicy-205"><a href="#EstateTaxPolicy-205"><span class="linenos">205</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="EstateTaxPolicy-206"><a href="#EstateTaxPolicy-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-207"><a href="#EstateTaxPolicy-207"><span class="linenos">207</span></a><span class="sd">        Estimate number of taxable estates and average taxable amount.</span>
</span><span id="EstateTaxPolicy-208"><a href="#EstateTaxPolicy-208"><span class="linenos">208</span></a>
</span><span id="EstateTaxPolicy-209"><a href="#EstateTaxPolicy-209"><span class="linenos">209</span></a><span class="sd">        Uses relationship between exemption level and taxable estates.</span>
</span><span id="EstateTaxPolicy-210"><a href="#EstateTaxPolicy-210"><span class="linenos">210</span></a><span class="sd">        Higher exemption = fewer estates pay tax.</span>
</span><span id="EstateTaxPolicy-211"><a href="#EstateTaxPolicy-211"><span class="linenos">211</span></a>
</span><span id="EstateTaxPolicy-212"><a href="#EstateTaxPolicy-212"><span class="linenos">212</span></a><span class="sd">        Args:</span>
</span><span id="EstateTaxPolicy-213"><a href="#EstateTaxPolicy-213"><span class="linenos">213</span></a><span class="sd">            exemption: Effective exemption level</span>
</span><span id="EstateTaxPolicy-214"><a href="#EstateTaxPolicy-214"><span class="linenos">214</span></a><span class="sd">            year: Tax year</span>
</span><span id="EstateTaxPolicy-215"><a href="#EstateTaxPolicy-215"><span class="linenos">215</span></a>
</span><span id="EstateTaxPolicy-216"><a href="#EstateTaxPolicy-216"><span class="linenos">216</span></a><span class="sd">        Returns:</span>
</span><span id="EstateTaxPolicy-217"><a href="#EstateTaxPolicy-217"><span class="linenos">217</span></a><span class="sd">            Tuple of (number of taxable estates, average taxable amount)</span>
</span><span id="EstateTaxPolicy-218"><a href="#EstateTaxPolicy-218"><span class="linenos">218</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-219"><a href="#EstateTaxPolicy-219"><span class="linenos">219</span></a>        <span class="c1"># Reference points</span>
</span><span id="EstateTaxPolicy-220"><a href="#EstateTaxPolicy-220"><span class="linenos">220</span></a>        <span class="n">tcja_exemption</span> <span class="o">=</span> <span class="mi">14_000_000</span>
</span><span id="EstateTaxPolicy-221"><a href="#EstateTaxPolicy-221"><span class="linenos">221</span></a>        <span class="n">tcja_estates</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;taxable_estates_tcja&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy-222"><a href="#EstateTaxPolicy-222"><span class="linenos">222</span></a>        <span class="n">tcja_avg</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;avg_taxable_amount_tcja&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy-223"><a href="#EstateTaxPolicy-223"><span class="linenos">223</span></a>
</span><span id="EstateTaxPolicy-224"><a href="#EstateTaxPolicy-224"><span class="linenos">224</span></a>        <span class="n">post_tcja_exemption</span> <span class="o">=</span> <span class="mi">6_400_000</span>
</span><span id="EstateTaxPolicy-225"><a href="#EstateTaxPolicy-225"><span class="linenos">225</span></a>        <span class="n">post_tcja_estates</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;taxable_estates_post_tcja&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy-226"><a href="#EstateTaxPolicy-226"><span class="linenos">226</span></a>        <span class="n">post_tcja_avg</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;avg_taxable_amount_post_tcja&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy-227"><a href="#EstateTaxPolicy-227"><span class="linenos">227</span></a>
</span><span id="EstateTaxPolicy-228"><a href="#EstateTaxPolicy-228"><span class="linenos">228</span></a>        <span class="c1"># Interpolate based on exemption level</span>
</span><span id="EstateTaxPolicy-229"><a href="#EstateTaxPolicy-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="n">exemption</span> <span class="o">&gt;=</span> <span class="n">tcja_exemption</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-230"><a href="#EstateTaxPolicy-230"><span class="linenos">230</span></a>            <span class="c1"># Very high exemption - fewer estates</span>
</span><span id="EstateTaxPolicy-231"><a href="#EstateTaxPolicy-231"><span class="linenos">231</span></a>            <span class="n">scale</span> <span class="o">=</span> <span class="n">tcja_exemption</span> <span class="o">/</span> <span class="n">exemption</span>
</span><span id="EstateTaxPolicy-232"><a href="#EstateTaxPolicy-232"><span class="linenos">232</span></a>            <span class="n">estates</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tcja_estates</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-233"><a href="#EstateTaxPolicy-233"><span class="linenos">233</span></a>            <span class="n">avg_amount</span> <span class="o">=</span> <span class="n">tcja_avg</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">exemption</span> <span class="o">-</span> <span class="n">tcja_exemption</span><span class="p">)</span> <span class="o">/</span> <span class="n">tcja_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-234"><a href="#EstateTaxPolicy-234"><span class="linenos">234</span></a>        <span class="k">elif</span> <span class="n">exemption</span> <span class="o">&lt;=</span> <span class="n">post_tcja_exemption</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-235"><a href="#EstateTaxPolicy-235"><span class="linenos">235</span></a>            <span class="c1"># Low exemption - more estates</span>
</span><span id="EstateTaxPolicy-236"><a href="#EstateTaxPolicy-236"><span class="linenos">236</span></a>            <span class="n">scale</span> <span class="o">=</span> <span class="n">post_tcja_exemption</span> <span class="o">/</span> <span class="n">exemption</span>
</span><span id="EstateTaxPolicy-237"><a href="#EstateTaxPolicy-237"><span class="linenos">237</span></a>            <span class="n">estates</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">post_tcja_estates</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-238"><a href="#EstateTaxPolicy-238"><span class="linenos">238</span></a>            <span class="n">avg_amount</span> <span class="o">=</span> <span class="n">post_tcja_avg</span> <span class="o">*</span> <span class="p">(</span><span class="n">exemption</span> <span class="o">/</span> <span class="n">post_tcja_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-239"><a href="#EstateTaxPolicy-239"><span class="linenos">239</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-240"><a href="#EstateTaxPolicy-240"><span class="linenos">240</span></a>            <span class="c1"># Linear interpolation</span>
</span><span id="EstateTaxPolicy-241"><a href="#EstateTaxPolicy-241"><span class="linenos">241</span></a>            <span class="n">frac</span> <span class="o">=</span> <span class="p">(</span><span class="n">exemption</span> <span class="o">-</span> <span class="n">post_tcja_exemption</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tcja_exemption</span> <span class="o">-</span> <span class="n">post_tcja_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-242"><a href="#EstateTaxPolicy-242"><span class="linenos">242</span></a>            <span class="n">estates</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">post_tcja_estates</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcja_estates</span> <span class="o">-</span> <span class="n">post_tcja_estates</span><span class="p">))</span>
</span><span id="EstateTaxPolicy-243"><a href="#EstateTaxPolicy-243"><span class="linenos">243</span></a>            <span class="n">avg_amount</span> <span class="o">=</span> <span class="n">post_tcja_avg</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcja_avg</span> <span class="o">-</span> <span class="n">post_tcja_avg</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-244"><a href="#EstateTaxPolicy-244"><span class="linenos">244</span></a>
</span><span id="EstateTaxPolicy-245"><a href="#EstateTaxPolicy-245"><span class="linenos">245</span></a>        <span class="k">return</span> <span class="n">estates</span><span class="p">,</span> <span class="n">avg_amount</span>
</span><span id="EstateTaxPolicy-246"><a href="#EstateTaxPolicy-246"><span class="linenos">246</span></a>
</span><span id="EstateTaxPolicy-247"><a href="#EstateTaxPolicy-247"><span class="linenos">247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="EstateTaxPolicy-248"><a href="#EstateTaxPolicy-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="EstateTaxPolicy-249"><a href="#EstateTaxPolicy-249"><span class="linenos">249</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="EstateTaxPolicy-250"><a href="#EstateTaxPolicy-250"><span class="linenos">250</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="EstateTaxPolicy-251"><a href="#EstateTaxPolicy-251"><span class="linenos">251</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-252"><a href="#EstateTaxPolicy-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-253"><a href="#EstateTaxPolicy-253"><span class="linenos">253</span></a><span class="sd">        Estimate static revenue effect of estate tax policy change.</span>
</span><span id="EstateTaxPolicy-254"><a href="#EstateTaxPolicy-254"><span class="linenos">254</span></a>
</span><span id="EstateTaxPolicy-255"><a href="#EstateTaxPolicy-255"><span class="linenos">255</span></a><span class="sd">        Args:</span>
</span><span id="EstateTaxPolicy-256"><a href="#EstateTaxPolicy-256"><span class="linenos">256</span></a><span class="sd">            baseline_revenue: Baseline estate tax revenue (billions)</span>
</span><span id="EstateTaxPolicy-257"><a href="#EstateTaxPolicy-257"><span class="linenos">257</span></a><span class="sd">            use_real_data: Whether to use detailed calculations</span>
</span><span id="EstateTaxPolicy-258"><a href="#EstateTaxPolicy-258"><span class="linenos">258</span></a>
</span><span id="EstateTaxPolicy-259"><a href="#EstateTaxPolicy-259"><span class="linenos">259</span></a><span class="sd">        Returns:</span>
</span><span id="EstateTaxPolicy-260"><a href="#EstateTaxPolicy-260"><span class="linenos">260</span></a><span class="sd">            Revenue change in billions (negative = revenue loss)</span>
</span><span id="EstateTaxPolicy-261"><a href="#EstateTaxPolicy-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-262"><a href="#EstateTaxPolicy-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-263"><a href="#EstateTaxPolicy-263"><span class="linenos">263</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="EstateTaxPolicy-264"><a href="#EstateTaxPolicy-264"><span class="linenos">264</span></a>
</span><span id="EstateTaxPolicy-265"><a href="#EstateTaxPolicy-265"><span class="linenos">265</span></a>        <span class="c1"># Use CBO estimate for TCJA extension</span>
</span><span id="EstateTaxPolicy-266"><a href="#EstateTaxPolicy-266"><span class="linenos">266</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_tcja_exemption</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-267"><a href="#EstateTaxPolicy-267"><span class="linenos">267</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">CBO_ESTATE_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;extend_tcja_annual&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy-268"><a href="#EstateTaxPolicy-268"><span class="linenos">268</span></a>
</span><span id="EstateTaxPolicy-269"><a href="#EstateTaxPolicy-269"><span class="linenos">269</span></a>        <span class="c1"># Calculate from exemption/rate changes</span>
</span><span id="EstateTaxPolicy-270"><a href="#EstateTaxPolicy-270"><span class="linenos">270</span></a>        <span class="n">baseline_exemption</span> <span class="o">=</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="EstateTaxPolicy-271"><a href="#EstateTaxPolicy-271"><span class="linenos">271</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># First full year</span>
</span><span id="EstateTaxPolicy-272"><a href="#EstateTaxPolicy-272"><span class="linenos">272</span></a>            <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="p">[</span><span class="mi">2026</span><span class="p">]</span>
</span><span id="EstateTaxPolicy-273"><a href="#EstateTaxPolicy-273"><span class="linenos">273</span></a>        <span class="p">)</span>
</span><span id="EstateTaxPolicy-274"><a href="#EstateTaxPolicy-274"><span class="linenos">274</span></a>        <span class="n">policy_exemption</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exemption_for_year</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-275"><a href="#EstateTaxPolicy-275"><span class="linenos">275</span></a>
</span><span id="EstateTaxPolicy-276"><a href="#EstateTaxPolicy-276"><span class="linenos">276</span></a>        <span class="c1"># Get taxable estates under each scenario</span>
</span><span id="EstateTaxPolicy-277"><a href="#EstateTaxPolicy-277"><span class="linenos">277</span></a>        <span class="n">baseline_estates</span><span class="p">,</span> <span class="n">baseline_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_taxable_estates</span><span class="p">(</span><span class="n">baseline_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-278"><a href="#EstateTaxPolicy-278"><span class="linenos">278</span></a>        <span class="n">policy_estates</span><span class="p">,</span> <span class="n">policy_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_taxable_estates</span><span class="p">(</span><span class="n">policy_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-279"><a href="#EstateTaxPolicy-279"><span class="linenos">279</span></a>
</span><span id="EstateTaxPolicy-280"><a href="#EstateTaxPolicy-280"><span class="linenos">280</span></a>        <span class="c1"># Calculate revenue</span>
</span><span id="EstateTaxPolicy-281"><a href="#EstateTaxPolicy-281"><span class="linenos">281</span></a>        <span class="n">baseline_rate</span> <span class="o">=</span> <span class="n">CURRENT_ESTATE_TAX_RATE</span>
</span><span id="EstateTaxPolicy-282"><a href="#EstateTaxPolicy-282"><span class="linenos">282</span></a>        <span class="n">policy_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rate_for_year</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="EstateTaxPolicy-283"><a href="#EstateTaxPolicy-283"><span class="linenos">283</span></a>
</span><span id="EstateTaxPolicy-284"><a href="#EstateTaxPolicy-284"><span class="linenos">284</span></a>        <span class="n">baseline_revenue</span> <span class="o">=</span> <span class="n">baseline_estates</span> <span class="o">*</span> <span class="n">baseline_avg</span> <span class="o">*</span> <span class="n">baseline_rate</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="EstateTaxPolicy-285"><a href="#EstateTaxPolicy-285"><span class="linenos">285</span></a>        <span class="n">policy_revenue</span> <span class="o">=</span> <span class="n">policy_estates</span> <span class="o">*</span> <span class="n">policy_avg</span> <span class="o">*</span> <span class="n">policy_rate</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="EstateTaxPolicy-286"><a href="#EstateTaxPolicy-286"><span class="linenos">286</span></a>
</span><span id="EstateTaxPolicy-287"><a href="#EstateTaxPolicy-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="n">policy_revenue</span> <span class="o">-</span> <span class="n">baseline_revenue</span>
</span><span id="EstateTaxPolicy-288"><a href="#EstateTaxPolicy-288"><span class="linenos">288</span></a>
</span><span id="EstateTaxPolicy-289"><a href="#EstateTaxPolicy-289"><span class="linenos">289</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-290"><a href="#EstateTaxPolicy-290"><span class="linenos">290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-291"><a href="#EstateTaxPolicy-291"><span class="linenos">291</span></a><span class="sd">        Estimate behavioral response to estate tax changes.</span>
</span><span id="EstateTaxPolicy-292"><a href="#EstateTaxPolicy-292"><span class="linenos">292</span></a>
</span><span id="EstateTaxPolicy-293"><a href="#EstateTaxPolicy-293"><span class="linenos">293</span></a><span class="sd">        Behavioral responses include:</span>
</span><span id="EstateTaxPolicy-294"><a href="#EstateTaxPolicy-294"><span class="linenos">294</span></a><span class="sd">        - Estate planning (trusts, family partnerships)</span>
</span><span id="EstateTaxPolicy-295"><a href="#EstateTaxPolicy-295"><span class="linenos">295</span></a><span class="sd">        - Inter vivos gifts to reduce estate</span>
</span><span id="EstateTaxPolicy-296"><a href="#EstateTaxPolicy-296"><span class="linenos">296</span></a><span class="sd">        - Valuation discounts</span>
</span><span id="EstateTaxPolicy-297"><a href="#EstateTaxPolicy-297"><span class="linenos">297</span></a><span class="sd">        - Charitable giving</span>
</span><span id="EstateTaxPolicy-298"><a href="#EstateTaxPolicy-298"><span class="linenos">298</span></a>
</span><span id="EstateTaxPolicy-299"><a href="#EstateTaxPolicy-299"><span class="linenos">299</span></a><span class="sd">        Returns:</span>
</span><span id="EstateTaxPolicy-300"><a href="#EstateTaxPolicy-300"><span class="linenos">300</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="EstateTaxPolicy-301"><a href="#EstateTaxPolicy-301"><span class="linenos">301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy-302"><a href="#EstateTaxPolicy-302"><span class="linenos">302</span></a>        <span class="c1"># Planning response</span>
</span><span id="EstateTaxPolicy-303"><a href="#EstateTaxPolicy-303"><span class="linenos">303</span></a>        <span class="n">planning_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">planning_elasticity</span>
</span><span id="EstateTaxPolicy-304"><a href="#EstateTaxPolicy-304"><span class="linenos">304</span></a>
</span><span id="EstateTaxPolicy-305"><a href="#EstateTaxPolicy-305"><span class="linenos">305</span></a>        <span class="c1"># Gift shifting response</span>
</span><span id="EstateTaxPolicy-306"><a href="#EstateTaxPolicy-306"><span class="linenos">306</span></a>        <span class="n">gift_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gift_shifting_elasticity</span>
</span><span id="EstateTaxPolicy-307"><a href="#EstateTaxPolicy-307"><span class="linenos">307</span></a>
</span><span id="EstateTaxPolicy-308"><a href="#EstateTaxPolicy-308"><span class="linenos">308</span></a>        <span class="n">total_offset</span> <span class="o">=</span> <span class="n">planning_offset</span> <span class="o">+</span> <span class="n">gift_offset</span>
</span><span id="EstateTaxPolicy-309"><a href="#EstateTaxPolicy-309"><span class="linenos">309</span></a>
</span><span id="EstateTaxPolicy-310"><a href="#EstateTaxPolicy-310"><span class="linenos">310</span></a>        <span class="c1"># Offset reduces revenue gain or loss</span>
</span><span id="EstateTaxPolicy-311"><a href="#EstateTaxPolicy-311"><span class="linenos">311</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-312"><a href="#EstateTaxPolicy-312"><span class="linenos">312</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">total_offset</span>  <span class="c1"># Reduces revenue gain</span>
</span><span id="EstateTaxPolicy-313"><a href="#EstateTaxPolicy-313"><span class="linenos">313</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EstateTaxPolicy-314"><a href="#EstateTaxPolicy-314"><span class="linenos">314</span></a>            <span class="k">return</span> <span class="n">total_offset</span>  <span class="c1"># Reduces revenue loss</span>
</span></pre></div>


            <div class="docstring"><p>Estate tax policy modeling exemption and rate changes.</p>

<p>Models the federal estate (and gift) tax which applies to transfers
of wealth at death above the exemption amount.</p>

<p>Key parameters:
    exemption_change: Change in exemption level (dollars)
    new_exemption: New exemption level (overrides exemption_change)
    rate_change: Change in estate tax rate (e.g., 0.05 for 5pp increase)
    new_rate: New estate tax rate (overrides rate_change)</p>

<p>Behavioral responses:
    - Higher exemptions reduce taxable estates
    - Lower rates reduce planning/avoidance
    - Lock-in effects similar to capital gains</p>
</div>


                            <div id="EstateTaxPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EstateTaxPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">exemption_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_exemption</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">extend_tcja_exemption</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">modify_portability</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">portability_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">planning_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>,</span><span class="param">	<span class="n">gift_shifting_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">limit_valuation_discounts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">discount_limit_pct</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">base_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2024</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.__init__"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.exemption_change" class="classattr">
                                <div class="attr variable">
            <span class="name">exemption_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.exemption_change"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.new_exemption" class="classattr">
                                <div class="attr variable">
            <span class="name">new_exemption</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.new_exemption"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.extend_tcja_exemption" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_tcja_exemption</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.extend_tcja_exemption"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.rate_change"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.new_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">new_rate</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.new_rate"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.modify_portability" class="classattr">
                                <div class="attr variable">
            <span class="name">modify_portability</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.modify_portability"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.portability_cap" class="classattr">
                                <div class="attr variable">
            <span class="name">portability_cap</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.portability_cap"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.planning_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">planning_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.15</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.planning_elasticity"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.gift_shifting_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">gift_shifting_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.1</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.gift_shifting_elasticity"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.limit_valuation_discounts" class="classattr">
                                <div class="attr variable">
            <span class="name">limit_valuation_discounts</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.limit_valuation_discounts"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.discount_limit_pct" class="classattr">
                                <div class="attr variable">
            <span class="name">discount_limit_pct</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.discount_limit_pct"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.base_year" class="classattr">
                                <div class="attr variable">
            <span class="name">base_year</span><span class="annotation">: int</span>        =
<span class="default_value">2024</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.base_year"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.annual_revenue_change_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_revenue_change_billions</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxPolicy.annual_revenue_change_billions"></a>
    
    

                            </div>
                            <div id="EstateTaxPolicy.get_exemption_for_year" class="classattr">
                                        <input id="EstateTaxPolicy.get_exemption_for_year-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_exemption_for_year</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">policy_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="EstateTaxPolicy.get_exemption_for_year-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EstateTaxPolicy.get_exemption_for_year"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EstateTaxPolicy.get_exemption_for_year-168"><a href="#EstateTaxPolicy.get_exemption_for_year-168"><span class="linenos">168</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_exemption_for_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">policy_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-169"><a href="#EstateTaxPolicy.get_exemption_for_year-169"><span class="linenos">169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-170"><a href="#EstateTaxPolicy.get_exemption_for_year-170"><span class="linenos">170</span></a><span class="sd">        Get the effective exemption for a given year.</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-171"><a href="#EstateTaxPolicy.get_exemption_for_year-171"><span class="linenos">171</span></a>
</span><span id="EstateTaxPolicy.get_exemption_for_year-172"><a href="#EstateTaxPolicy.get_exemption_for_year-172"><span class="linenos">172</span></a><span class="sd">        Args:</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-173"><a href="#EstateTaxPolicy.get_exemption_for_year-173"><span class="linenos">173</span></a><span class="sd">            year: Tax year</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-174"><a href="#EstateTaxPolicy.get_exemption_for_year-174"><span class="linenos">174</span></a><span class="sd">            policy_active: Whether policy is in effect</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-175"><a href="#EstateTaxPolicy.get_exemption_for_year-175"><span class="linenos">175</span></a>
</span><span id="EstateTaxPolicy.get_exemption_for_year-176"><a href="#EstateTaxPolicy.get_exemption_for_year-176"><span class="linenos">176</span></a><span class="sd">        Returns:</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-177"><a href="#EstateTaxPolicy.get_exemption_for_year-177"><span class="linenos">177</span></a><span class="sd">            Exemption amount in dollars</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-178"><a href="#EstateTaxPolicy.get_exemption_for_year-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-179"><a href="#EstateTaxPolicy.get_exemption_for_year-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">policy_active</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-180"><a href="#EstateTaxPolicy.get_exemption_for_year-180"><span class="linenos">180</span></a>            <span class="c1"># Return baseline (current law)</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-181"><a href="#EstateTaxPolicy.get_exemption_for_year-181"><span class="linenos">181</span></a>            <span class="k">return</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="p">[</span><span class="mi">2034</span><span class="p">])</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-182"><a href="#EstateTaxPolicy.get_exemption_for_year-182"><span class="linenos">182</span></a>
</span><span id="EstateTaxPolicy.get_exemption_for_year-183"><a href="#EstateTaxPolicy.get_exemption_for_year-183"><span class="linenos">183</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-184"><a href="#EstateTaxPolicy.get_exemption_for_year-184"><span class="linenos">184</span></a>            <span class="c1"># Specific exemption set</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-185"><a href="#EstateTaxPolicy.get_exemption_for_year-185"><span class="linenos">185</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-186"><a href="#EstateTaxPolicy.get_exemption_for_year-186"><span class="linenos">186</span></a>
</span><span id="EstateTaxPolicy.get_exemption_for_year-187"><a href="#EstateTaxPolicy.get_exemption_for_year-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_tcja_exemption</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-188"><a href="#EstateTaxPolicy.get_exemption_for_year-188"><span class="linenos">188</span></a>            <span class="c1"># Keep TCJA-level exemptions</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-189"><a href="#EstateTaxPolicy.get_exemption_for_year-189"><span class="linenos">189</span></a>            <span class="k">return</span> <span class="n">TCJA_EXTENDED_EXEMPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">TCJA_EXTENDED_EXEMPTIONS</span><span class="p">[</span><span class="mi">2034</span><span class="p">])</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-190"><a href="#EstateTaxPolicy.get_exemption_for_year-190"><span class="linenos">190</span></a>
</span><span id="EstateTaxPolicy.get_exemption_for_year-191"><a href="#EstateTaxPolicy.get_exemption_for_year-191"><span class="linenos">191</span></a>        <span class="c1"># Apply exemption change to baseline</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-192"><a href="#EstateTaxPolicy.get_exemption_for_year-192"><span class="linenos">192</span></a>        <span class="n">baseline</span> <span class="o">=</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="p">[</span><span class="mi">2034</span><span class="p">])</span>
</span><span id="EstateTaxPolicy.get_exemption_for_year-193"><a href="#EstateTaxPolicy.get_exemption_for_year-193"><span class="linenos">193</span></a>        <span class="k">return</span> <span class="n">baseline</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">exemption_change</span>
</span></pre></div>


            <div class="docstring"><p>Get the effective exemption for a given year.</p>

<p>Args:
    year: Tax year
    policy_active: Whether policy is in effect</p>

<p>Returns:
    Exemption amount in dollars</p>
</div>


                            </div>
                            <div id="EstateTaxPolicy.get_rate_for_year" class="classattr">
                                        <input id="EstateTaxPolicy.get_rate_for_year-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_rate_for_year</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="EstateTaxPolicy.get_rate_for_year-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EstateTaxPolicy.get_rate_for_year"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EstateTaxPolicy.get_rate_for_year-195"><a href="#EstateTaxPolicy.get_rate_for_year-195"><span class="linenos">195</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rate_for_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.get_rate_for_year-196"><a href="#EstateTaxPolicy.get_rate_for_year-196"><span class="linenos">196</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the effective estate tax rate.&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.get_rate_for_year-197"><a href="#EstateTaxPolicy.get_rate_for_year-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.get_rate_for_year-198"><a href="#EstateTaxPolicy.get_rate_for_year-198"><span class="linenos">198</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_rate</span>
</span><span id="EstateTaxPolicy.get_rate_for_year-199"><a href="#EstateTaxPolicy.get_rate_for_year-199"><span class="linenos">199</span></a>        <span class="k">return</span> <span class="n">CURRENT_ESTATE_TAX_RATE</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span>
</span></pre></div>


            <div class="docstring"><p>Get the effective estate tax rate.</p>
</div>


                            </div>
                            <div id="EstateTaxPolicy.estimate_taxable_estates" class="classattr">
                                        <input id="EstateTaxPolicy.estimate_taxable_estates-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_taxable_estates</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">exemption</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="EstateTaxPolicy.estimate_taxable_estates-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EstateTaxPolicy.estimate_taxable_estates"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EstateTaxPolicy.estimate_taxable_estates-201"><a href="#EstateTaxPolicy.estimate_taxable_estates-201"><span class="linenos">201</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_taxable_estates</span><span class="p">(</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-202"><a href="#EstateTaxPolicy.estimate_taxable_estates-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-203"><a href="#EstateTaxPolicy.estimate_taxable_estates-203"><span class="linenos">203</span></a>        <span class="n">exemption</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-204"><a href="#EstateTaxPolicy.estimate_taxable_estates-204"><span class="linenos">204</span></a>        <span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-205"><a href="#EstateTaxPolicy.estimate_taxable_estates-205"><span class="linenos">205</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-206"><a href="#EstateTaxPolicy.estimate_taxable_estates-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-207"><a href="#EstateTaxPolicy.estimate_taxable_estates-207"><span class="linenos">207</span></a><span class="sd">        Estimate number of taxable estates and average taxable amount.</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-208"><a href="#EstateTaxPolicy.estimate_taxable_estates-208"><span class="linenos">208</span></a>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-209"><a href="#EstateTaxPolicy.estimate_taxable_estates-209"><span class="linenos">209</span></a><span class="sd">        Uses relationship between exemption level and taxable estates.</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-210"><a href="#EstateTaxPolicy.estimate_taxable_estates-210"><span class="linenos">210</span></a><span class="sd">        Higher exemption = fewer estates pay tax.</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-211"><a href="#EstateTaxPolicy.estimate_taxable_estates-211"><span class="linenos">211</span></a>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-212"><a href="#EstateTaxPolicy.estimate_taxable_estates-212"><span class="linenos">212</span></a><span class="sd">        Args:</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-213"><a href="#EstateTaxPolicy.estimate_taxable_estates-213"><span class="linenos">213</span></a><span class="sd">            exemption: Effective exemption level</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-214"><a href="#EstateTaxPolicy.estimate_taxable_estates-214"><span class="linenos">214</span></a><span class="sd">            year: Tax year</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-215"><a href="#EstateTaxPolicy.estimate_taxable_estates-215"><span class="linenos">215</span></a>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-216"><a href="#EstateTaxPolicy.estimate_taxable_estates-216"><span class="linenos">216</span></a><span class="sd">        Returns:</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-217"><a href="#EstateTaxPolicy.estimate_taxable_estates-217"><span class="linenos">217</span></a><span class="sd">            Tuple of (number of taxable estates, average taxable amount)</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-218"><a href="#EstateTaxPolicy.estimate_taxable_estates-218"><span class="linenos">218</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-219"><a href="#EstateTaxPolicy.estimate_taxable_estates-219"><span class="linenos">219</span></a>        <span class="c1"># Reference points</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-220"><a href="#EstateTaxPolicy.estimate_taxable_estates-220"><span class="linenos">220</span></a>        <span class="n">tcja_exemption</span> <span class="o">=</span> <span class="mi">14_000_000</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-221"><a href="#EstateTaxPolicy.estimate_taxable_estates-221"><span class="linenos">221</span></a>        <span class="n">tcja_estates</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;taxable_estates_tcja&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-222"><a href="#EstateTaxPolicy.estimate_taxable_estates-222"><span class="linenos">222</span></a>        <span class="n">tcja_avg</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;avg_taxable_amount_tcja&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-223"><a href="#EstateTaxPolicy.estimate_taxable_estates-223"><span class="linenos">223</span></a>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-224"><a href="#EstateTaxPolicy.estimate_taxable_estates-224"><span class="linenos">224</span></a>        <span class="n">post_tcja_exemption</span> <span class="o">=</span> <span class="mi">6_400_000</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-225"><a href="#EstateTaxPolicy.estimate_taxable_estates-225"><span class="linenos">225</span></a>        <span class="n">post_tcja_estates</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;taxable_estates_post_tcja&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-226"><a href="#EstateTaxPolicy.estimate_taxable_estates-226"><span class="linenos">226</span></a>        <span class="n">post_tcja_avg</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;avg_taxable_amount_post_tcja&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-227"><a href="#EstateTaxPolicy.estimate_taxable_estates-227"><span class="linenos">227</span></a>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-228"><a href="#EstateTaxPolicy.estimate_taxable_estates-228"><span class="linenos">228</span></a>        <span class="c1"># Interpolate based on exemption level</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-229"><a href="#EstateTaxPolicy.estimate_taxable_estates-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="n">exemption</span> <span class="o">&gt;=</span> <span class="n">tcja_exemption</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-230"><a href="#EstateTaxPolicy.estimate_taxable_estates-230"><span class="linenos">230</span></a>            <span class="c1"># Very high exemption - fewer estates</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-231"><a href="#EstateTaxPolicy.estimate_taxable_estates-231"><span class="linenos">231</span></a>            <span class="n">scale</span> <span class="o">=</span> <span class="n">tcja_exemption</span> <span class="o">/</span> <span class="n">exemption</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-232"><a href="#EstateTaxPolicy.estimate_taxable_estates-232"><span class="linenos">232</span></a>            <span class="n">estates</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tcja_estates</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-233"><a href="#EstateTaxPolicy.estimate_taxable_estates-233"><span class="linenos">233</span></a>            <span class="n">avg_amount</span> <span class="o">=</span> <span class="n">tcja_avg</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">exemption</span> <span class="o">-</span> <span class="n">tcja_exemption</span><span class="p">)</span> <span class="o">/</span> <span class="n">tcja_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-234"><a href="#EstateTaxPolicy.estimate_taxable_estates-234"><span class="linenos">234</span></a>        <span class="k">elif</span> <span class="n">exemption</span> <span class="o">&lt;=</span> <span class="n">post_tcja_exemption</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-235"><a href="#EstateTaxPolicy.estimate_taxable_estates-235"><span class="linenos">235</span></a>            <span class="c1"># Low exemption - more estates</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-236"><a href="#EstateTaxPolicy.estimate_taxable_estates-236"><span class="linenos">236</span></a>            <span class="n">scale</span> <span class="o">=</span> <span class="n">post_tcja_exemption</span> <span class="o">/</span> <span class="n">exemption</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-237"><a href="#EstateTaxPolicy.estimate_taxable_estates-237"><span class="linenos">237</span></a>            <span class="n">estates</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">post_tcja_estates</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-238"><a href="#EstateTaxPolicy.estimate_taxable_estates-238"><span class="linenos">238</span></a>            <span class="n">avg_amount</span> <span class="o">=</span> <span class="n">post_tcja_avg</span> <span class="o">*</span> <span class="p">(</span><span class="n">exemption</span> <span class="o">/</span> <span class="n">post_tcja_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-239"><a href="#EstateTaxPolicy.estimate_taxable_estates-239"><span class="linenos">239</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-240"><a href="#EstateTaxPolicy.estimate_taxable_estates-240"><span class="linenos">240</span></a>            <span class="c1"># Linear interpolation</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-241"><a href="#EstateTaxPolicy.estimate_taxable_estates-241"><span class="linenos">241</span></a>            <span class="n">frac</span> <span class="o">=</span> <span class="p">(</span><span class="n">exemption</span> <span class="o">-</span> <span class="n">post_tcja_exemption</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tcja_exemption</span> <span class="o">-</span> <span class="n">post_tcja_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-242"><a href="#EstateTaxPolicy.estimate_taxable_estates-242"><span class="linenos">242</span></a>            <span class="n">estates</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">post_tcja_estates</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcja_estates</span> <span class="o">-</span> <span class="n">post_tcja_estates</span><span class="p">))</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-243"><a href="#EstateTaxPolicy.estimate_taxable_estates-243"><span class="linenos">243</span></a>            <span class="n">avg_amount</span> <span class="o">=</span> <span class="n">post_tcja_avg</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcja_avg</span> <span class="o">-</span> <span class="n">post_tcja_avg</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-244"><a href="#EstateTaxPolicy.estimate_taxable_estates-244"><span class="linenos">244</span></a>
</span><span id="EstateTaxPolicy.estimate_taxable_estates-245"><a href="#EstateTaxPolicy.estimate_taxable_estates-245"><span class="linenos">245</span></a>        <span class="k">return</span> <span class="n">estates</span><span class="p">,</span> <span class="n">avg_amount</span>
</span></pre></div>


            <div class="docstring"><p>Estimate number of taxable estates and average taxable amount.</p>

<p>Uses relationship between exemption level and taxable estates.
Higher exemption = fewer estates pay tax.</p>

<p>Args:
    exemption: Effective exemption level
    year: Tax year</p>

<p>Returns:
    Tuple of (number of taxable estates, average taxable amount)</p>
</div>


                            </div>
                            <div id="EstateTaxPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="EstateTaxPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="EstateTaxPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EstateTaxPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EstateTaxPolicy.estimate_static_revenue_effect-247"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-247"><span class="linenos">247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-248"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-249"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-249"><span class="linenos">249</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-250"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-250"><span class="linenos">250</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-251"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-251"><span class="linenos">251</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-252"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-253"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-253"><span class="linenos">253</span></a><span class="sd">        Estimate static revenue effect of estate tax policy change.</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-254"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-254"><span class="linenos">254</span></a>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-255"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-255"><span class="linenos">255</span></a><span class="sd">        Args:</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-256"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-256"><span class="linenos">256</span></a><span class="sd">            baseline_revenue: Baseline estate tax revenue (billions)</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-257"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-257"><span class="linenos">257</span></a><span class="sd">            use_real_data: Whether to use detailed calculations</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-258"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-258"><span class="linenos">258</span></a>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-259"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-259"><span class="linenos">259</span></a><span class="sd">        Returns:</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-260"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-260"><span class="linenos">260</span></a><span class="sd">            Revenue change in billions (negative = revenue loss)</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-261"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-262"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-263"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-263"><span class="linenos">263</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-264"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-264"><span class="linenos">264</span></a>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-265"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-265"><span class="linenos">265</span></a>        <span class="c1"># Use CBO estimate for TCJA extension</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-266"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-266"><span class="linenos">266</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_tcja_exemption</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-267"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-267"><span class="linenos">267</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">CBO_ESTATE_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;extend_tcja_annual&quot;</span><span class="p">]</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-268"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-268"><span class="linenos">268</span></a>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-269"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-269"><span class="linenos">269</span></a>        <span class="c1"># Calculate from exemption/rate changes</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-270"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-270"><span class="linenos">270</span></a>        <span class="n">baseline_exemption</span> <span class="o">=</span> <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-271"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-271"><span class="linenos">271</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># First full year</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-272"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-272"><span class="linenos">272</span></a>            <span class="n">ESTATE_TAX_EXEMPTIONS</span><span class="p">[</span><span class="mi">2026</span><span class="p">]</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-273"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-273"><span class="linenos">273</span></a>        <span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-274"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-274"><span class="linenos">274</span></a>        <span class="n">policy_exemption</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exemption_for_year</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-275"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-275"><span class="linenos">275</span></a>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-276"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-276"><span class="linenos">276</span></a>        <span class="c1"># Get taxable estates under each scenario</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-277"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-277"><span class="linenos">277</span></a>        <span class="n">baseline_estates</span><span class="p">,</span> <span class="n">baseline_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_taxable_estates</span><span class="p">(</span><span class="n">baseline_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-278"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-278"><span class="linenos">278</span></a>        <span class="n">policy_estates</span><span class="p">,</span> <span class="n">policy_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_taxable_estates</span><span class="p">(</span><span class="n">policy_exemption</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-279"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-279"><span class="linenos">279</span></a>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-280"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-280"><span class="linenos">280</span></a>        <span class="c1"># Calculate revenue</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-281"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-281"><span class="linenos">281</span></a>        <span class="n">baseline_rate</span> <span class="o">=</span> <span class="n">CURRENT_ESTATE_TAX_RATE</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-282"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-282"><span class="linenos">282</span></a>        <span class="n">policy_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rate_for_year</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-283"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-283"><span class="linenos">283</span></a>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-284"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-284"><span class="linenos">284</span></a>        <span class="n">baseline_revenue</span> <span class="o">=</span> <span class="n">baseline_estates</span> <span class="o">*</span> <span class="n">baseline_avg</span> <span class="o">*</span> <span class="n">baseline_rate</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-285"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-285"><span class="linenos">285</span></a>        <span class="n">policy_revenue</span> <span class="o">=</span> <span class="n">policy_estates</span> <span class="o">*</span> <span class="n">policy_avg</span> <span class="o">*</span> <span class="n">policy_rate</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-286"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-286"><span class="linenos">286</span></a>
</span><span id="EstateTaxPolicy.estimate_static_revenue_effect-287"><a href="#EstateTaxPolicy.estimate_static_revenue_effect-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="n">policy_revenue</span> <span class="o">-</span> <span class="n">baseline_revenue</span>
</span></pre></div>


            <div class="docstring"><p>Estimate static revenue effect of estate tax policy change.</p>

<p>Args:
    baseline_revenue: Baseline estate tax revenue (billions)
    use_real_data: Whether to use detailed calculations</p>

<p>Returns:
    Revenue change in billions (negative = revenue loss)</p>
</div>


                            </div>
                            <div id="EstateTaxPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="EstateTaxPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="EstateTaxPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EstateTaxPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EstateTaxPolicy.estimate_behavioral_offset-289"><a href="#EstateTaxPolicy.estimate_behavioral_offset-289"><span class="linenos">289</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-290"><a href="#EstateTaxPolicy.estimate_behavioral_offset-290"><span class="linenos">290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-291"><a href="#EstateTaxPolicy.estimate_behavioral_offset-291"><span class="linenos">291</span></a><span class="sd">        Estimate behavioral response to estate tax changes.</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-292"><a href="#EstateTaxPolicy.estimate_behavioral_offset-292"><span class="linenos">292</span></a>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-293"><a href="#EstateTaxPolicy.estimate_behavioral_offset-293"><span class="linenos">293</span></a><span class="sd">        Behavioral responses include:</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-294"><a href="#EstateTaxPolicy.estimate_behavioral_offset-294"><span class="linenos">294</span></a><span class="sd">        - Estate planning (trusts, family partnerships)</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-295"><a href="#EstateTaxPolicy.estimate_behavioral_offset-295"><span class="linenos">295</span></a><span class="sd">        - Inter vivos gifts to reduce estate</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-296"><a href="#EstateTaxPolicy.estimate_behavioral_offset-296"><span class="linenos">296</span></a><span class="sd">        - Valuation discounts</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-297"><a href="#EstateTaxPolicy.estimate_behavioral_offset-297"><span class="linenos">297</span></a><span class="sd">        - Charitable giving</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-298"><a href="#EstateTaxPolicy.estimate_behavioral_offset-298"><span class="linenos">298</span></a>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-299"><a href="#EstateTaxPolicy.estimate_behavioral_offset-299"><span class="linenos">299</span></a><span class="sd">        Returns:</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-300"><a href="#EstateTaxPolicy.estimate_behavioral_offset-300"><span class="linenos">300</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-301"><a href="#EstateTaxPolicy.estimate_behavioral_offset-301"><span class="linenos">301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-302"><a href="#EstateTaxPolicy.estimate_behavioral_offset-302"><span class="linenos">302</span></a>        <span class="c1"># Planning response</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-303"><a href="#EstateTaxPolicy.estimate_behavioral_offset-303"><span class="linenos">303</span></a>        <span class="n">planning_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">planning_elasticity</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-304"><a href="#EstateTaxPolicy.estimate_behavioral_offset-304"><span class="linenos">304</span></a>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-305"><a href="#EstateTaxPolicy.estimate_behavioral_offset-305"><span class="linenos">305</span></a>        <span class="c1"># Gift shifting response</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-306"><a href="#EstateTaxPolicy.estimate_behavioral_offset-306"><span class="linenos">306</span></a>        <span class="n">gift_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gift_shifting_elasticity</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-307"><a href="#EstateTaxPolicy.estimate_behavioral_offset-307"><span class="linenos">307</span></a>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-308"><a href="#EstateTaxPolicy.estimate_behavioral_offset-308"><span class="linenos">308</span></a>        <span class="n">total_offset</span> <span class="o">=</span> <span class="n">planning_offset</span> <span class="o">+</span> <span class="n">gift_offset</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-309"><a href="#EstateTaxPolicy.estimate_behavioral_offset-309"><span class="linenos">309</span></a>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-310"><a href="#EstateTaxPolicy.estimate_behavioral_offset-310"><span class="linenos">310</span></a>        <span class="c1"># Offset reduces revenue gain or loss</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-311"><a href="#EstateTaxPolicy.estimate_behavioral_offset-311"><span class="linenos">311</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-312"><a href="#EstateTaxPolicy.estimate_behavioral_offset-312"><span class="linenos">312</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">total_offset</span>  <span class="c1"># Reduces revenue gain</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-313"><a href="#EstateTaxPolicy.estimate_behavioral_offset-313"><span class="linenos">313</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EstateTaxPolicy.estimate_behavioral_offset-314"><a href="#EstateTaxPolicy.estimate_behavioral_offset-314"><span class="linenos">314</span></a>            <span class="k">return</span> <span class="n">total_offset</span>  <span class="c1"># Reduces revenue loss</span>
</span></pre></div>


            <div class="docstring"><p>Estimate behavioral response to estate tax changes.</p>

<p>Behavioral responses include:</p>

<ul>
<li>Estate planning (trusts, family partnerships)</li>
<li>Inter vivos gifts to reduce estate</li>
<li>Valuation discounts</li>
<li>Charitable giving</li>
</ul>

<p>Returns:
    Behavioral offset in billions</p>
</div>


                            </div>
                </section>
                <section id="EstateTaxScenario">
                            <input id="EstateTaxScenario-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EstateTaxScenario</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="EstateTaxScenario-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EstateTaxScenario"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EstateTaxScenario-36"><a href="#EstateTaxScenario-36"><span class="linenos">36</span></a><span class="k">class</span><span class="w"> </span><span class="nc">EstateTaxScenario</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="EstateTaxScenario-37"><a href="#EstateTaxScenario-37"><span class="linenos">37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Common estate tax policy scenarios.&quot;&quot;&quot;</span>
</span><span id="EstateTaxScenario-38"><a href="#EstateTaxScenario-38"><span class="linenos">38</span></a>    <span class="n">CURRENT_LAW</span> <span class="o">=</span> <span class="s2">&quot;current_law&quot;</span>  <span class="c1"># TCJA expires 2026</span>
</span><span id="EstateTaxScenario-39"><a href="#EstateTaxScenario-39"><span class="linenos">39</span></a>    <span class="n">EXTEND_TCJA</span> <span class="o">=</span> <span class="s2">&quot;extend_tcja&quot;</span>  <span class="c1"># Keep $14M+ exemption</span>
</span><span id="EstateTaxScenario-40"><a href="#EstateTaxScenario-40"><span class="linenos">40</span></a>    <span class="n">LOWER_EXEMPTION</span> <span class="o">=</span> <span class="s2">&quot;lower_exemption&quot;</span>  <span class="c1"># e.g., $3.5M</span>
</span><span id="EstateTaxScenario-41"><a href="#EstateTaxScenario-41"><span class="linenos">41</span></a>    <span class="n">INCREASE_RATE</span> <span class="o">=</span> <span class="s2">&quot;increase_rate&quot;</span>
</span><span id="EstateTaxScenario-42"><a href="#EstateTaxScenario-42"><span class="linenos">42</span></a>    <span class="n">ELIMINATE</span> <span class="o">=</span> <span class="s2">&quot;eliminate&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Common estate tax policy scenarios.</p>
</div>


                            <div id="EstateTaxScenario.CURRENT_LAW" class="classattr">
                                <div class="attr variable">
            <span class="name">CURRENT_LAW</span>        =
<span class="default_value">&lt;<a href="#EstateTaxScenario.CURRENT_LAW">EstateTaxScenario.CURRENT_LAW</a>: &#39;current_law&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxScenario.CURRENT_LAW"></a>
    
    

                            </div>
                            <div id="EstateTaxScenario.EXTEND_TCJA" class="classattr">
                                <div class="attr variable">
            <span class="name">EXTEND_TCJA</span>        =
<span class="default_value">&lt;<a href="#EstateTaxScenario.EXTEND_TCJA">EstateTaxScenario.EXTEND_TCJA</a>: &#39;extend_tcja&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxScenario.EXTEND_TCJA"></a>
    
    

                            </div>
                            <div id="EstateTaxScenario.LOWER_EXEMPTION" class="classattr">
                                <div class="attr variable">
            <span class="name">LOWER_EXEMPTION</span>        =
<span class="default_value">&lt;<a href="#EstateTaxScenario.LOWER_EXEMPTION">EstateTaxScenario.LOWER_EXEMPTION</a>: &#39;lower_exemption&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxScenario.LOWER_EXEMPTION"></a>
    
    

                            </div>
                            <div id="EstateTaxScenario.INCREASE_RATE" class="classattr">
                                <div class="attr variable">
            <span class="name">INCREASE_RATE</span>        =
<span class="default_value">&lt;<a href="#EstateTaxScenario.INCREASE_RATE">EstateTaxScenario.INCREASE_RATE</a>: &#39;increase_rate&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxScenario.INCREASE_RATE"></a>
    
    

                            </div>
                            <div id="EstateTaxScenario.ELIMINATE" class="classattr">
                                <div class="attr variable">
            <span class="name">ELIMINATE</span>        =
<span class="default_value">&lt;<a href="#EstateTaxScenario.ELIMINATE">EstateTaxScenario.ELIMINATE</a>: &#39;eliminate&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#EstateTaxScenario.ELIMINATE"></a>
    
    

                            </div>
                </section>
                <section id="ESTATE_TAX_EXEMPTIONS">
                    <div class="attr variable">
            <span class="name">ESTATE_TAX_EXEMPTIONS</span>        =
<input id="ESTATE_TAX_EXEMPTIONS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="ESTATE_TAX_EXEMPTIONS-view-value"></label><span class="default_value">{2024: 13610000, 2025: 13990000, 2026: 6400000, 2027: 6600000, 2028: 6800000, 2029: 7000000, 2030: 7200000, 2031: 7400000, 2032: 7600000, 2033: 7800000, 2034: 8000000}</span>

        
    </div>
    <a class="headerlink" href="#ESTATE_TAX_EXEMPTIONS"></a>
    
    

                </section>
                <section id="CURRENT_ESTATE_TAX_RATE">
                    <div class="attr variable">
            <span class="name">CURRENT_ESTATE_TAX_RATE</span>        =
<span class="default_value">0.4</span>

        
    </div>
    <a class="headerlink" href="#CURRENT_ESTATE_TAX_RATE"></a>
    
    

                </section>
                <section id="BASELINE_ESTATE_DATA">
                    <div class="attr variable">
            <span class="name">BASELINE_ESTATE_DATA</span>        =
<input id="BASELINE_ESTATE_DATA-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="BASELINE_ESTATE_DATA-view-value"></label><span class="default_value">{&#39;revenue_2024&#39;: 32.0, &#39;revenue_baseline_2026&#39;: 50.0, &#39;taxable_estates_tcja&#39;: 7000, &#39;taxable_estates_post_tcja&#39;: 19000, &#39;avg_taxable_amount_tcja&#39;: 8000000, &#39;avg_taxable_amount_post_tcja&#39;: 4000000, &#39;annual_deaths&#39;: 2800000, &#39;planning_elasticity&#39;: 0.15, &#39;gift_shifting_rate&#39;: 0.1}</span>

        
    </div>
    <a class="headerlink" href="#BASELINE_ESTATE_DATA"></a>
    
    

                </section>
                <section id="CBO_ESTATE_ESTIMATES">
                    <div class="attr variable">
            <span class="name">CBO_ESTATE_ESTIMATES</span>        =
<input id="CBO_ESTATE_ESTIMATES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="CBO_ESTATE_ESTIMATES-view-value"></label><span class="default_value">{&#39;extend_tcja_10yr&#39;: 167.0, &#39;extend_tcja_annual&#39;: 16.7, &#39;permanent_extension_10yr&#39;: 201.0, &#39;total_revenue_10yr&#39;: 372.0}</span>

        
    </div>
    <a class="headerlink" href="#CBO_ESTATE_ESTIMATES"></a>
    
    

                </section>
                <section id="create_tcja_estate_extension">
                            <input id="create_tcja_estate_extension-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_tcja_estate_extension</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#EstateTaxPolicy">EstateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_tcja_estate_extension-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_tcja_estate_extension"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_tcja_estate_extension-321"><a href="#create_tcja_estate_extension-321"><span class="linenos">321</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_tcja_estate_extension</span><span class="p">(</span>
</span><span id="create_tcja_estate_extension-322"><a href="#create_tcja_estate_extension-322"><span class="linenos">322</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-323"><a href="#create_tcja_estate_extension-323"><span class="linenos">323</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-324"><a href="#create_tcja_estate_extension-324"><span class="linenos">324</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EstateTaxPolicy</span><span class="p">:</span>
</span><span id="create_tcja_estate_extension-325"><a href="#create_tcja_estate_extension-325"><span class="linenos">325</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_tcja_estate_extension-326"><a href="#create_tcja_estate_extension-326"><span class="linenos">326</span></a><span class="sd">    Create policy to extend TCJA estate tax exemption.</span>
</span><span id="create_tcja_estate_extension-327"><a href="#create_tcja_estate_extension-327"><span class="linenos">327</span></a>
</span><span id="create_tcja_estate_extension-328"><a href="#create_tcja_estate_extension-328"><span class="linenos">328</span></a><span class="sd">    Keeps the ~$14M exemption (indexed) instead of reverting</span>
</span><span id="create_tcja_estate_extension-329"><a href="#create_tcja_estate_extension-329"><span class="linenos">329</span></a><span class="sd">    to ~$6.4M in 2026.</span>
</span><span id="create_tcja_estate_extension-330"><a href="#create_tcja_estate_extension-330"><span class="linenos">330</span></a>
</span><span id="create_tcja_estate_extension-331"><a href="#create_tcja_estate_extension-331"><span class="linenos">331</span></a><span class="sd">    CBO estimate: $167B cost over 10 years</span>
</span><span id="create_tcja_estate_extension-332"><a href="#create_tcja_estate_extension-332"><span class="linenos">332</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_tcja_estate_extension-333"><a href="#create_tcja_estate_extension-333"><span class="linenos">333</span></a>    <span class="k">return</span> <span class="n">EstateTaxPolicy</span><span class="p">(</span>
</span><span id="create_tcja_estate_extension-334"><a href="#create_tcja_estate_extension-334"><span class="linenos">334</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Extend TCJA Estate Exemption&quot;</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-335"><a href="#create_tcja_estate_extension-335"><span class="linenos">335</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extend doubled estate tax exemption (~$14M vs ~$6.4M) beyond 2025&quot;</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-336"><a href="#create_tcja_estate_extension-336"><span class="linenos">336</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">ESTATE_TAX</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-337"><a href="#create_tcja_estate_extension-337"><span class="linenos">337</span></a>        <span class="n">extend_tcja_exemption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-338"><a href="#create_tcja_estate_extension-338"><span class="linenos">338</span></a>        <span class="n">planning_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Behavioral response already in calibration</span>
</span><span id="create_tcja_estate_extension-339"><a href="#create_tcja_estate_extension-339"><span class="linenos">339</span></a>        <span class="c1"># Calibrated to CBO $167B over 10 years (with 3% annual growth)</span>
</span><span id="create_tcja_estate_extension-340"><a href="#create_tcja_estate_extension-340"><span class="linenos">340</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">14.6</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-341"><a href="#create_tcja_estate_extension-341"><span class="linenos">341</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-342"><a href="#create_tcja_estate_extension-342"><span class="linenos">342</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_tcja_estate_extension-343"><a href="#create_tcja_estate_extension-343"><span class="linenos">343</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to extend TCJA estate tax exemption.</p>

<p>Keeps the ~$14M exemption (indexed) instead of reverting
to ~$6.4M in 2026.</p>

<p>CBO estimate: $167B cost over 10 years</p>
</div>


                </section>
                <section id="create_biden_estate_proposal">
                            <input id="create_biden_estate_proposal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_biden_estate_proposal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">exemption</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">3500000</span>,</span><span class="param">	<span class="n">rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.45</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#EstateTaxPolicy">EstateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_biden_estate_proposal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_biden_estate_proposal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_biden_estate_proposal-346"><a href="#create_biden_estate_proposal-346"><span class="linenos">346</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_biden_estate_proposal</span><span class="p">(</span>
</span><span id="create_biden_estate_proposal-347"><a href="#create_biden_estate_proposal-347"><span class="linenos">347</span></a>    <span class="n">exemption</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">3_500_000</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-348"><a href="#create_biden_estate_proposal-348"><span class="linenos">348</span></a>    <span class="n">rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.45</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-349"><a href="#create_biden_estate_proposal-349"><span class="linenos">349</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-350"><a href="#create_biden_estate_proposal-350"><span class="linenos">350</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-351"><a href="#create_biden_estate_proposal-351"><span class="linenos">351</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EstateTaxPolicy</span><span class="p">:</span>
</span><span id="create_biden_estate_proposal-352"><a href="#create_biden_estate_proposal-352"><span class="linenos">352</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_biden_estate_proposal-353"><a href="#create_biden_estate_proposal-353"><span class="linenos">353</span></a><span class="sd">    Create Biden-style estate tax reform.</span>
</span><span id="create_biden_estate_proposal-354"><a href="#create_biden_estate_proposal-354"><span class="linenos">354</span></a>
</span><span id="create_biden_estate_proposal-355"><a href="#create_biden_estate_proposal-355"><span class="linenos">355</span></a><span class="sd">    Key features:</span>
</span><span id="create_biden_estate_proposal-356"><a href="#create_biden_estate_proposal-356"><span class="linenos">356</span></a><span class="sd">    - Lower exemption to $3.5M (from $14M)</span>
</span><span id="create_biden_estate_proposal-357"><a href="#create_biden_estate_proposal-357"><span class="linenos">357</span></a><span class="sd">    - Increase rate to 45% (from 40%)</span>
</span><span id="create_biden_estate_proposal-358"><a href="#create_biden_estate_proposal-358"><span class="linenos">358</span></a>
</span><span id="create_biden_estate_proposal-359"><a href="#create_biden_estate_proposal-359"><span class="linenos">359</span></a><span class="sd">    This would dramatically increase taxable estates and revenue.</span>
</span><span id="create_biden_estate_proposal-360"><a href="#create_biden_estate_proposal-360"><span class="linenos">360</span></a><span class="sd">    Treasury estimate: ~$450B over 10 years</span>
</span><span id="create_biden_estate_proposal-361"><a href="#create_biden_estate_proposal-361"><span class="linenos">361</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_biden_estate_proposal-362"><a href="#create_biden_estate_proposal-362"><span class="linenos">362</span></a>    <span class="k">return</span> <span class="n">EstateTaxPolicy</span><span class="p">(</span>
</span><span id="create_biden_estate_proposal-363"><a href="#create_biden_estate_proposal-363"><span class="linenos">363</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Biden Estate Tax Reform&quot;</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-364"><a href="#create_biden_estate_proposal-364"><span class="linenos">364</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Lower exemption to $</span><span class="si">{</span><span class="n">exemption</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">M, raise rate to </span><span class="si">{</span><span class="n">rate</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-365"><a href="#create_biden_estate_proposal-365"><span class="linenos">365</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">ESTATE_TAX</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-366"><a href="#create_biden_estate_proposal-366"><span class="linenos">366</span></a>        <span class="n">new_exemption</span><span class="o">=</span><span class="n">exemption</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-367"><a href="#create_biden_estate_proposal-367"><span class="linenos">367</span></a>        <span class="n">new_rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-368"><a href="#create_biden_estate_proposal-368"><span class="linenos">368</span></a>        <span class="n">planning_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Behavioral response in calibration</span>
</span><span id="create_biden_estate_proposal-369"><a href="#create_biden_estate_proposal-369"><span class="linenos">369</span></a>        <span class="c1"># Calibrated to Treasury ~$450B over 10 years (with 3% growth)</span>
</span><span id="create_biden_estate_proposal-370"><a href="#create_biden_estate_proposal-370"><span class="linenos">370</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">39.3</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-371"><a href="#create_biden_estate_proposal-371"><span class="linenos">371</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-372"><a href="#create_biden_estate_proposal-372"><span class="linenos">372</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_biden_estate_proposal-373"><a href="#create_biden_estate_proposal-373"><span class="linenos">373</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create Biden-style estate tax reform.</p>

<p>Key features:</p>

<ul>
<li>Lower exemption to $3.5M (from $14M)</li>
<li>Increase rate to 45% (from 40%)</li>
</ul>

<p>This would dramatically increase taxable estates and revenue.
Treasury estimate: ~$450B over 10 years</p>
</div>


                </section>
                <section id="create_warren_estate_proposal">
                            <input id="create_warren_estate_proposal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_warren_estate_proposal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#EstateTaxPolicy">EstateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_warren_estate_proposal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_warren_estate_proposal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_warren_estate_proposal-376"><a href="#create_warren_estate_proposal-376"><span class="linenos">376</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_warren_estate_proposal</span><span class="p">(</span>
</span><span id="create_warren_estate_proposal-377"><a href="#create_warren_estate_proposal-377"><span class="linenos">377</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-378"><a href="#create_warren_estate_proposal-378"><span class="linenos">378</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-379"><a href="#create_warren_estate_proposal-379"><span class="linenos">379</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EstateTaxPolicy</span><span class="p">:</span>
</span><span id="create_warren_estate_proposal-380"><a href="#create_warren_estate_proposal-380"><span class="linenos">380</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_warren_estate_proposal-381"><a href="#create_warren_estate_proposal-381"><span class="linenos">381</span></a><span class="sd">    Create Warren-style progressive estate tax.</span>
</span><span id="create_warren_estate_proposal-382"><a href="#create_warren_estate_proposal-382"><span class="linenos">382</span></a>
</span><span id="create_warren_estate_proposal-383"><a href="#create_warren_estate_proposal-383"><span class="linenos">383</span></a><span class="sd">    Key features:</span>
</span><span id="create_warren_estate_proposal-384"><a href="#create_warren_estate_proposal-384"><span class="linenos">384</span></a><span class="sd">    - $3.5M exemption</span>
</span><span id="create_warren_estate_proposal-385"><a href="#create_warren_estate_proposal-385"><span class="linenos">385</span></a><span class="sd">    - Progressive rates: 45% up to $10M, 55% up to $50M, 65% over $1B</span>
</span><span id="create_warren_estate_proposal-386"><a href="#create_warren_estate_proposal-386"><span class="linenos">386</span></a><span class="sd">    - Limit valuation discounts</span>
</span><span id="create_warren_estate_proposal-387"><a href="#create_warren_estate_proposal-387"><span class="linenos">387</span></a>
</span><span id="create_warren_estate_proposal-388"><a href="#create_warren_estate_proposal-388"><span class="linenos">388</span></a><span class="sd">    For simplicity, we use the effective average rate.</span>
</span><span id="create_warren_estate_proposal-389"><a href="#create_warren_estate_proposal-389"><span class="linenos">389</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_warren_estate_proposal-390"><a href="#create_warren_estate_proposal-390"><span class="linenos">390</span></a>    <span class="k">return</span> <span class="n">EstateTaxPolicy</span><span class="p">(</span>
</span><span id="create_warren_estate_proposal-391"><a href="#create_warren_estate_proposal-391"><span class="linenos">391</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Warren Progressive Estate Tax&quot;</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-392"><a href="#create_warren_estate_proposal-392"><span class="linenos">392</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$3.5M exemption, progressive rates up to 65</span><span class="si">% o</span><span class="s2">n billionaires&quot;</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-393"><a href="#create_warren_estate_proposal-393"><span class="linenos">393</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">ESTATE_TAX</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-394"><a href="#create_warren_estate_proposal-394"><span class="linenos">394</span></a>        <span class="n">new_exemption</span><span class="o">=</span><span class="mi">3_500_000</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-395"><a href="#create_warren_estate_proposal-395"><span class="linenos">395</span></a>        <span class="n">new_rate</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span>  <span class="c1"># Effective average rate</span>
</span><span id="create_warren_estate_proposal-396"><a href="#create_warren_estate_proposal-396"><span class="linenos">396</span></a>        <span class="n">limit_valuation_discounts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-397"><a href="#create_warren_estate_proposal-397"><span class="linenos">397</span></a>        <span class="n">discount_limit_pct</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-398"><a href="#create_warren_estate_proposal-398"><span class="linenos">398</span></a>        <span class="n">planning_elasticity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># High response to aggressive policy</span>
</span><span id="create_warren_estate_proposal-399"><a href="#create_warren_estate_proposal-399"><span class="linenos">399</span></a>        <span class="c1"># Penn Wharton estimated ~$2.6T over 10 years</span>
</span><span id="create_warren_estate_proposal-400"><a href="#create_warren_estate_proposal-400"><span class="linenos">400</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">260.0</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-401"><a href="#create_warren_estate_proposal-401"><span class="linenos">401</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-402"><a href="#create_warren_estate_proposal-402"><span class="linenos">402</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_warren_estate_proposal-403"><a href="#create_warren_estate_proposal-403"><span class="linenos">403</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create Warren-style progressive estate tax.</p>

<p>Key features:</p>

<ul>
<li>$3.5M exemption</li>
<li>Progressive rates: 45% up to $10M, 55% up to $50M, 65% over $1B</li>
<li>Limit valuation discounts</li>
</ul>

<p>For simplicity, we use the effective average rate.</p>
</div>


                </section>
                <section id="create_estate_rate_change">
                            <input id="create_estate_rate_change-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_estate_rate_change</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#EstateTaxPolicy">EstateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_estate_rate_change-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_estate_rate_change"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_estate_rate_change-406"><a href="#create_estate_rate_change-406"><span class="linenos">406</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_estate_rate_change</span><span class="p">(</span>
</span><span id="create_estate_rate_change-407"><a href="#create_estate_rate_change-407"><span class="linenos">407</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_estate_rate_change-408"><a href="#create_estate_rate_change-408"><span class="linenos">408</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_estate_rate_change-409"><a href="#create_estate_rate_change-409"><span class="linenos">409</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_estate_rate_change-410"><a href="#create_estate_rate_change-410"><span class="linenos">410</span></a>    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="create_estate_rate_change-411"><a href="#create_estate_rate_change-411"><span class="linenos">411</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EstateTaxPolicy</span><span class="p">:</span>
</span><span id="create_estate_rate_change-412"><a href="#create_estate_rate_change-412"><span class="linenos">412</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_estate_rate_change-413"><a href="#create_estate_rate_change-413"><span class="linenos">413</span></a><span class="sd">    Create a simple estate tax rate change.</span>
</span><span id="create_estate_rate_change-414"><a href="#create_estate_rate_change-414"><span class="linenos">414</span></a>
</span><span id="create_estate_rate_change-415"><a href="#create_estate_rate_change-415"><span class="linenos">415</span></a><span class="sd">    Args:</span>
</span><span id="create_estate_rate_change-416"><a href="#create_estate_rate_change-416"><span class="linenos">416</span></a><span class="sd">        rate_change: Change in rate (e.g., 0.05 for 5pp increase)</span>
</span><span id="create_estate_rate_change-417"><a href="#create_estate_rate_change-417"><span class="linenos">417</span></a><span class="sd">        start_year: First year of policy</span>
</span><span id="create_estate_rate_change-418"><a href="#create_estate_rate_change-418"><span class="linenos">418</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_estate_rate_change-419"><a href="#create_estate_rate_change-419"><span class="linenos">419</span></a><span class="sd">        name: Optional custom name</span>
</span><span id="create_estate_rate_change-420"><a href="#create_estate_rate_change-420"><span class="linenos">420</span></a>
</span><span id="create_estate_rate_change-421"><a href="#create_estate_rate_change-421"><span class="linenos">421</span></a><span class="sd">    Returns:</span>
</span><span id="create_estate_rate_change-422"><a href="#create_estate_rate_change-422"><span class="linenos">422</span></a><span class="sd">        EstateTaxPolicy for rate change</span>
</span><span id="create_estate_rate_change-423"><a href="#create_estate_rate_change-423"><span class="linenos">423</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_estate_rate_change-424"><a href="#create_estate_rate_change-424"><span class="linenos">424</span></a>    <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;increase&quot;</span> <span class="k">if</span> <span class="n">rate_change</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;decrease&quot;</span>
</span><span id="create_estate_rate_change-425"><a href="#create_estate_rate_change-425"><span class="linenos">425</span></a>    <span class="n">new_rate</span> <span class="o">=</span> <span class="n">CURRENT_ESTATE_TAX_RATE</span> <span class="o">+</span> <span class="n">rate_change</span>
</span><span id="create_estate_rate_change-426"><a href="#create_estate_rate_change-426"><span class="linenos">426</span></a>
</span><span id="create_estate_rate_change-427"><a href="#create_estate_rate_change-427"><span class="linenos">427</span></a>    <span class="c1"># Estimate revenue effect</span>
</span><span id="create_estate_rate_change-428"><a href="#create_estate_rate_change-428"><span class="linenos">428</span></a>    <span class="c1"># ~$32B baseline revenue, rate change proportional</span>
</span><span id="create_estate_rate_change-429"><a href="#create_estate_rate_change-429"><span class="linenos">429</span></a>    <span class="n">baseline_revenue</span> <span class="o">=</span> <span class="n">BASELINE_ESTATE_DATA</span><span class="p">[</span><span class="s2">&quot;revenue_2024&quot;</span><span class="p">]</span>
</span><span id="create_estate_rate_change-430"><a href="#create_estate_rate_change-430"><span class="linenos">430</span></a>    <span class="n">static_pct_change</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">/</span> <span class="n">CURRENT_ESTATE_TAX_RATE</span>
</span><span id="create_estate_rate_change-431"><a href="#create_estate_rate_change-431"><span class="linenos">431</span></a>    <span class="n">annual_change</span> <span class="o">=</span> <span class="n">baseline_revenue</span> <span class="o">*</span> <span class="n">static_pct_change</span>
</span><span id="create_estate_rate_change-432"><a href="#create_estate_rate_change-432"><span class="linenos">432</span></a>
</span><span id="create_estate_rate_change-433"><a href="#create_estate_rate_change-433"><span class="linenos">433</span></a>    <span class="k">return</span> <span class="n">EstateTaxPolicy</span><span class="p">(</span>
</span><span id="create_estate_rate_change-434"><a href="#create_estate_rate_change-434"><span class="linenos">434</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Estate Tax Rate </span><span class="si">{</span><span class="n">direction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">new_rate</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
</span><span id="create_estate_rate_change-435"><a href="#create_estate_rate_change-435"><span class="linenos">435</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Change estate tax rate from 40% to </span><span class="si">{</span><span class="n">new_rate</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
</span><span id="create_estate_rate_change-436"><a href="#create_estate_rate_change-436"><span class="linenos">436</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">ESTATE_TAX</span><span class="p">,</span>
</span><span id="create_estate_rate_change-437"><a href="#create_estate_rate_change-437"><span class="linenos">437</span></a>        <span class="n">rate_change</span><span class="o">=</span><span class="n">rate_change</span><span class="p">,</span>
</span><span id="create_estate_rate_change-438"><a href="#create_estate_rate_change-438"><span class="linenos">438</span></a>        <span class="n">planning_elasticity</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
</span><span id="create_estate_rate_change-439"><a href="#create_estate_rate_change-439"><span class="linenos">439</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="n">annual_change</span><span class="p">,</span>
</span><span id="create_estate_rate_change-440"><a href="#create_estate_rate_change-440"><span class="linenos">440</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_estate_rate_change-441"><a href="#create_estate_rate_change-441"><span class="linenos">441</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_estate_rate_change-442"><a href="#create_estate_rate_change-442"><span class="linenos">442</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a simple estate tax rate change.</p>

<p>Args:
    rate_change: Change in rate (e.g., 0.05 for 5pp increase)
    start_year: First year of policy
    duration_years: Duration
    name: Optional custom name</p>

<p>Returns:
    EstateTaxPolicy for rate change</p>
</div>


                </section>
                <section id="create_estate_exemption_change">
                            <input id="create_estate_exemption_change-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_estate_exemption_change</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">new_exemption</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#EstateTaxPolicy">EstateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_estate_exemption_change-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_estate_exemption_change"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_estate_exemption_change-445"><a href="#create_estate_exemption_change-445"><span class="linenos">445</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_estate_exemption_change</span><span class="p">(</span>
</span><span id="create_estate_exemption_change-446"><a href="#create_estate_exemption_change-446"><span class="linenos">446</span></a>    <span class="n">new_exemption</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-447"><a href="#create_estate_exemption_change-447"><span class="linenos">447</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-448"><a href="#create_estate_exemption_change-448"><span class="linenos">448</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-449"><a href="#create_estate_exemption_change-449"><span class="linenos">449</span></a>    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-450"><a href="#create_estate_exemption_change-450"><span class="linenos">450</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EstateTaxPolicy</span><span class="p">:</span>
</span><span id="create_estate_exemption_change-451"><a href="#create_estate_exemption_change-451"><span class="linenos">451</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_estate_exemption_change-452"><a href="#create_estate_exemption_change-452"><span class="linenos">452</span></a><span class="sd">    Create an estate tax exemption change policy.</span>
</span><span id="create_estate_exemption_change-453"><a href="#create_estate_exemption_change-453"><span class="linenos">453</span></a>
</span><span id="create_estate_exemption_change-454"><a href="#create_estate_exemption_change-454"><span class="linenos">454</span></a><span class="sd">    Args:</span>
</span><span id="create_estate_exemption_change-455"><a href="#create_estate_exemption_change-455"><span class="linenos">455</span></a><span class="sd">        new_exemption: New exemption level in dollars</span>
</span><span id="create_estate_exemption_change-456"><a href="#create_estate_exemption_change-456"><span class="linenos">456</span></a><span class="sd">        start_year: First year of policy</span>
</span><span id="create_estate_exemption_change-457"><a href="#create_estate_exemption_change-457"><span class="linenos">457</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_estate_exemption_change-458"><a href="#create_estate_exemption_change-458"><span class="linenos">458</span></a><span class="sd">        name: Optional custom name</span>
</span><span id="create_estate_exemption_change-459"><a href="#create_estate_exemption_change-459"><span class="linenos">459</span></a>
</span><span id="create_estate_exemption_change-460"><a href="#create_estate_exemption_change-460"><span class="linenos">460</span></a><span class="sd">    Returns:</span>
</span><span id="create_estate_exemption_change-461"><a href="#create_estate_exemption_change-461"><span class="linenos">461</span></a><span class="sd">        EstateTaxPolicy for exemption change</span>
</span><span id="create_estate_exemption_change-462"><a href="#create_estate_exemption_change-462"><span class="linenos">462</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_estate_exemption_change-463"><a href="#create_estate_exemption_change-463"><span class="linenos">463</span></a>    <span class="n">policy</span> <span class="o">=</span> <span class="n">EstateTaxPolicy</span><span class="p">(</span>
</span><span id="create_estate_exemption_change-464"><a href="#create_estate_exemption_change-464"><span class="linenos">464</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Estate Exemption to $</span><span class="si">{</span><span class="n">new_exemption</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">M&quot;</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-465"><a href="#create_estate_exemption_change-465"><span class="linenos">465</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Set estate tax exemption to $</span><span class="si">{</span><span class="n">new_exemption</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-466"><a href="#create_estate_exemption_change-466"><span class="linenos">466</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">ESTATE_TAX</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-467"><a href="#create_estate_exemption_change-467"><span class="linenos">467</span></a>        <span class="n">new_exemption</span><span class="o">=</span><span class="n">new_exemption</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-468"><a href="#create_estate_exemption_change-468"><span class="linenos">468</span></a>        <span class="n">planning_elasticity</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-469"><a href="#create_estate_exemption_change-469"><span class="linenos">469</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-470"><a href="#create_estate_exemption_change-470"><span class="linenos">470</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_estate_exemption_change-471"><a href="#create_estate_exemption_change-471"><span class="linenos">471</span></a>    <span class="p">)</span>
</span><span id="create_estate_exemption_change-472"><a href="#create_estate_exemption_change-472"><span class="linenos">472</span></a>
</span><span id="create_estate_exemption_change-473"><a href="#create_estate_exemption_change-473"><span class="linenos">473</span></a>    <span class="c1"># Calculate annual revenue change</span>
</span><span id="create_estate_exemption_change-474"><a href="#create_estate_exemption_change-474"><span class="linenos">474</span></a>    <span class="n">annual_change</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="create_estate_exemption_change-475"><a href="#create_estate_exemption_change-475"><span class="linenos">475</span></a>    <span class="n">policy</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="o">=</span> <span class="n">annual_change</span>
</span><span id="create_estate_exemption_change-476"><a href="#create_estate_exemption_change-476"><span class="linenos">476</span></a>
</span><span id="create_estate_exemption_change-477"><a href="#create_estate_exemption_change-477"><span class="linenos">477</span></a>    <span class="k">return</span> <span class="n">policy</span>
</span></pre></div>


            <div class="docstring"><p>Create an estate tax exemption change policy.</p>

<p>Args:
    new_exemption: New exemption level in dollars
    start_year: First year of policy
    duration_years: Duration
    name: Optional custom name</p>

<p>Returns:
    EstateTaxPolicy for exemption change</p>
</div>


                </section>
                <section id="create_eliminate_estate_tax">
                            <input id="create_eliminate_estate_tax-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_eliminate_estate_tax</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#EstateTaxPolicy">EstateTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_eliminate_estate_tax-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_eliminate_estate_tax"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_eliminate_estate_tax-480"><a href="#create_eliminate_estate_tax-480"><span class="linenos">480</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_eliminate_estate_tax</span><span class="p">(</span>
</span><span id="create_eliminate_estate_tax-481"><a href="#create_eliminate_estate_tax-481"><span class="linenos">481</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-482"><a href="#create_eliminate_estate_tax-482"><span class="linenos">482</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-483"><a href="#create_eliminate_estate_tax-483"><span class="linenos">483</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EstateTaxPolicy</span><span class="p">:</span>
</span><span id="create_eliminate_estate_tax-484"><a href="#create_eliminate_estate_tax-484"><span class="linenos">484</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_eliminate_estate_tax-485"><a href="#create_eliminate_estate_tax-485"><span class="linenos">485</span></a><span class="sd">    Create policy to eliminate the estate tax entirely.</span>
</span><span id="create_eliminate_estate_tax-486"><a href="#create_eliminate_estate_tax-486"><span class="linenos">486</span></a>
</span><span id="create_eliminate_estate_tax-487"><a href="#create_eliminate_estate_tax-487"><span class="linenos">487</span></a><span class="sd">    Estimated cost: ~$350B over 10 years (foregone revenue)</span>
</span><span id="create_eliminate_estate_tax-488"><a href="#create_eliminate_estate_tax-488"><span class="linenos">488</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_eliminate_estate_tax-489"><a href="#create_eliminate_estate_tax-489"><span class="linenos">489</span></a>    <span class="k">return</span> <span class="n">EstateTaxPolicy</span><span class="p">(</span>
</span><span id="create_eliminate_estate_tax-490"><a href="#create_eliminate_estate_tax-490"><span class="linenos">490</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Eliminate Estate Tax&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-491"><a href="#create_eliminate_estate_tax-491"><span class="linenos">491</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Repeal the federal estate tax entirely&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-492"><a href="#create_eliminate_estate_tax-492"><span class="linenos">492</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">ESTATE_TAX</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-493"><a href="#create_eliminate_estate_tax-493"><span class="linenos">493</span></a>        <span class="n">new_exemption</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span>  <span class="c1"># Effectively no tax</span>
</span><span id="create_eliminate_estate_tax-494"><a href="#create_eliminate_estate_tax-494"><span class="linenos">494</span></a>        <span class="n">new_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-495"><a href="#create_eliminate_estate_tax-495"><span class="linenos">495</span></a>        <span class="n">planning_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># No behavioral offset needed</span>
</span><span id="create_eliminate_estate_tax-496"><a href="#create_eliminate_estate_tax-496"><span class="linenos">496</span></a>        <span class="c1"># Calibrated: ~$350B over 10 years (with 3% growth)</span>
</span><span id="create_eliminate_estate_tax-497"><a href="#create_eliminate_estate_tax-497"><span class="linenos">497</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">30.6</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-498"><a href="#create_eliminate_estate_tax-498"><span class="linenos">498</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-499"><a href="#create_eliminate_estate_tax-499"><span class="linenos">499</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_eliminate_estate_tax-500"><a href="#create_eliminate_estate_tax-500"><span class="linenos">500</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to eliminate the estate tax entirely.</p>

<p>Estimated cost: ~$350B over 10 years (foregone revenue)</p>
</div>


                </section>
                <section id="estimate_estate_revenue">
                            <input id="estimate_estate_revenue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_estate_revenue</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#EstateTaxPolicy">EstateTaxPolicy</a></span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="estimate_estate_revenue-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#estimate_estate_revenue"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="estimate_estate_revenue-525"><a href="#estimate_estate_revenue-525"><span class="linenos">525</span></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_estate_revenue</span><span class="p">(</span><span class="n">policy</span><span class="p">:</span> <span class="n">EstateTaxPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="estimate_estate_revenue-526"><a href="#estimate_estate_revenue-526"><span class="linenos">526</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="estimate_estate_revenue-527"><a href="#estimate_estate_revenue-527"><span class="linenos">527</span></a><span class="sd">    Estimate total revenue effect of an estate tax policy.</span>
</span><span id="estimate_estate_revenue-528"><a href="#estimate_estate_revenue-528"><span class="linenos">528</span></a>
</span><span id="estimate_estate_revenue-529"><a href="#estimate_estate_revenue-529"><span class="linenos">529</span></a><span class="sd">    Returns dict with:</span>
</span><span id="estimate_estate_revenue-530"><a href="#estimate_estate_revenue-530"><span class="linenos">530</span></a><span class="sd">        - annual_static: Average annual static effect</span>
</span><span id="estimate_estate_revenue-531"><a href="#estimate_estate_revenue-531"><span class="linenos">531</span></a><span class="sd">        - ten_year_static: Total 10-year static effect</span>
</span><span id="estimate_estate_revenue-532"><a href="#estimate_estate_revenue-532"><span class="linenos">532</span></a><span class="sd">        - behavioral_offset: Total behavioral offset</span>
</span><span id="estimate_estate_revenue-533"><a href="#estimate_estate_revenue-533"><span class="linenos">533</span></a><span class="sd">        - net_effect: Final effect after behavioral response</span>
</span><span id="estimate_estate_revenue-534"><a href="#estimate_estate_revenue-534"><span class="linenos">534</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="estimate_estate_revenue-535"><a href="#estimate_estate_revenue-535"><span class="linenos">535</span></a>    <span class="n">annual_static</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="estimate_estate_revenue-536"><a href="#estimate_estate_revenue-536"><span class="linenos">536</span></a>    <span class="n">behavioral</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">annual_static</span><span class="p">)</span>
</span><span id="estimate_estate_revenue-537"><a href="#estimate_estate_revenue-537"><span class="linenos">537</span></a>
</span><span id="estimate_estate_revenue-538"><a href="#estimate_estate_revenue-538"><span class="linenos">538</span></a>    <span class="c1"># Apply growth (~3%/year for wealth growth)</span>
</span><span id="estimate_estate_revenue-539"><a href="#estimate_estate_revenue-539"><span class="linenos">539</span></a>    <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="estimate_estate_revenue-540"><a href="#estimate_estate_revenue-540"><span class="linenos">540</span></a>    <span class="n">annual_effects</span> <span class="o">=</span> <span class="n">annual_static</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.03</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_estate_revenue-541"><a href="#estimate_estate_revenue-541"><span class="linenos">541</span></a>    <span class="n">behavioral_effects</span> <span class="o">=</span> <span class="n">behavioral</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.03</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_estate_revenue-542"><a href="#estimate_estate_revenue-542"><span class="linenos">542</span></a>
</span><span id="estimate_estate_revenue-543"><a href="#estimate_estate_revenue-543"><span class="linenos">543</span></a>    <span class="n">ten_year_static</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">annual_effects</span><span class="p">)</span>
</span><span id="estimate_estate_revenue-544"><a href="#estimate_estate_revenue-544"><span class="linenos">544</span></a>    <span class="n">ten_year_behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">behavioral_effects</span><span class="p">)</span>
</span><span id="estimate_estate_revenue-545"><a href="#estimate_estate_revenue-545"><span class="linenos">545</span></a>
</span><span id="estimate_estate_revenue-546"><a href="#estimate_estate_revenue-546"><span class="linenos">546</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="estimate_estate_revenue-547"><a href="#estimate_estate_revenue-547"><span class="linenos">547</span></a>        <span class="s2">&quot;annual_static&quot;</span><span class="p">:</span> <span class="n">annual_static</span><span class="p">,</span>
</span><span id="estimate_estate_revenue-548"><a href="#estimate_estate_revenue-548"><span class="linenos">548</span></a>        <span class="s2">&quot;ten_year_static&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span><span class="p">,</span>
</span><span id="estimate_estate_revenue-549"><a href="#estimate_estate_revenue-549"><span class="linenos">549</span></a>        <span class="s2">&quot;behavioral_offset&quot;</span><span class="p">:</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_estate_revenue-550"><a href="#estimate_estate_revenue-550"><span class="linenos">550</span></a>        <span class="s2">&quot;net_effect&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span> <span class="o">+</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_estate_revenue-551"><a href="#estimate_estate_revenue-551"><span class="linenos">551</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Estimate total revenue effect of an estate tax policy.</p>

<p>Returns dict with:
    - annual_static: Average annual static effect
    - ten_year_static: Total 10-year static effect
    - behavioral_offset: Total behavioral offset
    - net_effect: Final effect after behavioral response</p>
</div>


                </section>
                <section id="ESTATE_VALIDATION_SCENARIOS">
                    <div class="attr variable">
            <span class="name">ESTATE_VALIDATION_SCENARIOS</span>        =
<input id="ESTATE_VALIDATION_SCENARIOS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="ESTATE_VALIDATION_SCENARIOS-view-value"></label><span class="default_value">{&#39;extend_tcja_exemption&#39;: {&#39;description&#39;: &#39;Extend TCJA estate exemption&#39;, &#39;policy_factory&#39;: &#39;create_tcja_estate_extension&#39;, &#39;expected_10yr&#39;: 167.0, &#39;source&#39;: &#39;CBO&#39;, &#39;notes&#39;: &#39;Keep $14M+ exemption instead of reversion to $6.4M&#39;}, &#39;biden_estate_reform&#39;: {&#39;description&#39;: &#39;Biden estate tax reform ($3.5M, 45%)&#39;, &#39;policy_factory&#39;: &#39;create_biden_estate_proposal&#39;, &#39;expected_10yr&#39;: -450.0, &#39;source&#39;: &#39;Treasury estimate&#39;, &#39;notes&#39;: &#39;Lower exemption + higher rate raises significant revenue&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#ESTATE_VALIDATION_SCENARIOS"></a>
    
    

                </section>
                <section id="PayrollTaxPolicy">
                            <input id="PayrollTaxPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">PayrollTaxPolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="PayrollTaxPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PayrollTaxPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PayrollTaxPolicy-129"><a href="#PayrollTaxPolicy-129"><span class="linenos">129</span></a><span class="nd">@dataclass</span>
</span><span id="PayrollTaxPolicy-130"><a href="#PayrollTaxPolicy-130"><span class="linenos">130</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PayrollTaxPolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="PayrollTaxPolicy-131"><a href="#PayrollTaxPolicy-131"><span class="linenos">131</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy-132"><a href="#PayrollTaxPolicy-132"><span class="linenos">132</span></a><span class="sd">    Payroll tax policy with Social Security and Medicare modeling.</span>
</span><span id="PayrollTaxPolicy-133"><a href="#PayrollTaxPolicy-133"><span class="linenos">133</span></a>
</span><span id="PayrollTaxPolicy-134"><a href="#PayrollTaxPolicy-134"><span class="linenos">134</span></a><span class="sd">    Supports:</span>
</span><span id="PayrollTaxPolicy-135"><a href="#PayrollTaxPolicy-135"><span class="linenos">135</span></a><span class="sd">    - Social Security wage cap changes</span>
</span><span id="PayrollTaxPolicy-136"><a href="#PayrollTaxPolicy-136"><span class="linenos">136</span></a><span class="sd">    - Social Security rate changes</span>
</span><span id="PayrollTaxPolicy-137"><a href="#PayrollTaxPolicy-137"><span class="linenos">137</span></a><span class="sd">    - Medicare rate changes</span>
</span><span id="PayrollTaxPolicy-138"><a href="#PayrollTaxPolicy-138"><span class="linenos">138</span></a><span class="sd">    - Additional Medicare Tax threshold changes</span>
</span><span id="PayrollTaxPolicy-139"><a href="#PayrollTaxPolicy-139"><span class="linenos">139</span></a><span class="sd">    - NIIT expansion</span>
</span><span id="PayrollTaxPolicy-140"><a href="#PayrollTaxPolicy-140"><span class="linenos">140</span></a>
</span><span id="PayrollTaxPolicy-141"><a href="#PayrollTaxPolicy-141"><span class="linenos">141</span></a><span class="sd">    Key parameters:</span>
</span><span id="PayrollTaxPolicy-142"><a href="#PayrollTaxPolicy-142"><span class="linenos">142</span></a><span class="sd">        payroll_tax_type: Type of payroll tax being modified</span>
</span><span id="PayrollTaxPolicy-143"><a href="#PayrollTaxPolicy-143"><span class="linenos">143</span></a><span class="sd">        ss_cap_change: Change Social Security wage cap</span>
</span><span id="PayrollTaxPolicy-144"><a href="#PayrollTaxPolicy-144"><span class="linenos">144</span></a><span class="sd">        ss_new_cap: Set specific cap (None = current law)</span>
</span><span id="PayrollTaxPolicy-145"><a href="#PayrollTaxPolicy-145"><span class="linenos">145</span></a><span class="sd">        ss_eliminate_cap: Eliminate cap entirely</span>
</span><span id="PayrollTaxPolicy-146"><a href="#PayrollTaxPolicy-146"><span class="linenos">146</span></a><span class="sd">        ss_donut_hole_start: Apply tax above this threshold (donut hole)</span>
</span><span id="PayrollTaxPolicy-147"><a href="#PayrollTaxPolicy-147"><span class="linenos">147</span></a><span class="sd">        ss_rate_change: Change Social Security rate</span>
</span><span id="PayrollTaxPolicy-148"><a href="#PayrollTaxPolicy-148"><span class="linenos">148</span></a><span class="sd">        medicare_rate_change: Change Medicare rate</span>
</span><span id="PayrollTaxPolicy-149"><a href="#PayrollTaxPolicy-149"><span class="linenos">149</span></a><span class="sd">        expand_niit: Expand NIIT to pass-through income</span>
</span><span id="PayrollTaxPolicy-150"><a href="#PayrollTaxPolicy-150"><span class="linenos">150</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy-151"><a href="#PayrollTaxPolicy-151"><span class="linenos">151</span></a>
</span><span id="PayrollTaxPolicy-152"><a href="#PayrollTaxPolicy-152"><span class="linenos">152</span></a>    <span class="n">payroll_tax_type</span><span class="p">:</span> <span class="n">PayrollTaxType</span> <span class="o">=</span> <span class="n">PayrollTaxType</span><span class="o">.</span><span class="n">SOCIAL_SECURITY</span>
</span><span id="PayrollTaxPolicy-153"><a href="#PayrollTaxPolicy-153"><span class="linenos">153</span></a>
</span><span id="PayrollTaxPolicy-154"><a href="#PayrollTaxPolicy-154"><span class="linenos">154</span></a>    <span class="c1"># Social Security cap changes</span>
</span><span id="PayrollTaxPolicy-155"><a href="#PayrollTaxPolicy-155"><span class="linenos">155</span></a>    <span class="n">ss_cap_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Dollar change in cap</span>
</span><span id="PayrollTaxPolicy-156"><a href="#PayrollTaxPolicy-156"><span class="linenos">156</span></a>    <span class="n">ss_new_cap</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Set specific cap</span>
</span><span id="PayrollTaxPolicy-157"><a href="#PayrollTaxPolicy-157"><span class="linenos">157</span></a>    <span class="n">ss_eliminate_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Eliminate cap entirely</span>
</span><span id="PayrollTaxPolicy-158"><a href="#PayrollTaxPolicy-158"><span class="linenos">158</span></a>    <span class="n">ss_donut_hole_start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Donut hole threshold (e.g., $250K)</span>
</span><span id="PayrollTaxPolicy-159"><a href="#PayrollTaxPolicy-159"><span class="linenos">159</span></a>    <span class="n">ss_cover_90_pct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Raise cap to cover 90% of wages</span>
</span><span id="PayrollTaxPolicy-160"><a href="#PayrollTaxPolicy-160"><span class="linenos">160</span></a>
</span><span id="PayrollTaxPolicy-161"><a href="#PayrollTaxPolicy-161"><span class="linenos">161</span></a>    <span class="c1"># Rate changes</span>
</span><span id="PayrollTaxPolicy-162"><a href="#PayrollTaxPolicy-162"><span class="linenos">162</span></a>    <span class="n">ss_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in SS rate (combined)</span>
</span><span id="PayrollTaxPolicy-163"><a href="#PayrollTaxPolicy-163"><span class="linenos">163</span></a>    <span class="n">medicare_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in Medicare rate</span>
</span><span id="PayrollTaxPolicy-164"><a href="#PayrollTaxPolicy-164"><span class="linenos">164</span></a>
</span><span id="PayrollTaxPolicy-165"><a href="#PayrollTaxPolicy-165"><span class="linenos">165</span></a>    <span class="c1"># Additional Medicare Tax changes</span>
</span><span id="PayrollTaxPolicy-166"><a href="#PayrollTaxPolicy-166"><span class="linenos">166</span></a>    <span class="n">additional_medicare_threshold_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="PayrollTaxPolicy-167"><a href="#PayrollTaxPolicy-167"><span class="linenos">167</span></a>    <span class="n">additional_medicare_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="PayrollTaxPolicy-168"><a href="#PayrollTaxPolicy-168"><span class="linenos">168</span></a>
</span><span id="PayrollTaxPolicy-169"><a href="#PayrollTaxPolicy-169"><span class="linenos">169</span></a>    <span class="c1"># NIIT changes</span>
</span><span id="PayrollTaxPolicy-170"><a href="#PayrollTaxPolicy-170"><span class="linenos">170</span></a>    <span class="n">expand_niit_to_passthrough</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PayrollTaxPolicy-171"><a href="#PayrollTaxPolicy-171"><span class="linenos">171</span></a>    <span class="n">niit_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="PayrollTaxPolicy-172"><a href="#PayrollTaxPolicy-172"><span class="linenos">172</span></a>
</span><span id="PayrollTaxPolicy-173"><a href="#PayrollTaxPolicy-173"><span class="linenos">173</span></a>    <span class="c1"># Behavioral parameters</span>
</span><span id="PayrollTaxPolicy-174"><a href="#PayrollTaxPolicy-174"><span class="linenos">174</span></a>    <span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Labor supply response</span>
</span><span id="PayrollTaxPolicy-175"><a href="#PayrollTaxPolicy-175"><span class="linenos">175</span></a>    <span class="n">tax_avoidance_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>  <span class="c1"># Shifting income to avoid tax</span>
</span><span id="PayrollTaxPolicy-176"><a href="#PayrollTaxPolicy-176"><span class="linenos">176</span></a>
</span><span id="PayrollTaxPolicy-177"><a href="#PayrollTaxPolicy-177"><span class="linenos">177</span></a>    <span class="c1"># Calibrated annual revenue change</span>
</span><span id="PayrollTaxPolicy-178"><a href="#PayrollTaxPolicy-178"><span class="linenos">178</span></a>    <span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PayrollTaxPolicy-179"><a href="#PayrollTaxPolicy-179"><span class="linenos">179</span></a>
</span><span id="PayrollTaxPolicy-180"><a href="#PayrollTaxPolicy-180"><span class="linenos">180</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PayrollTaxPolicy-181"><a href="#PayrollTaxPolicy-181"><span class="linenos">181</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set default policy type.&quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy-182"><a href="#PayrollTaxPolicy-182"><span class="linenos">182</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-183"><a href="#PayrollTaxPolicy-183"><span class="linenos">183</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">=</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span>
</span><span id="PayrollTaxPolicy-184"><a href="#PayrollTaxPolicy-184"><span class="linenos">184</span></a>
</span><span id="PayrollTaxPolicy-185"><a href="#PayrollTaxPolicy-185"><span class="linenos">185</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_effective_ss_cap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="PayrollTaxPolicy-186"><a href="#PayrollTaxPolicy-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the effective Social Security wage cap for a given year.&quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy-187"><a href="#PayrollTaxPolicy-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_eliminate_cap</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-188"><a href="#PayrollTaxPolicy-188"><span class="linenos">188</span></a>            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># No cap</span>
</span><span id="PayrollTaxPolicy-189"><a href="#PayrollTaxPolicy-189"><span class="linenos">189</span></a>
</span><span id="PayrollTaxPolicy-190"><a href="#PayrollTaxPolicy-190"><span class="linenos">190</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_new_cap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-191"><a href="#PayrollTaxPolicy-191"><span class="linenos">191</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_new_cap</span>
</span><span id="PayrollTaxPolicy-192"><a href="#PayrollTaxPolicy-192"><span class="linenos">192</span></a>
</span><span id="PayrollTaxPolicy-193"><a href="#PayrollTaxPolicy-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_cover_90_pct</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-194"><a href="#PayrollTaxPolicy-194"><span class="linenos">194</span></a>            <span class="c1"># Cap that covers 90% of wages (~$305K in 2024)</span>
</span><span id="PayrollTaxPolicy-195"><a href="#PayrollTaxPolicy-195"><span class="linenos">195</span></a>            <span class="n">base_90_pct_cap</span> <span class="o">=</span> <span class="mi">305_000</span>
</span><span id="PayrollTaxPolicy-196"><a href="#PayrollTaxPolicy-196"><span class="linenos">196</span></a>            <span class="n">years_from_2024</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">2024</span>
</span><span id="PayrollTaxPolicy-197"><a href="#PayrollTaxPolicy-197"><span class="linenos">197</span></a>            <span class="n">growth</span> <span class="o">=</span> <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">[</span><span class="s2">&quot;cap_growth_rate&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-198"><a href="#PayrollTaxPolicy-198"><span class="linenos">198</span></a>            <span class="k">return</span> <span class="n">base_90_pct_cap</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth</span><span class="p">)</span> <span class="o">**</span> <span class="n">years_from_2024</span><span class="p">)</span>
</span><span id="PayrollTaxPolicy-199"><a href="#PayrollTaxPolicy-199"><span class="linenos">199</span></a>
</span><span id="PayrollTaxPolicy-200"><a href="#PayrollTaxPolicy-200"><span class="linenos">200</span></a>        <span class="c1"># Current law cap with growth</span>
</span><span id="PayrollTaxPolicy-201"><a href="#PayrollTaxPolicy-201"><span class="linenos">201</span></a>        <span class="n">base_cap</span> <span class="o">=</span> <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">[</span><span class="s2">&quot;cap_2025&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-202"><a href="#PayrollTaxPolicy-202"><span class="linenos">202</span></a>        <span class="n">years_from_2025</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">2025</span>
</span><span id="PayrollTaxPolicy-203"><a href="#PayrollTaxPolicy-203"><span class="linenos">203</span></a>        <span class="n">growth</span> <span class="o">=</span> <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">[</span><span class="s2">&quot;cap_growth_rate&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-204"><a href="#PayrollTaxPolicy-204"><span class="linenos">204</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">base_cap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_cap_change</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth</span><span class="p">)</span> <span class="o">**</span> <span class="n">years_from_2025</span><span class="p">)</span>
</span><span id="PayrollTaxPolicy-205"><a href="#PayrollTaxPolicy-205"><span class="linenos">205</span></a>
</span><span id="PayrollTaxPolicy-206"><a href="#PayrollTaxPolicy-206"><span class="linenos">206</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="PayrollTaxPolicy-207"><a href="#PayrollTaxPolicy-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PayrollTaxPolicy-208"><a href="#PayrollTaxPolicy-208"><span class="linenos">208</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PayrollTaxPolicy-209"><a href="#PayrollTaxPolicy-209"><span class="linenos">209</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PayrollTaxPolicy-210"><a href="#PayrollTaxPolicy-210"><span class="linenos">210</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-211"><a href="#PayrollTaxPolicy-211"><span class="linenos">211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy-212"><a href="#PayrollTaxPolicy-212"><span class="linenos">212</span></a><span class="sd">        Estimate static revenue effect of payroll tax policy change.</span>
</span><span id="PayrollTaxPolicy-213"><a href="#PayrollTaxPolicy-213"><span class="linenos">213</span></a>
</span><span id="PayrollTaxPolicy-214"><a href="#PayrollTaxPolicy-214"><span class="linenos">214</span></a><span class="sd">        Args:</span>
</span><span id="PayrollTaxPolicy-215"><a href="#PayrollTaxPolicy-215"><span class="linenos">215</span></a><span class="sd">            baseline_revenue: Baseline payroll tax revenue (billions)</span>
</span><span id="PayrollTaxPolicy-216"><a href="#PayrollTaxPolicy-216"><span class="linenos">216</span></a><span class="sd">            use_real_data: Whether to use detailed calculations</span>
</span><span id="PayrollTaxPolicy-217"><a href="#PayrollTaxPolicy-217"><span class="linenos">217</span></a>
</span><span id="PayrollTaxPolicy-218"><a href="#PayrollTaxPolicy-218"><span class="linenos">218</span></a><span class="sd">        Returns:</span>
</span><span id="PayrollTaxPolicy-219"><a href="#PayrollTaxPolicy-219"><span class="linenos">219</span></a><span class="sd">            Revenue change in billions (negative = revenue loss)</span>
</span><span id="PayrollTaxPolicy-220"><a href="#PayrollTaxPolicy-220"><span class="linenos">220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy-221"><a href="#PayrollTaxPolicy-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-222"><a href="#PayrollTaxPolicy-222"><span class="linenos">222</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="PayrollTaxPolicy-223"><a href="#PayrollTaxPolicy-223"><span class="linenos">223</span></a>
</span><span id="PayrollTaxPolicy-224"><a href="#PayrollTaxPolicy-224"><span class="linenos">224</span></a>        <span class="n">total_revenue</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="PayrollTaxPolicy-225"><a href="#PayrollTaxPolicy-225"><span class="linenos">225</span></a>
</span><span id="PayrollTaxPolicy-226"><a href="#PayrollTaxPolicy-226"><span class="linenos">226</span></a>        <span class="c1"># Social Security cap changes</span>
</span><span id="PayrollTaxPolicy-227"><a href="#PayrollTaxPolicy-227"><span class="linenos">227</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_eliminate_cap</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-228"><a href="#PayrollTaxPolicy-228"><span class="linenos">228</span></a>            <span class="c1"># Taxing all wages above current cap</span>
</span><span id="PayrollTaxPolicy-229"><a href="#PayrollTaxPolicy-229"><span class="linenos">229</span></a>            <span class="c1"># ~$1.87T in wages above cap  12.4% = ~$232B additional</span>
</span><span id="PayrollTaxPolicy-230"><a href="#PayrollTaxPolicy-230"><span class="linenos">230</span></a>            <span class="c1"># But CBO says $3.2T over 10 years = ~$320B/year (includes growth)</span>
</span><span id="PayrollTaxPolicy-231"><a href="#PayrollTaxPolicy-231"><span class="linenos">231</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;eliminate_cap_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-232"><a href="#PayrollTaxPolicy-232"><span class="linenos">232</span></a>
</span><span id="PayrollTaxPolicy-233"><a href="#PayrollTaxPolicy-233"><span class="linenos">233</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_cover_90_pct</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-234"><a href="#PayrollTaxPolicy-234"><span class="linenos">234</span></a>            <span class="c1"># Raise cap to cover 90% of wages</span>
</span><span id="PayrollTaxPolicy-235"><a href="#PayrollTaxPolicy-235"><span class="linenos">235</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;cap_90_pct_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-236"><a href="#PayrollTaxPolicy-236"><span class="linenos">236</span></a>
</span><span id="PayrollTaxPolicy-237"><a href="#PayrollTaxPolicy-237"><span class="linenos">237</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_donut_hole_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-238"><a href="#PayrollTaxPolicy-238"><span class="linenos">238</span></a>            <span class="c1"># Donut hole: tax wages above threshold</span>
</span><span id="PayrollTaxPolicy-239"><a href="#PayrollTaxPolicy-239"><span class="linenos">239</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_donut_hole_start</span> <span class="o">&lt;=</span> <span class="mi">250_000</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-240"><a href="#PayrollTaxPolicy-240"><span class="linenos">240</span></a>                <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;donut_250k_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-241"><a href="#PayrollTaxPolicy-241"><span class="linenos">241</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-242"><a href="#PayrollTaxPolicy-242"><span class="linenos">242</span></a>                <span class="c1"># Scale based on threshold</span>
</span><span id="PayrollTaxPolicy-243"><a href="#PayrollTaxPolicy-243"><span class="linenos">243</span></a>                <span class="n">base_wages</span> <span class="o">=</span> <span class="n">BASELINE_WAGE_DATA</span><span class="p">[</span><span class="s2">&quot;wages_250k_plus_billions&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-244"><a href="#PayrollTaxPolicy-244"><span class="linenos">244</span></a>                <span class="n">threshold_factor</span> <span class="o">=</span> <span class="mi">250_000</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_donut_hole_start</span>
</span><span id="PayrollTaxPolicy-245"><a href="#PayrollTaxPolicy-245"><span class="linenos">245</span></a>                <span class="n">scaled_wages</span> <span class="o">=</span> <span class="n">base_wages</span> <span class="o">*</span> <span class="n">threshold_factor</span>
</span><span id="PayrollTaxPolicy-246"><a href="#PayrollTaxPolicy-246"><span class="linenos">246</span></a>                <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">scaled_wages</span> <span class="o">*</span> <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">[</span><span class="s2">&quot;rate_combined&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-247"><a href="#PayrollTaxPolicy-247"><span class="linenos">247</span></a>
</span><span id="PayrollTaxPolicy-248"><a href="#PayrollTaxPolicy-248"><span class="linenos">248</span></a>        <span class="c1"># Social Security rate changes</span>
</span><span id="PayrollTaxPolicy-249"><a href="#PayrollTaxPolicy-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-250"><a href="#PayrollTaxPolicy-250"><span class="linenos">250</span></a>            <span class="c1"># 1pp rate increase = ~$90B/year</span>
</span><span id="PayrollTaxPolicy-251"><a href="#PayrollTaxPolicy-251"><span class="linenos">251</span></a>            <span class="n">rate_change_pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_rate_change</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># Convert to percentage points</span>
</span><span id="PayrollTaxPolicy-252"><a href="#PayrollTaxPolicy-252"><span class="linenos">252</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">rate_change_pp</span> <span class="o">*</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;rate_1pp_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-253"><a href="#PayrollTaxPolicy-253"><span class="linenos">253</span></a>
</span><span id="PayrollTaxPolicy-254"><a href="#PayrollTaxPolicy-254"><span class="linenos">254</span></a>        <span class="c1"># Medicare rate changes</span>
</span><span id="PayrollTaxPolicy-255"><a href="#PayrollTaxPolicy-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">medicare_rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-256"><a href="#PayrollTaxPolicy-256"><span class="linenos">256</span></a>            <span class="c1"># Medicare applies to all wages</span>
</span><span id="PayrollTaxPolicy-257"><a href="#PayrollTaxPolicy-257"><span class="linenos">257</span></a>            <span class="n">rate_change_pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medicare_rate_change</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="PayrollTaxPolicy-258"><a href="#PayrollTaxPolicy-258"><span class="linenos">258</span></a>            <span class="c1"># Medicare revenue is ~$400B at 2.9%, so 1pp = ~$140B</span>
</span><span id="PayrollTaxPolicy-259"><a href="#PayrollTaxPolicy-259"><span class="linenos">259</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">rate_change_pp</span> <span class="o">*</span> <span class="mf">140.0</span>
</span><span id="PayrollTaxPolicy-260"><a href="#PayrollTaxPolicy-260"><span class="linenos">260</span></a>
</span><span id="PayrollTaxPolicy-261"><a href="#PayrollTaxPolicy-261"><span class="linenos">261</span></a>        <span class="c1"># NIIT expansion</span>
</span><span id="PayrollTaxPolicy-262"><a href="#PayrollTaxPolicy-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_niit_to_passthrough</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-263"><a href="#PayrollTaxPolicy-263"><span class="linenos">263</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;expand_niit_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy-264"><a href="#PayrollTaxPolicy-264"><span class="linenos">264</span></a>
</span><span id="PayrollTaxPolicy-265"><a href="#PayrollTaxPolicy-265"><span class="linenos">265</span></a>        <span class="k">return</span> <span class="n">total_revenue</span>
</span><span id="PayrollTaxPolicy-266"><a href="#PayrollTaxPolicy-266"><span class="linenos">266</span></a>
</span><span id="PayrollTaxPolicy-267"><a href="#PayrollTaxPolicy-267"><span class="linenos">267</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-268"><a href="#PayrollTaxPolicy-268"><span class="linenos">268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy-269"><a href="#PayrollTaxPolicy-269"><span class="linenos">269</span></a><span class="sd">        Estimate behavioral response to payroll tax changes.</span>
</span><span id="PayrollTaxPolicy-270"><a href="#PayrollTaxPolicy-270"><span class="linenos">270</span></a>
</span><span id="PayrollTaxPolicy-271"><a href="#PayrollTaxPolicy-271"><span class="linenos">271</span></a><span class="sd">        Behavioral responses include:</span>
</span><span id="PayrollTaxPolicy-272"><a href="#PayrollTaxPolicy-272"><span class="linenos">272</span></a><span class="sd">        - Labor supply effects (work less in response to higher taxes)</span>
</span><span id="PayrollTaxPolicy-273"><a href="#PayrollTaxPolicy-273"><span class="linenos">273</span></a><span class="sd">        - Income shifting (convert wages to other income types)</span>
</span><span id="PayrollTaxPolicy-274"><a href="#PayrollTaxPolicy-274"><span class="linenos">274</span></a><span class="sd">        - Tax avoidance (S-corps, etc.)</span>
</span><span id="PayrollTaxPolicy-275"><a href="#PayrollTaxPolicy-275"><span class="linenos">275</span></a>
</span><span id="PayrollTaxPolicy-276"><a href="#PayrollTaxPolicy-276"><span class="linenos">276</span></a><span class="sd">        Returns:</span>
</span><span id="PayrollTaxPolicy-277"><a href="#PayrollTaxPolicy-277"><span class="linenos">277</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="PayrollTaxPolicy-278"><a href="#PayrollTaxPolicy-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy-279"><a href="#PayrollTaxPolicy-279"><span class="linenos">279</span></a>        <span class="c1"># Labor supply effect</span>
</span><span id="PayrollTaxPolicy-280"><a href="#PayrollTaxPolicy-280"><span class="linenos">280</span></a>        <span class="n">labor_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">labor_supply_elasticity</span>
</span><span id="PayrollTaxPolicy-281"><a href="#PayrollTaxPolicy-281"><span class="linenos">281</span></a>
</span><span id="PayrollTaxPolicy-282"><a href="#PayrollTaxPolicy-282"><span class="linenos">282</span></a>        <span class="c1"># Tax avoidance (especially for cap elimination)</span>
</span><span id="PayrollTaxPolicy-283"><a href="#PayrollTaxPolicy-283"><span class="linenos">283</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_eliminate_cap</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_donut_hole_start</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-284"><a href="#PayrollTaxPolicy-284"><span class="linenos">284</span></a>            <span class="n">avoidance_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tax_avoidance_elasticity</span>
</span><span id="PayrollTaxPolicy-285"><a href="#PayrollTaxPolicy-285"><span class="linenos">285</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-286"><a href="#PayrollTaxPolicy-286"><span class="linenos">286</span></a>            <span class="n">avoidance_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tax_avoidance_elasticity</span> <span class="o">*</span> <span class="mf">0.5</span>
</span><span id="PayrollTaxPolicy-287"><a href="#PayrollTaxPolicy-287"><span class="linenos">287</span></a>
</span><span id="PayrollTaxPolicy-288"><a href="#PayrollTaxPolicy-288"><span class="linenos">288</span></a>        <span class="n">total_offset</span> <span class="o">=</span> <span class="n">labor_offset</span> <span class="o">+</span> <span class="n">avoidance_offset</span>
</span><span id="PayrollTaxPolicy-289"><a href="#PayrollTaxPolicy-289"><span class="linenos">289</span></a>
</span><span id="PayrollTaxPolicy-290"><a href="#PayrollTaxPolicy-290"><span class="linenos">290</span></a>        <span class="c1"># Offset reduces revenue gain</span>
</span><span id="PayrollTaxPolicy-291"><a href="#PayrollTaxPolicy-291"><span class="linenos">291</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-292"><a href="#PayrollTaxPolicy-292"><span class="linenos">292</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">total_offset</span>
</span><span id="PayrollTaxPolicy-293"><a href="#PayrollTaxPolicy-293"><span class="linenos">293</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy-294"><a href="#PayrollTaxPolicy-294"><span class="linenos">294</span></a>            <span class="k">return</span> <span class="n">total_offset</span>
</span></pre></div>


            <div class="docstring"><p>Payroll tax policy with Social Security and Medicare modeling.</p>

<p>Supports:</p>

<ul>
<li>Social Security wage cap changes</li>
<li>Social Security rate changes</li>
<li>Medicare rate changes</li>
<li>Additional Medicare Tax threshold changes</li>
<li>NIIT expansion</li>
</ul>

<p>Key parameters:
    payroll_tax_type: Type of payroll tax being modified
    ss_cap_change: Change Social Security wage cap
    ss_new_cap: Set specific cap (None = current law)
    ss_eliminate_cap: Eliminate cap entirely
    ss_donut_hole_start: Apply tax above this threshold (donut hole)
    ss_rate_change: Change Social Security rate
    medicare_rate_change: Change Medicare rate
    expand_niit: Expand NIIT to pass-through income</p>
</div>


                            <div id="PayrollTaxPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PayrollTaxPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">payroll_tax_type</span><span class="p">:</span> <span class="n"><a href="#PayrollTaxType">PayrollTaxType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#PayrollTaxType.SOCIAL_SECURITY">PayrollTaxType.SOCIAL_SECURITY</a></span><span class="p">:</span> <span class="s1">&#39;social_security&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">ss_cap_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">ss_new_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ss_eliminate_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">ss_donut_hole_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ss_cover_90_pct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">ss_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">medicare_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">additional_medicare_threshold_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">additional_medicare_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">expand_niit_to_passthrough</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">niit_rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">tax_avoidance_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.__init__"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.payroll_tax_type" class="classattr">
                                <div class="attr variable">
            <span class="name">payroll_tax_type</span><span class="annotation">: <a href="#PayrollTaxType">PayrollTaxType</a></span>        =
<span class="default_value">&lt;<a href="#PayrollTaxType.SOCIAL_SECURITY">PayrollTaxType.SOCIAL_SECURITY</a>: &#39;social_security&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.payroll_tax_type"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.ss_cap_change" class="classattr">
                                <div class="attr variable">
            <span class="name">ss_cap_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.ss_cap_change"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.ss_new_cap" class="classattr">
                                <div class="attr variable">
            <span class="name">ss_new_cap</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.ss_new_cap"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.ss_eliminate_cap" class="classattr">
                                <div class="attr variable">
            <span class="name">ss_eliminate_cap</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.ss_eliminate_cap"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.ss_donut_hole_start" class="classattr">
                                <div class="attr variable">
            <span class="name">ss_donut_hole_start</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.ss_donut_hole_start"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.ss_cover_90_pct" class="classattr">
                                <div class="attr variable">
            <span class="name">ss_cover_90_pct</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.ss_cover_90_pct"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.ss_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">ss_rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.ss_rate_change"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.medicare_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">medicare_rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.medicare_rate_change"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.additional_medicare_threshold_change" class="classattr">
                                <div class="attr variable">
            <span class="name">additional_medicare_threshold_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.additional_medicare_threshold_change"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.additional_medicare_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">additional_medicare_rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.additional_medicare_rate_change"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.expand_niit_to_passthrough" class="classattr">
                                <div class="attr variable">
            <span class="name">expand_niit_to_passthrough</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.expand_niit_to_passthrough"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.niit_rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">niit_rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.niit_rate_change"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.labor_supply_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">labor_supply_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.1</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.labor_supply_elasticity"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.tax_avoidance_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">tax_avoidance_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.15</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.tax_avoidance_elasticity"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.annual_revenue_change_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_revenue_change_billions</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.annual_revenue_change_billions"></a>
    
    

                            </div>
                            <div id="PayrollTaxPolicy.get_effective_ss_cap" class="classattr">
                                        <input id="PayrollTaxPolicy.get_effective_ss_cap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_effective_ss_cap</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PayrollTaxPolicy.get_effective_ss_cap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.get_effective_ss_cap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PayrollTaxPolicy.get_effective_ss_cap-185"><a href="#PayrollTaxPolicy.get_effective_ss_cap-185"><span class="linenos">185</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_effective_ss_cap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-186"><a href="#PayrollTaxPolicy.get_effective_ss_cap-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the effective Social Security wage cap for a given year.&quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-187"><a href="#PayrollTaxPolicy.get_effective_ss_cap-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_eliminate_cap</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-188"><a href="#PayrollTaxPolicy.get_effective_ss_cap-188"><span class="linenos">188</span></a>            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># No cap</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-189"><a href="#PayrollTaxPolicy.get_effective_ss_cap-189"><span class="linenos">189</span></a>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-190"><a href="#PayrollTaxPolicy.get_effective_ss_cap-190"><span class="linenos">190</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_new_cap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-191"><a href="#PayrollTaxPolicy.get_effective_ss_cap-191"><span class="linenos">191</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_new_cap</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-192"><a href="#PayrollTaxPolicy.get_effective_ss_cap-192"><span class="linenos">192</span></a>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-193"><a href="#PayrollTaxPolicy.get_effective_ss_cap-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_cover_90_pct</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-194"><a href="#PayrollTaxPolicy.get_effective_ss_cap-194"><span class="linenos">194</span></a>            <span class="c1"># Cap that covers 90% of wages (~$305K in 2024)</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-195"><a href="#PayrollTaxPolicy.get_effective_ss_cap-195"><span class="linenos">195</span></a>            <span class="n">base_90_pct_cap</span> <span class="o">=</span> <span class="mi">305_000</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-196"><a href="#PayrollTaxPolicy.get_effective_ss_cap-196"><span class="linenos">196</span></a>            <span class="n">years_from_2024</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">2024</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-197"><a href="#PayrollTaxPolicy.get_effective_ss_cap-197"><span class="linenos">197</span></a>            <span class="n">growth</span> <span class="o">=</span> <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">[</span><span class="s2">&quot;cap_growth_rate&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-198"><a href="#PayrollTaxPolicy.get_effective_ss_cap-198"><span class="linenos">198</span></a>            <span class="k">return</span> <span class="n">base_90_pct_cap</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth</span><span class="p">)</span> <span class="o">**</span> <span class="n">years_from_2024</span><span class="p">)</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-199"><a href="#PayrollTaxPolicy.get_effective_ss_cap-199"><span class="linenos">199</span></a>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-200"><a href="#PayrollTaxPolicy.get_effective_ss_cap-200"><span class="linenos">200</span></a>        <span class="c1"># Current law cap with growth</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-201"><a href="#PayrollTaxPolicy.get_effective_ss_cap-201"><span class="linenos">201</span></a>        <span class="n">base_cap</span> <span class="o">=</span> <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">[</span><span class="s2">&quot;cap_2025&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-202"><a href="#PayrollTaxPolicy.get_effective_ss_cap-202"><span class="linenos">202</span></a>        <span class="n">years_from_2025</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">2025</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-203"><a href="#PayrollTaxPolicy.get_effective_ss_cap-203"><span class="linenos">203</span></a>        <span class="n">growth</span> <span class="o">=</span> <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">[</span><span class="s2">&quot;cap_growth_rate&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.get_effective_ss_cap-204"><a href="#PayrollTaxPolicy.get_effective_ss_cap-204"><span class="linenos">204</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">base_cap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_cap_change</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth</span><span class="p">)</span> <span class="o">**</span> <span class="n">years_from_2025</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the effective Social Security wage cap for a given year.</p>
</div>


                            </div>
                            <div id="PayrollTaxPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="PayrollTaxPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="PayrollTaxPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-206"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-206"><span class="linenos">206</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-207"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-208"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-208"><span class="linenos">208</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-209"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-209"><span class="linenos">209</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-210"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-210"><span class="linenos">210</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-211"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-211"><span class="linenos">211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-212"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-212"><span class="linenos">212</span></a><span class="sd">        Estimate static revenue effect of payroll tax policy change.</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-213"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-213"><span class="linenos">213</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-214"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-214"><span class="linenos">214</span></a><span class="sd">        Args:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-215"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-215"><span class="linenos">215</span></a><span class="sd">            baseline_revenue: Baseline payroll tax revenue (billions)</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-216"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-216"><span class="linenos">216</span></a><span class="sd">            use_real_data: Whether to use detailed calculations</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-217"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-217"><span class="linenos">217</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-218"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-218"><span class="linenos">218</span></a><span class="sd">        Returns:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-219"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-219"><span class="linenos">219</span></a><span class="sd">            Revenue change in billions (negative = revenue loss)</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-220"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-220"><span class="linenos">220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-221"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-222"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-222"><span class="linenos">222</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-223"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-223"><span class="linenos">223</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-224"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-224"><span class="linenos">224</span></a>        <span class="n">total_revenue</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-225"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-225"><span class="linenos">225</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-226"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-226"><span class="linenos">226</span></a>        <span class="c1"># Social Security cap changes</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-227"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-227"><span class="linenos">227</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_eliminate_cap</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-228"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-228"><span class="linenos">228</span></a>            <span class="c1"># Taxing all wages above current cap</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-229"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-229"><span class="linenos">229</span></a>            <span class="c1"># ~$1.87T in wages above cap  12.4% = ~$232B additional</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-230"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-230"><span class="linenos">230</span></a>            <span class="c1"># But CBO says $3.2T over 10 years = ~$320B/year (includes growth)</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-231"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-231"><span class="linenos">231</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;eliminate_cap_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-232"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-232"><span class="linenos">232</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-233"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-233"><span class="linenos">233</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_cover_90_pct</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-234"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-234"><span class="linenos">234</span></a>            <span class="c1"># Raise cap to cover 90% of wages</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-235"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-235"><span class="linenos">235</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;cap_90_pct_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-236"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-236"><span class="linenos">236</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-237"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-237"><span class="linenos">237</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_donut_hole_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-238"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-238"><span class="linenos">238</span></a>            <span class="c1"># Donut hole: tax wages above threshold</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-239"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-239"><span class="linenos">239</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_donut_hole_start</span> <span class="o">&lt;=</span> <span class="mi">250_000</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-240"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-240"><span class="linenos">240</span></a>                <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;donut_250k_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-241"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-241"><span class="linenos">241</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-242"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-242"><span class="linenos">242</span></a>                <span class="c1"># Scale based on threshold</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-243"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-243"><span class="linenos">243</span></a>                <span class="n">base_wages</span> <span class="o">=</span> <span class="n">BASELINE_WAGE_DATA</span><span class="p">[</span><span class="s2">&quot;wages_250k_plus_billions&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-244"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-244"><span class="linenos">244</span></a>                <span class="n">threshold_factor</span> <span class="o">=</span> <span class="mi">250_000</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_donut_hole_start</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-245"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-245"><span class="linenos">245</span></a>                <span class="n">scaled_wages</span> <span class="o">=</span> <span class="n">base_wages</span> <span class="o">*</span> <span class="n">threshold_factor</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-246"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-246"><span class="linenos">246</span></a>                <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">scaled_wages</span> <span class="o">*</span> <span class="n">SOCIAL_SECURITY_PARAMS</span><span class="p">[</span><span class="s2">&quot;rate_combined&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-247"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-247"><span class="linenos">247</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-248"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-248"><span class="linenos">248</span></a>        <span class="c1"># Social Security rate changes</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-249"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-250"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-250"><span class="linenos">250</span></a>            <span class="c1"># 1pp rate increase = ~$90B/year</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-251"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-251"><span class="linenos">251</span></a>            <span class="n">rate_change_pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_rate_change</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># Convert to percentage points</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-252"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-252"><span class="linenos">252</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">rate_change_pp</span> <span class="o">*</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;rate_1pp_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-253"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-253"><span class="linenos">253</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-254"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-254"><span class="linenos">254</span></a>        <span class="c1"># Medicare rate changes</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-255"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">medicare_rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-256"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-256"><span class="linenos">256</span></a>            <span class="c1"># Medicare applies to all wages</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-257"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-257"><span class="linenos">257</span></a>            <span class="n">rate_change_pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medicare_rate_change</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-258"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-258"><span class="linenos">258</span></a>            <span class="c1"># Medicare revenue is ~$400B at 2.9%, so 1pp = ~$140B</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-259"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-259"><span class="linenos">259</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">rate_change_pp</span> <span class="o">*</span> <span class="mf">140.0</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-260"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-260"><span class="linenos">260</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-261"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-261"><span class="linenos">261</span></a>        <span class="c1"># NIIT expansion</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-262"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_niit_to_passthrough</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-263"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-263"><span class="linenos">263</span></a>            <span class="n">total_revenue</span> <span class="o">+=</span> <span class="n">CBO_PAYROLL_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;expand_niit_annual&quot;</span><span class="p">]</span>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-264"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-264"><span class="linenos">264</span></a>
</span><span id="PayrollTaxPolicy.estimate_static_revenue_effect-265"><a href="#PayrollTaxPolicy.estimate_static_revenue_effect-265"><span class="linenos">265</span></a>        <span class="k">return</span> <span class="n">total_revenue</span>
</span></pre></div>


            <div class="docstring"><p>Estimate static revenue effect of payroll tax policy change.</p>

<p>Args:
    baseline_revenue: Baseline payroll tax revenue (billions)
    use_real_data: Whether to use detailed calculations</p>

<p>Returns:
    Revenue change in billions (negative = revenue loss)</p>
</div>


                            </div>
                            <div id="PayrollTaxPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="PayrollTaxPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="PayrollTaxPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PayrollTaxPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PayrollTaxPolicy.estimate_behavioral_offset-267"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-267"><span class="linenos">267</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-268"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-268"><span class="linenos">268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-269"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-269"><span class="linenos">269</span></a><span class="sd">        Estimate behavioral response to payroll tax changes.</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-270"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-270"><span class="linenos">270</span></a>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-271"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-271"><span class="linenos">271</span></a><span class="sd">        Behavioral responses include:</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-272"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-272"><span class="linenos">272</span></a><span class="sd">        - Labor supply effects (work less in response to higher taxes)</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-273"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-273"><span class="linenos">273</span></a><span class="sd">        - Income shifting (convert wages to other income types)</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-274"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-274"><span class="linenos">274</span></a><span class="sd">        - Tax avoidance (S-corps, etc.)</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-275"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-275"><span class="linenos">275</span></a>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-276"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-276"><span class="linenos">276</span></a><span class="sd">        Returns:</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-277"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-277"><span class="linenos">277</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-278"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-279"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-279"><span class="linenos">279</span></a>        <span class="c1"># Labor supply effect</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-280"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-280"><span class="linenos">280</span></a>        <span class="n">labor_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">labor_supply_elasticity</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-281"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-281"><span class="linenos">281</span></a>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-282"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-282"><span class="linenos">282</span></a>        <span class="c1"># Tax avoidance (especially for cap elimination)</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-283"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-283"><span class="linenos">283</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_eliminate_cap</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_donut_hole_start</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-284"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-284"><span class="linenos">284</span></a>            <span class="n">avoidance_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tax_avoidance_elasticity</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-285"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-285"><span class="linenos">285</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-286"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-286"><span class="linenos">286</span></a>            <span class="n">avoidance_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tax_avoidance_elasticity</span> <span class="o">*</span> <span class="mf">0.5</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-287"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-287"><span class="linenos">287</span></a>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-288"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-288"><span class="linenos">288</span></a>        <span class="n">total_offset</span> <span class="o">=</span> <span class="n">labor_offset</span> <span class="o">+</span> <span class="n">avoidance_offset</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-289"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-289"><span class="linenos">289</span></a>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-290"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-290"><span class="linenos">290</span></a>        <span class="c1"># Offset reduces revenue gain</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-291"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-291"><span class="linenos">291</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-292"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-292"><span class="linenos">292</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">total_offset</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-293"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-293"><span class="linenos">293</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PayrollTaxPolicy.estimate_behavioral_offset-294"><a href="#PayrollTaxPolicy.estimate_behavioral_offset-294"><span class="linenos">294</span></a>            <span class="k">return</span> <span class="n">total_offset</span>
</span></pre></div>


            <div class="docstring"><p>Estimate behavioral response to payroll tax changes.</p>

<p>Behavioral responses include:</p>

<ul>
<li>Labor supply effects (work less in response to higher taxes)</li>
<li>Income shifting (convert wages to other income types)</li>
<li>Tax avoidance (S-corps, etc.)</li>
</ul>

<p>Returns:
    Behavioral offset in billions</p>
</div>


                            </div>
                </section>
                <section id="PayrollTaxType">
                            <input id="PayrollTaxType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PayrollTaxType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="PayrollTaxType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PayrollTaxType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PayrollTaxType-32"><a href="#PayrollTaxType-32"><span class="linenos">32</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PayrollTaxType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="PayrollTaxType-33"><a href="#PayrollTaxType-33"><span class="linenos">33</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Types of payroll taxes.&quot;&quot;&quot;</span>
</span><span id="PayrollTaxType-34"><a href="#PayrollTaxType-34"><span class="linenos">34</span></a>    <span class="n">SOCIAL_SECURITY</span> <span class="o">=</span> <span class="s2">&quot;social_security&quot;</span>
</span><span id="PayrollTaxType-35"><a href="#PayrollTaxType-35"><span class="linenos">35</span></a>    <span class="n">MEDICARE</span> <span class="o">=</span> <span class="s2">&quot;medicare&quot;</span>
</span><span id="PayrollTaxType-36"><a href="#PayrollTaxType-36"><span class="linenos">36</span></a>    <span class="n">ADDITIONAL_MEDICARE</span> <span class="o">=</span> <span class="s2">&quot;additional_medicare&quot;</span>
</span><span id="PayrollTaxType-37"><a href="#PayrollTaxType-37"><span class="linenos">37</span></a>    <span class="n">NIIT</span> <span class="o">=</span> <span class="s2">&quot;niit&quot;</span>  <span class="c1"># Net Investment Income Tax</span>
</span><span id="PayrollTaxType-38"><a href="#PayrollTaxType-38"><span class="linenos">38</span></a>    <span class="n">COMBINED</span> <span class="o">=</span> <span class="s2">&quot;combined&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Types of payroll taxes.</p>
</div>


                            <div id="PayrollTaxType.SOCIAL_SECURITY" class="classattr">
                                <div class="attr variable">
            <span class="name">SOCIAL_SECURITY</span>        =
<span class="default_value">&lt;<a href="#PayrollTaxType.SOCIAL_SECURITY">PayrollTaxType.SOCIAL_SECURITY</a>: &#39;social_security&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxType.SOCIAL_SECURITY"></a>
    
    

                            </div>
                            <div id="PayrollTaxType.MEDICARE" class="classattr">
                                <div class="attr variable">
            <span class="name">MEDICARE</span>        =
<span class="default_value">&lt;<a href="#PayrollTaxType.MEDICARE">PayrollTaxType.MEDICARE</a>: &#39;medicare&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxType.MEDICARE"></a>
    
    

                            </div>
                            <div id="PayrollTaxType.ADDITIONAL_MEDICARE" class="classattr">
                                <div class="attr variable">
            <span class="name">ADDITIONAL_MEDICARE</span>        =
<span class="default_value">&lt;<a href="#PayrollTaxType.ADDITIONAL_MEDICARE">PayrollTaxType.ADDITIONAL_MEDICARE</a>: &#39;additional_medicare&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxType.ADDITIONAL_MEDICARE"></a>
    
    

                            </div>
                            <div id="PayrollTaxType.NIIT" class="classattr">
                                <div class="attr variable">
            <span class="name">NIIT</span>        =
<span class="default_value">&lt;<a href="#PayrollTaxType.NIIT">PayrollTaxType.NIIT</a>: &#39;niit&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxType.NIIT"></a>
    
    

                            </div>
                            <div id="PayrollTaxType.COMBINED" class="classattr">
                                <div class="attr variable">
            <span class="name">COMBINED</span>        =
<span class="default_value">&lt;<a href="#PayrollTaxType.COMBINED">PayrollTaxType.COMBINED</a>: &#39;combined&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PayrollTaxType.COMBINED"></a>
    
    

                            </div>
                </section>
                <section id="SOCIAL_SECURITY_PARAMS">
                    <div class="attr variable">
            <span class="name">SOCIAL_SECURITY_PARAMS</span>        =
<input id="SOCIAL_SECURITY_PARAMS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="SOCIAL_SECURITY_PARAMS-view-value"></label><span class="default_value">{&#39;rate_combined&#39;: 0.124, &#39;rate_employee&#39;: 0.062, &#39;rate_employer&#39;: 0.062, &#39;cap_2024&#39;: 168600, &#39;cap_2025&#39;: 176100, &#39;cap_2026&#39;: 183900, &#39;cap_growth_rate&#39;: 0.044, &#39;pct_wages_covered&#39;: 0.83, &#39;pct_wages_above_cap&#39;: 0.17}</span>

        
    </div>
    <a class="headerlink" href="#SOCIAL_SECURITY_PARAMS"></a>
    
    

                </section>
                <section id="MEDICARE_PARAMS">
                    <div class="attr variable">
            <span class="name">MEDICARE_PARAMS</span>        =
<input id="MEDICARE_PARAMS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="MEDICARE_PARAMS-view-value"></label><span class="default_value">{&#39;rate_combined&#39;: 0.029, &#39;rate_employee&#39;: 0.0145, &#39;rate_employer&#39;: 0.0145, &#39;wage_cap&#39;: None, &#39;additional_rate&#39;: 0.009, &#39;threshold_single&#39;: 200000, &#39;threshold_married&#39;: 250000}</span>

        
    </div>
    <a class="headerlink" href="#MEDICARE_PARAMS"></a>
    
    

                </section>
                <section id="NIIT_PARAMS">
                    <div class="attr variable">
            <span class="name">NIIT_PARAMS</span>        =
<input id="NIIT_PARAMS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="NIIT_PARAMS-view-value"></label><span class="default_value">{&#39;rate&#39;: 0.038, &#39;threshold_single&#39;: 200000, &#39;threshold_married&#39;: 250000, &#39;annual_revenue_billions&#39;: 60.0}</span>

        
    </div>
    <a class="headerlink" href="#NIIT_PARAMS"></a>
    
    

                </section>
                <section id="CBO_PAYROLL_ESTIMATES">
                    <div class="attr variable">
            <span class="name">CBO_PAYROLL_ESTIMATES</span>        =
<input id="CBO_PAYROLL_ESTIMATES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="CBO_PAYROLL_ESTIMATES-view-value"></label><span class="default_value">{&#39;cap_90_pct_10yr&#39;: 800.0, &#39;cap_90_pct_annual&#39;: 80.0, &#39;donut_250k_10yr&#39;: 2700.0, &#39;donut_250k_annual&#39;: 270.0, &#39;eliminate_cap_10yr&#39;: 3200.0, &#39;eliminate_cap_annual&#39;: 320.0, &#39;expand_niit_10yr&#39;: 250.0, &#39;expand_niit_annual&#39;: 25.0, &#39;rate_1pp_10yr&#39;: 900.0, &#39;rate_1pp_annual&#39;: 90.0}</span>

        
    </div>
    <a class="headerlink" href="#CBO_PAYROLL_ESTIMATES"></a>
    
    

                </section>
                <section id="create_ss_cap_90_percent">
                            <input id="create_ss_cap_90_percent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_ss_cap_90_percent</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PayrollTaxPolicy">PayrollTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_ss_cap_90_percent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_ss_cap_90_percent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_ss_cap_90_percent-301"><a href="#create_ss_cap_90_percent-301"><span class="linenos">301</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_ss_cap_90_percent</span><span class="p">(</span>
</span><span id="create_ss_cap_90_percent-302"><a href="#create_ss_cap_90_percent-302"><span class="linenos">302</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-303"><a href="#create_ss_cap_90_percent-303"><span class="linenos">303</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-304"><a href="#create_ss_cap_90_percent-304"><span class="linenos">304</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PayrollTaxPolicy</span><span class="p">:</span>
</span><span id="create_ss_cap_90_percent-305"><a href="#create_ss_cap_90_percent-305"><span class="linenos">305</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_ss_cap_90_percent-306"><a href="#create_ss_cap_90_percent-306"><span class="linenos">306</span></a><span class="sd">    Create policy to raise Social Security cap to cover 90% of wages.</span>
</span><span id="create_ss_cap_90_percent-307"><a href="#create_ss_cap_90_percent-307"><span class="linenos">307</span></a>
</span><span id="create_ss_cap_90_percent-308"><a href="#create_ss_cap_90_percent-308"><span class="linenos">308</span></a><span class="sd">    Raises cap from ~$176K to ~$305K (in 2024 dollars).</span>
</span><span id="create_ss_cap_90_percent-309"><a href="#create_ss_cap_90_percent-309"><span class="linenos">309</span></a><span class="sd">    CBO estimate: ~$800B over 10 years</span>
</span><span id="create_ss_cap_90_percent-310"><a href="#create_ss_cap_90_percent-310"><span class="linenos">310</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_ss_cap_90_percent-311"><a href="#create_ss_cap_90_percent-311"><span class="linenos">311</span></a>    <span class="k">return</span> <span class="n">PayrollTaxPolicy</span><span class="p">(</span>
</span><span id="create_ss_cap_90_percent-312"><a href="#create_ss_cap_90_percent-312"><span class="linenos">312</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SS Cap to 90</span><span class="si">% o</span><span class="s2">f Wages&quot;</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-313"><a href="#create_ss_cap_90_percent-313"><span class="linenos">313</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Raise Social Security wage cap to cover 90</span><span class="si">% o</span><span class="s2">f earnings (~$305K)&quot;</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-314"><a href="#create_ss_cap_90_percent-314"><span class="linenos">314</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-315"><a href="#create_ss_cap_90_percent-315"><span class="linenos">315</span></a>        <span class="n">payroll_tax_type</span><span class="o">=</span><span class="n">PayrollTaxType</span><span class="o">.</span><span class="n">SOCIAL_SECURITY</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-316"><a href="#create_ss_cap_90_percent-316"><span class="linenos">316</span></a>        <span class="n">ss_cover_90_pct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-317"><a href="#create_ss_cap_90_percent-317"><span class="linenos">317</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Behavioral already in calibration</span>
</span><span id="create_ss_cap_90_percent-318"><a href="#create_ss_cap_90_percent-318"><span class="linenos">318</span></a>        <span class="n">tax_avoidance_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-319"><a href="#create_ss_cap_90_percent-319"><span class="linenos">319</span></a>        <span class="c1"># Calibrated to CBO $800B over 10 years (with 4% growth)</span>
</span><span id="create_ss_cap_90_percent-320"><a href="#create_ss_cap_90_percent-320"><span class="linenos">320</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">58.5</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-321"><a href="#create_ss_cap_90_percent-321"><span class="linenos">321</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-322"><a href="#create_ss_cap_90_percent-322"><span class="linenos">322</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_ss_cap_90_percent-323"><a href="#create_ss_cap_90_percent-323"><span class="linenos">323</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to raise Social Security cap to cover 90% of wages.</p>

<p>Raises cap from ~$176K to ~$305K (in 2024 dollars).
CBO estimate: ~$800B over 10 years</p>
</div>


                </section>
                <section id="create_ss_donut_hole">
                            <input id="create_ss_donut_hole-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_ss_donut_hole</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">250000</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PayrollTaxPolicy">PayrollTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_ss_donut_hole-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_ss_donut_hole"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_ss_donut_hole-326"><a href="#create_ss_donut_hole-326"><span class="linenos">326</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_ss_donut_hole</span><span class="p">(</span>
</span><span id="create_ss_donut_hole-327"><a href="#create_ss_donut_hole-327"><span class="linenos">327</span></a>    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">250_000</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-328"><a href="#create_ss_donut_hole-328"><span class="linenos">328</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-329"><a href="#create_ss_donut_hole-329"><span class="linenos">329</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-330"><a href="#create_ss_donut_hole-330"><span class="linenos">330</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PayrollTaxPolicy</span><span class="p">:</span>
</span><span id="create_ss_donut_hole-331"><a href="#create_ss_donut_hole-331"><span class="linenos">331</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_ss_donut_hole-332"><a href="#create_ss_donut_hole-332"><span class="linenos">332</span></a><span class="sd">    Create policy to apply Social Security tax above a threshold.</span>
</span><span id="create_ss_donut_hole-333"><a href="#create_ss_donut_hole-333"><span class="linenos">333</span></a>
</span><span id="create_ss_donut_hole-334"><a href="#create_ss_donut_hole-334"><span class="linenos">334</span></a><span class="sd">    &quot;Donut hole&quot; approach: tax wages up to current cap AND above threshold.</span>
</span><span id="create_ss_donut_hole-335"><a href="#create_ss_donut_hole-335"><span class="linenos">335</span></a><span class="sd">    Exempts wages between cap and threshold.</span>
</span><span id="create_ss_donut_hole-336"><a href="#create_ss_donut_hole-336"><span class="linenos">336</span></a>
</span><span id="create_ss_donut_hole-337"><a href="#create_ss_donut_hole-337"><span class="linenos">337</span></a><span class="sd">    SS Trustees estimate: ~$2.7T over 10 years for $250K threshold</span>
</span><span id="create_ss_donut_hole-338"><a href="#create_ss_donut_hole-338"><span class="linenos">338</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_ss_donut_hole-339"><a href="#create_ss_donut_hole-339"><span class="linenos">339</span></a>    <span class="k">return</span> <span class="n">PayrollTaxPolicy</span><span class="p">(</span>
</span><span id="create_ss_donut_hole-340"><a href="#create_ss_donut_hole-340"><span class="linenos">340</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SS Donut Hole Above $</span><span class="si">{</span><span class="n">threshold</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K&quot;</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-341"><a href="#create_ss_donut_hole-341"><span class="linenos">341</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Apply Social Security tax to wages above $</span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-342"><a href="#create_ss_donut_hole-342"><span class="linenos">342</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-343"><a href="#create_ss_donut_hole-343"><span class="linenos">343</span></a>        <span class="n">payroll_tax_type</span><span class="o">=</span><span class="n">PayrollTaxType</span><span class="o">.</span><span class="n">SOCIAL_SECURITY</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-344"><a href="#create_ss_donut_hole-344"><span class="linenos">344</span></a>        <span class="n">ss_donut_hole_start</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-345"><a href="#create_ss_donut_hole-345"><span class="linenos">345</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Behavioral already in calibration</span>
</span><span id="create_ss_donut_hole-346"><a href="#create_ss_donut_hole-346"><span class="linenos">346</span></a>        <span class="n">tax_avoidance_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-347"><a href="#create_ss_donut_hole-347"><span class="linenos">347</span></a>        <span class="c1"># Calibrated to Trustees $2.7T over 10 years (with 4% growth)</span>
</span><span id="create_ss_donut_hole-348"><a href="#create_ss_donut_hole-348"><span class="linenos">348</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">197.5</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-349"><a href="#create_ss_donut_hole-349"><span class="linenos">349</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-350"><a href="#create_ss_donut_hole-350"><span class="linenos">350</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_ss_donut_hole-351"><a href="#create_ss_donut_hole-351"><span class="linenos">351</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to apply Social Security tax above a threshold.</p>

<p>"Donut hole" approach: tax wages up to current cap AND above threshold.
Exempts wages between cap and threshold.</p>

<p>SS Trustees estimate: ~$2.7T over 10 years for $250K threshold</p>
</div>


                </section>
                <section id="create_ss_eliminate_cap">
                            <input id="create_ss_eliminate_cap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_ss_eliminate_cap</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PayrollTaxPolicy">PayrollTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_ss_eliminate_cap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_ss_eliminate_cap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_ss_eliminate_cap-354"><a href="#create_ss_eliminate_cap-354"><span class="linenos">354</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_ss_eliminate_cap</span><span class="p">(</span>
</span><span id="create_ss_eliminate_cap-355"><a href="#create_ss_eliminate_cap-355"><span class="linenos">355</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-356"><a href="#create_ss_eliminate_cap-356"><span class="linenos">356</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-357"><a href="#create_ss_eliminate_cap-357"><span class="linenos">357</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PayrollTaxPolicy</span><span class="p">:</span>
</span><span id="create_ss_eliminate_cap-358"><a href="#create_ss_eliminate_cap-358"><span class="linenos">358</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_ss_eliminate_cap-359"><a href="#create_ss_eliminate_cap-359"><span class="linenos">359</span></a><span class="sd">    Create policy to eliminate the Social Security wage cap entirely.</span>
</span><span id="create_ss_eliminate_cap-360"><a href="#create_ss_eliminate_cap-360"><span class="linenos">360</span></a>
</span><span id="create_ss_eliminate_cap-361"><a href="#create_ss_eliminate_cap-361"><span class="linenos">361</span></a><span class="sd">    Tax all wages at 12.4% (6.2% employee + 6.2% employer).</span>
</span><span id="create_ss_eliminate_cap-362"><a href="#create_ss_eliminate_cap-362"><span class="linenos">362</span></a><span class="sd">    SS Trustees estimate: ~$3.2T over 10 years</span>
</span><span id="create_ss_eliminate_cap-363"><a href="#create_ss_eliminate_cap-363"><span class="linenos">363</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_ss_eliminate_cap-364"><a href="#create_ss_eliminate_cap-364"><span class="linenos">364</span></a>    <span class="k">return</span> <span class="n">PayrollTaxPolicy</span><span class="p">(</span>
</span><span id="create_ss_eliminate_cap-365"><a href="#create_ss_eliminate_cap-365"><span class="linenos">365</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Eliminate SS Cap&quot;</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-366"><a href="#create_ss_eliminate_cap-366"><span class="linenos">366</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Eliminate Social Security wage cap, tax all earnings at 12.4%&quot;</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-367"><a href="#create_ss_eliminate_cap-367"><span class="linenos">367</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-368"><a href="#create_ss_eliminate_cap-368"><span class="linenos">368</span></a>        <span class="n">payroll_tax_type</span><span class="o">=</span><span class="n">PayrollTaxType</span><span class="o">.</span><span class="n">SOCIAL_SECURITY</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-369"><a href="#create_ss_eliminate_cap-369"><span class="linenos">369</span></a>        <span class="n">ss_eliminate_cap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-370"><a href="#create_ss_eliminate_cap-370"><span class="linenos">370</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Behavioral already in calibration</span>
</span><span id="create_ss_eliminate_cap-371"><a href="#create_ss_eliminate_cap-371"><span class="linenos">371</span></a>        <span class="n">tax_avoidance_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-372"><a href="#create_ss_eliminate_cap-372"><span class="linenos">372</span></a>        <span class="c1"># Calibrated to Trustees $3.2T over 10 years (with 4% growth)</span>
</span><span id="create_ss_eliminate_cap-373"><a href="#create_ss_eliminate_cap-373"><span class="linenos">373</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">234.0</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-374"><a href="#create_ss_eliminate_cap-374"><span class="linenos">374</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-375"><a href="#create_ss_eliminate_cap-375"><span class="linenos">375</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_ss_eliminate_cap-376"><a href="#create_ss_eliminate_cap-376"><span class="linenos">376</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to eliminate the Social Security wage cap entirely.</p>

<p>Tax all wages at 12.4% (6.2% employee + 6.2% employer).
SS Trustees estimate: ~$3.2T over 10 years</p>
</div>


                </section>
                <section id="create_ss_rate_increase">
                            <input id="create_ss_rate_increase-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_ss_rate_increase</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PayrollTaxPolicy">PayrollTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_ss_rate_increase-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_ss_rate_increase"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_ss_rate_increase-379"><a href="#create_ss_rate_increase-379"><span class="linenos">379</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_ss_rate_increase</span><span class="p">(</span>
</span><span id="create_ss_rate_increase-380"><a href="#create_ss_rate_increase-380"><span class="linenos">380</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-381"><a href="#create_ss_rate_increase-381"><span class="linenos">381</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-382"><a href="#create_ss_rate_increase-382"><span class="linenos">382</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-383"><a href="#create_ss_rate_increase-383"><span class="linenos">383</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PayrollTaxPolicy</span><span class="p">:</span>
</span><span id="create_ss_rate_increase-384"><a href="#create_ss_rate_increase-384"><span class="linenos">384</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_ss_rate_increase-385"><a href="#create_ss_rate_increase-385"><span class="linenos">385</span></a><span class="sd">    Create policy to increase Social Security payroll tax rate.</span>
</span><span id="create_ss_rate_increase-386"><a href="#create_ss_rate_increase-386"><span class="linenos">386</span></a>
</span><span id="create_ss_rate_increase-387"><a href="#create_ss_rate_increase-387"><span class="linenos">387</span></a><span class="sd">    Args:</span>
</span><span id="create_ss_rate_increase-388"><a href="#create_ss_rate_increase-388"><span class="linenos">388</span></a><span class="sd">        rate_change: Change in rate (e.g., 0.01 for 1pp increase)</span>
</span><span id="create_ss_rate_increase-389"><a href="#create_ss_rate_increase-389"><span class="linenos">389</span></a><span class="sd">        start_year: First year of policy</span>
</span><span id="create_ss_rate_increase-390"><a href="#create_ss_rate_increase-390"><span class="linenos">390</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_ss_rate_increase-391"><a href="#create_ss_rate_increase-391"><span class="linenos">391</span></a>
</span><span id="create_ss_rate_increase-392"><a href="#create_ss_rate_increase-392"><span class="linenos">392</span></a><span class="sd">    Returns:</span>
</span><span id="create_ss_rate_increase-393"><a href="#create_ss_rate_increase-393"><span class="linenos">393</span></a><span class="sd">        PayrollTaxPolicy for rate increase</span>
</span><span id="create_ss_rate_increase-394"><a href="#create_ss_rate_increase-394"><span class="linenos">394</span></a>
</span><span id="create_ss_rate_increase-395"><a href="#create_ss_rate_increase-395"><span class="linenos">395</span></a><span class="sd">    Example:</span>
</span><span id="create_ss_rate_increase-396"><a href="#create_ss_rate_increase-396"><span class="linenos">396</span></a><span class="sd">        # 1pp increase (0.5% on each side)</span>
</span><span id="create_ss_rate_increase-397"><a href="#create_ss_rate_increase-397"><span class="linenos">397</span></a><span class="sd">        policy = create_ss_rate_increase(0.01)</span>
</span><span id="create_ss_rate_increase-398"><a href="#create_ss_rate_increase-398"><span class="linenos">398</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_ss_rate_increase-399"><a href="#create_ss_rate_increase-399"><span class="linenos">399</span></a>    <span class="n">rate_pp</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="create_ss_rate_increase-400"><a href="#create_ss_rate_increase-400"><span class="linenos">400</span></a>    <span class="c1"># 1pp = ~$90B/year</span>
</span><span id="create_ss_rate_increase-401"><a href="#create_ss_rate_increase-401"><span class="linenos">401</span></a>    <span class="n">annual_revenue</span> <span class="o">=</span> <span class="n">rate_pp</span> <span class="o">*</span> <span class="mf">78.5</span>  <span class="c1"># Calibrated</span>
</span><span id="create_ss_rate_increase-402"><a href="#create_ss_rate_increase-402"><span class="linenos">402</span></a>
</span><span id="create_ss_rate_increase-403"><a href="#create_ss_rate_increase-403"><span class="linenos">403</span></a>    <span class="k">return</span> <span class="n">PayrollTaxPolicy</span><span class="p">(</span>
</span><span id="create_ss_rate_increase-404"><a href="#create_ss_rate_increase-404"><span class="linenos">404</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SS Rate +</span><span class="si">{</span><span class="n">rate_pp</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">pp&quot;</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-405"><a href="#create_ss_rate_increase-405"><span class="linenos">405</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Increase Social Security payroll tax rate by </span><span class="si">{</span><span class="n">rate_pp</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> percentage points&quot;</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-406"><a href="#create_ss_rate_increase-406"><span class="linenos">406</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-407"><a href="#create_ss_rate_increase-407"><span class="linenos">407</span></a>        <span class="n">payroll_tax_type</span><span class="o">=</span><span class="n">PayrollTaxType</span><span class="o">.</span><span class="n">SOCIAL_SECURITY</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-408"><a href="#create_ss_rate_increase-408"><span class="linenos">408</span></a>        <span class="n">ss_rate_change</span><span class="o">=</span><span class="n">rate_change</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-409"><a href="#create_ss_rate_increase-409"><span class="linenos">409</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>  <span class="c1"># Rate increases have larger labor effects</span>
</span><span id="create_ss_rate_increase-410"><a href="#create_ss_rate_increase-410"><span class="linenos">410</span></a>        <span class="c1"># Calibrated</span>
</span><span id="create_ss_rate_increase-411"><a href="#create_ss_rate_increase-411"><span class="linenos">411</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="n">annual_revenue</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-412"><a href="#create_ss_rate_increase-412"><span class="linenos">412</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-413"><a href="#create_ss_rate_increase-413"><span class="linenos">413</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_ss_rate_increase-414"><a href="#create_ss_rate_increase-414"><span class="linenos">414</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to increase Social Security payroll tax rate.</p>

<p>Args:
    rate_change: Change in rate (e.g., 0.01 for 1pp increase)
    start_year: First year of policy
    duration_years: Duration</p>

<p>Returns:
    PayrollTaxPolicy for rate increase</p>

<p>Example:
    # 1pp increase (0.5% on each side)
    policy = create_ss_rate_increase(0.01)</p>
</div>


                </section>
                <section id="create_expand_niit">
                            <input id="create_expand_niit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_expand_niit</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PayrollTaxPolicy">PayrollTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_expand_niit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_expand_niit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_expand_niit-417"><a href="#create_expand_niit-417"><span class="linenos">417</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_expand_niit</span><span class="p">(</span>
</span><span id="create_expand_niit-418"><a href="#create_expand_niit-418"><span class="linenos">418</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_expand_niit-419"><a href="#create_expand_niit-419"><span class="linenos">419</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_expand_niit-420"><a href="#create_expand_niit-420"><span class="linenos">420</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PayrollTaxPolicy</span><span class="p">:</span>
</span><span id="create_expand_niit-421"><a href="#create_expand_niit-421"><span class="linenos">421</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_expand_niit-422"><a href="#create_expand_niit-422"><span class="linenos">422</span></a><span class="sd">    Create policy to expand NIIT to pass-through business income.</span>
</span><span id="create_expand_niit-423"><a href="#create_expand_niit-423"><span class="linenos">423</span></a>
</span><span id="create_expand_niit-424"><a href="#create_expand_niit-424"><span class="linenos">424</span></a><span class="sd">    Closes loophole where S-corp and partnership income avoids both</span>
</span><span id="create_expand_niit-425"><a href="#create_expand_niit-425"><span class="linenos">425</span></a><span class="sd">    Additional Medicare Tax and NIIT.</span>
</span><span id="create_expand_niit-426"><a href="#create_expand_niit-426"><span class="linenos">426</span></a>
</span><span id="create_expand_niit-427"><a href="#create_expand_niit-427"><span class="linenos">427</span></a><span class="sd">    JCT estimate (Build Back Better): ~$250B over 10 years</span>
</span><span id="create_expand_niit-428"><a href="#create_expand_niit-428"><span class="linenos">428</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_expand_niit-429"><a href="#create_expand_niit-429"><span class="linenos">429</span></a>    <span class="k">return</span> <span class="n">PayrollTaxPolicy</span><span class="p">(</span>
</span><span id="create_expand_niit-430"><a href="#create_expand_niit-430"><span class="linenos">430</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Expand NIIT to Pass-Through&quot;</span><span class="p">,</span>
</span><span id="create_expand_niit-431"><a href="#create_expand_niit-431"><span class="linenos">431</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Apply 3.8% NIIT to S-corp and partnership income of high earners&quot;</span><span class="p">,</span>
</span><span id="create_expand_niit-432"><a href="#create_expand_niit-432"><span class="linenos">432</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span><span class="p">,</span>
</span><span id="create_expand_niit-433"><a href="#create_expand_niit-433"><span class="linenos">433</span></a>        <span class="n">payroll_tax_type</span><span class="o">=</span><span class="n">PayrollTaxType</span><span class="o">.</span><span class="n">NIIT</span><span class="p">,</span>
</span><span id="create_expand_niit-434"><a href="#create_expand_niit-434"><span class="linenos">434</span></a>        <span class="n">expand_niit_to_passthrough</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_expand_niit-435"><a href="#create_expand_niit-435"><span class="linenos">435</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Behavioral already in calibration</span>
</span><span id="create_expand_niit-436"><a href="#create_expand_niit-436"><span class="linenos">436</span></a>        <span class="n">tax_avoidance_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_expand_niit-437"><a href="#create_expand_niit-437"><span class="linenos">437</span></a>        <span class="c1"># Calibrated to JCT $250B over 10 years (with 4% growth)</span>
</span><span id="create_expand_niit-438"><a href="#create_expand_niit-438"><span class="linenos">438</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">18.3</span><span class="p">,</span>
</span><span id="create_expand_niit-439"><a href="#create_expand_niit-439"><span class="linenos">439</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_expand_niit-440"><a href="#create_expand_niit-440"><span class="linenos">440</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_expand_niit-441"><a href="#create_expand_niit-441"><span class="linenos">441</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to expand NIIT to pass-through business income.</p>

<p>Closes loophole where S-corp and partnership income avoids both
Additional Medicare Tax and NIIT.</p>

<p>JCT estimate (Build Back Better): ~$250B over 10 years</p>
</div>


                </section>
                <section id="create_medicare_rate_increase">
                            <input id="create_medicare_rate_increase-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_medicare_rate_increase</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PayrollTaxPolicy">PayrollTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_medicare_rate_increase-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_medicare_rate_increase"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_medicare_rate_increase-444"><a href="#create_medicare_rate_increase-444"><span class="linenos">444</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_medicare_rate_increase</span><span class="p">(</span>
</span><span id="create_medicare_rate_increase-445"><a href="#create_medicare_rate_increase-445"><span class="linenos">445</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-446"><a href="#create_medicare_rate_increase-446"><span class="linenos">446</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-447"><a href="#create_medicare_rate_increase-447"><span class="linenos">447</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-448"><a href="#create_medicare_rate_increase-448"><span class="linenos">448</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PayrollTaxPolicy</span><span class="p">:</span>
</span><span id="create_medicare_rate_increase-449"><a href="#create_medicare_rate_increase-449"><span class="linenos">449</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_medicare_rate_increase-450"><a href="#create_medicare_rate_increase-450"><span class="linenos">450</span></a><span class="sd">    Create policy to increase Medicare payroll tax rate.</span>
</span><span id="create_medicare_rate_increase-451"><a href="#create_medicare_rate_increase-451"><span class="linenos">451</span></a>
</span><span id="create_medicare_rate_increase-452"><a href="#create_medicare_rate_increase-452"><span class="linenos">452</span></a><span class="sd">    Args:</span>
</span><span id="create_medicare_rate_increase-453"><a href="#create_medicare_rate_increase-453"><span class="linenos">453</span></a><span class="sd">        rate_change: Change in rate (e.g., 0.01 for 1pp increase)</span>
</span><span id="create_medicare_rate_increase-454"><a href="#create_medicare_rate_increase-454"><span class="linenos">454</span></a><span class="sd">        start_year: First year of policy</span>
</span><span id="create_medicare_rate_increase-455"><a href="#create_medicare_rate_increase-455"><span class="linenos">455</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_medicare_rate_increase-456"><a href="#create_medicare_rate_increase-456"><span class="linenos">456</span></a>
</span><span id="create_medicare_rate_increase-457"><a href="#create_medicare_rate_increase-457"><span class="linenos">457</span></a><span class="sd">    Returns:</span>
</span><span id="create_medicare_rate_increase-458"><a href="#create_medicare_rate_increase-458"><span class="linenos">458</span></a><span class="sd">        PayrollTaxPolicy for Medicare rate increase</span>
</span><span id="create_medicare_rate_increase-459"><a href="#create_medicare_rate_increase-459"><span class="linenos">459</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_medicare_rate_increase-460"><a href="#create_medicare_rate_increase-460"><span class="linenos">460</span></a>    <span class="n">rate_pp</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="create_medicare_rate_increase-461"><a href="#create_medicare_rate_increase-461"><span class="linenos">461</span></a>    <span class="c1"># Medicare revenue ~$400B at 2.9%, so 1pp = ~$140B</span>
</span><span id="create_medicare_rate_increase-462"><a href="#create_medicare_rate_increase-462"><span class="linenos">462</span></a>    <span class="n">annual_revenue</span> <span class="o">=</span> <span class="n">rate_pp</span> <span class="o">*</span> <span class="mf">122.0</span>  <span class="c1"># Calibrated</span>
</span><span id="create_medicare_rate_increase-463"><a href="#create_medicare_rate_increase-463"><span class="linenos">463</span></a>
</span><span id="create_medicare_rate_increase-464"><a href="#create_medicare_rate_increase-464"><span class="linenos">464</span></a>    <span class="k">return</span> <span class="n">PayrollTaxPolicy</span><span class="p">(</span>
</span><span id="create_medicare_rate_increase-465"><a href="#create_medicare_rate_increase-465"><span class="linenos">465</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Medicare Rate +</span><span class="si">{</span><span class="n">rate_pp</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">pp&quot;</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-466"><a href="#create_medicare_rate_increase-466"><span class="linenos">466</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Increase Medicare payroll tax rate by </span><span class="si">{</span><span class="n">rate_pp</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> percentage points&quot;</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-467"><a href="#create_medicare_rate_increase-467"><span class="linenos">467</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-468"><a href="#create_medicare_rate_increase-468"><span class="linenos">468</span></a>        <span class="n">payroll_tax_type</span><span class="o">=</span><span class="n">PayrollTaxType</span><span class="o">.</span><span class="n">MEDICARE</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-469"><a href="#create_medicare_rate_increase-469"><span class="linenos">469</span></a>        <span class="n">medicare_rate_change</span><span class="o">=</span><span class="n">rate_change</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-470"><a href="#create_medicare_rate_increase-470"><span class="linenos">470</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.12</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-471"><a href="#create_medicare_rate_increase-471"><span class="linenos">471</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="n">annual_revenue</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-472"><a href="#create_medicare_rate_increase-472"><span class="linenos">472</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-473"><a href="#create_medicare_rate_increase-473"><span class="linenos">473</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_medicare_rate_increase-474"><a href="#create_medicare_rate_increase-474"><span class="linenos">474</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to increase Medicare payroll tax rate.</p>

<p>Args:
    rate_change: Change in rate (e.g., 0.01 for 1pp increase)
    start_year: First year of policy
    duration_years: Duration</p>

<p>Returns:
    PayrollTaxPolicy for Medicare rate increase</p>
</div>


                </section>
                <section id="create_biden_payroll_proposal">
                            <input id="create_biden_payroll_proposal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_biden_payroll_proposal</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#PayrollTaxPolicy">PayrollTaxPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_biden_payroll_proposal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_biden_payroll_proposal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_biden_payroll_proposal-477"><a href="#create_biden_payroll_proposal-477"><span class="linenos">477</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_biden_payroll_proposal</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">PayrollTaxPolicy</span><span class="p">:</span>
</span><span id="create_biden_payroll_proposal-478"><a href="#create_biden_payroll_proposal-478"><span class="linenos">478</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_biden_payroll_proposal-479"><a href="#create_biden_payroll_proposal-479"><span class="linenos">479</span></a><span class="sd">    Create Biden&#39;s payroll tax proposal for Social Security.</span>
</span><span id="create_biden_payroll_proposal-480"><a href="#create_biden_payroll_proposal-480"><span class="linenos">480</span></a>
</span><span id="create_biden_payroll_proposal-481"><a href="#create_biden_payroll_proposal-481"><span class="linenos">481</span></a><span class="sd">    Key features:</span>
</span><span id="create_biden_payroll_proposal-482"><a href="#create_biden_payroll_proposal-482"><span class="linenos">482</span></a><span class="sd">    - Apply 12.4% SS tax on wages above $400K (donut hole)</span>
</span><span id="create_biden_payroll_proposal-483"><a href="#create_biden_payroll_proposal-483"><span class="linenos">483</span></a><span class="sd">    - Current cap (~$176K) + above $400K taxed</span>
</span><span id="create_biden_payroll_proposal-484"><a href="#create_biden_payroll_proposal-484"><span class="linenos">484</span></a><span class="sd">    - Gap between ~$176K and $400K exempt</span>
</span><span id="create_biden_payroll_proposal-485"><a href="#create_biden_payroll_proposal-485"><span class="linenos">485</span></a>
</span><span id="create_biden_payroll_proposal-486"><a href="#create_biden_payroll_proposal-486"><span class="linenos">486</span></a><span class="sd">    Estimated revenue: ~$1.4T over 10 years</span>
</span><span id="create_biden_payroll_proposal-487"><a href="#create_biden_payroll_proposal-487"><span class="linenos">487</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_biden_payroll_proposal-488"><a href="#create_biden_payroll_proposal-488"><span class="linenos">488</span></a>    <span class="k">return</span> <span class="n">PayrollTaxPolicy</span><span class="p">(</span>
</span><span id="create_biden_payroll_proposal-489"><a href="#create_biden_payroll_proposal-489"><span class="linenos">489</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Biden SS Tax Above $400K&quot;</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-490"><a href="#create_biden_payroll_proposal-490"><span class="linenos">490</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Apply Social Security tax to wages above $400K (donut hole)&quot;</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-491"><a href="#create_biden_payroll_proposal-491"><span class="linenos">491</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">PAYROLL_TAX</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-492"><a href="#create_biden_payroll_proposal-492"><span class="linenos">492</span></a>        <span class="n">payroll_tax_type</span><span class="o">=</span><span class="n">PayrollTaxType</span><span class="o">.</span><span class="n">SOCIAL_SECURITY</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-493"><a href="#create_biden_payroll_proposal-493"><span class="linenos">493</span></a>        <span class="n">ss_donut_hole_start</span><span class="o">=</span><span class="mi">400_000</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-494"><a href="#create_biden_payroll_proposal-494"><span class="linenos">494</span></a>        <span class="n">labor_supply_elasticity</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-495"><a href="#create_biden_payroll_proposal-495"><span class="linenos">495</span></a>        <span class="n">tax_avoidance_elasticity</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-496"><a href="#create_biden_payroll_proposal-496"><span class="linenos">496</span></a>        <span class="c1"># Scaled estimate based on $250K donut hole</span>
</span><span id="create_biden_payroll_proposal-497"><a href="#create_biden_payroll_proposal-497"><span class="linenos">497</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">122.0</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-498"><a href="#create_biden_payroll_proposal-498"><span class="linenos">498</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2025</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-499"><a href="#create_biden_payroll_proposal-499"><span class="linenos">499</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_biden_payroll_proposal-500"><a href="#create_biden_payroll_proposal-500"><span class="linenos">500</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create Biden's payroll tax proposal for Social Security.</p>

<p>Key features:</p>

<ul>
<li>Apply 12.4% SS tax on wages above $400K (donut hole)</li>
<li>Current cap (~$176K) + above $400K taxed</li>
<li>Gap between ~$176K and $400K exempt</li>
</ul>

<p>Estimated revenue: ~$1.4T over 10 years</p>
</div>


                </section>
                <section id="estimate_payroll_revenue">
                            <input id="estimate_payroll_revenue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_payroll_revenue</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#PayrollTaxPolicy">PayrollTaxPolicy</a></span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="estimate_payroll_revenue-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#estimate_payroll_revenue"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="estimate_payroll_revenue-539"><a href="#estimate_payroll_revenue-539"><span class="linenos">539</span></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_payroll_revenue</span><span class="p">(</span><span class="n">policy</span><span class="p">:</span> <span class="n">PayrollTaxPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="estimate_payroll_revenue-540"><a href="#estimate_payroll_revenue-540"><span class="linenos">540</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="estimate_payroll_revenue-541"><a href="#estimate_payroll_revenue-541"><span class="linenos">541</span></a><span class="sd">    Estimate total revenue effect of a payroll tax policy.</span>
</span><span id="estimate_payroll_revenue-542"><a href="#estimate_payroll_revenue-542"><span class="linenos">542</span></a>
</span><span id="estimate_payroll_revenue-543"><a href="#estimate_payroll_revenue-543"><span class="linenos">543</span></a><span class="sd">    Returns dict with:</span>
</span><span id="estimate_payroll_revenue-544"><a href="#estimate_payroll_revenue-544"><span class="linenos">544</span></a><span class="sd">        - annual_static: Average annual static effect</span>
</span><span id="estimate_payroll_revenue-545"><a href="#estimate_payroll_revenue-545"><span class="linenos">545</span></a><span class="sd">        - ten_year_static: Total 10-year static effect</span>
</span><span id="estimate_payroll_revenue-546"><a href="#estimate_payroll_revenue-546"><span class="linenos">546</span></a><span class="sd">        - behavioral_offset: Total behavioral offset</span>
</span><span id="estimate_payroll_revenue-547"><a href="#estimate_payroll_revenue-547"><span class="linenos">547</span></a><span class="sd">        - net_effect: Final effect after behavioral response</span>
</span><span id="estimate_payroll_revenue-548"><a href="#estimate_payroll_revenue-548"><span class="linenos">548</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="estimate_payroll_revenue-549"><a href="#estimate_payroll_revenue-549"><span class="linenos">549</span></a>    <span class="n">annual_static</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="estimate_payroll_revenue-550"><a href="#estimate_payroll_revenue-550"><span class="linenos">550</span></a>    <span class="n">behavioral</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">annual_static</span><span class="p">)</span>
</span><span id="estimate_payroll_revenue-551"><a href="#estimate_payroll_revenue-551"><span class="linenos">551</span></a>
</span><span id="estimate_payroll_revenue-552"><a href="#estimate_payroll_revenue-552"><span class="linenos">552</span></a>    <span class="c1"># Apply growth (~4%/year for wage growth)</span>
</span><span id="estimate_payroll_revenue-553"><a href="#estimate_payroll_revenue-553"><span class="linenos">553</span></a>    <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="estimate_payroll_revenue-554"><a href="#estimate_payroll_revenue-554"><span class="linenos">554</span></a>    <span class="n">annual_effects</span> <span class="o">=</span> <span class="n">annual_static</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.04</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_payroll_revenue-555"><a href="#estimate_payroll_revenue-555"><span class="linenos">555</span></a>    <span class="n">behavioral_effects</span> <span class="o">=</span> <span class="n">behavioral</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.04</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_payroll_revenue-556"><a href="#estimate_payroll_revenue-556"><span class="linenos">556</span></a>
</span><span id="estimate_payroll_revenue-557"><a href="#estimate_payroll_revenue-557"><span class="linenos">557</span></a>    <span class="n">ten_year_static</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">annual_effects</span><span class="p">)</span>
</span><span id="estimate_payroll_revenue-558"><a href="#estimate_payroll_revenue-558"><span class="linenos">558</span></a>    <span class="n">ten_year_behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">behavioral_effects</span><span class="p">)</span>
</span><span id="estimate_payroll_revenue-559"><a href="#estimate_payroll_revenue-559"><span class="linenos">559</span></a>
</span><span id="estimate_payroll_revenue-560"><a href="#estimate_payroll_revenue-560"><span class="linenos">560</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="estimate_payroll_revenue-561"><a href="#estimate_payroll_revenue-561"><span class="linenos">561</span></a>        <span class="s2">&quot;annual_static&quot;</span><span class="p">:</span> <span class="n">annual_static</span><span class="p">,</span>
</span><span id="estimate_payroll_revenue-562"><a href="#estimate_payroll_revenue-562"><span class="linenos">562</span></a>        <span class="s2">&quot;ten_year_static&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span><span class="p">,</span>
</span><span id="estimate_payroll_revenue-563"><a href="#estimate_payroll_revenue-563"><span class="linenos">563</span></a>        <span class="s2">&quot;behavioral_offset&quot;</span><span class="p">:</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_payroll_revenue-564"><a href="#estimate_payroll_revenue-564"><span class="linenos">564</span></a>        <span class="s2">&quot;net_effect&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span> <span class="o">+</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_payroll_revenue-565"><a href="#estimate_payroll_revenue-565"><span class="linenos">565</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Estimate total revenue effect of a payroll tax policy.</p>

<p>Returns dict with:
    - annual_static: Average annual static effect
    - ten_year_static: Total 10-year static effect
    - behavioral_offset: Total behavioral offset
    - net_effect: Final effect after behavioral response</p>
</div>


                </section>
                <section id="PAYROLL_VALIDATION_SCENARIOS">
                    <div class="attr variable">
            <span class="name">PAYROLL_VALIDATION_SCENARIOS</span>        =
<input id="PAYROLL_VALIDATION_SCENARIOS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="PAYROLL_VALIDATION_SCENARIOS-view-value"></label><span class="default_value">{&#39;ss_cap_90_pct&#39;: {&#39;description&#39;: &#39;SS cap to cover 90% of wages&#39;, &#39;policy_factory&#39;: &#39;create_ss_cap_90_percent&#39;, &#39;expected_10yr&#39;: -800.0, &#39;source&#39;: &#39;CBO&#39;, &#39;notes&#39;: &#39;Raise cap from ~$176K to ~$305K&#39;}, &#39;ss_donut_250k&#39;: {&#39;description&#39;: &#39;SS tax on wages above $250K&#39;, &#39;policy_factory&#39;: &#39;create_ss_donut_hole&#39;, &#39;expected_10yr&#39;: -2700.0, &#39;source&#39;: &#39;Social Security Trustees&#39;, &#39;notes&#39;: &#39;Donut hole: tax current cap + above $250K&#39;}, &#39;ss_eliminate_cap&#39;: {&#39;description&#39;: &#39;Eliminate SS wage cap&#39;, &#39;policy_factory&#39;: &#39;create_ss_eliminate_cap&#39;, &#39;expected_10yr&#39;: -3200.0, &#39;source&#39;: &#39;Social Security Trustees&#39;, &#39;notes&#39;: &#39;Tax all wages at 12.4%&#39;}, &#39;expand_niit&#39;: {&#39;description&#39;: &#39;Expand NIIT to pass-through income&#39;, &#39;policy_factory&#39;: &#39;create_expand_niit&#39;, &#39;expected_10yr&#39;: -250.0, &#39;source&#39;: &#39;JCT (Build Back Better)&#39;, &#39;notes&#39;: &#39;Close S-corp/partnership loophole&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#PAYROLL_VALIDATION_SCENARIOS"></a>
    
    

                </section>
                <section id="AMTPolicy">
                            <input id="AMTPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">AMTPolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="AMTPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AMTPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AMTPolicy-152"><a href="#AMTPolicy-152"><span class="linenos">152</span></a><span class="nd">@dataclass</span>
</span><span id="AMTPolicy-153"><a href="#AMTPolicy-153"><span class="linenos">153</span></a><span class="k">class</span><span class="w"> </span><span class="nc">AMTPolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="AMTPolicy-154"><a href="#AMTPolicy-154"><span class="linenos">154</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy-155"><a href="#AMTPolicy-155"><span class="linenos">155</span></a><span class="sd">    Alternative Minimum Tax policy modeling exemption, rate, and threshold changes.</span>
</span><span id="AMTPolicy-156"><a href="#AMTPolicy-156"><span class="linenos">156</span></a>
</span><span id="AMTPolicy-157"><a href="#AMTPolicy-157"><span class="linenos">157</span></a><span class="sd">    Models both individual AMT and corporate AMT (book minimum tax).</span>
</span><span id="AMTPolicy-158"><a href="#AMTPolicy-158"><span class="linenos">158</span></a>
</span><span id="AMTPolicy-159"><a href="#AMTPolicy-159"><span class="linenos">159</span></a><span class="sd">    Key parameters:</span>
</span><span id="AMTPolicy-160"><a href="#AMTPolicy-160"><span class="linenos">160</span></a><span class="sd">        amt_type: Whether modeling individual or corporate AMT</span>
</span><span id="AMTPolicy-161"><a href="#AMTPolicy-161"><span class="linenos">161</span></a><span class="sd">        extend_tcja_relief: Extend TCJA&#39;s higher exemptions past 2025</span>
</span><span id="AMTPolicy-162"><a href="#AMTPolicy-162"><span class="linenos">162</span></a><span class="sd">        exemption_change: Change in exemption levels (dollars)</span>
</span><span id="AMTPolicy-163"><a href="#AMTPolicy-163"><span class="linenos">163</span></a><span class="sd">        new_exemption_single: Specific new exemption (single)</span>
</span><span id="AMTPolicy-164"><a href="#AMTPolicy-164"><span class="linenos">164</span></a><span class="sd">        new_exemption_mfj: Specific new exemption (MFJ)</span>
</span><span id="AMTPolicy-165"><a href="#AMTPolicy-165"><span class="linenos">165</span></a><span class="sd">        repeal_individual_amt: Fully repeal individual AMT</span>
</span><span id="AMTPolicy-166"><a href="#AMTPolicy-166"><span class="linenos">166</span></a><span class="sd">        rate_change: Change in AMT rates</span>
</span><span id="AMTPolicy-167"><a href="#AMTPolicy-167"><span class="linenos">167</span></a>
</span><span id="AMTPolicy-168"><a href="#AMTPolicy-168"><span class="linenos">168</span></a><span class="sd">    Behavioral responses:</span>
</span><span id="AMTPolicy-169"><a href="#AMTPolicy-169"><span class="linenos">169</span></a><span class="sd">        - Income timing (defer income to avoid AMT)</span>
</span><span id="AMTPolicy-170"><a href="#AMTPolicy-170"><span class="linenos">170</span></a><span class="sd">        - Tax planning (restructure to minimize AMTI)</span>
</span><span id="AMTPolicy-171"><a href="#AMTPolicy-171"><span class="linenos">171</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AMTPolicy-172"><a href="#AMTPolicy-172"><span class="linenos">172</span></a>
</span><span id="AMTPolicy-173"><a href="#AMTPolicy-173"><span class="linenos">173</span></a>    <span class="c1"># AMT type</span>
</span><span id="AMTPolicy-174"><a href="#AMTPolicy-174"><span class="linenos">174</span></a>    <span class="n">amt_type</span><span class="p">:</span> <span class="n">AMTType</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">AMTType</span><span class="o">.</span><span class="n">INDIVIDUAL</span><span class="p">)</span>
</span><span id="AMTPolicy-175"><a href="#AMTPolicy-175"><span class="linenos">175</span></a>
</span><span id="AMTPolicy-176"><a href="#AMTPolicy-176"><span class="linenos">176</span></a>    <span class="c1"># TCJA extension</span>
</span><span id="AMTPolicy-177"><a href="#AMTPolicy-177"><span class="linenos">177</span></a>    <span class="n">extend_tcja_relief</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Keep TCJA&#39;s high exemptions post-2025</span>
</span><span id="AMTPolicy-178"><a href="#AMTPolicy-178"><span class="linenos">178</span></a>
</span><span id="AMTPolicy-179"><a href="#AMTPolicy-179"><span class="linenos">179</span></a>    <span class="c1"># Exemption changes (individual AMT)</span>
</span><span id="AMTPolicy-180"><a href="#AMTPolicy-180"><span class="linenos">180</span></a>    <span class="n">exemption_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Dollar change in exemption</span>
</span><span id="AMTPolicy-181"><a href="#AMTPolicy-181"><span class="linenos">181</span></a>    <span class="n">new_exemption_single</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AMTPolicy-182"><a href="#AMTPolicy-182"><span class="linenos">182</span></a>    <span class="n">new_exemption_mfj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AMTPolicy-183"><a href="#AMTPolicy-183"><span class="linenos">183</span></a>
</span><span id="AMTPolicy-184"><a href="#AMTPolicy-184"><span class="linenos">184</span></a>    <span class="c1"># Full repeal options</span>
</span><span id="AMTPolicy-185"><a href="#AMTPolicy-185"><span class="linenos">185</span></a>    <span class="n">repeal_individual_amt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="AMTPolicy-186"><a href="#AMTPolicy-186"><span class="linenos">186</span></a>    <span class="n">repeal_corporate_amt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="AMTPolicy-187"><a href="#AMTPolicy-187"><span class="linenos">187</span></a>
</span><span id="AMTPolicy-188"><a href="#AMTPolicy-188"><span class="linenos">188</span></a>    <span class="c1"># Rate changes</span>
</span><span id="AMTPolicy-189"><a href="#AMTPolicy-189"><span class="linenos">189</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change to both tiers</span>
</span><span id="AMTPolicy-190"><a href="#AMTPolicy-190"><span class="linenos">190</span></a>    <span class="n">new_first_tier_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 26% default</span>
</span><span id="AMTPolicy-191"><a href="#AMTPolicy-191"><span class="linenos">191</span></a>    <span class="n">new_second_tier_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 28% default</span>
</span><span id="AMTPolicy-192"><a href="#AMTPolicy-192"><span class="linenos">192</span></a>
</span><span id="AMTPolicy-193"><a href="#AMTPolicy-193"><span class="linenos">193</span></a>    <span class="c1"># Phase-out changes</span>
</span><span id="AMTPolicy-194"><a href="#AMTPolicy-194"><span class="linenos">194</span></a>    <span class="n">phase_out_threshold_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change to phase-out start</span>
</span><span id="AMTPolicy-195"><a href="#AMTPolicy-195"><span class="linenos">195</span></a>
</span><span id="AMTPolicy-196"><a href="#AMTPolicy-196"><span class="linenos">196</span></a>    <span class="c1"># Behavioral parameters</span>
</span><span id="AMTPolicy-197"><a href="#AMTPolicy-197"><span class="linenos">197</span></a>    <span class="n">timing_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>
</span><span id="AMTPolicy-198"><a href="#AMTPolicy-198"><span class="linenos">198</span></a>    <span class="n">avoidance_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.10</span>
</span><span id="AMTPolicy-199"><a href="#AMTPolicy-199"><span class="linenos">199</span></a>
</span><span id="AMTPolicy-200"><a href="#AMTPolicy-200"><span class="linenos">200</span></a>    <span class="c1"># Base year for calculations</span>
</span><span id="AMTPolicy-201"><a href="#AMTPolicy-201"><span class="linenos">201</span></a>    <span class="n">base_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2024</span>
</span><span id="AMTPolicy-202"><a href="#AMTPolicy-202"><span class="linenos">202</span></a>
</span><span id="AMTPolicy-203"><a href="#AMTPolicy-203"><span class="linenos">203</span></a>    <span class="c1"># Calibration</span>
</span><span id="AMTPolicy-204"><a href="#AMTPolicy-204"><span class="linenos">204</span></a>    <span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AMTPolicy-205"><a href="#AMTPolicy-205"><span class="linenos">205</span></a>
</span><span id="AMTPolicy-206"><a href="#AMTPolicy-206"><span class="linenos">206</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AMTPolicy-207"><a href="#AMTPolicy-207"><span class="linenos">207</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set default policy type.&quot;&quot;&quot;</span>
</span><span id="AMTPolicy-208"><a href="#AMTPolicy-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">:</span>
</span><span id="AMTPolicy-209"><a href="#AMTPolicy-209"><span class="linenos">209</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">=</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span>  <span class="c1"># AMT is part of income tax</span>
</span><span id="AMTPolicy-210"><a href="#AMTPolicy-210"><span class="linenos">210</span></a>
</span><span id="AMTPolicy-211"><a href="#AMTPolicy-211"><span class="linenos">211</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_exemption_for_year</span><span class="p">(</span>
</span><span id="AMTPolicy-212"><a href="#AMTPolicy-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AMTPolicy-213"><a href="#AMTPolicy-213"><span class="linenos">213</span></a>        <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AMTPolicy-214"><a href="#AMTPolicy-214"><span class="linenos">214</span></a>        <span class="n">filing_status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mfj&quot;</span>
</span><span id="AMTPolicy-215"><a href="#AMTPolicy-215"><span class="linenos">215</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="AMTPolicy-216"><a href="#AMTPolicy-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy-217"><a href="#AMTPolicy-217"><span class="linenos">217</span></a><span class="sd">        Get the effective AMT exemption for a given year.</span>
</span><span id="AMTPolicy-218"><a href="#AMTPolicy-218"><span class="linenos">218</span></a>
</span><span id="AMTPolicy-219"><a href="#AMTPolicy-219"><span class="linenos">219</span></a><span class="sd">        Args:</span>
</span><span id="AMTPolicy-220"><a href="#AMTPolicy-220"><span class="linenos">220</span></a><span class="sd">            year: Tax year</span>
</span><span id="AMTPolicy-221"><a href="#AMTPolicy-221"><span class="linenos">221</span></a><span class="sd">            filing_status: &#39;single&#39;, &#39;mfj&#39;, or &#39;mfs&#39;</span>
</span><span id="AMTPolicy-222"><a href="#AMTPolicy-222"><span class="linenos">222</span></a>
</span><span id="AMTPolicy-223"><a href="#AMTPolicy-223"><span class="linenos">223</span></a><span class="sd">        Returns:</span>
</span><span id="AMTPolicy-224"><a href="#AMTPolicy-224"><span class="linenos">224</span></a><span class="sd">            Exemption amount in dollars</span>
</span><span id="AMTPolicy-225"><a href="#AMTPolicy-225"><span class="linenos">225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy-226"><a href="#AMTPolicy-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_individual_amt</span><span class="p">:</span>
</span><span id="AMTPolicy-227"><a href="#AMTPolicy-227"><span class="linenos">227</span></a>            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>  <span class="c1"># No AMT = infinite exemption</span>
</span><span id="AMTPolicy-228"><a href="#AMTPolicy-228"><span class="linenos">228</span></a>
</span><span id="AMTPolicy-229"><a href="#AMTPolicy-229"><span class="linenos">229</span></a>        <span class="c1"># Specific exemption overrides</span>
</span><span id="AMTPolicy-230"><a href="#AMTPolicy-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="n">filing_status</span> <span class="o">==</span> <span class="s2">&quot;single&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_single</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy-231"><a href="#AMTPolicy-231"><span class="linenos">231</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_single</span>
</span><span id="AMTPolicy-232"><a href="#AMTPolicy-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="n">filing_status</span> <span class="o">==</span> <span class="s2">&quot;mfj&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_mfj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy-233"><a href="#AMTPolicy-233"><span class="linenos">233</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_mfj</span>
</span><span id="AMTPolicy-234"><a href="#AMTPolicy-234"><span class="linenos">234</span></a>        <span class="k">if</span> <span class="n">filing_status</span> <span class="o">==</span> <span class="s2">&quot;mfs&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_mfj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy-235"><a href="#AMTPolicy-235"><span class="linenos">235</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_mfj</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># MFS is half of MFJ</span>
</span><span id="AMTPolicy-236"><a href="#AMTPolicy-236"><span class="linenos">236</span></a>
</span><span id="AMTPolicy-237"><a href="#AMTPolicy-237"><span class="linenos">237</span></a>        <span class="c1"># TCJA extension</span>
</span><span id="AMTPolicy-238"><a href="#AMTPolicy-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_tcja_relief</span><span class="p">:</span>
</span><span id="AMTPolicy-239"><a href="#AMTPolicy-239"><span class="linenos">239</span></a>            <span class="k">if</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">AMT_EXEMPTIONS_TCJA_EXTENDED</span><span class="p">:</span>
</span><span id="AMTPolicy-240"><a href="#AMTPolicy-240"><span class="linenos">240</span></a>                <span class="n">exemptions</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA_EXTENDED</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
</span><span id="AMTPolicy-241"><a href="#AMTPolicy-241"><span class="linenos">241</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy-242"><a href="#AMTPolicy-242"><span class="linenos">242</span></a>                <span class="n">exemptions</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA_EXTENDED</span><span class="p">[</span><span class="mi">2034</span><span class="p">]</span>
</span><span id="AMTPolicy-243"><a href="#AMTPolicy-243"><span class="linenos">243</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy-244"><a href="#AMTPolicy-244"><span class="linenos">244</span></a>            <span class="c1"># Current law baseline</span>
</span><span id="AMTPolicy-245"><a href="#AMTPolicy-245"><span class="linenos">245</span></a>            <span class="k">if</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">:</span>
</span><span id="AMTPolicy-246"><a href="#AMTPolicy-246"><span class="linenos">246</span></a>                <span class="n">exemptions</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
</span><span id="AMTPolicy-247"><a href="#AMTPolicy-247"><span class="linenos">247</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy-248"><a href="#AMTPolicy-248"><span class="linenos">248</span></a>                <span class="n">exemptions</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">[</span><span class="mi">2034</span><span class="p">]</span>
</span><span id="AMTPolicy-249"><a href="#AMTPolicy-249"><span class="linenos">249</span></a>
</span><span id="AMTPolicy-250"><a href="#AMTPolicy-250"><span class="linenos">250</span></a>        <span class="c1"># Extract by filing status</span>
</span><span id="AMTPolicy-251"><a href="#AMTPolicy-251"><span class="linenos">251</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;single&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;mfj&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;mfs&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">filing_status</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AMTPolicy-252"><a href="#AMTPolicy-252"><span class="linenos">252</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">exemptions</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="AMTPolicy-253"><a href="#AMTPolicy-253"><span class="linenos">253</span></a>
</span><span id="AMTPolicy-254"><a href="#AMTPolicy-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="n">base</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">exemption_change</span>
</span><span id="AMTPolicy-255"><a href="#AMTPolicy-255"><span class="linenos">255</span></a>
</span><span id="AMTPolicy-256"><a href="#AMTPolicy-256"><span class="linenos">256</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rate_for_tier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tier</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="AMTPolicy-257"><a href="#AMTPolicy-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy-258"><a href="#AMTPolicy-258"><span class="linenos">258</span></a><span class="sd">        Get AMT rate for a tier (1 = 26%, 2 = 28%).</span>
</span><span id="AMTPolicy-259"><a href="#AMTPolicy-259"><span class="linenos">259</span></a>
</span><span id="AMTPolicy-260"><a href="#AMTPolicy-260"><span class="linenos">260</span></a><span class="sd">        Args:</span>
</span><span id="AMTPolicy-261"><a href="#AMTPolicy-261"><span class="linenos">261</span></a><span class="sd">            tier: 1 for first tier, 2 for second tier</span>
</span><span id="AMTPolicy-262"><a href="#AMTPolicy-262"><span class="linenos">262</span></a>
</span><span id="AMTPolicy-263"><a href="#AMTPolicy-263"><span class="linenos">263</span></a><span class="sd">        Returns:</span>
</span><span id="AMTPolicy-264"><a href="#AMTPolicy-264"><span class="linenos">264</span></a><span class="sd">            Tax rate as decimal</span>
</span><span id="AMTPolicy-265"><a href="#AMTPolicy-265"><span class="linenos">265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy-266"><a href="#AMTPolicy-266"><span class="linenos">266</span></a>        <span class="k">if</span> <span class="n">tier</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AMTPolicy-267"><a href="#AMTPolicy-267"><span class="linenos">267</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_first_tier_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy-268"><a href="#AMTPolicy-268"><span class="linenos">268</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_first_tier_rate</span>
</span><span id="AMTPolicy-269"><a href="#AMTPolicy-269"><span class="linenos">269</span></a>            <span class="k">return</span> <span class="n">AMT_RATES</span><span class="p">[</span><span class="s2">&quot;first_tier&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span>
</span><span id="AMTPolicy-270"><a href="#AMTPolicy-270"><span class="linenos">270</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy-271"><a href="#AMTPolicy-271"><span class="linenos">271</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_second_tier_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy-272"><a href="#AMTPolicy-272"><span class="linenos">272</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_second_tier_rate</span>
</span><span id="AMTPolicy-273"><a href="#AMTPolicy-273"><span class="linenos">273</span></a>            <span class="k">return</span> <span class="n">AMT_RATES</span><span class="p">[</span><span class="s2">&quot;second_tier&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span>
</span><span id="AMTPolicy-274"><a href="#AMTPolicy-274"><span class="linenos">274</span></a>
</span><span id="AMTPolicy-275"><a href="#AMTPolicy-275"><span class="linenos">275</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_affected_taxpayers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="AMTPolicy-276"><a href="#AMTPolicy-276"><span class="linenos">276</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy-277"><a href="#AMTPolicy-277"><span class="linenos">277</span></a><span class="sd">        Estimate number of taxpayers affected by AMT.</span>
</span><span id="AMTPolicy-278"><a href="#AMTPolicy-278"><span class="linenos">278</span></a>
</span><span id="AMTPolicy-279"><a href="#AMTPolicy-279"><span class="linenos">279</span></a><span class="sd">        Under TCJA high exemptions: ~200,000</span>
</span><span id="AMTPolicy-280"><a href="#AMTPolicy-280"><span class="linenos">280</span></a><span class="sd">        After TCJA sunset: ~7.3M</span>
</span><span id="AMTPolicy-281"><a href="#AMTPolicy-281"><span class="linenos">281</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy-282"><a href="#AMTPolicy-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_individual_amt</span><span class="p">:</span>
</span><span id="AMTPolicy-283"><a href="#AMTPolicy-283"><span class="linenos">283</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="AMTPolicy-284"><a href="#AMTPolicy-284"><span class="linenos">284</span></a>
</span><span id="AMTPolicy-285"><a href="#AMTPolicy-285"><span class="linenos">285</span></a>        <span class="c1"># Get exemption level to estimate taxpayers</span>
</span><span id="AMTPolicy-286"><a href="#AMTPolicy-286"><span class="linenos">286</span></a>        <span class="n">exemption</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exemption_for_year</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;mfj&quot;</span><span class="p">)</span>
</span><span id="AMTPolicy-287"><a href="#AMTPolicy-287"><span class="linenos">287</span></a>
</span><span id="AMTPolicy-288"><a href="#AMTPolicy-288"><span class="linenos">288</span></a>        <span class="c1"># Reference points</span>
</span><span id="AMTPolicy-289"><a href="#AMTPolicy-289"><span class="linenos">289</span></a>        <span class="n">tcja_exemption</span> <span class="o">=</span> <span class="mi">137_000</span>
</span><span id="AMTPolicy-290"><a href="#AMTPolicy-290"><span class="linenos">290</span></a>        <span class="n">post_tcja_exemption</span> <span class="o">=</span> <span class="mi">93_000</span>
</span><span id="AMTPolicy-291"><a href="#AMTPolicy-291"><span class="linenos">291</span></a>
</span><span id="AMTPolicy-292"><a href="#AMTPolicy-292"><span class="linenos">292</span></a>        <span class="n">tcja_taxpayers</span> <span class="o">=</span> <span class="n">BASELINE_AMT_DATA</span><span class="p">[</span><span class="s2">&quot;taxpayers_tcja&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy-293"><a href="#AMTPolicy-293"><span class="linenos">293</span></a>        <span class="n">post_tcja_taxpayers</span> <span class="o">=</span> <span class="n">BASELINE_AMT_DATA</span><span class="p">[</span><span class="s2">&quot;taxpayers_post_tcja&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy-294"><a href="#AMTPolicy-294"><span class="linenos">294</span></a>
</span><span id="AMTPolicy-295"><a href="#AMTPolicy-295"><span class="linenos">295</span></a>        <span class="c1"># Higher exemption = fewer affected taxpayers</span>
</span><span id="AMTPolicy-296"><a href="#AMTPolicy-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">exemption</span> <span class="o">&gt;=</span> <span class="n">tcja_exemption</span><span class="p">:</span>
</span><span id="AMTPolicy-297"><a href="#AMTPolicy-297"><span class="linenos">297</span></a>            <span class="c1"># Scale down from TCJA baseline</span>
</span><span id="AMTPolicy-298"><a href="#AMTPolicy-298"><span class="linenos">298</span></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">tcja_exemption</span> <span class="o">/</span> <span class="n">exemption</span>
</span><span id="AMTPolicy-299"><a href="#AMTPolicy-299"><span class="linenos">299</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">tcja_taxpayers</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
</span><span id="AMTPolicy-300"><a href="#AMTPolicy-300"><span class="linenos">300</span></a>        <span class="k">elif</span> <span class="n">exemption</span> <span class="o">&lt;=</span> <span class="n">post_tcja_exemption</span><span class="p">:</span>
</span><span id="AMTPolicy-301"><a href="#AMTPolicy-301"><span class="linenos">301</span></a>            <span class="c1"># Scale up from post-TCJA baseline</span>
</span><span id="AMTPolicy-302"><a href="#AMTPolicy-302"><span class="linenos">302</span></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">post_tcja_exemption</span> <span class="o">/</span> <span class="n">exemption</span>
</span><span id="AMTPolicy-303"><a href="#AMTPolicy-303"><span class="linenos">303</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">post_tcja_taxpayers</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
</span><span id="AMTPolicy-304"><a href="#AMTPolicy-304"><span class="linenos">304</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy-305"><a href="#AMTPolicy-305"><span class="linenos">305</span></a>            <span class="c1"># Interpolate</span>
</span><span id="AMTPolicy-306"><a href="#AMTPolicy-306"><span class="linenos">306</span></a>            <span class="n">frac</span> <span class="o">=</span> <span class="p">(</span><span class="n">exemption</span> <span class="o">-</span> <span class="n">post_tcja_exemption</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tcja_exemption</span> <span class="o">-</span> <span class="n">post_tcja_exemption</span><span class="p">)</span>
</span><span id="AMTPolicy-307"><a href="#AMTPolicy-307"><span class="linenos">307</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">post_tcja_taxpayers</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcja_taxpayers</span> <span class="o">-</span> <span class="n">post_tcja_taxpayers</span><span class="p">))</span>
</span><span id="AMTPolicy-308"><a href="#AMTPolicy-308"><span class="linenos">308</span></a>
</span><span id="AMTPolicy-309"><a href="#AMTPolicy-309"><span class="linenos">309</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="AMTPolicy-310"><a href="#AMTPolicy-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AMTPolicy-311"><a href="#AMTPolicy-311"><span class="linenos">311</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="AMTPolicy-312"><a href="#AMTPolicy-312"><span class="linenos">312</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="AMTPolicy-313"><a href="#AMTPolicy-313"><span class="linenos">313</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="AMTPolicy-314"><a href="#AMTPolicy-314"><span class="linenos">314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy-315"><a href="#AMTPolicy-315"><span class="linenos">315</span></a><span class="sd">        Estimate static revenue effect of AMT policy change.</span>
</span><span id="AMTPolicy-316"><a href="#AMTPolicy-316"><span class="linenos">316</span></a>
</span><span id="AMTPolicy-317"><a href="#AMTPolicy-317"><span class="linenos">317</span></a><span class="sd">        Args:</span>
</span><span id="AMTPolicy-318"><a href="#AMTPolicy-318"><span class="linenos">318</span></a><span class="sd">            baseline_revenue: Baseline revenue (not used; we use calibrated values)</span>
</span><span id="AMTPolicy-319"><a href="#AMTPolicy-319"><span class="linenos">319</span></a><span class="sd">            use_real_data: Whether to use detailed calculations</span>
</span><span id="AMTPolicy-320"><a href="#AMTPolicy-320"><span class="linenos">320</span></a>
</span><span id="AMTPolicy-321"><a href="#AMTPolicy-321"><span class="linenos">321</span></a><span class="sd">        Returns:</span>
</span><span id="AMTPolicy-322"><a href="#AMTPolicy-322"><span class="linenos">322</span></a><span class="sd">            Revenue change in billions (negative = revenue loss)</span>
</span><span id="AMTPolicy-323"><a href="#AMTPolicy-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy-324"><a href="#AMTPolicy-324"><span class="linenos">324</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy-325"><a href="#AMTPolicy-325"><span class="linenos">325</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="AMTPolicy-326"><a href="#AMTPolicy-326"><span class="linenos">326</span></a>
</span><span id="AMTPolicy-327"><a href="#AMTPolicy-327"><span class="linenos">327</span></a>        <span class="c1"># Handle corporate AMT</span>
</span><span id="AMTPolicy-328"><a href="#AMTPolicy-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">amt_type</span> <span class="o">==</span> <span class="n">AMTType</span><span class="o">.</span><span class="n">CORPORATE</span><span class="p">:</span>
</span><span id="AMTPolicy-329"><a href="#AMTPolicy-329"><span class="linenos">329</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_corporate_amt</span><span class="p">:</span>
</span><span id="AMTPolicy-330"><a href="#AMTPolicy-330"><span class="linenos">330</span></a>                <span class="k">return</span> <span class="o">-</span><span class="n">CORPORATE_AMT</span><span class="p">[</span><span class="s2">&quot;revenue_per_year&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy-331"><a href="#AMTPolicy-331"><span class="linenos">331</span></a>            <span class="c1"># Rate changes for corporate AMT</span>
</span><span id="AMTPolicy-332"><a href="#AMTPolicy-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AMTPolicy-333"><a href="#AMTPolicy-333"><span class="linenos">333</span></a>                <span class="n">base_revenue</span> <span class="o">=</span> <span class="n">CORPORATE_AMT</span><span class="p">[</span><span class="s2">&quot;revenue_per_year&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy-334"><a href="#AMTPolicy-334"><span class="linenos">334</span></a>                <span class="n">pct_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">/</span> <span class="n">CORPORATE_AMT</span><span class="p">[</span><span class="s2">&quot;rate&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy-335"><a href="#AMTPolicy-335"><span class="linenos">335</span></a>                <span class="k">return</span> <span class="n">base_revenue</span> <span class="o">*</span> <span class="n">pct_change</span>
</span><span id="AMTPolicy-336"><a href="#AMTPolicy-336"><span class="linenos">336</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="AMTPolicy-337"><a href="#AMTPolicy-337"><span class="linenos">337</span></a>
</span><span id="AMTPolicy-338"><a href="#AMTPolicy-338"><span class="linenos">338</span></a>        <span class="c1"># Individual AMT</span>
</span><span id="AMTPolicy-339"><a href="#AMTPolicy-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_individual_amt</span><span class="p">:</span>
</span><span id="AMTPolicy-340"><a href="#AMTPolicy-340"><span class="linenos">340</span></a>            <span class="c1"># Cost of full repeal (lose all individual AMT revenue)</span>
</span><span id="AMTPolicy-341"><a href="#AMTPolicy-341"><span class="linenos">341</span></a>            <span class="c1"># Under current law, this is ~$5B/year but grows significantly</span>
</span><span id="AMTPolicy-342"><a href="#AMTPolicy-342"><span class="linenos">342</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">CBO_AMT_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;current_individual_annual&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy-343"><a href="#AMTPolicy-343"><span class="linenos">343</span></a>
</span><span id="AMTPolicy-344"><a href="#AMTPolicy-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_tcja_relief</span><span class="p">:</span>
</span><span id="AMTPolicy-345"><a href="#AMTPolicy-345"><span class="linenos">345</span></a>            <span class="c1"># Cost of extending TCJA relief (foregone revenue)</span>
</span><span id="AMTPolicy-346"><a href="#AMTPolicy-346"><span class="linenos">346</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">CBO_AMT_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;extend_tcja_annual&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy-347"><a href="#AMTPolicy-347"><span class="linenos">347</span></a>
</span><span id="AMTPolicy-348"><a href="#AMTPolicy-348"><span class="linenos">348</span></a>        <span class="c1"># Calculate from exemption changes</span>
</span><span id="AMTPolicy-349"><a href="#AMTPolicy-349"><span class="linenos">349</span></a>        <span class="n">baseline_exemption</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="AMTPolicy-350"><a href="#AMTPolicy-350"><span class="linenos">350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="AMTPolicy-351"><a href="#AMTPolicy-351"><span class="linenos">351</span></a>            <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">[</span><span class="mi">2026</span><span class="p">]</span>
</span><span id="AMTPolicy-352"><a href="#AMTPolicy-352"><span class="linenos">352</span></a>        <span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># MFJ</span>
</span><span id="AMTPolicy-353"><a href="#AMTPolicy-353"><span class="linenos">353</span></a>
</span><span id="AMTPolicy-354"><a href="#AMTPolicy-354"><span class="linenos">354</span></a>        <span class="n">policy_exemption</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exemption_for_year</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;mfj&quot;</span><span class="p">)</span>
</span><span id="AMTPolicy-355"><a href="#AMTPolicy-355"><span class="linenos">355</span></a>
</span><span id="AMTPolicy-356"><a href="#AMTPolicy-356"><span class="linenos">356</span></a>        <span class="c1"># Estimate revenue based on taxpayer count and average liability</span>
</span><span id="AMTPolicy-357"><a href="#AMTPolicy-357"><span class="linenos">357</span></a>        <span class="n">baseline_taxpayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_affected_taxpayers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AMTPolicy-358"><a href="#AMTPolicy-358"><span class="linenos">358</span></a>        <span class="c1"># Approximate new taxpayer count</span>
</span><span id="AMTPolicy-359"><a href="#AMTPolicy-359"><span class="linenos">359</span></a>        <span class="n">old_policy</span> <span class="o">=</span> <span class="n">AMTPolicy</span><span class="p">(</span><span class="n">amt_type</span><span class="o">=</span><span class="n">AMTType</span><span class="o">.</span><span class="n">INDIVIDUAL</span><span class="p">)</span>  <span class="c1"># Default policy</span>
</span><span id="AMTPolicy-360"><a href="#AMTPolicy-360"><span class="linenos">360</span></a>        <span class="n">policy_taxpayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_affected_taxpayers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AMTPolicy-361"><a href="#AMTPolicy-361"><span class="linenos">361</span></a>
</span><span id="AMTPolicy-362"><a href="#AMTPolicy-362"><span class="linenos">362</span></a>        <span class="c1"># Get average liability (inversely related to exemption for those affected)</span>
</span><span id="AMTPolicy-363"><a href="#AMTPolicy-363"><span class="linenos">363</span></a>        <span class="n">avg_liability</span> <span class="o">=</span> <span class="n">BASELINE_AMT_DATA</span><span class="p">[</span><span class="s2">&quot;avg_amt_post_tcja&quot;</span><span class="p">]</span>  <span class="c1"># ~$10K average</span>
</span><span id="AMTPolicy-364"><a href="#AMTPolicy-364"><span class="linenos">364</span></a>
</span><span id="AMTPolicy-365"><a href="#AMTPolicy-365"><span class="linenos">365</span></a>        <span class="c1"># Revenue = taxpayers  avg liability</span>
</span><span id="AMTPolicy-366"><a href="#AMTPolicy-366"><span class="linenos">366</span></a>        <span class="n">baseline_revenue</span> <span class="o">=</span> <span class="n">baseline_taxpayers</span> <span class="o">*</span> <span class="n">avg_liability</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="AMTPolicy-367"><a href="#AMTPolicy-367"><span class="linenos">367</span></a>        <span class="n">policy_revenue</span> <span class="o">=</span> <span class="n">policy_taxpayers</span> <span class="o">*</span> <span class="n">avg_liability</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="AMTPolicy-368"><a href="#AMTPolicy-368"><span class="linenos">368</span></a>
</span><span id="AMTPolicy-369"><a href="#AMTPolicy-369"><span class="linenos">369</span></a>        <span class="k">return</span> <span class="n">policy_revenue</span> <span class="o">-</span> <span class="n">baseline_revenue</span>
</span><span id="AMTPolicy-370"><a href="#AMTPolicy-370"><span class="linenos">370</span></a>
</span><span id="AMTPolicy-371"><a href="#AMTPolicy-371"><span class="linenos">371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="AMTPolicy-372"><a href="#AMTPolicy-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy-373"><a href="#AMTPolicy-373"><span class="linenos">373</span></a><span class="sd">        Estimate behavioral response to AMT changes.</span>
</span><span id="AMTPolicy-374"><a href="#AMTPolicy-374"><span class="linenos">374</span></a>
</span><span id="AMTPolicy-375"><a href="#AMTPolicy-375"><span class="linenos">375</span></a><span class="sd">        Behavioral responses include:</span>
</span><span id="AMTPolicy-376"><a href="#AMTPolicy-376"><span class="linenos">376</span></a><span class="sd">        - Income timing (accelerate/defer income)</span>
</span><span id="AMTPolicy-377"><a href="#AMTPolicy-377"><span class="linenos">377</span></a><span class="sd">        - Tax planning (restructure to minimize AMTI)</span>
</span><span id="AMTPolicy-378"><a href="#AMTPolicy-378"><span class="linenos">378</span></a><span class="sd">        - Charitable giving timing</span>
</span><span id="AMTPolicy-379"><a href="#AMTPolicy-379"><span class="linenos">379</span></a>
</span><span id="AMTPolicy-380"><a href="#AMTPolicy-380"><span class="linenos">380</span></a><span class="sd">        Returns:</span>
</span><span id="AMTPolicy-381"><a href="#AMTPolicy-381"><span class="linenos">381</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="AMTPolicy-382"><a href="#AMTPolicy-382"><span class="linenos">382</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy-383"><a href="#AMTPolicy-383"><span class="linenos">383</span></a>        <span class="c1"># Timing response</span>
</span><span id="AMTPolicy-384"><a href="#AMTPolicy-384"><span class="linenos">384</span></a>        <span class="n">timing_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_elasticity</span>
</span><span id="AMTPolicy-385"><a href="#AMTPolicy-385"><span class="linenos">385</span></a>
</span><span id="AMTPolicy-386"><a href="#AMTPolicy-386"><span class="linenos">386</span></a>        <span class="c1"># Avoidance response</span>
</span><span id="AMTPolicy-387"><a href="#AMTPolicy-387"><span class="linenos">387</span></a>        <span class="n">avoidance_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">avoidance_elasticity</span>
</span><span id="AMTPolicy-388"><a href="#AMTPolicy-388"><span class="linenos">388</span></a>
</span><span id="AMTPolicy-389"><a href="#AMTPolicy-389"><span class="linenos">389</span></a>        <span class="n">total_offset</span> <span class="o">=</span> <span class="n">timing_offset</span> <span class="o">+</span> <span class="n">avoidance_offset</span>
</span><span id="AMTPolicy-390"><a href="#AMTPolicy-390"><span class="linenos">390</span></a>
</span><span id="AMTPolicy-391"><a href="#AMTPolicy-391"><span class="linenos">391</span></a>        <span class="c1"># Offset reduces revenue gain or loss</span>
</span><span id="AMTPolicy-392"><a href="#AMTPolicy-392"><span class="linenos">392</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AMTPolicy-393"><a href="#AMTPolicy-393"><span class="linenos">393</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">total_offset</span>  <span class="c1"># Reduces revenue gain</span>
</span><span id="AMTPolicy-394"><a href="#AMTPolicy-394"><span class="linenos">394</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy-395"><a href="#AMTPolicy-395"><span class="linenos">395</span></a>            <span class="k">return</span> <span class="n">total_offset</span>  <span class="c1"># Reduces revenue loss</span>
</span></pre></div>


            <div class="docstring"><p>Alternative Minimum Tax policy modeling exemption, rate, and threshold changes.</p>

<p>Models both individual AMT and corporate AMT (book minimum tax).</p>

<p>Key parameters:
    amt_type: Whether modeling individual or corporate AMT
    extend_tcja_relief: Extend TCJA's higher exemptions past 2025
    exemption_change: Change in exemption levels (dollars)
    new_exemption_single: Specific new exemption (single)
    new_exemption_mfj: Specific new exemption (MFJ)
    repeal_individual_amt: Fully repeal individual AMT
    rate_change: Change in AMT rates</p>

<p>Behavioral responses:
    - Income timing (defer income to avoid AMT)
    - Tax planning (restructure to minimize AMTI)</p>
</div>


                            <div id="AMTPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">AMTPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">amt_type</span><span class="p">:</span> <span class="n"><a href="#AMTType">AMTType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#AMTType.INDIVIDUAL">AMTType.INDIVIDUAL</a></span><span class="p">:</span> <span class="s1">&#39;individual&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">extend_tcja_relief</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">exemption_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_exemption_single</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">new_exemption_mfj</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">repeal_individual_amt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">repeal_corporate_amt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">new_first_tier_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">new_second_tier_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">phase_out_threshold_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">timing_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>,</span><span class="param">	<span class="n">avoidance_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">base_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2024</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.__init__"></a>
    
    

                            </div>
                            <div id="AMTPolicy.amt_type" class="classattr">
                                <div class="attr variable">
            <span class="name">amt_type</span><span class="annotation">: <a href="#AMTType">AMTType</a></span>        =
<span class="default_value">&lt;<a href="#AMTType.INDIVIDUAL">AMTType.INDIVIDUAL</a>: &#39;individual&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.amt_type"></a>
    
    

                            </div>
                            <div id="AMTPolicy.extend_tcja_relief" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_tcja_relief</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.extend_tcja_relief"></a>
    
    

                            </div>
                            <div id="AMTPolicy.exemption_change" class="classattr">
                                <div class="attr variable">
            <span class="name">exemption_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.exemption_change"></a>
    
    

                            </div>
                            <div id="AMTPolicy.new_exemption_single" class="classattr">
                                <div class="attr variable">
            <span class="name">new_exemption_single</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.new_exemption_single"></a>
    
    

                            </div>
                            <div id="AMTPolicy.new_exemption_mfj" class="classattr">
                                <div class="attr variable">
            <span class="name">new_exemption_mfj</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.new_exemption_mfj"></a>
    
    

                            </div>
                            <div id="AMTPolicy.repeal_individual_amt" class="classattr">
                                <div class="attr variable">
            <span class="name">repeal_individual_amt</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.repeal_individual_amt"></a>
    
    

                            </div>
                            <div id="AMTPolicy.repeal_corporate_amt" class="classattr">
                                <div class="attr variable">
            <span class="name">repeal_corporate_amt</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.repeal_corporate_amt"></a>
    
    

                            </div>
                            <div id="AMTPolicy.rate_change" class="classattr">
                                <div class="attr variable">
            <span class="name">rate_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.rate_change"></a>
    
    

                            </div>
                            <div id="AMTPolicy.new_first_tier_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">new_first_tier_rate</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.new_first_tier_rate"></a>
    
    

                            </div>
                            <div id="AMTPolicy.new_second_tier_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">new_second_tier_rate</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.new_second_tier_rate"></a>
    
    

                            </div>
                            <div id="AMTPolicy.phase_out_threshold_change" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_out_threshold_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.phase_out_threshold_change"></a>
    
    

                            </div>
                            <div id="AMTPolicy.timing_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">timing_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.15</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.timing_elasticity"></a>
    
    

                            </div>
                            <div id="AMTPolicy.avoidance_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">avoidance_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.1</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.avoidance_elasticity"></a>
    
    

                            </div>
                            <div id="AMTPolicy.base_year" class="classattr">
                                <div class="attr variable">
            <span class="name">base_year</span><span class="annotation">: int</span>        =
<span class="default_value">2024</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.base_year"></a>
    
    

                            </div>
                            <div id="AMTPolicy.annual_revenue_change_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_revenue_change_billions</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#AMTPolicy.annual_revenue_change_billions"></a>
    
    

                            </div>
                            <div id="AMTPolicy.get_exemption_for_year" class="classattr">
                                        <input id="AMTPolicy.get_exemption_for_year-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_exemption_for_year</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">filing_status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;mfj&#39;</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="AMTPolicy.get_exemption_for_year-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AMTPolicy.get_exemption_for_year"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AMTPolicy.get_exemption_for_year-211"><a href="#AMTPolicy.get_exemption_for_year-211"><span class="linenos">211</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_exemption_for_year</span><span class="p">(</span>
</span><span id="AMTPolicy.get_exemption_for_year-212"><a href="#AMTPolicy.get_exemption_for_year-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AMTPolicy.get_exemption_for_year-213"><a href="#AMTPolicy.get_exemption_for_year-213"><span class="linenos">213</span></a>        <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="AMTPolicy.get_exemption_for_year-214"><a href="#AMTPolicy.get_exemption_for_year-214"><span class="linenos">214</span></a>        <span class="n">filing_status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mfj&quot;</span>
</span><span id="AMTPolicy.get_exemption_for_year-215"><a href="#AMTPolicy.get_exemption_for_year-215"><span class="linenos">215</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-216"><a href="#AMTPolicy.get_exemption_for_year-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy.get_exemption_for_year-217"><a href="#AMTPolicy.get_exemption_for_year-217"><span class="linenos">217</span></a><span class="sd">        Get the effective AMT exemption for a given year.</span>
</span><span id="AMTPolicy.get_exemption_for_year-218"><a href="#AMTPolicy.get_exemption_for_year-218"><span class="linenos">218</span></a>
</span><span id="AMTPolicy.get_exemption_for_year-219"><a href="#AMTPolicy.get_exemption_for_year-219"><span class="linenos">219</span></a><span class="sd">        Args:</span>
</span><span id="AMTPolicy.get_exemption_for_year-220"><a href="#AMTPolicy.get_exemption_for_year-220"><span class="linenos">220</span></a><span class="sd">            year: Tax year</span>
</span><span id="AMTPolicy.get_exemption_for_year-221"><a href="#AMTPolicy.get_exemption_for_year-221"><span class="linenos">221</span></a><span class="sd">            filing_status: &#39;single&#39;, &#39;mfj&#39;, or &#39;mfs&#39;</span>
</span><span id="AMTPolicy.get_exemption_for_year-222"><a href="#AMTPolicy.get_exemption_for_year-222"><span class="linenos">222</span></a>
</span><span id="AMTPolicy.get_exemption_for_year-223"><a href="#AMTPolicy.get_exemption_for_year-223"><span class="linenos">223</span></a><span class="sd">        Returns:</span>
</span><span id="AMTPolicy.get_exemption_for_year-224"><a href="#AMTPolicy.get_exemption_for_year-224"><span class="linenos">224</span></a><span class="sd">            Exemption amount in dollars</span>
</span><span id="AMTPolicy.get_exemption_for_year-225"><a href="#AMTPolicy.get_exemption_for_year-225"><span class="linenos">225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy.get_exemption_for_year-226"><a href="#AMTPolicy.get_exemption_for_year-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_individual_amt</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-227"><a href="#AMTPolicy.get_exemption_for_year-227"><span class="linenos">227</span></a>            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>  <span class="c1"># No AMT = infinite exemption</span>
</span><span id="AMTPolicy.get_exemption_for_year-228"><a href="#AMTPolicy.get_exemption_for_year-228"><span class="linenos">228</span></a>
</span><span id="AMTPolicy.get_exemption_for_year-229"><a href="#AMTPolicy.get_exemption_for_year-229"><span class="linenos">229</span></a>        <span class="c1"># Specific exemption overrides</span>
</span><span id="AMTPolicy.get_exemption_for_year-230"><a href="#AMTPolicy.get_exemption_for_year-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="n">filing_status</span> <span class="o">==</span> <span class="s2">&quot;single&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_single</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-231"><a href="#AMTPolicy.get_exemption_for_year-231"><span class="linenos">231</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_single</span>
</span><span id="AMTPolicy.get_exemption_for_year-232"><a href="#AMTPolicy.get_exemption_for_year-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="n">filing_status</span> <span class="o">==</span> <span class="s2">&quot;mfj&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_mfj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-233"><a href="#AMTPolicy.get_exemption_for_year-233"><span class="linenos">233</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_mfj</span>
</span><span id="AMTPolicy.get_exemption_for_year-234"><a href="#AMTPolicy.get_exemption_for_year-234"><span class="linenos">234</span></a>        <span class="k">if</span> <span class="n">filing_status</span> <span class="o">==</span> <span class="s2">&quot;mfs&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_mfj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-235"><a href="#AMTPolicy.get_exemption_for_year-235"><span class="linenos">235</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_exemption_mfj</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># MFS is half of MFJ</span>
</span><span id="AMTPolicy.get_exemption_for_year-236"><a href="#AMTPolicy.get_exemption_for_year-236"><span class="linenos">236</span></a>
</span><span id="AMTPolicy.get_exemption_for_year-237"><a href="#AMTPolicy.get_exemption_for_year-237"><span class="linenos">237</span></a>        <span class="c1"># TCJA extension</span>
</span><span id="AMTPolicy.get_exemption_for_year-238"><a href="#AMTPolicy.get_exemption_for_year-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_tcja_relief</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-239"><a href="#AMTPolicy.get_exemption_for_year-239"><span class="linenos">239</span></a>            <span class="k">if</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">AMT_EXEMPTIONS_TCJA_EXTENDED</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-240"><a href="#AMTPolicy.get_exemption_for_year-240"><span class="linenos">240</span></a>                <span class="n">exemptions</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA_EXTENDED</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
</span><span id="AMTPolicy.get_exemption_for_year-241"><a href="#AMTPolicy.get_exemption_for_year-241"><span class="linenos">241</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-242"><a href="#AMTPolicy.get_exemption_for_year-242"><span class="linenos">242</span></a>                <span class="n">exemptions</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA_EXTENDED</span><span class="p">[</span><span class="mi">2034</span><span class="p">]</span>
</span><span id="AMTPolicy.get_exemption_for_year-243"><a href="#AMTPolicy.get_exemption_for_year-243"><span class="linenos">243</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-244"><a href="#AMTPolicy.get_exemption_for_year-244"><span class="linenos">244</span></a>            <span class="c1"># Current law baseline</span>
</span><span id="AMTPolicy.get_exemption_for_year-245"><a href="#AMTPolicy.get_exemption_for_year-245"><span class="linenos">245</span></a>            <span class="k">if</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-246"><a href="#AMTPolicy.get_exemption_for_year-246"><span class="linenos">246</span></a>                <span class="n">exemptions</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
</span><span id="AMTPolicy.get_exemption_for_year-247"><a href="#AMTPolicy.get_exemption_for_year-247"><span class="linenos">247</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy.get_exemption_for_year-248"><a href="#AMTPolicy.get_exemption_for_year-248"><span class="linenos">248</span></a>                <span class="n">exemptions</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">[</span><span class="mi">2034</span><span class="p">]</span>
</span><span id="AMTPolicy.get_exemption_for_year-249"><a href="#AMTPolicy.get_exemption_for_year-249"><span class="linenos">249</span></a>
</span><span id="AMTPolicy.get_exemption_for_year-250"><a href="#AMTPolicy.get_exemption_for_year-250"><span class="linenos">250</span></a>        <span class="c1"># Extract by filing status</span>
</span><span id="AMTPolicy.get_exemption_for_year-251"><a href="#AMTPolicy.get_exemption_for_year-251"><span class="linenos">251</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;single&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;mfj&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;mfs&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">filing_status</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AMTPolicy.get_exemption_for_year-252"><a href="#AMTPolicy.get_exemption_for_year-252"><span class="linenos">252</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">exemptions</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="AMTPolicy.get_exemption_for_year-253"><a href="#AMTPolicy.get_exemption_for_year-253"><span class="linenos">253</span></a>
</span><span id="AMTPolicy.get_exemption_for_year-254"><a href="#AMTPolicy.get_exemption_for_year-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="n">base</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">exemption_change</span>
</span></pre></div>


            <div class="docstring"><p>Get the effective AMT exemption for a given year.</p>

<p>Args:
    year: Tax year
    filing_status: 'single', 'mfj', or 'mfs'</p>

<p>Returns:
    Exemption amount in dollars</p>
</div>


                            </div>
                            <div id="AMTPolicy.get_rate_for_tier" class="classattr">
                                        <input id="AMTPolicy.get_rate_for_tier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_rate_for_tier</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">tier</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="AMTPolicy.get_rate_for_tier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AMTPolicy.get_rate_for_tier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AMTPolicy.get_rate_for_tier-256"><a href="#AMTPolicy.get_rate_for_tier-256"><span class="linenos">256</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rate_for_tier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tier</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="AMTPolicy.get_rate_for_tier-257"><a href="#AMTPolicy.get_rate_for_tier-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy.get_rate_for_tier-258"><a href="#AMTPolicy.get_rate_for_tier-258"><span class="linenos">258</span></a><span class="sd">        Get AMT rate for a tier (1 = 26%, 2 = 28%).</span>
</span><span id="AMTPolicy.get_rate_for_tier-259"><a href="#AMTPolicy.get_rate_for_tier-259"><span class="linenos">259</span></a>
</span><span id="AMTPolicy.get_rate_for_tier-260"><a href="#AMTPolicy.get_rate_for_tier-260"><span class="linenos">260</span></a><span class="sd">        Args:</span>
</span><span id="AMTPolicy.get_rate_for_tier-261"><a href="#AMTPolicy.get_rate_for_tier-261"><span class="linenos">261</span></a><span class="sd">            tier: 1 for first tier, 2 for second tier</span>
</span><span id="AMTPolicy.get_rate_for_tier-262"><a href="#AMTPolicy.get_rate_for_tier-262"><span class="linenos">262</span></a>
</span><span id="AMTPolicy.get_rate_for_tier-263"><a href="#AMTPolicy.get_rate_for_tier-263"><span class="linenos">263</span></a><span class="sd">        Returns:</span>
</span><span id="AMTPolicy.get_rate_for_tier-264"><a href="#AMTPolicy.get_rate_for_tier-264"><span class="linenos">264</span></a><span class="sd">            Tax rate as decimal</span>
</span><span id="AMTPolicy.get_rate_for_tier-265"><a href="#AMTPolicy.get_rate_for_tier-265"><span class="linenos">265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy.get_rate_for_tier-266"><a href="#AMTPolicy.get_rate_for_tier-266"><span class="linenos">266</span></a>        <span class="k">if</span> <span class="n">tier</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AMTPolicy.get_rate_for_tier-267"><a href="#AMTPolicy.get_rate_for_tier-267"><span class="linenos">267</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_first_tier_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy.get_rate_for_tier-268"><a href="#AMTPolicy.get_rate_for_tier-268"><span class="linenos">268</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_first_tier_rate</span>
</span><span id="AMTPolicy.get_rate_for_tier-269"><a href="#AMTPolicy.get_rate_for_tier-269"><span class="linenos">269</span></a>            <span class="k">return</span> <span class="n">AMT_RATES</span><span class="p">[</span><span class="s2">&quot;first_tier&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span>
</span><span id="AMTPolicy.get_rate_for_tier-270"><a href="#AMTPolicy.get_rate_for_tier-270"><span class="linenos">270</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy.get_rate_for_tier-271"><a href="#AMTPolicy.get_rate_for_tier-271"><span class="linenos">271</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_second_tier_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy.get_rate_for_tier-272"><a href="#AMTPolicy.get_rate_for_tier-272"><span class="linenos">272</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_second_tier_rate</span>
</span><span id="AMTPolicy.get_rate_for_tier-273"><a href="#AMTPolicy.get_rate_for_tier-273"><span class="linenos">273</span></a>            <span class="k">return</span> <span class="n">AMT_RATES</span><span class="p">[</span><span class="s2">&quot;second_tier&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span>
</span></pre></div>


            <div class="docstring"><p>Get AMT rate for a tier (1 = 26%, 2 = 28%).</p>

<p>Args:
    tier: 1 for first tier, 2 for second tier</p>

<p>Returns:
    Tax rate as decimal</p>
</div>


                            </div>
                            <div id="AMTPolicy.estimate_affected_taxpayers" class="classattr">
                                        <input id="AMTPolicy.estimate_affected_taxpayers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_affected_taxpayers</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="AMTPolicy.estimate_affected_taxpayers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AMTPolicy.estimate_affected_taxpayers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AMTPolicy.estimate_affected_taxpayers-275"><a href="#AMTPolicy.estimate_affected_taxpayers-275"><span class="linenos">275</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_affected_taxpayers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-276"><a href="#AMTPolicy.estimate_affected_taxpayers-276"><span class="linenos">276</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-277"><a href="#AMTPolicy.estimate_affected_taxpayers-277"><span class="linenos">277</span></a><span class="sd">        Estimate number of taxpayers affected by AMT.</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-278"><a href="#AMTPolicy.estimate_affected_taxpayers-278"><span class="linenos">278</span></a>
</span><span id="AMTPolicy.estimate_affected_taxpayers-279"><a href="#AMTPolicy.estimate_affected_taxpayers-279"><span class="linenos">279</span></a><span class="sd">        Under TCJA high exemptions: ~200,000</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-280"><a href="#AMTPolicy.estimate_affected_taxpayers-280"><span class="linenos">280</span></a><span class="sd">        After TCJA sunset: ~7.3M</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-281"><a href="#AMTPolicy.estimate_affected_taxpayers-281"><span class="linenos">281</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-282"><a href="#AMTPolicy.estimate_affected_taxpayers-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_individual_amt</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-283"><a href="#AMTPolicy.estimate_affected_taxpayers-283"><span class="linenos">283</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-284"><a href="#AMTPolicy.estimate_affected_taxpayers-284"><span class="linenos">284</span></a>
</span><span id="AMTPolicy.estimate_affected_taxpayers-285"><a href="#AMTPolicy.estimate_affected_taxpayers-285"><span class="linenos">285</span></a>        <span class="c1"># Get exemption level to estimate taxpayers</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-286"><a href="#AMTPolicy.estimate_affected_taxpayers-286"><span class="linenos">286</span></a>        <span class="n">exemption</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exemption_for_year</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;mfj&quot;</span><span class="p">)</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-287"><a href="#AMTPolicy.estimate_affected_taxpayers-287"><span class="linenos">287</span></a>
</span><span id="AMTPolicy.estimate_affected_taxpayers-288"><a href="#AMTPolicy.estimate_affected_taxpayers-288"><span class="linenos">288</span></a>        <span class="c1"># Reference points</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-289"><a href="#AMTPolicy.estimate_affected_taxpayers-289"><span class="linenos">289</span></a>        <span class="n">tcja_exemption</span> <span class="o">=</span> <span class="mi">137_000</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-290"><a href="#AMTPolicy.estimate_affected_taxpayers-290"><span class="linenos">290</span></a>        <span class="n">post_tcja_exemption</span> <span class="o">=</span> <span class="mi">93_000</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-291"><a href="#AMTPolicy.estimate_affected_taxpayers-291"><span class="linenos">291</span></a>
</span><span id="AMTPolicy.estimate_affected_taxpayers-292"><a href="#AMTPolicy.estimate_affected_taxpayers-292"><span class="linenos">292</span></a>        <span class="n">tcja_taxpayers</span> <span class="o">=</span> <span class="n">BASELINE_AMT_DATA</span><span class="p">[</span><span class="s2">&quot;taxpayers_tcja&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-293"><a href="#AMTPolicy.estimate_affected_taxpayers-293"><span class="linenos">293</span></a>        <span class="n">post_tcja_taxpayers</span> <span class="o">=</span> <span class="n">BASELINE_AMT_DATA</span><span class="p">[</span><span class="s2">&quot;taxpayers_post_tcja&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-294"><a href="#AMTPolicy.estimate_affected_taxpayers-294"><span class="linenos">294</span></a>
</span><span id="AMTPolicy.estimate_affected_taxpayers-295"><a href="#AMTPolicy.estimate_affected_taxpayers-295"><span class="linenos">295</span></a>        <span class="c1"># Higher exemption = fewer affected taxpayers</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-296"><a href="#AMTPolicy.estimate_affected_taxpayers-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">exemption</span> <span class="o">&gt;=</span> <span class="n">tcja_exemption</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-297"><a href="#AMTPolicy.estimate_affected_taxpayers-297"><span class="linenos">297</span></a>            <span class="c1"># Scale down from TCJA baseline</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-298"><a href="#AMTPolicy.estimate_affected_taxpayers-298"><span class="linenos">298</span></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">tcja_exemption</span> <span class="o">/</span> <span class="n">exemption</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-299"><a href="#AMTPolicy.estimate_affected_taxpayers-299"><span class="linenos">299</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">tcja_taxpayers</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-300"><a href="#AMTPolicy.estimate_affected_taxpayers-300"><span class="linenos">300</span></a>        <span class="k">elif</span> <span class="n">exemption</span> <span class="o">&lt;=</span> <span class="n">post_tcja_exemption</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-301"><a href="#AMTPolicy.estimate_affected_taxpayers-301"><span class="linenos">301</span></a>            <span class="c1"># Scale up from post-TCJA baseline</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-302"><a href="#AMTPolicy.estimate_affected_taxpayers-302"><span class="linenos">302</span></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">post_tcja_exemption</span> <span class="o">/</span> <span class="n">exemption</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-303"><a href="#AMTPolicy.estimate_affected_taxpayers-303"><span class="linenos">303</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">post_tcja_taxpayers</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-304"><a href="#AMTPolicy.estimate_affected_taxpayers-304"><span class="linenos">304</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-305"><a href="#AMTPolicy.estimate_affected_taxpayers-305"><span class="linenos">305</span></a>            <span class="c1"># Interpolate</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-306"><a href="#AMTPolicy.estimate_affected_taxpayers-306"><span class="linenos">306</span></a>            <span class="n">frac</span> <span class="o">=</span> <span class="p">(</span><span class="n">exemption</span> <span class="o">-</span> <span class="n">post_tcja_exemption</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tcja_exemption</span> <span class="o">-</span> <span class="n">post_tcja_exemption</span><span class="p">)</span>
</span><span id="AMTPolicy.estimate_affected_taxpayers-307"><a href="#AMTPolicy.estimate_affected_taxpayers-307"><span class="linenos">307</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">post_tcja_taxpayers</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcja_taxpayers</span> <span class="o">-</span> <span class="n">post_tcja_taxpayers</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Estimate number of taxpayers affected by AMT.</p>

<p>Under TCJA high exemptions: ~200,000
After TCJA sunset: ~7.3M</p>
</div>


                            </div>
                            <div id="AMTPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="AMTPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="AMTPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AMTPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AMTPolicy.estimate_static_revenue_effect-309"><a href="#AMTPolicy.estimate_static_revenue_effect-309"><span class="linenos">309</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-310"><a href="#AMTPolicy.estimate_static_revenue_effect-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-311"><a href="#AMTPolicy.estimate_static_revenue_effect-311"><span class="linenos">311</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-312"><a href="#AMTPolicy.estimate_static_revenue_effect-312"><span class="linenos">312</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-313"><a href="#AMTPolicy.estimate_static_revenue_effect-313"><span class="linenos">313</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-314"><a href="#AMTPolicy.estimate_static_revenue_effect-314"><span class="linenos">314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-315"><a href="#AMTPolicy.estimate_static_revenue_effect-315"><span class="linenos">315</span></a><span class="sd">        Estimate static revenue effect of AMT policy change.</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-316"><a href="#AMTPolicy.estimate_static_revenue_effect-316"><span class="linenos">316</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-317"><a href="#AMTPolicy.estimate_static_revenue_effect-317"><span class="linenos">317</span></a><span class="sd">        Args:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-318"><a href="#AMTPolicy.estimate_static_revenue_effect-318"><span class="linenos">318</span></a><span class="sd">            baseline_revenue: Baseline revenue (not used; we use calibrated values)</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-319"><a href="#AMTPolicy.estimate_static_revenue_effect-319"><span class="linenos">319</span></a><span class="sd">            use_real_data: Whether to use detailed calculations</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-320"><a href="#AMTPolicy.estimate_static_revenue_effect-320"><span class="linenos">320</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-321"><a href="#AMTPolicy.estimate_static_revenue_effect-321"><span class="linenos">321</span></a><span class="sd">        Returns:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-322"><a href="#AMTPolicy.estimate_static_revenue_effect-322"><span class="linenos">322</span></a><span class="sd">            Revenue change in billions (negative = revenue loss)</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-323"><a href="#AMTPolicy.estimate_static_revenue_effect-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-324"><a href="#AMTPolicy.estimate_static_revenue_effect-324"><span class="linenos">324</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-325"><a href="#AMTPolicy.estimate_static_revenue_effect-325"><span class="linenos">325</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-326"><a href="#AMTPolicy.estimate_static_revenue_effect-326"><span class="linenos">326</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-327"><a href="#AMTPolicy.estimate_static_revenue_effect-327"><span class="linenos">327</span></a>        <span class="c1"># Handle corporate AMT</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-328"><a href="#AMTPolicy.estimate_static_revenue_effect-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">amt_type</span> <span class="o">==</span> <span class="n">AMTType</span><span class="o">.</span><span class="n">CORPORATE</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-329"><a href="#AMTPolicy.estimate_static_revenue_effect-329"><span class="linenos">329</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_corporate_amt</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-330"><a href="#AMTPolicy.estimate_static_revenue_effect-330"><span class="linenos">330</span></a>                <span class="k">return</span> <span class="o">-</span><span class="n">CORPORATE_AMT</span><span class="p">[</span><span class="s2">&quot;revenue_per_year&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-331"><a href="#AMTPolicy.estimate_static_revenue_effect-331"><span class="linenos">331</span></a>            <span class="c1"># Rate changes for corporate AMT</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-332"><a href="#AMTPolicy.estimate_static_revenue_effect-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-333"><a href="#AMTPolicy.estimate_static_revenue_effect-333"><span class="linenos">333</span></a>                <span class="n">base_revenue</span> <span class="o">=</span> <span class="n">CORPORATE_AMT</span><span class="p">[</span><span class="s2">&quot;revenue_per_year&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-334"><a href="#AMTPolicy.estimate_static_revenue_effect-334"><span class="linenos">334</span></a>                <span class="n">pct_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_change</span> <span class="o">/</span> <span class="n">CORPORATE_AMT</span><span class="p">[</span><span class="s2">&quot;rate&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-335"><a href="#AMTPolicy.estimate_static_revenue_effect-335"><span class="linenos">335</span></a>                <span class="k">return</span> <span class="n">base_revenue</span> <span class="o">*</span> <span class="n">pct_change</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-336"><a href="#AMTPolicy.estimate_static_revenue_effect-336"><span class="linenos">336</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-337"><a href="#AMTPolicy.estimate_static_revenue_effect-337"><span class="linenos">337</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-338"><a href="#AMTPolicy.estimate_static_revenue_effect-338"><span class="linenos">338</span></a>        <span class="c1"># Individual AMT</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-339"><a href="#AMTPolicy.estimate_static_revenue_effect-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_individual_amt</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-340"><a href="#AMTPolicy.estimate_static_revenue_effect-340"><span class="linenos">340</span></a>            <span class="c1"># Cost of full repeal (lose all individual AMT revenue)</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-341"><a href="#AMTPolicy.estimate_static_revenue_effect-341"><span class="linenos">341</span></a>            <span class="c1"># Under current law, this is ~$5B/year but grows significantly</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-342"><a href="#AMTPolicy.estimate_static_revenue_effect-342"><span class="linenos">342</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">CBO_AMT_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;current_individual_annual&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-343"><a href="#AMTPolicy.estimate_static_revenue_effect-343"><span class="linenos">343</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-344"><a href="#AMTPolicy.estimate_static_revenue_effect-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_tcja_relief</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-345"><a href="#AMTPolicy.estimate_static_revenue_effect-345"><span class="linenos">345</span></a>            <span class="c1"># Cost of extending TCJA relief (foregone revenue)</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-346"><a href="#AMTPolicy.estimate_static_revenue_effect-346"><span class="linenos">346</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">CBO_AMT_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;extend_tcja_annual&quot;</span><span class="p">]</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-347"><a href="#AMTPolicy.estimate_static_revenue_effect-347"><span class="linenos">347</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-348"><a href="#AMTPolicy.estimate_static_revenue_effect-348"><span class="linenos">348</span></a>        <span class="c1"># Calculate from exemption changes</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-349"><a href="#AMTPolicy.estimate_static_revenue_effect-349"><span class="linenos">349</span></a>        <span class="n">baseline_exemption</span> <span class="o">=</span> <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-350"><a href="#AMTPolicy.estimate_static_revenue_effect-350"><span class="linenos">350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-351"><a href="#AMTPolicy.estimate_static_revenue_effect-351"><span class="linenos">351</span></a>            <span class="n">AMT_EXEMPTIONS_TCJA</span><span class="p">[</span><span class="mi">2026</span><span class="p">]</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-352"><a href="#AMTPolicy.estimate_static_revenue_effect-352"><span class="linenos">352</span></a>        <span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># MFJ</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-353"><a href="#AMTPolicy.estimate_static_revenue_effect-353"><span class="linenos">353</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-354"><a href="#AMTPolicy.estimate_static_revenue_effect-354"><span class="linenos">354</span></a>        <span class="n">policy_exemption</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exemption_for_year</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;mfj&quot;</span><span class="p">)</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-355"><a href="#AMTPolicy.estimate_static_revenue_effect-355"><span class="linenos">355</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-356"><a href="#AMTPolicy.estimate_static_revenue_effect-356"><span class="linenos">356</span></a>        <span class="c1"># Estimate revenue based on taxpayer count and average liability</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-357"><a href="#AMTPolicy.estimate_static_revenue_effect-357"><span class="linenos">357</span></a>        <span class="n">baseline_taxpayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_affected_taxpayers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-358"><a href="#AMTPolicy.estimate_static_revenue_effect-358"><span class="linenos">358</span></a>        <span class="c1"># Approximate new taxpayer count</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-359"><a href="#AMTPolicy.estimate_static_revenue_effect-359"><span class="linenos">359</span></a>        <span class="n">old_policy</span> <span class="o">=</span> <span class="n">AMTPolicy</span><span class="p">(</span><span class="n">amt_type</span><span class="o">=</span><span class="n">AMTType</span><span class="o">.</span><span class="n">INDIVIDUAL</span><span class="p">)</span>  <span class="c1"># Default policy</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-360"><a href="#AMTPolicy.estimate_static_revenue_effect-360"><span class="linenos">360</span></a>        <span class="n">policy_taxpayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_affected_taxpayers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-361"><a href="#AMTPolicy.estimate_static_revenue_effect-361"><span class="linenos">361</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-362"><a href="#AMTPolicy.estimate_static_revenue_effect-362"><span class="linenos">362</span></a>        <span class="c1"># Get average liability (inversely related to exemption for those affected)</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-363"><a href="#AMTPolicy.estimate_static_revenue_effect-363"><span class="linenos">363</span></a>        <span class="n">avg_liability</span> <span class="o">=</span> <span class="n">BASELINE_AMT_DATA</span><span class="p">[</span><span class="s2">&quot;avg_amt_post_tcja&quot;</span><span class="p">]</span>  <span class="c1"># ~$10K average</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-364"><a href="#AMTPolicy.estimate_static_revenue_effect-364"><span class="linenos">364</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-365"><a href="#AMTPolicy.estimate_static_revenue_effect-365"><span class="linenos">365</span></a>        <span class="c1"># Revenue = taxpayers  avg liability</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-366"><a href="#AMTPolicy.estimate_static_revenue_effect-366"><span class="linenos">366</span></a>        <span class="n">baseline_revenue</span> <span class="o">=</span> <span class="n">baseline_taxpayers</span> <span class="o">*</span> <span class="n">avg_liability</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-367"><a href="#AMTPolicy.estimate_static_revenue_effect-367"><span class="linenos">367</span></a>        <span class="n">policy_revenue</span> <span class="o">=</span> <span class="n">policy_taxpayers</span> <span class="o">*</span> <span class="n">avg_liability</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="AMTPolicy.estimate_static_revenue_effect-368"><a href="#AMTPolicy.estimate_static_revenue_effect-368"><span class="linenos">368</span></a>
</span><span id="AMTPolicy.estimate_static_revenue_effect-369"><a href="#AMTPolicy.estimate_static_revenue_effect-369"><span class="linenos">369</span></a>        <span class="k">return</span> <span class="n">policy_revenue</span> <span class="o">-</span> <span class="n">baseline_revenue</span>
</span></pre></div>


            <div class="docstring"><p>Estimate static revenue effect of AMT policy change.</p>

<p>Args:
    baseline_revenue: Baseline revenue (not used; we use calibrated values)
    use_real_data: Whether to use detailed calculations</p>

<p>Returns:
    Revenue change in billions (negative = revenue loss)</p>
</div>


                            </div>
                            <div id="AMTPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="AMTPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="AMTPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AMTPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AMTPolicy.estimate_behavioral_offset-371"><a href="#AMTPolicy.estimate_behavioral_offset-371"><span class="linenos">371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-372"><a href="#AMTPolicy.estimate_behavioral_offset-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-373"><a href="#AMTPolicy.estimate_behavioral_offset-373"><span class="linenos">373</span></a><span class="sd">        Estimate behavioral response to AMT changes.</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-374"><a href="#AMTPolicy.estimate_behavioral_offset-374"><span class="linenos">374</span></a>
</span><span id="AMTPolicy.estimate_behavioral_offset-375"><a href="#AMTPolicy.estimate_behavioral_offset-375"><span class="linenos">375</span></a><span class="sd">        Behavioral responses include:</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-376"><a href="#AMTPolicy.estimate_behavioral_offset-376"><span class="linenos">376</span></a><span class="sd">        - Income timing (accelerate/defer income)</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-377"><a href="#AMTPolicy.estimate_behavioral_offset-377"><span class="linenos">377</span></a><span class="sd">        - Tax planning (restructure to minimize AMTI)</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-378"><a href="#AMTPolicy.estimate_behavioral_offset-378"><span class="linenos">378</span></a><span class="sd">        - Charitable giving timing</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-379"><a href="#AMTPolicy.estimate_behavioral_offset-379"><span class="linenos">379</span></a>
</span><span id="AMTPolicy.estimate_behavioral_offset-380"><a href="#AMTPolicy.estimate_behavioral_offset-380"><span class="linenos">380</span></a><span class="sd">        Returns:</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-381"><a href="#AMTPolicy.estimate_behavioral_offset-381"><span class="linenos">381</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-382"><a href="#AMTPolicy.estimate_behavioral_offset-382"><span class="linenos">382</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-383"><a href="#AMTPolicy.estimate_behavioral_offset-383"><span class="linenos">383</span></a>        <span class="c1"># Timing response</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-384"><a href="#AMTPolicy.estimate_behavioral_offset-384"><span class="linenos">384</span></a>        <span class="n">timing_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_elasticity</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-385"><a href="#AMTPolicy.estimate_behavioral_offset-385"><span class="linenos">385</span></a>
</span><span id="AMTPolicy.estimate_behavioral_offset-386"><a href="#AMTPolicy.estimate_behavioral_offset-386"><span class="linenos">386</span></a>        <span class="c1"># Avoidance response</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-387"><a href="#AMTPolicy.estimate_behavioral_offset-387"><span class="linenos">387</span></a>        <span class="n">avoidance_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">avoidance_elasticity</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-388"><a href="#AMTPolicy.estimate_behavioral_offset-388"><span class="linenos">388</span></a>
</span><span id="AMTPolicy.estimate_behavioral_offset-389"><a href="#AMTPolicy.estimate_behavioral_offset-389"><span class="linenos">389</span></a>        <span class="n">total_offset</span> <span class="o">=</span> <span class="n">timing_offset</span> <span class="o">+</span> <span class="n">avoidance_offset</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-390"><a href="#AMTPolicy.estimate_behavioral_offset-390"><span class="linenos">390</span></a>
</span><span id="AMTPolicy.estimate_behavioral_offset-391"><a href="#AMTPolicy.estimate_behavioral_offset-391"><span class="linenos">391</span></a>        <span class="c1"># Offset reduces revenue gain or loss</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-392"><a href="#AMTPolicy.estimate_behavioral_offset-392"><span class="linenos">392</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-393"><a href="#AMTPolicy.estimate_behavioral_offset-393"><span class="linenos">393</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">total_offset</span>  <span class="c1"># Reduces revenue gain</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-394"><a href="#AMTPolicy.estimate_behavioral_offset-394"><span class="linenos">394</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AMTPolicy.estimate_behavioral_offset-395"><a href="#AMTPolicy.estimate_behavioral_offset-395"><span class="linenos">395</span></a>            <span class="k">return</span> <span class="n">total_offset</span>  <span class="c1"># Reduces revenue loss</span>
</span></pre></div>


            <div class="docstring"><p>Estimate behavioral response to AMT changes.</p>

<p>Behavioral responses include:</p>

<ul>
<li>Income timing (accelerate/defer income)</li>
<li>Tax planning (restructure to minimize AMTI)</li>
<li>Charitable giving timing</li>
</ul>

<p>Returns:
    Behavioral offset in billions</p>
</div>


                            </div>
                </section>
                <section id="AMTType">
                            <input id="AMTType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AMTType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="AMTType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AMTType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AMTType-44"><a href="#AMTType-44"><span class="linenos">44</span></a><span class="k">class</span><span class="w"> </span><span class="nc">AMTType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="AMTType-45"><a href="#AMTType-45"><span class="linenos">45</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Type of AMT being modeled.&quot;&quot;&quot;</span>
</span><span id="AMTType-46"><a href="#AMTType-46"><span class="linenos">46</span></a>    <span class="n">INDIVIDUAL</span> <span class="o">=</span> <span class="s2">&quot;individual&quot;</span>
</span><span id="AMTType-47"><a href="#AMTType-47"><span class="linenos">47</span></a>    <span class="n">CORPORATE</span> <span class="o">=</span> <span class="s2">&quot;corporate&quot;</span>  <span class="c1"># Book minimum tax from IRA</span>
</span></pre></div>


            <div class="docstring"><p>Type of AMT being modeled.</p>
</div>


                            <div id="AMTType.INDIVIDUAL" class="classattr">
                                <div class="attr variable">
            <span class="name">INDIVIDUAL</span>        =
<span class="default_value">&lt;<a href="#AMTType.INDIVIDUAL">AMTType.INDIVIDUAL</a>: &#39;individual&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#AMTType.INDIVIDUAL"></a>
    
    

                            </div>
                            <div id="AMTType.CORPORATE" class="classattr">
                                <div class="attr variable">
            <span class="name">CORPORATE</span>        =
<span class="default_value">&lt;<a href="#AMTType.CORPORATE">AMTType.CORPORATE</a>: &#39;corporate&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#AMTType.CORPORATE"></a>
    
    

                            </div>
                </section>
                <section id="AMT_EXEMPTIONS_TCJA">
                    <div class="attr variable">
            <span class="name">AMT_EXEMPTIONS_TCJA</span>        =
<input id="AMT_EXEMPTIONS_TCJA-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="AMT_EXEMPTIONS_TCJA-view-value"></label><span class="default_value">{2024: (85700, 133300, 66650), 2025: (88100, 137000, 68500), 2026: (60000, 93000, 46500), 2027: (62000, 96000, 48000), 2028: (64000, 99000, 49500), 2029: (66000, 102000, 51000), 2030: (68000, 105000, 52500), 2031: (70000, 108000, 54000), 2032: (72000, 111000, 55500), 2033: (74000, 114000, 57000), 2034: (76000, 117000, 58500)}</span>

        
    </div>
    <a class="headerlink" href="#AMT_EXEMPTIONS_TCJA"></a>
    
    

                </section>
                <section id="AMT_EXEMPTIONS_TCJA_EXTENDED">
                    <div class="attr variable">
            <span class="name">AMT_EXEMPTIONS_TCJA_EXTENDED</span>        =
<input id="AMT_EXEMPTIONS_TCJA_EXTENDED-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="AMT_EXEMPTIONS_TCJA_EXTENDED-view-value"></label><span class="default_value">{2026: (91000, 141000, 70500), 2027: (94000, 145000, 72500), 2028: (97000, 150000, 75000), 2029: (100000, 155000, 77500), 2030: (103000, 160000, 80000), 2031: (106000, 165000, 82500), 2032: (109000, 170000, 85000), 2033: (112000, 175000, 87500), 2034: (115000, 180000, 90000)}</span>

        
    </div>
    <a class="headerlink" href="#AMT_EXEMPTIONS_TCJA_EXTENDED"></a>
    
    

                </section>
                <section id="AMT_RATES">
                    <div class="attr variable">
            <span class="name">AMT_RATES</span>        =
<input id="AMT_RATES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="AMT_RATES-view-value"></label><span class="default_value">{&#39;first_tier&#39;: 0.26, &#39;second_tier&#39;: 0.28, &#39;tier_threshold_mfj&#39;: 232600, &#39;tier_threshold_single&#39;: 116300}</span>

        
    </div>
    <a class="headerlink" href="#AMT_RATES"></a>
    
    

                </section>
                <section id="CORPORATE_AMT">
                    <div class="attr variable">
            <span class="name">CORPORATE_AMT</span>        =
<span class="default_value">{&#39;rate&#39;: 0.15, &#39;threshold&#39;: 1000000000, &#39;revenue_per_year&#39;: 22.0}</span>

        
    </div>
    <a class="headerlink" href="#CORPORATE_AMT"></a>
    
    

                </section>
                <section id="BASELINE_AMT_DATA">
                    <div class="attr variable">
            <span class="name">BASELINE_AMT_DATA</span>        =
<input id="BASELINE_AMT_DATA-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="BASELINE_AMT_DATA-view-value"></label><span class="default_value">{&#39;taxpayers_tcja&#39;: 200000, &#39;taxpayers_post_tcja&#39;: 7300000, &#39;revenue_tcja&#39;: 5.0, &#39;revenue_post_tcja_2030&#39;: 75.0, &#39;avg_amt_tcja&#39;: 25000, &#39;avg_amt_post_tcja&#39;: 10000, &#39;timing_elasticity&#39;: 0.15, &#39;avoidance_elasticity&#39;: 0.1}</span>

        
    </div>
    <a class="headerlink" href="#BASELINE_AMT_DATA"></a>
    
    

                </section>
                <section id="CBO_AMT_ESTIMATES">
                    <div class="attr variable">
            <span class="name">CBO_AMT_ESTIMATES</span>        =
<input id="CBO_AMT_ESTIMATES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="CBO_AMT_ESTIMATES-view-value"></label><span class="default_value">{&#39;extend_tcja_10yr&#39;: 450.0, &#39;extend_tcja_annual&#39;: 39.3, &#39;tcja_expiration_10yr&#39;: 450.0, &#39;current_individual_annual&#39;: 5.0, &#39;camt_annual&#39;: 22.0, &#39;camt_10yr&#39;: 220.0, &#39;repeal_individual_10yr&#39;: 450.0}</span>

        
    </div>
    <a class="headerlink" href="#CBO_AMT_ESTIMATES"></a>
    
    

                </section>
                <section id="create_extend_tcja_amt_relief">
                            <input id="create_extend_tcja_amt_relief-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_extend_tcja_amt_relief</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#AMTPolicy">AMTPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_extend_tcja_amt_relief-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_extend_tcja_amt_relief"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_extend_tcja_amt_relief-402"><a href="#create_extend_tcja_amt_relief-402"><span class="linenos">402</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_extend_tcja_amt_relief</span><span class="p">(</span>
</span><span id="create_extend_tcja_amt_relief-403"><a href="#create_extend_tcja_amt_relief-403"><span class="linenos">403</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-404"><a href="#create_extend_tcja_amt_relief-404"><span class="linenos">404</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-405"><a href="#create_extend_tcja_amt_relief-405"><span class="linenos">405</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AMTPolicy</span><span class="p">:</span>
</span><span id="create_extend_tcja_amt_relief-406"><a href="#create_extend_tcja_amt_relief-406"><span class="linenos">406</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_extend_tcja_amt_relief-407"><a href="#create_extend_tcja_amt_relief-407"><span class="linenos">407</span></a><span class="sd">    Create policy to extend TCJA AMT relief beyond 2025.</span>
</span><span id="create_extend_tcja_amt_relief-408"><a href="#create_extend_tcja_amt_relief-408"><span class="linenos">408</span></a>
</span><span id="create_extend_tcja_amt_relief-409"><a href="#create_extend_tcja_amt_relief-409"><span class="linenos">409</span></a><span class="sd">    Keeps the higher exemptions ($88K single, $137K MFJ) instead of</span>
</span><span id="create_extend_tcja_amt_relief-410"><a href="#create_extend_tcja_amt_relief-410"><span class="linenos">410</span></a><span class="sd">    reverting to pre-TCJA levels (~$60K single, ~$93K MFJ).</span>
</span><span id="create_extend_tcja_amt_relief-411"><a href="#create_extend_tcja_amt_relief-411"><span class="linenos">411</span></a>
</span><span id="create_extend_tcja_amt_relief-412"><a href="#create_extend_tcja_amt_relief-412"><span class="linenos">412</span></a><span class="sd">    CBO/JCT estimate: ~$450B cost over 10 years</span>
</span><span id="create_extend_tcja_amt_relief-413"><a href="#create_extend_tcja_amt_relief-413"><span class="linenos">413</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_extend_tcja_amt_relief-414"><a href="#create_extend_tcja_amt_relief-414"><span class="linenos">414</span></a>    <span class="k">return</span> <span class="n">AMTPolicy</span><span class="p">(</span>
</span><span id="create_extend_tcja_amt_relief-415"><a href="#create_extend_tcja_amt_relief-415"><span class="linenos">415</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Extend TCJA AMT Relief&quot;</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-416"><a href="#create_extend_tcja_amt_relief-416"><span class="linenos">416</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extend higher AMT exemptions beyond 2025 sunset&quot;</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-417"><a href="#create_extend_tcja_amt_relief-417"><span class="linenos">417</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-418"><a href="#create_extend_tcja_amt_relief-418"><span class="linenos">418</span></a>        <span class="n">amt_type</span><span class="o">=</span><span class="n">AMTType</span><span class="o">.</span><span class="n">INDIVIDUAL</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-419"><a href="#create_extend_tcja_amt_relief-419"><span class="linenos">419</span></a>        <span class="n">extend_tcja_relief</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-420"><a href="#create_extend_tcja_amt_relief-420"><span class="linenos">420</span></a>        <span class="n">timing_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Behavioral already in calibration</span>
</span><span id="create_extend_tcja_amt_relief-421"><a href="#create_extend_tcja_amt_relief-421"><span class="linenos">421</span></a>        <span class="n">avoidance_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-422"><a href="#create_extend_tcja_amt_relief-422"><span class="linenos">422</span></a>        <span class="c1"># Calibrated to ~$450B over 10 years (with 3% annual growth)</span>
</span><span id="create_extend_tcja_amt_relief-423"><a href="#create_extend_tcja_amt_relief-423"><span class="linenos">423</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">39.3</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-424"><a href="#create_extend_tcja_amt_relief-424"><span class="linenos">424</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-425"><a href="#create_extend_tcja_amt_relief-425"><span class="linenos">425</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_extend_tcja_amt_relief-426"><a href="#create_extend_tcja_amt_relief-426"><span class="linenos">426</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to extend TCJA AMT relief beyond 2025.</p>

<p>Keeps the higher exemptions ($88K single, $137K MFJ) instead of
reverting to pre-TCJA levels (~$60K single, ~$93K MFJ).</p>

<p>CBO/JCT estimate: ~$450B cost over 10 years</p>
</div>


                </section>
                <section id="create_repeal_individual_amt">
                            <input id="create_repeal_individual_amt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_repeal_individual_amt</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#AMTPolicy">AMTPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_repeal_individual_amt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_repeal_individual_amt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_repeal_individual_amt-429"><a href="#create_repeal_individual_amt-429"><span class="linenos">429</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_repeal_individual_amt</span><span class="p">(</span>
</span><span id="create_repeal_individual_amt-430"><a href="#create_repeal_individual_amt-430"><span class="linenos">430</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-431"><a href="#create_repeal_individual_amt-431"><span class="linenos">431</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-432"><a href="#create_repeal_individual_amt-432"><span class="linenos">432</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AMTPolicy</span><span class="p">:</span>
</span><span id="create_repeal_individual_amt-433"><a href="#create_repeal_individual_amt-433"><span class="linenos">433</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_repeal_individual_amt-434"><a href="#create_repeal_individual_amt-434"><span class="linenos">434</span></a><span class="sd">    Create policy to fully repeal the individual AMT.</span>
</span><span id="create_repeal_individual_amt-435"><a href="#create_repeal_individual_amt-435"><span class="linenos">435</span></a>
</span><span id="create_repeal_individual_amt-436"><a href="#create_repeal_individual_amt-436"><span class="linenos">436</span></a><span class="sd">    This eliminates all individual AMT revenue.</span>
</span><span id="create_repeal_individual_amt-437"><a href="#create_repeal_individual_amt-437"><span class="linenos">437</span></a><span class="sd">    Under TCJA, this is ~$5B/year, growing to ~$75B/year after sunset.</span>
</span><span id="create_repeal_individual_amt-438"><a href="#create_repeal_individual_amt-438"><span class="linenos">438</span></a>
</span><span id="create_repeal_individual_amt-439"><a href="#create_repeal_individual_amt-439"><span class="linenos">439</span></a><span class="sd">    If starting post-2025 (after sunset), the 10-year cost is ~$450B.</span>
</span><span id="create_repeal_individual_amt-440"><a href="#create_repeal_individual_amt-440"><span class="linenos">440</span></a><span class="sd">    If starting in 2025 (before sunset), cost is lower (~$50B over 10 years).</span>
</span><span id="create_repeal_individual_amt-441"><a href="#create_repeal_individual_amt-441"><span class="linenos">441</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_repeal_individual_amt-442"><a href="#create_repeal_individual_amt-442"><span class="linenos">442</span></a>    <span class="c1"># Cost depends on whether TCJA is still in effect</span>
</span><span id="create_repeal_individual_amt-443"><a href="#create_repeal_individual_amt-443"><span class="linenos">443</span></a>    <span class="k">if</span> <span class="n">start_year</span> <span class="o">&lt;=</span> <span class="mi">2025</span><span class="p">:</span>
</span><span id="create_repeal_individual_amt-444"><a href="#create_repeal_individual_amt-444"><span class="linenos">444</span></a>        <span class="c1"># TCJA still in effect - lower revenue to lose</span>
</span><span id="create_repeal_individual_amt-445"><a href="#create_repeal_individual_amt-445"><span class="linenos">445</span></a>        <span class="n">annual_cost</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span>  <span class="c1"># ~$5B/year under TCJA</span>
</span><span id="create_repeal_individual_amt-446"><a href="#create_repeal_individual_amt-446"><span class="linenos">446</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="create_repeal_individual_amt-447"><a href="#create_repeal_individual_amt-447"><span class="linenos">447</span></a>        <span class="c1"># Post-TCJA - more revenue at stake</span>
</span><span id="create_repeal_individual_amt-448"><a href="#create_repeal_individual_amt-448"><span class="linenos">448</span></a>        <span class="n">annual_cost</span> <span class="o">=</span> <span class="o">-</span><span class="mf">39.3</span>  <span class="c1"># Growing to ~$75B by 2030</span>
</span><span id="create_repeal_individual_amt-449"><a href="#create_repeal_individual_amt-449"><span class="linenos">449</span></a>
</span><span id="create_repeal_individual_amt-450"><a href="#create_repeal_individual_amt-450"><span class="linenos">450</span></a>    <span class="k">return</span> <span class="n">AMTPolicy</span><span class="p">(</span>
</span><span id="create_repeal_individual_amt-451"><a href="#create_repeal_individual_amt-451"><span class="linenos">451</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Repeal Individual AMT&quot;</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-452"><a href="#create_repeal_individual_amt-452"><span class="linenos">452</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Fully repeal the individual Alternative Minimum Tax&quot;</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-453"><a href="#create_repeal_individual_amt-453"><span class="linenos">453</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-454"><a href="#create_repeal_individual_amt-454"><span class="linenos">454</span></a>        <span class="n">amt_type</span><span class="o">=</span><span class="n">AMTType</span><span class="o">.</span><span class="n">INDIVIDUAL</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-455"><a href="#create_repeal_individual_amt-455"><span class="linenos">455</span></a>        <span class="n">repeal_individual_amt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-456"><a href="#create_repeal_individual_amt-456"><span class="linenos">456</span></a>        <span class="n">timing_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-457"><a href="#create_repeal_individual_amt-457"><span class="linenos">457</span></a>        <span class="n">avoidance_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-458"><a href="#create_repeal_individual_amt-458"><span class="linenos">458</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="n">annual_cost</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-459"><a href="#create_repeal_individual_amt-459"><span class="linenos">459</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-460"><a href="#create_repeal_individual_amt-460"><span class="linenos">460</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_repeal_individual_amt-461"><a href="#create_repeal_individual_amt-461"><span class="linenos">461</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to fully repeal the individual AMT.</p>

<p>This eliminates all individual AMT revenue.
Under TCJA, this is ~$5B/year, growing to ~$75B/year after sunset.</p>

<p>If starting post-2025 (after sunset), the 10-year cost is ~$450B.
If starting in 2025 (before sunset), cost is lower (~$50B over 10 years).</p>
</div>


                </section>
                <section id="create_repeal_corporate_amt">
                            <input id="create_repeal_corporate_amt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_repeal_corporate_amt</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#AMTPolicy">AMTPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_repeal_corporate_amt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_repeal_corporate_amt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_repeal_corporate_amt-464"><a href="#create_repeal_corporate_amt-464"><span class="linenos">464</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_repeal_corporate_amt</span><span class="p">(</span>
</span><span id="create_repeal_corporate_amt-465"><a href="#create_repeal_corporate_amt-465"><span class="linenos">465</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-466"><a href="#create_repeal_corporate_amt-466"><span class="linenos">466</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-467"><a href="#create_repeal_corporate_amt-467"><span class="linenos">467</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AMTPolicy</span><span class="p">:</span>
</span><span id="create_repeal_corporate_amt-468"><a href="#create_repeal_corporate_amt-468"><span class="linenos">468</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_repeal_corporate_amt-469"><a href="#create_repeal_corporate_amt-469"><span class="linenos">469</span></a><span class="sd">    Create policy to repeal the corporate AMT (book minimum tax).</span>
</span><span id="create_repeal_corporate_amt-470"><a href="#create_repeal_corporate_amt-470"><span class="linenos">470</span></a>
</span><span id="create_repeal_corporate_amt-471"><a href="#create_repeal_corporate_amt-471"><span class="linenos">471</span></a><span class="sd">    The 15% corporate AMT was enacted in IRA 2022 and is permanent.</span>
</span><span id="create_repeal_corporate_amt-472"><a href="#create_repeal_corporate_amt-472"><span class="linenos">472</span></a><span class="sd">    Repealing would cost ~$22B/year in lost revenue.</span>
</span><span id="create_repeal_corporate_amt-473"><a href="#create_repeal_corporate_amt-473"><span class="linenos">473</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_repeal_corporate_amt-474"><a href="#create_repeal_corporate_amt-474"><span class="linenos">474</span></a>    <span class="k">return</span> <span class="n">AMTPolicy</span><span class="p">(</span>
</span><span id="create_repeal_corporate_amt-475"><a href="#create_repeal_corporate_amt-475"><span class="linenos">475</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Repeal Corporate AMT&quot;</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-476"><a href="#create_repeal_corporate_amt-476"><span class="linenos">476</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Repeal the 15% book minimum tax (CAMT) from IRA 2022&quot;</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-477"><a href="#create_repeal_corporate_amt-477"><span class="linenos">477</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">CORPORATE_TAX</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-478"><a href="#create_repeal_corporate_amt-478"><span class="linenos">478</span></a>        <span class="n">amt_type</span><span class="o">=</span><span class="n">AMTType</span><span class="o">.</span><span class="n">CORPORATE</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-479"><a href="#create_repeal_corporate_amt-479"><span class="linenos">479</span></a>        <span class="n">repeal_corporate_amt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-480"><a href="#create_repeal_corporate_amt-480"><span class="linenos">480</span></a>        <span class="n">timing_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-481"><a href="#create_repeal_corporate_amt-481"><span class="linenos">481</span></a>        <span class="n">avoidance_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-482"><a href="#create_repeal_corporate_amt-482"><span class="linenos">482</span></a>        <span class="c1"># Calibrated: ~$220B over 10 years</span>
</span><span id="create_repeal_corporate_amt-483"><a href="#create_repeal_corporate_amt-483"><span class="linenos">483</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">19.2</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-484"><a href="#create_repeal_corporate_amt-484"><span class="linenos">484</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-485"><a href="#create_repeal_corporate_amt-485"><span class="linenos">485</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_repeal_corporate_amt-486"><a href="#create_repeal_corporate_amt-486"><span class="linenos">486</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to repeal the corporate AMT (book minimum tax).</p>

<p>The 15% corporate AMT was enacted in IRA 2022 and is permanent.
Repealing would cost ~$22B/year in lost revenue.</p>
</div>


                </section>
                <section id="create_increase_amt_exemption">
                            <input id="create_increase_amt_exemption-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_increase_amt_exemption</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">exemption_increase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">25000</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#AMTPolicy">AMTPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_increase_amt_exemption-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_increase_amt_exemption"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_increase_amt_exemption-489"><a href="#create_increase_amt_exemption-489"><span class="linenos">489</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_increase_amt_exemption</span><span class="p">(</span>
</span><span id="create_increase_amt_exemption-490"><a href="#create_increase_amt_exemption-490"><span class="linenos">490</span></a>    <span class="n">exemption_increase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">25_000</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-491"><a href="#create_increase_amt_exemption-491"><span class="linenos">491</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-492"><a href="#create_increase_amt_exemption-492"><span class="linenos">492</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-493"><a href="#create_increase_amt_exemption-493"><span class="linenos">493</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AMTPolicy</span><span class="p">:</span>
</span><span id="create_increase_amt_exemption-494"><a href="#create_increase_amt_exemption-494"><span class="linenos">494</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_increase_amt_exemption-495"><a href="#create_increase_amt_exemption-495"><span class="linenos">495</span></a><span class="sd">    Create policy to increase AMT exemption levels.</span>
</span><span id="create_increase_amt_exemption-496"><a href="#create_increase_amt_exemption-496"><span class="linenos">496</span></a>
</span><span id="create_increase_amt_exemption-497"><a href="#create_increase_amt_exemption-497"><span class="linenos">497</span></a><span class="sd">    Args:</span>
</span><span id="create_increase_amt_exemption-498"><a href="#create_increase_amt_exemption-498"><span class="linenos">498</span></a><span class="sd">        exemption_increase: Dollar increase in exemption (e.g., $25,000)</span>
</span><span id="create_increase_amt_exemption-499"><a href="#create_increase_amt_exemption-499"><span class="linenos">499</span></a><span class="sd">        start_year: First year of policy</span>
</span><span id="create_increase_amt_exemption-500"><a href="#create_increase_amt_exemption-500"><span class="linenos">500</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_increase_amt_exemption-501"><a href="#create_increase_amt_exemption-501"><span class="linenos">501</span></a>
</span><span id="create_increase_amt_exemption-502"><a href="#create_increase_amt_exemption-502"><span class="linenos">502</span></a><span class="sd">    Returns:</span>
</span><span id="create_increase_amt_exemption-503"><a href="#create_increase_amt_exemption-503"><span class="linenos">503</span></a><span class="sd">        AMTPolicy for exemption increase</span>
</span><span id="create_increase_amt_exemption-504"><a href="#create_increase_amt_exemption-504"><span class="linenos">504</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_increase_amt_exemption-505"><a href="#create_increase_amt_exemption-505"><span class="linenos">505</span></a>    <span class="c1"># Rough estimate: each $25K exemption increase reduces affected taxpayers</span>
</span><span id="create_increase_amt_exemption-506"><a href="#create_increase_amt_exemption-506"><span class="linenos">506</span></a>    <span class="c1"># and revenue by roughly 15%</span>
</span><span id="create_increase_amt_exemption-507"><a href="#create_increase_amt_exemption-507"><span class="linenos">507</span></a>    <span class="n">reduction_pct</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">exemption_increase</span> <span class="o">/</span> <span class="mi">25_000</span><span class="p">)</span>
</span><span id="create_increase_amt_exemption-508"><a href="#create_increase_amt_exemption-508"><span class="linenos">508</span></a>
</span><span id="create_increase_amt_exemption-509"><a href="#create_increase_amt_exemption-509"><span class="linenos">509</span></a>    <span class="c1"># Baseline post-TCJA revenue ~$39B/year (average)</span>
</span><span id="create_increase_amt_exemption-510"><a href="#create_increase_amt_exemption-510"><span class="linenos">510</span></a>    <span class="n">annual_cost</span> <span class="o">=</span> <span class="o">-</span><span class="mf">39.3</span> <span class="o">*</span> <span class="n">reduction_pct</span>
</span><span id="create_increase_amt_exemption-511"><a href="#create_increase_amt_exemption-511"><span class="linenos">511</span></a>
</span><span id="create_increase_amt_exemption-512"><a href="#create_increase_amt_exemption-512"><span class="linenos">512</span></a>    <span class="k">return</span> <span class="n">AMTPolicy</span><span class="p">(</span>
</span><span id="create_increase_amt_exemption-513"><a href="#create_increase_amt_exemption-513"><span class="linenos">513</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;AMT Exemption +$</span><span class="si">{</span><span class="n">exemption_increase</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K&quot;</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-514"><a href="#create_increase_amt_exemption-514"><span class="linenos">514</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Increase AMT exemption by $</span><span class="si">{</span><span class="n">exemption_increase</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-515"><a href="#create_increase_amt_exemption-515"><span class="linenos">515</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-516"><a href="#create_increase_amt_exemption-516"><span class="linenos">516</span></a>        <span class="n">amt_type</span><span class="o">=</span><span class="n">AMTType</span><span class="o">.</span><span class="n">INDIVIDUAL</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-517"><a href="#create_increase_amt_exemption-517"><span class="linenos">517</span></a>        <span class="n">exemption_change</span><span class="o">=</span><span class="n">exemption_increase</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-518"><a href="#create_increase_amt_exemption-518"><span class="linenos">518</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="n">annual_cost</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-519"><a href="#create_increase_amt_exemption-519"><span class="linenos">519</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-520"><a href="#create_increase_amt_exemption-520"><span class="linenos">520</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_increase_amt_exemption-521"><a href="#create_increase_amt_exemption-521"><span class="linenos">521</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to increase AMT exemption levels.</p>

<p>Args:
    exemption_increase: Dollar increase in exemption (e.g., $25,000)
    start_year: First year of policy
    duration_years: Duration</p>

<p>Returns:
    AMTPolicy for exemption increase</p>
</div>


                </section>
                <section id="create_amt_rate_change">
                            <input id="create_amt_rate_change-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_amt_rate_change</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#AMTPolicy">AMTPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_amt_rate_change-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_amt_rate_change"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_amt_rate_change-524"><a href="#create_amt_rate_change-524"><span class="linenos">524</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_amt_rate_change</span><span class="p">(</span>
</span><span id="create_amt_rate_change-525"><a href="#create_amt_rate_change-525"><span class="linenos">525</span></a>    <span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="create_amt_rate_change-526"><a href="#create_amt_rate_change-526"><span class="linenos">526</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">,</span>
</span><span id="create_amt_rate_change-527"><a href="#create_amt_rate_change-527"><span class="linenos">527</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_amt_rate_change-528"><a href="#create_amt_rate_change-528"><span class="linenos">528</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AMTPolicy</span><span class="p">:</span>
</span><span id="create_amt_rate_change-529"><a href="#create_amt_rate_change-529"><span class="linenos">529</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_amt_rate_change-530"><a href="#create_amt_rate_change-530"><span class="linenos">530</span></a><span class="sd">    Create AMT rate change policy.</span>
</span><span id="create_amt_rate_change-531"><a href="#create_amt_rate_change-531"><span class="linenos">531</span></a>
</span><span id="create_amt_rate_change-532"><a href="#create_amt_rate_change-532"><span class="linenos">532</span></a><span class="sd">    Args:</span>
</span><span id="create_amt_rate_change-533"><a href="#create_amt_rate_change-533"><span class="linenos">533</span></a><span class="sd">        rate_change: Change in rate (e.g., -0.02 for 2pp cut)</span>
</span><span id="create_amt_rate_change-534"><a href="#create_amt_rate_change-534"><span class="linenos">534</span></a><span class="sd">        start_year: First year</span>
</span><span id="create_amt_rate_change-535"><a href="#create_amt_rate_change-535"><span class="linenos">535</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_amt_rate_change-536"><a href="#create_amt_rate_change-536"><span class="linenos">536</span></a>
</span><span id="create_amt_rate_change-537"><a href="#create_amt_rate_change-537"><span class="linenos">537</span></a><span class="sd">    Returns:</span>
</span><span id="create_amt_rate_change-538"><a href="#create_amt_rate_change-538"><span class="linenos">538</span></a><span class="sd">        AMTPolicy for rate change</span>
</span><span id="create_amt_rate_change-539"><a href="#create_amt_rate_change-539"><span class="linenos">539</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_amt_rate_change-540"><a href="#create_amt_rate_change-540"><span class="linenos">540</span></a>    <span class="c1"># Revenue effect proportional to rate change</span>
</span><span id="create_amt_rate_change-541"><a href="#create_amt_rate_change-541"><span class="linenos">541</span></a>    <span class="c1"># Current combined rate ~27% average, baseline ~$40B/year post-TCJA</span>
</span><span id="create_amt_rate_change-542"><a href="#create_amt_rate_change-542"><span class="linenos">542</span></a>    <span class="n">avg_rate</span> <span class="o">=</span> <span class="p">(</span><span class="n">AMT_RATES</span><span class="p">[</span><span class="s2">&quot;first_tier&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">AMT_RATES</span><span class="p">[</span><span class="s2">&quot;second_tier&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="create_amt_rate_change-543"><a href="#create_amt_rate_change-543"><span class="linenos">543</span></a>    <span class="n">baseline_revenue</span> <span class="o">=</span> <span class="mf">39.3</span>  <span class="c1"># Average annual post-TCJA</span>
</span><span id="create_amt_rate_change-544"><a href="#create_amt_rate_change-544"><span class="linenos">544</span></a>    <span class="n">pct_change</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">/</span> <span class="n">avg_rate</span>
</span><span id="create_amt_rate_change-545"><a href="#create_amt_rate_change-545"><span class="linenos">545</span></a>    <span class="n">annual_change</span> <span class="o">=</span> <span class="n">baseline_revenue</span> <span class="o">*</span> <span class="n">pct_change</span>
</span><span id="create_amt_rate_change-546"><a href="#create_amt_rate_change-546"><span class="linenos">546</span></a>
</span><span id="create_amt_rate_change-547"><a href="#create_amt_rate_change-547"><span class="linenos">547</span></a>    <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;increase&quot;</span> <span class="k">if</span> <span class="n">rate_change</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;decrease&quot;</span>
</span><span id="create_amt_rate_change-548"><a href="#create_amt_rate_change-548"><span class="linenos">548</span></a>    <span class="n">new_first</span> <span class="o">=</span> <span class="n">AMT_RATES</span><span class="p">[</span><span class="s2">&quot;first_tier&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">rate_change</span>
</span><span id="create_amt_rate_change-549"><a href="#create_amt_rate_change-549"><span class="linenos">549</span></a>    <span class="n">new_second</span> <span class="o">=</span> <span class="n">AMT_RATES</span><span class="p">[</span><span class="s2">&quot;second_tier&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">rate_change</span>
</span><span id="create_amt_rate_change-550"><a href="#create_amt_rate_change-550"><span class="linenos">550</span></a>
</span><span id="create_amt_rate_change-551"><a href="#create_amt_rate_change-551"><span class="linenos">551</span></a>    <span class="k">return</span> <span class="n">AMTPolicy</span><span class="p">(</span>
</span><span id="create_amt_rate_change-552"><a href="#create_amt_rate_change-552"><span class="linenos">552</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;AMT Rate </span><span class="si">{</span><span class="n">direction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">rate_change</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">pp&quot;</span><span class="p">,</span>
</span><span id="create_amt_rate_change-553"><a href="#create_amt_rate_change-553"><span class="linenos">553</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Change AMT rates to </span><span class="si">{</span><span class="n">new_first</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%/</span><span class="si">{</span><span class="n">new_second</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
</span><span id="create_amt_rate_change-554"><a href="#create_amt_rate_change-554"><span class="linenos">554</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">,</span>
</span><span id="create_amt_rate_change-555"><a href="#create_amt_rate_change-555"><span class="linenos">555</span></a>        <span class="n">amt_type</span><span class="o">=</span><span class="n">AMTType</span><span class="o">.</span><span class="n">INDIVIDUAL</span><span class="p">,</span>
</span><span id="create_amt_rate_change-556"><a href="#create_amt_rate_change-556"><span class="linenos">556</span></a>        <span class="n">rate_change</span><span class="o">=</span><span class="n">rate_change</span><span class="p">,</span>
</span><span id="create_amt_rate_change-557"><a href="#create_amt_rate_change-557"><span class="linenos">557</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="n">annual_change</span><span class="p">,</span>
</span><span id="create_amt_rate_change-558"><a href="#create_amt_rate_change-558"><span class="linenos">558</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_amt_rate_change-559"><a href="#create_amt_rate_change-559"><span class="linenos">559</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_amt_rate_change-560"><a href="#create_amt_rate_change-560"><span class="linenos">560</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create AMT rate change policy.</p>

<p>Args:
    rate_change: Change in rate (e.g., -0.02 for 2pp cut)
    start_year: First year
    duration_years: Duration</p>

<p>Returns:
    AMTPolicy for rate change</p>
</div>


                </section>
                <section id="estimate_amt_revenue">
                            <input id="estimate_amt_revenue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_amt_revenue</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#AMTPolicy">AMTPolicy</a></span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="estimate_amt_revenue-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#estimate_amt_revenue"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="estimate_amt_revenue-593"><a href="#estimate_amt_revenue-593"><span class="linenos">593</span></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_amt_revenue</span><span class="p">(</span><span class="n">policy</span><span class="p">:</span> <span class="n">AMTPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="estimate_amt_revenue-594"><a href="#estimate_amt_revenue-594"><span class="linenos">594</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="estimate_amt_revenue-595"><a href="#estimate_amt_revenue-595"><span class="linenos">595</span></a><span class="sd">    Estimate total revenue effect of an AMT policy.</span>
</span><span id="estimate_amt_revenue-596"><a href="#estimate_amt_revenue-596"><span class="linenos">596</span></a>
</span><span id="estimate_amt_revenue-597"><a href="#estimate_amt_revenue-597"><span class="linenos">597</span></a><span class="sd">    Returns dict with:</span>
</span><span id="estimate_amt_revenue-598"><a href="#estimate_amt_revenue-598"><span class="linenos">598</span></a><span class="sd">        - annual_static: Average annual static effect</span>
</span><span id="estimate_amt_revenue-599"><a href="#estimate_amt_revenue-599"><span class="linenos">599</span></a><span class="sd">        - ten_year_static: Total 10-year static effect</span>
</span><span id="estimate_amt_revenue-600"><a href="#estimate_amt_revenue-600"><span class="linenos">600</span></a><span class="sd">        - behavioral_offset: Total behavioral offset</span>
</span><span id="estimate_amt_revenue-601"><a href="#estimate_amt_revenue-601"><span class="linenos">601</span></a><span class="sd">        - net_effect: Final effect after behavioral response</span>
</span><span id="estimate_amt_revenue-602"><a href="#estimate_amt_revenue-602"><span class="linenos">602</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="estimate_amt_revenue-603"><a href="#estimate_amt_revenue-603"><span class="linenos">603</span></a>    <span class="n">annual_static</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="estimate_amt_revenue-604"><a href="#estimate_amt_revenue-604"><span class="linenos">604</span></a>    <span class="n">behavioral</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">annual_static</span><span class="p">)</span>
</span><span id="estimate_amt_revenue-605"><a href="#estimate_amt_revenue-605"><span class="linenos">605</span></a>
</span><span id="estimate_amt_revenue-606"><a href="#estimate_amt_revenue-606"><span class="linenos">606</span></a>    <span class="c1"># Apply growth (~3%/year for income growth)</span>
</span><span id="estimate_amt_revenue-607"><a href="#estimate_amt_revenue-607"><span class="linenos">607</span></a>    <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="estimate_amt_revenue-608"><a href="#estimate_amt_revenue-608"><span class="linenos">608</span></a>    <span class="n">annual_effects</span> <span class="o">=</span> <span class="n">annual_static</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.03</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_amt_revenue-609"><a href="#estimate_amt_revenue-609"><span class="linenos">609</span></a>    <span class="n">behavioral_effects</span> <span class="o">=</span> <span class="n">behavioral</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.03</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_amt_revenue-610"><a href="#estimate_amt_revenue-610"><span class="linenos">610</span></a>
</span><span id="estimate_amt_revenue-611"><a href="#estimate_amt_revenue-611"><span class="linenos">611</span></a>    <span class="n">ten_year_static</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">annual_effects</span><span class="p">)</span>
</span><span id="estimate_amt_revenue-612"><a href="#estimate_amt_revenue-612"><span class="linenos">612</span></a>    <span class="n">ten_year_behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">behavioral_effects</span><span class="p">)</span>
</span><span id="estimate_amt_revenue-613"><a href="#estimate_amt_revenue-613"><span class="linenos">613</span></a>
</span><span id="estimate_amt_revenue-614"><a href="#estimate_amt_revenue-614"><span class="linenos">614</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="estimate_amt_revenue-615"><a href="#estimate_amt_revenue-615"><span class="linenos">615</span></a>        <span class="s2">&quot;annual_static&quot;</span><span class="p">:</span> <span class="n">annual_static</span><span class="p">,</span>
</span><span id="estimate_amt_revenue-616"><a href="#estimate_amt_revenue-616"><span class="linenos">616</span></a>        <span class="s2">&quot;ten_year_static&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span><span class="p">,</span>
</span><span id="estimate_amt_revenue-617"><a href="#estimate_amt_revenue-617"><span class="linenos">617</span></a>        <span class="s2">&quot;behavioral_offset&quot;</span><span class="p">:</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_amt_revenue-618"><a href="#estimate_amt_revenue-618"><span class="linenos">618</span></a>        <span class="s2">&quot;net_effect&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span> <span class="o">+</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_amt_revenue-619"><a href="#estimate_amt_revenue-619"><span class="linenos">619</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Estimate total revenue effect of an AMT policy.</p>

<p>Returns dict with:
    - annual_static: Average annual static effect
    - ten_year_static: Total 10-year static effect
    - behavioral_offset: Total behavioral offset
    - net_effect: Final effect after behavioral response</p>
</div>


                </section>
                <section id="AMT_VALIDATION_SCENARIOS">
                    <div class="attr variable">
            <span class="name">AMT_VALIDATION_SCENARIOS</span>        =
<input id="AMT_VALIDATION_SCENARIOS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="AMT_VALIDATION_SCENARIOS-view-value"></label><span class="default_value">{&#39;extend_tcja_amt&#39;: {&#39;description&#39;: &#39;Extend TCJA AMT relief&#39;, &#39;policy_factory&#39;: &#39;create_extend_tcja_amt_relief&#39;, &#39;expected_10yr&#39;: 450.0, &#39;source&#39;: &#39;JCT/CBO&#39;, &#39;notes&#39;: &#39;Keep higher exemptions instead of sunset to pre-TCJA levels&#39;}, &#39;repeal_individual_amt&#39;: {&#39;description&#39;: &#39;Repeal individual AMT (post-2025)&#39;, &#39;policy_factory&#39;: &#39;create_repeal_individual_amt&#39;, &#39;kwargs&#39;: {&#39;start_year&#39;: 2026}, &#39;expected_10yr&#39;: 450.0, &#39;source&#39;: &#39;CBO baseline&#39;, &#39;notes&#39;: &#39;Eliminate all individual AMT after TCJA expires&#39;}, &#39;repeal_corporate_amt&#39;: {&#39;description&#39;: &#39;Repeal corporate AMT (CAMT)&#39;, &#39;policy_factory&#39;: &#39;create_repeal_corporate_amt&#39;, &#39;expected_10yr&#39;: 220.0, &#39;source&#39;: &#39;CBO&#39;, &#39;notes&#39;: &#39;Repeal 15% book minimum tax from IRA 2022&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#AMT_VALIDATION_SCENARIOS"></a>
    
    

                </section>
                <section id="PremiumTaxCreditPolicy">
                            <input id="PremiumTaxCreditPolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">PremiumTaxCreditPolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="PremiumTaxCreditPolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PremiumTaxCreditPolicy-167"><a href="#PremiumTaxCreditPolicy-167"><span class="linenos">167</span></a><span class="nd">@dataclass</span>
</span><span id="PremiumTaxCreditPolicy-168"><a href="#PremiumTaxCreditPolicy-168"><span class="linenos">168</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PremiumTaxCreditPolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="PremiumTaxCreditPolicy-169"><a href="#PremiumTaxCreditPolicy-169"><span class="linenos">169</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-170"><a href="#PremiumTaxCreditPolicy-170"><span class="linenos">170</span></a><span class="sd">    Premium Tax Credit policy modeling ACA marketplace subsidies.</span>
</span><span id="PremiumTaxCreditPolicy-171"><a href="#PremiumTaxCreditPolicy-171"><span class="linenos">171</span></a>
</span><span id="PremiumTaxCreditPolicy-172"><a href="#PremiumTaxCreditPolicy-172"><span class="linenos">172</span></a><span class="sd">    Models premium subsidy changes including:</span>
</span><span id="PremiumTaxCreditPolicy-173"><a href="#PremiumTaxCreditPolicy-173"><span class="linenos">173</span></a><span class="sd">    - Enhanced vs original ACA credit structure</span>
</span><span id="PremiumTaxCreditPolicy-174"><a href="#PremiumTaxCreditPolicy-174"><span class="linenos">174</span></a><span class="sd">    - Income eligibility thresholds</span>
</span><span id="PremiumTaxCreditPolicy-175"><a href="#PremiumTaxCreditPolicy-175"><span class="linenos">175</span></a><span class="sd">    - Premium cap changes</span>
</span><span id="PremiumTaxCreditPolicy-176"><a href="#PremiumTaxCreditPolicy-176"><span class="linenos">176</span></a><span class="sd">    - Coverage effects</span>
</span><span id="PremiumTaxCreditPolicy-177"><a href="#PremiumTaxCreditPolicy-177"><span class="linenos">177</span></a>
</span><span id="PremiumTaxCreditPolicy-178"><a href="#PremiumTaxCreditPolicy-178"><span class="linenos">178</span></a><span class="sd">    Key parameters:</span>
</span><span id="PremiumTaxCreditPolicy-179"><a href="#PremiumTaxCreditPolicy-179"><span class="linenos">179</span></a><span class="sd">        scenario: Type of PTC policy change</span>
</span><span id="PremiumTaxCreditPolicy-180"><a href="#PremiumTaxCreditPolicy-180"><span class="linenos">180</span></a><span class="sd">        extend_enhanced: Extend enhanced PTCs past 2025</span>
</span><span id="PremiumTaxCreditPolicy-181"><a href="#PremiumTaxCreditPolicy-181"><span class="linenos">181</span></a><span class="sd">        make_permanent: Make enhanced PTCs permanent</span>
</span><span id="PremiumTaxCreditPolicy-182"><a href="#PremiumTaxCreditPolicy-182"><span class="linenos">182</span></a><span class="sd">        repeal_ptc: Eliminate PTCs entirely</span>
</span><span id="PremiumTaxCreditPolicy-183"><a href="#PremiumTaxCreditPolicy-183"><span class="linenos">183</span></a><span class="sd">        modify_premium_cap: Change premium cap percentages</span>
</span><span id="PremiumTaxCreditPolicy-184"><a href="#PremiumTaxCreditPolicy-184"><span class="linenos">184</span></a><span class="sd">        modify_income_limit: Change FPL eligibility limits</span>
</span><span id="PremiumTaxCreditPolicy-185"><a href="#PremiumTaxCreditPolicy-185"><span class="linenos">185</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-186"><a href="#PremiumTaxCreditPolicy-186"><span class="linenos">186</span></a>
</span><span id="PremiumTaxCreditPolicy-187"><a href="#PremiumTaxCreditPolicy-187"><span class="linenos">187</span></a>    <span class="c1"># Policy scenario</span>
</span><span id="PremiumTaxCreditPolicy-188"><a href="#PremiumTaxCreditPolicy-188"><span class="linenos">188</span></a>    <span class="n">scenario</span><span class="p">:</span> <span class="n">PTCScenario</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">PTCScenario</span><span class="o">.</span><span class="n">EXTEND_ENHANCED</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy-189"><a href="#PremiumTaxCreditPolicy-189"><span class="linenos">189</span></a>
</span><span id="PremiumTaxCreditPolicy-190"><a href="#PremiumTaxCreditPolicy-190"><span class="linenos">190</span></a>    <span class="c1"># Extension options</span>
</span><span id="PremiumTaxCreditPolicy-191"><a href="#PremiumTaxCreditPolicy-191"><span class="linenos">191</span></a>    <span class="n">extend_enhanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Extend enhanced PTCs past 2025</span>
</span><span id="PremiumTaxCreditPolicy-192"><a href="#PremiumTaxCreditPolicy-192"><span class="linenos">192</span></a>    <span class="n">make_permanent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Make permanent (vs temporary extension)</span>
</span><span id="PremiumTaxCreditPolicy-193"><a href="#PremiumTaxCreditPolicy-193"><span class="linenos">193</span></a>    <span class="n">extension_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Years to extend if not permanent</span>
</span><span id="PremiumTaxCreditPolicy-194"><a href="#PremiumTaxCreditPolicy-194"><span class="linenos">194</span></a>
</span><span id="PremiumTaxCreditPolicy-195"><a href="#PremiumTaxCreditPolicy-195"><span class="linenos">195</span></a>    <span class="c1"># Repeal option</span>
</span><span id="PremiumTaxCreditPolicy-196"><a href="#PremiumTaxCreditPolicy-196"><span class="linenos">196</span></a>    <span class="n">repeal_ptc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Eliminate PTCs entirely</span>
</span><span id="PremiumTaxCreditPolicy-197"><a href="#PremiumTaxCreditPolicy-197"><span class="linenos">197</span></a>
</span><span id="PremiumTaxCreditPolicy-198"><a href="#PremiumTaxCreditPolicy-198"><span class="linenos">198</span></a>    <span class="c1"># Premium cap modifications</span>
</span><span id="PremiumTaxCreditPolicy-199"><a href="#PremiumTaxCreditPolicy-199"><span class="linenos">199</span></a>    <span class="n">modify_premium_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PremiumTaxCreditPolicy-200"><a href="#PremiumTaxCreditPolicy-200"><span class="linenos">200</span></a>    <span class="n">new_premium_cap_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># New max cap (e.g., 0.085)</span>
</span><span id="PremiumTaxCreditPolicy-201"><a href="#PremiumTaxCreditPolicy-201"><span class="linenos">201</span></a>    <span class="n">premium_cap_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change to all caps</span>
</span><span id="PremiumTaxCreditPolicy-202"><a href="#PremiumTaxCreditPolicy-202"><span class="linenos">202</span></a>
</span><span id="PremiumTaxCreditPolicy-203"><a href="#PremiumTaxCreditPolicy-203"><span class="linenos">203</span></a>    <span class="c1"># Income limit modifications</span>
</span><span id="PremiumTaxCreditPolicy-204"><a href="#PremiumTaxCreditPolicy-204"><span class="linenos">204</span></a>    <span class="n">modify_income_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PremiumTaxCreditPolicy-205"><a href="#PremiumTaxCreditPolicy-205"><span class="linenos">205</span></a>    <span class="n">new_upper_fpl_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># New upper limit (e.g., 600% FPL)</span>
</span><span id="PremiumTaxCreditPolicy-206"><a href="#PremiumTaxCreditPolicy-206"><span class="linenos">206</span></a>    <span class="n">new_lower_fpl_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># New lower limit</span>
</span><span id="PremiumTaxCreditPolicy-207"><a href="#PremiumTaxCreditPolicy-207"><span class="linenos">207</span></a>
</span><span id="PremiumTaxCreditPolicy-208"><a href="#PremiumTaxCreditPolicy-208"><span class="linenos">208</span></a>    <span class="c1"># Behavioral parameters</span>
</span><span id="PremiumTaxCreditPolicy-209"><a href="#PremiumTaxCreditPolicy-209"><span class="linenos">209</span></a>    <span class="n">coverage_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Coverage response to subsidy changes</span>
</span><span id="PremiumTaxCreditPolicy-210"><a href="#PremiumTaxCreditPolicy-210"><span class="linenos">210</span></a>    <span class="n">take_up_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.85</span>  <span class="c1"># Eligible population that enrolls</span>
</span><span id="PremiumTaxCreditPolicy-211"><a href="#PremiumTaxCreditPolicy-211"><span class="linenos">211</span></a>    <span class="n">adverse_selection_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Premium spiral from losing healthy</span>
</span><span id="PremiumTaxCreditPolicy-212"><a href="#PremiumTaxCreditPolicy-212"><span class="linenos">212</span></a>
</span><span id="PremiumTaxCreditPolicy-213"><a href="#PremiumTaxCreditPolicy-213"><span class="linenos">213</span></a>    <span class="c1"># Healthcare cost growth</span>
</span><span id="PremiumTaxCreditPolicy-214"><a href="#PremiumTaxCreditPolicy-214"><span class="linenos">214</span></a>    <span class="n">healthcare_growth_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.04</span>  <span class="c1"># 4%/year premium growth</span>
</span><span id="PremiumTaxCreditPolicy-215"><a href="#PremiumTaxCreditPolicy-215"><span class="linenos">215</span></a>
</span><span id="PremiumTaxCreditPolicy-216"><a href="#PremiumTaxCreditPolicy-216"><span class="linenos">216</span></a>    <span class="c1"># Calibration</span>
</span><span id="PremiumTaxCreditPolicy-217"><a href="#PremiumTaxCreditPolicy-217"><span class="linenos">217</span></a>    <span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PremiumTaxCreditPolicy-218"><a href="#PremiumTaxCreditPolicy-218"><span class="linenos">218</span></a>
</span><span id="PremiumTaxCreditPolicy-219"><a href="#PremiumTaxCreditPolicy-219"><span class="linenos">219</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PremiumTaxCreditPolicy-220"><a href="#PremiumTaxCreditPolicy-220"><span class="linenos">220</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set default policy type.&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-221"><a href="#PremiumTaxCreditPolicy-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-222"><a href="#PremiumTaxCreditPolicy-222"><span class="linenos">222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">=</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span>
</span><span id="PremiumTaxCreditPolicy-223"><a href="#PremiumTaxCreditPolicy-223"><span class="linenos">223</span></a>
</span><span id="PremiumTaxCreditPolicy-224"><a href="#PremiumTaxCreditPolicy-224"><span class="linenos">224</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_premium_cap</span><span class="p">(</span>
</span><span id="PremiumTaxCreditPolicy-225"><a href="#PremiumTaxCreditPolicy-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-226"><a href="#PremiumTaxCreditPolicy-226"><span class="linenos">226</span></a>        <span class="n">fpl_percentage</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-227"><a href="#PremiumTaxCreditPolicy-227"><span class="linenos">227</span></a>        <span class="n">use_enhanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-228"><a href="#PremiumTaxCreditPolicy-228"><span class="linenos">228</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-229"><a href="#PremiumTaxCreditPolicy-229"><span class="linenos">229</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-230"><a href="#PremiumTaxCreditPolicy-230"><span class="linenos">230</span></a><span class="sd">        Get premium cap as percentage of income for given FPL level.</span>
</span><span id="PremiumTaxCreditPolicy-231"><a href="#PremiumTaxCreditPolicy-231"><span class="linenos">231</span></a>
</span><span id="PremiumTaxCreditPolicy-232"><a href="#PremiumTaxCreditPolicy-232"><span class="linenos">232</span></a><span class="sd">        Args:</span>
</span><span id="PremiumTaxCreditPolicy-233"><a href="#PremiumTaxCreditPolicy-233"><span class="linenos">233</span></a><span class="sd">            fpl_percentage: Household income as % of FPL (e.g., 250 = 250% FPL)</span>
</span><span id="PremiumTaxCreditPolicy-234"><a href="#PremiumTaxCreditPolicy-234"><span class="linenos">234</span></a><span class="sd">            use_enhanced: Use enhanced (ARPA/IRA) caps vs original ACA</span>
</span><span id="PremiumTaxCreditPolicy-235"><a href="#PremiumTaxCreditPolicy-235"><span class="linenos">235</span></a>
</span><span id="PremiumTaxCreditPolicy-236"><a href="#PremiumTaxCreditPolicy-236"><span class="linenos">236</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy-237"><a href="#PremiumTaxCreditPolicy-237"><span class="linenos">237</span></a><span class="sd">            Premium cap as decimal (e.g., 0.085 = 8.5%)</span>
</span><span id="PremiumTaxCreditPolicy-238"><a href="#PremiumTaxCreditPolicy-238"><span class="linenos">238</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-239"><a href="#PremiumTaxCreditPolicy-239"><span class="linenos">239</span></a>        <span class="n">caps</span> <span class="o">=</span> <span class="n">ENHANCED_PTC_CAPS</span> <span class="k">if</span> <span class="n">use_enhanced</span> <span class="k">else</span> <span class="n">ORIGINAL_ACA_CAPS</span>
</span><span id="PremiumTaxCreditPolicy-240"><a href="#PremiumTaxCreditPolicy-240"><span class="linenos">240</span></a>
</span><span id="PremiumTaxCreditPolicy-241"><a href="#PremiumTaxCreditPolicy-241"><span class="linenos">241</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">),</span> <span class="p">(</span><span class="n">min_cap</span><span class="p">,</span> <span class="n">max_cap</span><span class="p">)</span> <span class="ow">in</span> <span class="n">caps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PremiumTaxCreditPolicy-242"><a href="#PremiumTaxCreditPolicy-242"><span class="linenos">242</span></a>            <span class="k">if</span> <span class="n">low</span> <span class="o">&lt;=</span> <span class="n">fpl_percentage</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-243"><a href="#PremiumTaxCreditPolicy-243"><span class="linenos">243</span></a>                <span class="c1"># Linear interpolation within bracket</span>
</span><span id="PremiumTaxCreditPolicy-244"><a href="#PremiumTaxCreditPolicy-244"><span class="linenos">244</span></a>                <span class="k">if</span> <span class="n">high</span> <span class="o">==</span> <span class="n">low</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-245"><a href="#PremiumTaxCreditPolicy-245"><span class="linenos">245</span></a>                    <span class="k">return</span> <span class="n">min_cap</span>
</span><span id="PremiumTaxCreditPolicy-246"><a href="#PremiumTaxCreditPolicy-246"><span class="linenos">246</span></a>                <span class="n">bracket_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">fpl_percentage</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy-247"><a href="#PremiumTaxCreditPolicy-247"><span class="linenos">247</span></a>                <span class="k">return</span> <span class="n">min_cap</span> <span class="o">+</span> <span class="n">bracket_pct</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_cap</span> <span class="o">-</span> <span class="n">min_cap</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy-248"><a href="#PremiumTaxCreditPolicy-248"><span class="linenos">248</span></a>
</span><span id="PremiumTaxCreditPolicy-249"><a href="#PremiumTaxCreditPolicy-249"><span class="linenos">249</span></a>        <span class="c1"># Above all brackets</span>
</span><span id="PremiumTaxCreditPolicy-250"><a href="#PremiumTaxCreditPolicy-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="n">use_enhanced</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-251"><a href="#PremiumTaxCreditPolicy-251"><span class="linenos">251</span></a>            <span class="k">return</span> <span class="mf">0.085</span>  <span class="c1"># Enhanced caps at 8.5%</span>
</span><span id="PremiumTaxCreditPolicy-252"><a href="#PremiumTaxCreditPolicy-252"><span class="linenos">252</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-253"><a href="#PremiumTaxCreditPolicy-253"><span class="linenos">253</span></a>            <span class="k">return</span> <span class="mf">1.0</span>  <span class="c1"># No subsidy under original ACA above 400%</span>
</span><span id="PremiumTaxCreditPolicy-254"><a href="#PremiumTaxCreditPolicy-254"><span class="linenos">254</span></a>
</span><span id="PremiumTaxCreditPolicy-255"><a href="#PremiumTaxCreditPolicy-255"><span class="linenos">255</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_subsidy</span><span class="p">(</span>
</span><span id="PremiumTaxCreditPolicy-256"><a href="#PremiumTaxCreditPolicy-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-257"><a href="#PremiumTaxCreditPolicy-257"><span class="linenos">257</span></a>        <span class="n">income</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-258"><a href="#PremiumTaxCreditPolicy-258"><span class="linenos">258</span></a>        <span class="n">family_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-259"><a href="#PremiumTaxCreditPolicy-259"><span class="linenos">259</span></a>        <span class="n">benchmark_premium</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12000.0</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-260"><a href="#PremiumTaxCreditPolicy-260"><span class="linenos">260</span></a>        <span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-261"><a href="#PremiumTaxCreditPolicy-261"><span class="linenos">261</span></a>        <span class="n">use_enhanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-262"><a href="#PremiumTaxCreditPolicy-262"><span class="linenos">262</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-263"><a href="#PremiumTaxCreditPolicy-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-264"><a href="#PremiumTaxCreditPolicy-264"><span class="linenos">264</span></a><span class="sd">        Calculate PTC subsidy for a household.</span>
</span><span id="PremiumTaxCreditPolicy-265"><a href="#PremiumTaxCreditPolicy-265"><span class="linenos">265</span></a>
</span><span id="PremiumTaxCreditPolicy-266"><a href="#PremiumTaxCreditPolicy-266"><span class="linenos">266</span></a><span class="sd">        Args:</span>
</span><span id="PremiumTaxCreditPolicy-267"><a href="#PremiumTaxCreditPolicy-267"><span class="linenos">267</span></a><span class="sd">            income: Household income</span>
</span><span id="PremiumTaxCreditPolicy-268"><a href="#PremiumTaxCreditPolicy-268"><span class="linenos">268</span></a><span class="sd">            family_size: Number of people in household</span>
</span><span id="PremiumTaxCreditPolicy-269"><a href="#PremiumTaxCreditPolicy-269"><span class="linenos">269</span></a><span class="sd">            benchmark_premium: Second-lowest silver plan premium</span>
</span><span id="PremiumTaxCreditPolicy-270"><a href="#PremiumTaxCreditPolicy-270"><span class="linenos">270</span></a><span class="sd">            year: Tax year</span>
</span><span id="PremiumTaxCreditPolicy-271"><a href="#PremiumTaxCreditPolicy-271"><span class="linenos">271</span></a><span class="sd">            use_enhanced: Use enhanced credit structure</span>
</span><span id="PremiumTaxCreditPolicy-272"><a href="#PremiumTaxCreditPolicy-272"><span class="linenos">272</span></a>
</span><span id="PremiumTaxCreditPolicy-273"><a href="#PremiumTaxCreditPolicy-273"><span class="linenos">273</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy-274"><a href="#PremiumTaxCreditPolicy-274"><span class="linenos">274</span></a><span class="sd">            Dict with subsidy amount, premium cap, and expected contribution</span>
</span><span id="PremiumTaxCreditPolicy-275"><a href="#PremiumTaxCreditPolicy-275"><span class="linenos">275</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-276"><a href="#PremiumTaxCreditPolicy-276"><span class="linenos">276</span></a>        <span class="n">fpl</span> <span class="o">=</span> <span class="n">get_fpl</span><span class="p">(</span><span class="n">family_size</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy-277"><a href="#PremiumTaxCreditPolicy-277"><span class="linenos">277</span></a>        <span class="n">fpl_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">income</span> <span class="o">/</span> <span class="n">fpl</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="PremiumTaxCreditPolicy-278"><a href="#PremiumTaxCreditPolicy-278"><span class="linenos">278</span></a>
</span><span id="PremiumTaxCreditPolicy-279"><a href="#PremiumTaxCreditPolicy-279"><span class="linenos">279</span></a>        <span class="c1"># Check eligibility</span>
</span><span id="PremiumTaxCreditPolicy-280"><a href="#PremiumTaxCreditPolicy-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="n">use_enhanced</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-281"><a href="#PremiumTaxCreditPolicy-281"><span class="linenos">281</span></a>            <span class="n">eligible</span> <span class="o">=</span> <span class="n">fpl_pct</span> <span class="o">&gt;=</span> <span class="mi">100</span>  <span class="c1"># No upper limit under enhanced</span>
</span><span id="PremiumTaxCreditPolicy-282"><a href="#PremiumTaxCreditPolicy-282"><span class="linenos">282</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-283"><a href="#PremiumTaxCreditPolicy-283"><span class="linenos">283</span></a>            <span class="n">eligible</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">&lt;=</span> <span class="n">fpl_pct</span> <span class="o">&lt;=</span> <span class="mi">400</span>  <span class="c1"># Original ACA limits</span>
</span><span id="PremiumTaxCreditPolicy-284"><a href="#PremiumTaxCreditPolicy-284"><span class="linenos">284</span></a>
</span><span id="PremiumTaxCreditPolicy-285"><a href="#PremiumTaxCreditPolicy-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">eligible</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-286"><a href="#PremiumTaxCreditPolicy-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy-287"><a href="#PremiumTaxCreditPolicy-287"><span class="linenos">287</span></a>                <span class="s2">&quot;eligible&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-288"><a href="#PremiumTaxCreditPolicy-288"><span class="linenos">288</span></a>                <span class="s2">&quot;fpl_percentage&quot;</span><span class="p">:</span> <span class="n">fpl_pct</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-289"><a href="#PremiumTaxCreditPolicy-289"><span class="linenos">289</span></a>                <span class="s2">&quot;premium_cap&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-290"><a href="#PremiumTaxCreditPolicy-290"><span class="linenos">290</span></a>                <span class="s2">&quot;expected_contribution&quot;</span><span class="p">:</span> <span class="n">benchmark_premium</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-291"><a href="#PremiumTaxCreditPolicy-291"><span class="linenos">291</span></a>                <span class="s2">&quot;subsidy&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-292"><a href="#PremiumTaxCreditPolicy-292"><span class="linenos">292</span></a>            <span class="p">}</span>
</span><span id="PremiumTaxCreditPolicy-293"><a href="#PremiumTaxCreditPolicy-293"><span class="linenos">293</span></a>
</span><span id="PremiumTaxCreditPolicy-294"><a href="#PremiumTaxCreditPolicy-294"><span class="linenos">294</span></a>        <span class="c1"># Get premium cap</span>
</span><span id="PremiumTaxCreditPolicy-295"><a href="#PremiumTaxCreditPolicy-295"><span class="linenos">295</span></a>        <span class="n">premium_cap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_premium_cap</span><span class="p">(</span><span class="n">fpl_pct</span><span class="p">,</span> <span class="n">use_enhanced</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy-296"><a href="#PremiumTaxCreditPolicy-296"><span class="linenos">296</span></a>
</span><span id="PremiumTaxCreditPolicy-297"><a href="#PremiumTaxCreditPolicy-297"><span class="linenos">297</span></a>        <span class="c1"># Apply policy modifications</span>
</span><span id="PremiumTaxCreditPolicy-298"><a href="#PremiumTaxCreditPolicy-298"><span class="linenos">298</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_premium_cap</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_premium_cap_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-299"><a href="#PremiumTaxCreditPolicy-299"><span class="linenos">299</span></a>            <span class="n">premium_cap</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">premium_cap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_premium_cap_max</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy-300"><a href="#PremiumTaxCreditPolicy-300"><span class="linenos">300</span></a>        <span class="n">premium_cap</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">premium_cap_change</span>
</span><span id="PremiumTaxCreditPolicy-301"><a href="#PremiumTaxCreditPolicy-301"><span class="linenos">301</span></a>
</span><span id="PremiumTaxCreditPolicy-302"><a href="#PremiumTaxCreditPolicy-302"><span class="linenos">302</span></a>        <span class="c1"># Calculate expected contribution and subsidy</span>
</span><span id="PremiumTaxCreditPolicy-303"><a href="#PremiumTaxCreditPolicy-303"><span class="linenos">303</span></a>        <span class="n">expected_contribution</span> <span class="o">=</span> <span class="n">income</span> <span class="o">*</span> <span class="n">premium_cap</span>
</span><span id="PremiumTaxCreditPolicy-304"><a href="#PremiumTaxCreditPolicy-304"><span class="linenos">304</span></a>        <span class="n">subsidy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">benchmark_premium</span> <span class="o">-</span> <span class="n">expected_contribution</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy-305"><a href="#PremiumTaxCreditPolicy-305"><span class="linenos">305</span></a>
</span><span id="PremiumTaxCreditPolicy-306"><a href="#PremiumTaxCreditPolicy-306"><span class="linenos">306</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy-307"><a href="#PremiumTaxCreditPolicy-307"><span class="linenos">307</span></a>            <span class="s2">&quot;eligible&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-308"><a href="#PremiumTaxCreditPolicy-308"><span class="linenos">308</span></a>            <span class="s2">&quot;fpl_percentage&quot;</span><span class="p">:</span> <span class="n">fpl_pct</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-309"><a href="#PremiumTaxCreditPolicy-309"><span class="linenos">309</span></a>            <span class="s2">&quot;premium_cap&quot;</span><span class="p">:</span> <span class="n">premium_cap</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-310"><a href="#PremiumTaxCreditPolicy-310"><span class="linenos">310</span></a>            <span class="s2">&quot;expected_contribution&quot;</span><span class="p">:</span> <span class="n">expected_contribution</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-311"><a href="#PremiumTaxCreditPolicy-311"><span class="linenos">311</span></a>            <span class="s2">&quot;subsidy&quot;</span><span class="p">:</span> <span class="n">subsidy</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-312"><a href="#PremiumTaxCreditPolicy-312"><span class="linenos">312</span></a>        <span class="p">}</span>
</span><span id="PremiumTaxCreditPolicy-313"><a href="#PremiumTaxCreditPolicy-313"><span class="linenos">313</span></a>
</span><span id="PremiumTaxCreditPolicy-314"><a href="#PremiumTaxCreditPolicy-314"><span class="linenos">314</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_coverage_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-315"><a href="#PremiumTaxCreditPolicy-315"><span class="linenos">315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-316"><a href="#PremiumTaxCreditPolicy-316"><span class="linenos">316</span></a><span class="sd">        Estimate coverage effects of policy change.</span>
</span><span id="PremiumTaxCreditPolicy-317"><a href="#PremiumTaxCreditPolicy-317"><span class="linenos">317</span></a>
</span><span id="PremiumTaxCreditPolicy-318"><a href="#PremiumTaxCreditPolicy-318"><span class="linenos">318</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy-319"><a href="#PremiumTaxCreditPolicy-319"><span class="linenos">319</span></a><span class="sd">            Dict with coverage gains/losses</span>
</span><span id="PremiumTaxCreditPolicy-320"><a href="#PremiumTaxCreditPolicy-320"><span class="linenos">320</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-321"><a href="#PremiumTaxCreditPolicy-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_ptc</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-322"><a href="#PremiumTaxCreditPolicy-322"><span class="linenos">322</span></a>            <span class="c1"># Full repeal loses all subsidized coverage</span>
</span><span id="PremiumTaxCreditPolicy-323"><a href="#PremiumTaxCreditPolicy-323"><span class="linenos">323</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy-324"><a href="#PremiumTaxCreditPolicy-324"><span class="linenos">324</span></a>                <span class="s2">&quot;coverage_change_millions&quot;</span><span class="p">:</span> <span class="o">-</span><span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;receiving_ptc_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy-325"><a href="#PremiumTaxCreditPolicy-325"><span class="linenos">325</span></a>                <span class="s2">&quot;uninsured_change_millions&quot;</span><span class="p">:</span> <span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;receiving_ptc_millions&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-326"><a href="#PremiumTaxCreditPolicy-326"><span class="linenos">326</span></a>            <span class="p">}</span>
</span><span id="PremiumTaxCreditPolicy-327"><a href="#PremiumTaxCreditPolicy-327"><span class="linenos">327</span></a>
</span><span id="PremiumTaxCreditPolicy-328"><a href="#PremiumTaxCreditPolicy-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_enhanced</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_permanent</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-329"><a href="#PremiumTaxCreditPolicy-329"><span class="linenos">329</span></a>            <span class="c1"># Extending prevents coverage loss</span>
</span><span id="PremiumTaxCreditPolicy-330"><a href="#PremiumTaxCreditPolicy-330"><span class="linenos">330</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy-331"><a href="#PremiumTaxCreditPolicy-331"><span class="linenos">331</span></a>                <span class="s2">&quot;coverage_change_millions&quot;</span><span class="p">:</span> <span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;coverage_loss_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy-332"><a href="#PremiumTaxCreditPolicy-332"><span class="linenos">332</span></a>                <span class="s2">&quot;uninsured_change_millions&quot;</span><span class="p">:</span> <span class="o">-</span><span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;coverage_loss_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy-333"><a href="#PremiumTaxCreditPolicy-333"><span class="linenos">333</span></a>            <span class="p">}</span>
</span><span id="PremiumTaxCreditPolicy-334"><a href="#PremiumTaxCreditPolicy-334"><span class="linenos">334</span></a>
</span><span id="PremiumTaxCreditPolicy-335"><a href="#PremiumTaxCreditPolicy-335"><span class="linenos">335</span></a>        <span class="c1"># Letting enhanced expire (current law baseline)</span>
</span><span id="PremiumTaxCreditPolicy-336"><a href="#PremiumTaxCreditPolicy-336"><span class="linenos">336</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy-337"><a href="#PremiumTaxCreditPolicy-337"><span class="linenos">337</span></a>            <span class="s2">&quot;coverage_change_millions&quot;</span><span class="p">:</span> <span class="o">-</span><span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;coverage_loss_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy-338"><a href="#PremiumTaxCreditPolicy-338"><span class="linenos">338</span></a>            <span class="s2">&quot;uninsured_change_millions&quot;</span><span class="p">:</span> <span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;coverage_loss_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy-339"><a href="#PremiumTaxCreditPolicy-339"><span class="linenos">339</span></a>        <span class="p">}</span>
</span><span id="PremiumTaxCreditPolicy-340"><a href="#PremiumTaxCreditPolicy-340"><span class="linenos">340</span></a>
</span><span id="PremiumTaxCreditPolicy-341"><a href="#PremiumTaxCreditPolicy-341"><span class="linenos">341</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="PremiumTaxCreditPolicy-342"><a href="#PremiumTaxCreditPolicy-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-343"><a href="#PremiumTaxCreditPolicy-343"><span class="linenos">343</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-344"><a href="#PremiumTaxCreditPolicy-344"><span class="linenos">344</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy-345"><a href="#PremiumTaxCreditPolicy-345"><span class="linenos">345</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-346"><a href="#PremiumTaxCreditPolicy-346"><span class="linenos">346</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-347"><a href="#PremiumTaxCreditPolicy-347"><span class="linenos">347</span></a><span class="sd">        Estimate static revenue effect of PTC policy change.</span>
</span><span id="PremiumTaxCreditPolicy-348"><a href="#PremiumTaxCreditPolicy-348"><span class="linenos">348</span></a>
</span><span id="PremiumTaxCreditPolicy-349"><a href="#PremiumTaxCreditPolicy-349"><span class="linenos">349</span></a><span class="sd">        For PTCs, revenue effect = change in outlays (negative = costs money).</span>
</span><span id="PremiumTaxCreditPolicy-350"><a href="#PremiumTaxCreditPolicy-350"><span class="linenos">350</span></a>
</span><span id="PremiumTaxCreditPolicy-351"><a href="#PremiumTaxCreditPolicy-351"><span class="linenos">351</span></a><span class="sd">        Args:</span>
</span><span id="PremiumTaxCreditPolicy-352"><a href="#PremiumTaxCreditPolicy-352"><span class="linenos">352</span></a><span class="sd">            baseline_revenue: Baseline revenue (not used)</span>
</span><span id="PremiumTaxCreditPolicy-353"><a href="#PremiumTaxCreditPolicy-353"><span class="linenos">353</span></a><span class="sd">            use_real_data: Whether to use detailed calculations</span>
</span><span id="PremiumTaxCreditPolicy-354"><a href="#PremiumTaxCreditPolicy-354"><span class="linenos">354</span></a>
</span><span id="PremiumTaxCreditPolicy-355"><a href="#PremiumTaxCreditPolicy-355"><span class="linenos">355</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy-356"><a href="#PremiumTaxCreditPolicy-356"><span class="linenos">356</span></a><span class="sd">            Revenue change in billions (negative = cost increase)</span>
</span><span id="PremiumTaxCreditPolicy-357"><a href="#PremiumTaxCreditPolicy-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-358"><a href="#PremiumTaxCreditPolicy-358"><span class="linenos">358</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-359"><a href="#PremiumTaxCreditPolicy-359"><span class="linenos">359</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="PremiumTaxCreditPolicy-360"><a href="#PremiumTaxCreditPolicy-360"><span class="linenos">360</span></a>
</span><span id="PremiumTaxCreditPolicy-361"><a href="#PremiumTaxCreditPolicy-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_ptc</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-362"><a href="#PremiumTaxCreditPolicy-362"><span class="linenos">362</span></a>            <span class="c1"># Repealing PTCs saves all PTC spending</span>
</span><span id="PremiumTaxCreditPolicy-363"><a href="#PremiumTaxCreditPolicy-363"><span class="linenos">363</span></a>            <span class="k">return</span> <span class="n">CBO_PTC_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;baseline_enhanced_annual&quot;</span><span class="p">]</span>
</span><span id="PremiumTaxCreditPolicy-364"><a href="#PremiumTaxCreditPolicy-364"><span class="linenos">364</span></a>
</span><span id="PremiumTaxCreditPolicy-365"><a href="#PremiumTaxCreditPolicy-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_enhanced</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_permanent</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-366"><a href="#PremiumTaxCreditPolicy-366"><span class="linenos">366</span></a>            <span class="c1"># Cost of extending enhanced PTCs</span>
</span><span id="PremiumTaxCreditPolicy-367"><a href="#PremiumTaxCreditPolicy-367"><span class="linenos">367</span></a>            <span class="c1"># Difference between enhanced and original ACA baseline</span>
</span><span id="PremiumTaxCreditPolicy-368"><a href="#PremiumTaxCreditPolicy-368"><span class="linenos">368</span></a>            <span class="n">enhanced_cost</span> <span class="o">=</span> <span class="n">CBO_PTC_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;baseline_enhanced_annual&quot;</span><span class="p">]</span>
</span><span id="PremiumTaxCreditPolicy-369"><a href="#PremiumTaxCreditPolicy-369"><span class="linenos">369</span></a>            <span class="n">original_cost</span> <span class="o">=</span> <span class="n">CBO_PTC_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;baseline_original_annual&quot;</span><span class="p">]</span>
</span><span id="PremiumTaxCreditPolicy-370"><a href="#PremiumTaxCreditPolicy-370"><span class="linenos">370</span></a>            <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">enhanced_cost</span> <span class="o">-</span> <span class="n">original_cost</span><span class="p">)</span>  <span class="c1"># Additional cost</span>
</span><span id="PremiumTaxCreditPolicy-371"><a href="#PremiumTaxCreditPolicy-371"><span class="linenos">371</span></a>
</span><span id="PremiumTaxCreditPolicy-372"><a href="#PremiumTaxCreditPolicy-372"><span class="linenos">372</span></a>        <span class="c1"># Premium cap modifications</span>
</span><span id="PremiumTaxCreditPolicy-373"><a href="#PremiumTaxCreditPolicy-373"><span class="linenos">373</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_premium_cap</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">premium_cap_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-374"><a href="#PremiumTaxCreditPolicy-374"><span class="linenos">374</span></a>            <span class="c1"># Lower caps = higher subsidies = more cost</span>
</span><span id="PremiumTaxCreditPolicy-375"><a href="#PremiumTaxCreditPolicy-375"><span class="linenos">375</span></a>            <span class="c1"># Rough estimate: 1pp cap reduction = ~$10B/year</span>
</span><span id="PremiumTaxCreditPolicy-376"><a href="#PremiumTaxCreditPolicy-376"><span class="linenos">376</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">premium_cap_change</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># Billions per 1pp</span>
</span><span id="PremiumTaxCreditPolicy-377"><a href="#PremiumTaxCreditPolicy-377"><span class="linenos">377</span></a>
</span><span id="PremiumTaxCreditPolicy-378"><a href="#PremiumTaxCreditPolicy-378"><span class="linenos">378</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="PremiumTaxCreditPolicy-379"><a href="#PremiumTaxCreditPolicy-379"><span class="linenos">379</span></a>
</span><span id="PremiumTaxCreditPolicy-380"><a href="#PremiumTaxCreditPolicy-380"><span class="linenos">380</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-381"><a href="#PremiumTaxCreditPolicy-381"><span class="linenos">381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-382"><a href="#PremiumTaxCreditPolicy-382"><span class="linenos">382</span></a><span class="sd">        Estimate behavioral response to PTC changes.</span>
</span><span id="PremiumTaxCreditPolicy-383"><a href="#PremiumTaxCreditPolicy-383"><span class="linenos">383</span></a>
</span><span id="PremiumTaxCreditPolicy-384"><a href="#PremiumTaxCreditPolicy-384"><span class="linenos">384</span></a><span class="sd">        Behavioral responses include:</span>
</span><span id="PremiumTaxCreditPolicy-385"><a href="#PremiumTaxCreditPolicy-385"><span class="linenos">385</span></a><span class="sd">        - Coverage changes (more/fewer insured)</span>
</span><span id="PremiumTaxCreditPolicy-386"><a href="#PremiumTaxCreditPolicy-386"><span class="linenos">386</span></a><span class="sd">        - Premium spiral effects (adverse selection)</span>
</span><span id="PremiumTaxCreditPolicy-387"><a href="#PremiumTaxCreditPolicy-387"><span class="linenos">387</span></a><span class="sd">        - Labor supply effects (subsidy cliff)</span>
</span><span id="PremiumTaxCreditPolicy-388"><a href="#PremiumTaxCreditPolicy-388"><span class="linenos">388</span></a>
</span><span id="PremiumTaxCreditPolicy-389"><a href="#PremiumTaxCreditPolicy-389"><span class="linenos">389</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy-390"><a href="#PremiumTaxCreditPolicy-390"><span class="linenos">390</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="PremiumTaxCreditPolicy-391"><a href="#PremiumTaxCreditPolicy-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy-392"><a href="#PremiumTaxCreditPolicy-392"><span class="linenos">392</span></a>        <span class="c1"># Coverage effects affect healthcare costs elsewhere</span>
</span><span id="PremiumTaxCreditPolicy-393"><a href="#PremiumTaxCreditPolicy-393"><span class="linenos">393</span></a>        <span class="n">coverage_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coverage_elasticity</span> <span class="o">*</span> <span class="mf">0.1</span>
</span><span id="PremiumTaxCreditPolicy-394"><a href="#PremiumTaxCreditPolicy-394"><span class="linenos">394</span></a>
</span><span id="PremiumTaxCreditPolicy-395"><a href="#PremiumTaxCreditPolicy-395"><span class="linenos">395</span></a>        <span class="c1"># Adverse selection if coverage drops</span>
</span><span id="PremiumTaxCreditPolicy-396"><a href="#PremiumTaxCreditPolicy-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Saving money = losing coverage</span>
</span><span id="PremiumTaxCreditPolicy-397"><a href="#PremiumTaxCreditPolicy-397"><span class="linenos">397</span></a>            <span class="n">adverse_selection</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">adverse_selection_factor</span>
</span><span id="PremiumTaxCreditPolicy-398"><a href="#PremiumTaxCreditPolicy-398"><span class="linenos">398</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-399"><a href="#PremiumTaxCreditPolicy-399"><span class="linenos">399</span></a>            <span class="n">adverse_selection</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="PremiumTaxCreditPolicy-400"><a href="#PremiumTaxCreditPolicy-400"><span class="linenos">400</span></a>
</span><span id="PremiumTaxCreditPolicy-401"><a href="#PremiumTaxCreditPolicy-401"><span class="linenos">401</span></a>        <span class="n">total_offset</span> <span class="o">=</span> <span class="n">coverage_offset</span> <span class="o">+</span> <span class="n">adverse_selection</span>
</span><span id="PremiumTaxCreditPolicy-402"><a href="#PremiumTaxCreditPolicy-402"><span class="linenos">402</span></a>
</span><span id="PremiumTaxCreditPolicy-403"><a href="#PremiumTaxCreditPolicy-403"><span class="linenos">403</span></a>        <span class="c1"># Direction: if saving money (cutting subsidies), costs go up elsewhere</span>
</span><span id="PremiumTaxCreditPolicy-404"><a href="#PremiumTaxCreditPolicy-404"><span class="linenos">404</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-405"><a href="#PremiumTaxCreditPolicy-405"><span class="linenos">405</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">total_offset</span>  <span class="c1"># Reduces savings</span>
</span><span id="PremiumTaxCreditPolicy-406"><a href="#PremiumTaxCreditPolicy-406"><span class="linenos">406</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy-407"><a href="#PremiumTaxCreditPolicy-407"><span class="linenos">407</span></a>            <span class="k">return</span> <span class="n">total_offset</span>  <span class="c1"># Reduces cost</span>
</span></pre></div>


            <div class="docstring"><p>Premium Tax Credit policy modeling ACA marketplace subsidies.</p>

<p>Models premium subsidy changes including:</p>

<ul>
<li>Enhanced vs original ACA credit structure</li>
<li>Income eligibility thresholds</li>
<li>Premium cap changes</li>
<li>Coverage effects</li>
</ul>

<p>Key parameters:
    scenario: Type of PTC policy change
    extend_enhanced: Extend enhanced PTCs past 2025
    make_permanent: Make enhanced PTCs permanent
    repeal_ptc: Eliminate PTCs entirely
    modify_premium_cap: Change premium cap percentages
    modify_income_limit: Change FPL eligibility limits</p>
</div>


                            <div id="PremiumTaxCreditPolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PremiumTaxCreditPolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">scenario</span><span class="p">:</span> <span class="n"><a href="#PTCScenario">PTCScenario</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#PTCScenario.EXTEND_ENHANCED">PTCScenario.EXTEND_ENHANCED</a></span><span class="p">:</span> <span class="s1">&#39;extend_enhanced&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">extend_enhanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">make_permanent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">extension_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">repeal_ptc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">modify_premium_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">new_premium_cap_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">premium_cap_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">modify_income_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">new_upper_fpl_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">new_lower_fpl_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">coverage_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span>,</span><span class="param">	<span class="n">take_up_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.85</span>,</span><span class="param">	<span class="n">adverse_selection_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">healthcare_growth_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.04</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.__init__"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.scenario" class="classattr">
                                <div class="attr variable">
            <span class="name">scenario</span><span class="annotation">: <a href="#PTCScenario">PTCScenario</a></span>        =
<span class="default_value">&lt;<a href="#PTCScenario.EXTEND_ENHANCED">PTCScenario.EXTEND_ENHANCED</a>: &#39;extend_enhanced&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.scenario"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.extend_enhanced" class="classattr">
                                <div class="attr variable">
            <span class="name">extend_enhanced</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.extend_enhanced"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.make_permanent" class="classattr">
                                <div class="attr variable">
            <span class="name">make_permanent</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.make_permanent"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.extension_years" class="classattr">
                                <div class="attr variable">
            <span class="name">extension_years</span><span class="annotation">: int</span>        =
<span class="default_value">10</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.extension_years"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.repeal_ptc" class="classattr">
                                <div class="attr variable">
            <span class="name">repeal_ptc</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.repeal_ptc"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.modify_premium_cap" class="classattr">
                                <div class="attr variable">
            <span class="name">modify_premium_cap</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.modify_premium_cap"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.new_premium_cap_max" class="classattr">
                                <div class="attr variable">
            <span class="name">new_premium_cap_max</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.new_premium_cap_max"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.premium_cap_change" class="classattr">
                                <div class="attr variable">
            <span class="name">premium_cap_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.premium_cap_change"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.modify_income_limit" class="classattr">
                                <div class="attr variable">
            <span class="name">modify_income_limit</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.modify_income_limit"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.new_upper_fpl_limit" class="classattr">
                                <div class="attr variable">
            <span class="name">new_upper_fpl_limit</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.new_upper_fpl_limit"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.new_lower_fpl_limit" class="classattr">
                                <div class="attr variable">
            <span class="name">new_lower_fpl_limit</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.new_lower_fpl_limit"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.coverage_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">coverage_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.3</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.coverage_elasticity"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.take_up_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">take_up_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.85</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.take_up_rate"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.adverse_selection_factor" class="classattr">
                                <div class="attr variable">
            <span class="name">adverse_selection_factor</span><span class="annotation">: float</span>        =
<span class="default_value">0.1</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.adverse_selection_factor"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.healthcare_growth_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">healthcare_growth_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.04</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.healthcare_growth_rate"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.annual_revenue_change_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_revenue_change_billions</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.annual_revenue_change_billions"></a>
    
    

                            </div>
                            <div id="PremiumTaxCreditPolicy.get_premium_cap" class="classattr">
                                        <input id="PremiumTaxCreditPolicy.get_premium_cap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_premium_cap</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">fpl_percentage</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_enhanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="PremiumTaxCreditPolicy.get_premium_cap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.get_premium_cap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PremiumTaxCreditPolicy.get_premium_cap-224"><a href="#PremiumTaxCreditPolicy.get_premium_cap-224"><span class="linenos">224</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_premium_cap</span><span class="p">(</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-225"><a href="#PremiumTaxCreditPolicy.get_premium_cap-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-226"><a href="#PremiumTaxCreditPolicy.get_premium_cap-226"><span class="linenos">226</span></a>        <span class="n">fpl_percentage</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-227"><a href="#PremiumTaxCreditPolicy.get_premium_cap-227"><span class="linenos">227</span></a>        <span class="n">use_enhanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-228"><a href="#PremiumTaxCreditPolicy.get_premium_cap-228"><span class="linenos">228</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-229"><a href="#PremiumTaxCreditPolicy.get_premium_cap-229"><span class="linenos">229</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-230"><a href="#PremiumTaxCreditPolicy.get_premium_cap-230"><span class="linenos">230</span></a><span class="sd">        Get premium cap as percentage of income for given FPL level.</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-231"><a href="#PremiumTaxCreditPolicy.get_premium_cap-231"><span class="linenos">231</span></a>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-232"><a href="#PremiumTaxCreditPolicy.get_premium_cap-232"><span class="linenos">232</span></a><span class="sd">        Args:</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-233"><a href="#PremiumTaxCreditPolicy.get_premium_cap-233"><span class="linenos">233</span></a><span class="sd">            fpl_percentage: Household income as % of FPL (e.g., 250 = 250% FPL)</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-234"><a href="#PremiumTaxCreditPolicy.get_premium_cap-234"><span class="linenos">234</span></a><span class="sd">            use_enhanced: Use enhanced (ARPA/IRA) caps vs original ACA</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-235"><a href="#PremiumTaxCreditPolicy.get_premium_cap-235"><span class="linenos">235</span></a>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-236"><a href="#PremiumTaxCreditPolicy.get_premium_cap-236"><span class="linenos">236</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-237"><a href="#PremiumTaxCreditPolicy.get_premium_cap-237"><span class="linenos">237</span></a><span class="sd">            Premium cap as decimal (e.g., 0.085 = 8.5%)</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-238"><a href="#PremiumTaxCreditPolicy.get_premium_cap-238"><span class="linenos">238</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-239"><a href="#PremiumTaxCreditPolicy.get_premium_cap-239"><span class="linenos">239</span></a>        <span class="n">caps</span> <span class="o">=</span> <span class="n">ENHANCED_PTC_CAPS</span> <span class="k">if</span> <span class="n">use_enhanced</span> <span class="k">else</span> <span class="n">ORIGINAL_ACA_CAPS</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-240"><a href="#PremiumTaxCreditPolicy.get_premium_cap-240"><span class="linenos">240</span></a>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-241"><a href="#PremiumTaxCreditPolicy.get_premium_cap-241"><span class="linenos">241</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">),</span> <span class="p">(</span><span class="n">min_cap</span><span class="p">,</span> <span class="n">max_cap</span><span class="p">)</span> <span class="ow">in</span> <span class="n">caps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-242"><a href="#PremiumTaxCreditPolicy.get_premium_cap-242"><span class="linenos">242</span></a>            <span class="k">if</span> <span class="n">low</span> <span class="o">&lt;=</span> <span class="n">fpl_percentage</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-243"><a href="#PremiumTaxCreditPolicy.get_premium_cap-243"><span class="linenos">243</span></a>                <span class="c1"># Linear interpolation within bracket</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-244"><a href="#PremiumTaxCreditPolicy.get_premium_cap-244"><span class="linenos">244</span></a>                <span class="k">if</span> <span class="n">high</span> <span class="o">==</span> <span class="n">low</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-245"><a href="#PremiumTaxCreditPolicy.get_premium_cap-245"><span class="linenos">245</span></a>                    <span class="k">return</span> <span class="n">min_cap</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-246"><a href="#PremiumTaxCreditPolicy.get_premium_cap-246"><span class="linenos">246</span></a>                <span class="n">bracket_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">fpl_percentage</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-247"><a href="#PremiumTaxCreditPolicy.get_premium_cap-247"><span class="linenos">247</span></a>                <span class="k">return</span> <span class="n">min_cap</span> <span class="o">+</span> <span class="n">bracket_pct</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_cap</span> <span class="o">-</span> <span class="n">min_cap</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-248"><a href="#PremiumTaxCreditPolicy.get_premium_cap-248"><span class="linenos">248</span></a>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-249"><a href="#PremiumTaxCreditPolicy.get_premium_cap-249"><span class="linenos">249</span></a>        <span class="c1"># Above all brackets</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-250"><a href="#PremiumTaxCreditPolicy.get_premium_cap-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="n">use_enhanced</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-251"><a href="#PremiumTaxCreditPolicy.get_premium_cap-251"><span class="linenos">251</span></a>            <span class="k">return</span> <span class="mf">0.085</span>  <span class="c1"># Enhanced caps at 8.5%</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-252"><a href="#PremiumTaxCreditPolicy.get_premium_cap-252"><span class="linenos">252</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.get_premium_cap-253"><a href="#PremiumTaxCreditPolicy.get_premium_cap-253"><span class="linenos">253</span></a>            <span class="k">return</span> <span class="mf">1.0</span>  <span class="c1"># No subsidy under original ACA above 400%</span>
</span></pre></div>


            <div class="docstring"><p>Get premium cap as percentage of income for given FPL level.</p>

<p>Args:
    fpl_percentage: Household income as % of FPL (e.g., 250 = 250% FPL)
    use_enhanced: Use enhanced (ARPA/IRA) caps vs original ACA</p>

<p>Returns:
    Premium cap as decimal (e.g., 0.085 = 8.5%)</p>
</div>


                            </div>
                            <div id="PremiumTaxCreditPolicy.calculate_subsidy" class="classattr">
                                        <input id="PremiumTaxCreditPolicy.calculate_subsidy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_subsidy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">income</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">family_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">benchmark_premium</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12000.0</span>,</span><span class="param">	<span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">use_enhanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PremiumTaxCreditPolicy.calculate_subsidy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.calculate_subsidy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PremiumTaxCreditPolicy.calculate_subsidy-255"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-255"><span class="linenos">255</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_subsidy</span><span class="p">(</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-256"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-257"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-257"><span class="linenos">257</span></a>        <span class="n">income</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-258"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-258"><span class="linenos">258</span></a>        <span class="n">family_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-259"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-259"><span class="linenos">259</span></a>        <span class="n">benchmark_premium</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12000.0</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-260"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-260"><span class="linenos">260</span></a>        <span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-261"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-261"><span class="linenos">261</span></a>        <span class="n">use_enhanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-262"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-262"><span class="linenos">262</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-263"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-264"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-264"><span class="linenos">264</span></a><span class="sd">        Calculate PTC subsidy for a household.</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-265"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-265"><span class="linenos">265</span></a>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-266"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-266"><span class="linenos">266</span></a><span class="sd">        Args:</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-267"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-267"><span class="linenos">267</span></a><span class="sd">            income: Household income</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-268"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-268"><span class="linenos">268</span></a><span class="sd">            family_size: Number of people in household</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-269"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-269"><span class="linenos">269</span></a><span class="sd">            benchmark_premium: Second-lowest silver plan premium</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-270"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-270"><span class="linenos">270</span></a><span class="sd">            year: Tax year</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-271"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-271"><span class="linenos">271</span></a><span class="sd">            use_enhanced: Use enhanced credit structure</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-272"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-272"><span class="linenos">272</span></a>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-273"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-273"><span class="linenos">273</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-274"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-274"><span class="linenos">274</span></a><span class="sd">            Dict with subsidy amount, premium cap, and expected contribution</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-275"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-275"><span class="linenos">275</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-276"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-276"><span class="linenos">276</span></a>        <span class="n">fpl</span> <span class="o">=</span> <span class="n">get_fpl</span><span class="p">(</span><span class="n">family_size</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-277"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-277"><span class="linenos">277</span></a>        <span class="n">fpl_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">income</span> <span class="o">/</span> <span class="n">fpl</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-278"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-278"><span class="linenos">278</span></a>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-279"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-279"><span class="linenos">279</span></a>        <span class="c1"># Check eligibility</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-280"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="n">use_enhanced</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-281"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-281"><span class="linenos">281</span></a>            <span class="n">eligible</span> <span class="o">=</span> <span class="n">fpl_pct</span> <span class="o">&gt;=</span> <span class="mi">100</span>  <span class="c1"># No upper limit under enhanced</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-282"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-282"><span class="linenos">282</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-283"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-283"><span class="linenos">283</span></a>            <span class="n">eligible</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">&lt;=</span> <span class="n">fpl_pct</span> <span class="o">&lt;=</span> <span class="mi">400</span>  <span class="c1"># Original ACA limits</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-284"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-284"><span class="linenos">284</span></a>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-285"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">eligible</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-286"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-287"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-287"><span class="linenos">287</span></a>                <span class="s2">&quot;eligible&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-288"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-288"><span class="linenos">288</span></a>                <span class="s2">&quot;fpl_percentage&quot;</span><span class="p">:</span> <span class="n">fpl_pct</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-289"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-289"><span class="linenos">289</span></a>                <span class="s2">&quot;premium_cap&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-290"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-290"><span class="linenos">290</span></a>                <span class="s2">&quot;expected_contribution&quot;</span><span class="p">:</span> <span class="n">benchmark_premium</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-291"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-291"><span class="linenos">291</span></a>                <span class="s2">&quot;subsidy&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-292"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-292"><span class="linenos">292</span></a>            <span class="p">}</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-293"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-293"><span class="linenos">293</span></a>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-294"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-294"><span class="linenos">294</span></a>        <span class="c1"># Get premium cap</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-295"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-295"><span class="linenos">295</span></a>        <span class="n">premium_cap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_premium_cap</span><span class="p">(</span><span class="n">fpl_pct</span><span class="p">,</span> <span class="n">use_enhanced</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-296"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-296"><span class="linenos">296</span></a>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-297"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-297"><span class="linenos">297</span></a>        <span class="c1"># Apply policy modifications</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-298"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-298"><span class="linenos">298</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_premium_cap</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_premium_cap_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-299"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-299"><span class="linenos">299</span></a>            <span class="n">premium_cap</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">premium_cap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_premium_cap_max</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-300"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-300"><span class="linenos">300</span></a>        <span class="n">premium_cap</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">premium_cap_change</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-301"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-301"><span class="linenos">301</span></a>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-302"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-302"><span class="linenos">302</span></a>        <span class="c1"># Calculate expected contribution and subsidy</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-303"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-303"><span class="linenos">303</span></a>        <span class="n">expected_contribution</span> <span class="o">=</span> <span class="n">income</span> <span class="o">*</span> <span class="n">premium_cap</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-304"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-304"><span class="linenos">304</span></a>        <span class="n">subsidy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">benchmark_premium</span> <span class="o">-</span> <span class="n">expected_contribution</span><span class="p">)</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-305"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-305"><span class="linenos">305</span></a>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-306"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-306"><span class="linenos">306</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-307"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-307"><span class="linenos">307</span></a>            <span class="s2">&quot;eligible&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-308"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-308"><span class="linenos">308</span></a>            <span class="s2">&quot;fpl_percentage&quot;</span><span class="p">:</span> <span class="n">fpl_pct</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-309"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-309"><span class="linenos">309</span></a>            <span class="s2">&quot;premium_cap&quot;</span><span class="p">:</span> <span class="n">premium_cap</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-310"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-310"><span class="linenos">310</span></a>            <span class="s2">&quot;expected_contribution&quot;</span><span class="p">:</span> <span class="n">expected_contribution</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-311"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-311"><span class="linenos">311</span></a>            <span class="s2">&quot;subsidy&quot;</span><span class="p">:</span> <span class="n">subsidy</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.calculate_subsidy-312"><a href="#PremiumTaxCreditPolicy.calculate_subsidy-312"><span class="linenos">312</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Calculate PTC subsidy for a household.</p>

<p>Args:
    income: Household income
    family_size: Number of people in household
    benchmark_premium: Second-lowest silver plan premium
    year: Tax year
    use_enhanced: Use enhanced credit structure</p>

<p>Returns:
    Dict with subsidy amount, premium cap, and expected contribution</p>
</div>


                            </div>
                            <div id="PremiumTaxCreditPolicy.estimate_coverage_effect" class="classattr">
                                        <input id="PremiumTaxCreditPolicy.estimate_coverage_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_coverage_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PremiumTaxCreditPolicy.estimate_coverage_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.estimate_coverage_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-314"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-314"><span class="linenos">314</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_coverage_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-315"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-315"><span class="linenos">315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-316"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-316"><span class="linenos">316</span></a><span class="sd">        Estimate coverage effects of policy change.</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-317"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-317"><span class="linenos">317</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-318"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-318"><span class="linenos">318</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-319"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-319"><span class="linenos">319</span></a><span class="sd">            Dict with coverage gains/losses</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-320"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-320"><span class="linenos">320</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-321"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_ptc</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-322"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-322"><span class="linenos">322</span></a>            <span class="c1"># Full repeal loses all subsidized coverage</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-323"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-323"><span class="linenos">323</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-324"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-324"><span class="linenos">324</span></a>                <span class="s2">&quot;coverage_change_millions&quot;</span><span class="p">:</span> <span class="o">-</span><span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;receiving_ptc_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-325"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-325"><span class="linenos">325</span></a>                <span class="s2">&quot;uninsured_change_millions&quot;</span><span class="p">:</span> <span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;receiving_ptc_millions&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-326"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-326"><span class="linenos">326</span></a>            <span class="p">}</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-327"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-327"><span class="linenos">327</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-328"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_enhanced</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_permanent</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-329"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-329"><span class="linenos">329</span></a>            <span class="c1"># Extending prevents coverage loss</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-330"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-330"><span class="linenos">330</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-331"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-331"><span class="linenos">331</span></a>                <span class="s2">&quot;coverage_change_millions&quot;</span><span class="p">:</span> <span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;coverage_loss_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-332"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-332"><span class="linenos">332</span></a>                <span class="s2">&quot;uninsured_change_millions&quot;</span><span class="p">:</span> <span class="o">-</span><span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;coverage_loss_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-333"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-333"><span class="linenos">333</span></a>            <span class="p">}</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-334"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-334"><span class="linenos">334</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-335"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-335"><span class="linenos">335</span></a>        <span class="c1"># Letting enhanced expire (current law baseline)</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-336"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-336"><span class="linenos">336</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-337"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-337"><span class="linenos">337</span></a>            <span class="s2">&quot;coverage_change_millions&quot;</span><span class="p">:</span> <span class="o">-</span><span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;coverage_loss_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-338"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-338"><span class="linenos">338</span></a>            <span class="s2">&quot;uninsured_change_millions&quot;</span><span class="p">:</span> <span class="n">MARKETPLACE_DATA</span><span class="p">[</span><span class="s2">&quot;coverage_loss_millions&quot;</span><span class="p">],</span>
</span><span id="PremiumTaxCreditPolicy.estimate_coverage_effect-339"><a href="#PremiumTaxCreditPolicy.estimate_coverage_effect-339"><span class="linenos">339</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Estimate coverage effects of policy change.</p>

<p>Returns:
    Dict with coverage gains/losses</p>
</div>


                            </div>
                            <div id="PremiumTaxCreditPolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="PremiumTaxCreditPolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-341"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-341"><span class="linenos">341</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-342"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-343"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-343"><span class="linenos">343</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-344"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-344"><span class="linenos">344</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-345"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-345"><span class="linenos">345</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-346"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-346"><span class="linenos">346</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-347"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-347"><span class="linenos">347</span></a><span class="sd">        Estimate static revenue effect of PTC policy change.</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-348"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-348"><span class="linenos">348</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-349"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-349"><span class="linenos">349</span></a><span class="sd">        For PTCs, revenue effect = change in outlays (negative = costs money).</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-350"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-350"><span class="linenos">350</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-351"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-351"><span class="linenos">351</span></a><span class="sd">        Args:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-352"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-352"><span class="linenos">352</span></a><span class="sd">            baseline_revenue: Baseline revenue (not used)</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-353"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-353"><span class="linenos">353</span></a><span class="sd">            use_real_data: Whether to use detailed calculations</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-354"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-354"><span class="linenos">354</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-355"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-355"><span class="linenos">355</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-356"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-356"><span class="linenos">356</span></a><span class="sd">            Revenue change in billions (negative = cost increase)</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-357"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-358"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-358"><span class="linenos">358</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-359"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-359"><span class="linenos">359</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-360"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-360"><span class="linenos">360</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-361"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeal_ptc</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-362"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-362"><span class="linenos">362</span></a>            <span class="c1"># Repealing PTCs saves all PTC spending</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-363"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-363"><span class="linenos">363</span></a>            <span class="k">return</span> <span class="n">CBO_PTC_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;baseline_enhanced_annual&quot;</span><span class="p">]</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-364"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-364"><span class="linenos">364</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-365"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_enhanced</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_permanent</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-366"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-366"><span class="linenos">366</span></a>            <span class="c1"># Cost of extending enhanced PTCs</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-367"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-367"><span class="linenos">367</span></a>            <span class="c1"># Difference between enhanced and original ACA baseline</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-368"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-368"><span class="linenos">368</span></a>            <span class="n">enhanced_cost</span> <span class="o">=</span> <span class="n">CBO_PTC_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;baseline_enhanced_annual&quot;</span><span class="p">]</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-369"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-369"><span class="linenos">369</span></a>            <span class="n">original_cost</span> <span class="o">=</span> <span class="n">CBO_PTC_ESTIMATES</span><span class="p">[</span><span class="s2">&quot;baseline_original_annual&quot;</span><span class="p">]</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-370"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-370"><span class="linenos">370</span></a>            <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">enhanced_cost</span> <span class="o">-</span> <span class="n">original_cost</span><span class="p">)</span>  <span class="c1"># Additional cost</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-371"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-371"><span class="linenos">371</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-372"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-372"><span class="linenos">372</span></a>        <span class="c1"># Premium cap modifications</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-373"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-373"><span class="linenos">373</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_premium_cap</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">premium_cap_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-374"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-374"><span class="linenos">374</span></a>            <span class="c1"># Lower caps = higher subsidies = more cost</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-375"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-375"><span class="linenos">375</span></a>            <span class="c1"># Rough estimate: 1pp cap reduction = ~$10B/year</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-376"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-376"><span class="linenos">376</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">premium_cap_change</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># Billions per 1pp</span>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-377"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-377"><span class="linenos">377</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_static_revenue_effect-378"><a href="#PremiumTaxCreditPolicy.estimate_static_revenue_effect-378"><span class="linenos">378</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span></pre></div>


            <div class="docstring"><p>Estimate static revenue effect of PTC policy change.</p>

<p>For PTCs, revenue effect = change in outlays (negative = costs money).</p>

<p>Args:
    baseline_revenue: Baseline revenue (not used)
    use_real_data: Whether to use detailed calculations</p>

<p>Returns:
    Revenue change in billions (negative = cost increase)</p>
</div>


                            </div>
                            <div id="PremiumTaxCreditPolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="PremiumTaxCreditPolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="PremiumTaxCreditPolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PremiumTaxCreditPolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-380"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-380"><span class="linenos">380</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-381"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-381"><span class="linenos">381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-382"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-382"><span class="linenos">382</span></a><span class="sd">        Estimate behavioral response to PTC changes.</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-383"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-383"><span class="linenos">383</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-384"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-384"><span class="linenos">384</span></a><span class="sd">        Behavioral responses include:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-385"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-385"><span class="linenos">385</span></a><span class="sd">        - Coverage changes (more/fewer insured)</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-386"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-386"><span class="linenos">386</span></a><span class="sd">        - Premium spiral effects (adverse selection)</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-387"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-387"><span class="linenos">387</span></a><span class="sd">        - Labor supply effects (subsidy cliff)</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-388"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-388"><span class="linenos">388</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-389"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-389"><span class="linenos">389</span></a><span class="sd">        Returns:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-390"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-390"><span class="linenos">390</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-391"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-392"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-392"><span class="linenos">392</span></a>        <span class="c1"># Coverage effects affect healthcare costs elsewhere</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-393"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-393"><span class="linenos">393</span></a>        <span class="n">coverage_offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coverage_elasticity</span> <span class="o">*</span> <span class="mf">0.1</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-394"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-394"><span class="linenos">394</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-395"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-395"><span class="linenos">395</span></a>        <span class="c1"># Adverse selection if coverage drops</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-396"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Saving money = losing coverage</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-397"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-397"><span class="linenos">397</span></a>            <span class="n">adverse_selection</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">adverse_selection_factor</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-398"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-398"><span class="linenos">398</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-399"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-399"><span class="linenos">399</span></a>            <span class="n">adverse_selection</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-400"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-400"><span class="linenos">400</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-401"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-401"><span class="linenos">401</span></a>        <span class="n">total_offset</span> <span class="o">=</span> <span class="n">coverage_offset</span> <span class="o">+</span> <span class="n">adverse_selection</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-402"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-402"><span class="linenos">402</span></a>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-403"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-403"><span class="linenos">403</span></a>        <span class="c1"># Direction: if saving money (cutting subsidies), costs go up elsewhere</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-404"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-404"><span class="linenos">404</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-405"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-405"><span class="linenos">405</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">total_offset</span>  <span class="c1"># Reduces savings</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-406"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-406"><span class="linenos">406</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PremiumTaxCreditPolicy.estimate_behavioral_offset-407"><a href="#PremiumTaxCreditPolicy.estimate_behavioral_offset-407"><span class="linenos">407</span></a>            <span class="k">return</span> <span class="n">total_offset</span>  <span class="c1"># Reduces cost</span>
</span></pre></div>


            <div class="docstring"><p>Estimate behavioral response to PTC changes.</p>

<p>Behavioral responses include:</p>

<ul>
<li>Coverage changes (more/fewer insured)</li>
<li>Premium spiral effects (adverse selection)</li>
<li>Labor supply effects (subsidy cliff)</li>
</ul>

<p>Returns:
    Behavioral offset in billions</p>
</div>


                            </div>
                </section>
                <section id="PTCScenario">
                            <input id="PTCScenario-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PTCScenario</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="PTCScenario-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTCScenario"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTCScenario-42"><a href="#PTCScenario-42"><span class="linenos">42</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PTCScenario</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="PTCScenario-43"><a href="#PTCScenario-43"><span class="linenos">43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;PTC policy scenarios.&quot;&quot;&quot;</span>
</span><span id="PTCScenario-44"><a href="#PTCScenario-44"><span class="linenos">44</span></a>    <span class="n">EXTEND_ENHANCED</span> <span class="o">=</span> <span class="s2">&quot;extend_enhanced&quot;</span>  <span class="c1"># Extend ARPA/IRA enhanced credits</span>
</span><span id="PTCScenario-45"><a href="#PTCScenario-45"><span class="linenos">45</span></a>    <span class="n">ORIGINAL_ACA</span> <span class="o">=</span> <span class="s2">&quot;original_aca&quot;</span>  <span class="c1"># Let enhanced expire, return to original</span>
</span><span id="PTCScenario-46"><a href="#PTCScenario-46"><span class="linenos">46</span></a>    <span class="n">PERMANENT_ENHANCED</span> <span class="o">=</span> <span class="s2">&quot;permanent_enhanced&quot;</span>  <span class="c1"># Make enhanced credits permanent</span>
</span><span id="PTCScenario-47"><a href="#PTCScenario-47"><span class="linenos">47</span></a>    <span class="n">REPEAL_PTC</span> <span class="o">=</span> <span class="s2">&quot;repeal_ptc&quot;</span>  <span class="c1"># Eliminate PTCs entirely</span>
</span></pre></div>


            <div class="docstring"><p>PTC policy scenarios.</p>
</div>


                            <div id="PTCScenario.EXTEND_ENHANCED" class="classattr">
                                <div class="attr variable">
            <span class="name">EXTEND_ENHANCED</span>        =
<span class="default_value">&lt;<a href="#PTCScenario.EXTEND_ENHANCED">PTCScenario.EXTEND_ENHANCED</a>: &#39;extend_enhanced&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PTCScenario.EXTEND_ENHANCED"></a>
    
    

                            </div>
                            <div id="PTCScenario.ORIGINAL_ACA" class="classattr">
                                <div class="attr variable">
            <span class="name">ORIGINAL_ACA</span>        =
<span class="default_value">&lt;<a href="#PTCScenario.ORIGINAL_ACA">PTCScenario.ORIGINAL_ACA</a>: &#39;original_aca&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PTCScenario.ORIGINAL_ACA"></a>
    
    

                            </div>
                            <div id="PTCScenario.PERMANENT_ENHANCED" class="classattr">
                                <div class="attr variable">
            <span class="name">PERMANENT_ENHANCED</span>        =
<span class="default_value">&lt;<a href="#PTCScenario.PERMANENT_ENHANCED">PTCScenario.PERMANENT_ENHANCED</a>: &#39;permanent_enhanced&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PTCScenario.PERMANENT_ENHANCED"></a>
    
    

                            </div>
                            <div id="PTCScenario.REPEAL_PTC" class="classattr">
                                <div class="attr variable">
            <span class="name">REPEAL_PTC</span>        =
<span class="default_value">&lt;<a href="#PTCScenario.REPEAL_PTC">PTCScenario.REPEAL_PTC</a>: &#39;repeal_ptc&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#PTCScenario.REPEAL_PTC"></a>
    
    

                            </div>
                </section>
                <section id="FPL_2025">
                    <div class="attr variable">
            <span class="name">FPL_2025</span>        =
<span class="default_value">{1: 15650, 2: 21150, 3: 26650, 4: 32150, 5: 37650, 6: 43150, 7: 48650, 8: 54150}</span>

        
    </div>
    <a class="headerlink" href="#FPL_2025"></a>
    
    

                </section>
                <section id="ENHANCED_PTC_CAPS">
                    <div class="attr variable">
            <span class="name">ENHANCED_PTC_CAPS</span>        =
<input id="ENHANCED_PTC_CAPS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="ENHANCED_PTC_CAPS-view-value"></label><span class="default_value">{(0, 150): (0.0, 0.0), (150, 200): (0.0, 0.02), (200, 250): (0.02, 0.04), (250, 300): (0.04, 0.06), (300, 400): (0.06, 0.085), (400, 9999): (0.085, 0.085)}</span>

        
    </div>
    <a class="headerlink" href="#ENHANCED_PTC_CAPS"></a>
    
    

                </section>
                <section id="ORIGINAL_ACA_CAPS">
                    <div class="attr variable">
            <span class="name">ORIGINAL_ACA_CAPS</span>        =
<input id="ORIGINAL_ACA_CAPS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="ORIGINAL_ACA_CAPS-view-value"></label><span class="default_value">{(100, 133): (0.0206, 0.0206), (133, 150): (0.0306, 0.0406), (150, 200): (0.0406, 0.0644), (200, 250): (0.0644, 0.0806), (250, 300): (0.0806, 0.0961), (300, 400): (0.0961, 0.0986), (400, 9999): (1.0, 1.0)}</span>

        
    </div>
    <a class="headerlink" href="#ORIGINAL_ACA_CAPS"></a>
    
    

                </section>
                <section id="MARKETPLACE_DATA">
                    <div class="attr variable">
            <span class="name">MARKETPLACE_DATA</span>        =
<input id="MARKETPLACE_DATA-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="MARKETPLACE_DATA-view-value"></label><span class="default_value">{&#39;total_enrollees_millions&#39;: 22.0, &#39;receiving_ptc_millions&#39;: 19.0, &#39;receiving_csr_millions&#39;: 12.0, &#39;avg_subsidy_enhanced&#39;: 7000, &#39;avg_subsidy_original&#39;: 5500, &#39;avg_benchmark_premium&#39;: 12000, &#39;below_150_fpl_pct&#39;: 0.35, &#39;150_200_fpl_pct&#39;: 0.2, &#39;200_300_fpl_pct&#39;: 0.25, &#39;300_400_fpl_pct&#39;: 0.12, &#39;above_400_fpl_pct&#39;: 0.08, &#39;coverage_loss_millions&#39;: 4.0, &#39;uninsured_increase_millions&#39;: 14.0}</span>

        
    </div>
    <a class="headerlink" href="#MARKETPLACE_DATA"></a>
    
    

                </section>
                <section id="BASELINE_PTC_COSTS">
                    <div class="attr variable">
            <span class="name">BASELINE_PTC_COSTS</span>        =
<span class="default_value">{&#39;enhanced_annual&#39;: 95.0, &#39;original_aca_annual&#39;: 60.0, &#39;csr_annual&#39;: 15.0}</span>

        
    </div>
    <a class="headerlink" href="#BASELINE_PTC_COSTS"></a>
    
    

                </section>
                <section id="CBO_PTC_ESTIMATES">
                    <div class="attr variable">
            <span class="name">CBO_PTC_ESTIMATES</span>        =
<input id="CBO_PTC_ESTIMATES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="CBO_PTC_ESTIMATES-view-value"></label><span class="default_value">{&#39;extend_enhanced_10yr&#39;: 350.0, &#39;extend_enhanced_annual&#39;: 30.5, &#39;ira_extension_10yr&#39;: 64.0, &#39;baseline_enhanced_annual&#39;: 95.0, &#39;baseline_original_annual&#39;: 60.0, &#39;repeal_ptc_10yr&#39;: -1100.0}</span>

        
    </div>
    <a class="headerlink" href="#CBO_PTC_ESTIMATES"></a>
    
    

                </section>
                <section id="get_fpl">
                            <input id="get_fpl-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_fpl</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">family_size</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="get_fpl-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_fpl"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_fpl-67"><a href="#get_fpl-67"><span class="linenos">67</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_fpl</span><span class="p">(</span><span class="n">family_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="get_fpl-68"><a href="#get_fpl-68"><span class="linenos">68</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get Federal Poverty Level for family size.&quot;&quot;&quot;</span>
</span><span id="get_fpl-69"><a href="#get_fpl-69"><span class="linenos">69</span></a>    <span class="n">base_fpl</span> <span class="o">=</span> <span class="n">FPL_2025</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">family_size</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">FPL_2025</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
</span><span id="get_fpl-70"><a href="#get_fpl-70"><span class="linenos">70</span></a>    <span class="k">if</span> <span class="n">family_size</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="get_fpl-71"><a href="#get_fpl-71"><span class="linenos">71</span></a>        <span class="n">base_fpl</span> <span class="o">+=</span> <span class="p">(</span><span class="n">family_size</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5_500</span>
</span><span id="get_fpl-72"><a href="#get_fpl-72"><span class="linenos">72</span></a>    <span class="c1"># Adjust for year (FPL grows ~3%/year)</span>
</span><span id="get_fpl-73"><a href="#get_fpl-73"><span class="linenos">73</span></a>    <span class="n">years_diff</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">2025</span>
</span><span id="get_fpl-74"><a href="#get_fpl-74"><span class="linenos">74</span></a>    <span class="k">return</span> <span class="n">base_fpl</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.03</span> <span class="o">**</span> <span class="n">years_diff</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get Federal Poverty Level for family size.</p>
</div>


                </section>
                <section id="create_extend_enhanced_ptc">
                            <input id="create_extend_enhanced_ptc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_extend_enhanced_ptc</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">make_permanent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#PremiumTaxCreditPolicy">PremiumTaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_extend_enhanced_ptc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_extend_enhanced_ptc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_extend_enhanced_ptc-414"><a href="#create_extend_enhanced_ptc-414"><span class="linenos">414</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_extend_enhanced_ptc</span><span class="p">(</span>
</span><span id="create_extend_enhanced_ptc-415"><a href="#create_extend_enhanced_ptc-415"><span class="linenos">415</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-416"><a href="#create_extend_enhanced_ptc-416"><span class="linenos">416</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-417"><a href="#create_extend_enhanced_ptc-417"><span class="linenos">417</span></a>    <span class="n">make_permanent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-418"><a href="#create_extend_enhanced_ptc-418"><span class="linenos">418</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_extend_enhanced_ptc-419"><a href="#create_extend_enhanced_ptc-419"><span class="linenos">419</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_extend_enhanced_ptc-420"><a href="#create_extend_enhanced_ptc-420"><span class="linenos">420</span></a><span class="sd">    Create policy to extend enhanced PTCs beyond 2025.</span>
</span><span id="create_extend_enhanced_ptc-421"><a href="#create_extend_enhanced_ptc-421"><span class="linenos">421</span></a>
</span><span id="create_extend_enhanced_ptc-422"><a href="#create_extend_enhanced_ptc-422"><span class="linenos">422</span></a><span class="sd">    The enhanced PTCs from ARPA 2021 (extended by IRA 2022) expire end of 2025.</span>
</span><span id="create_extend_enhanced_ptc-423"><a href="#create_extend_enhanced_ptc-423"><span class="linenos">423</span></a><span class="sd">    This policy extends them to prevent premium spikes and coverage loss.</span>
</span><span id="create_extend_enhanced_ptc-424"><a href="#create_extend_enhanced_ptc-424"><span class="linenos">424</span></a>
</span><span id="create_extend_enhanced_ptc-425"><a href="#create_extend_enhanced_ptc-425"><span class="linenos">425</span></a><span class="sd">    CBO estimate: ~$350B over 2026-2035</span>
</span><span id="create_extend_enhanced_ptc-426"><a href="#create_extend_enhanced_ptc-426"><span class="linenos">426</span></a>
</span><span id="create_extend_enhanced_ptc-427"><a href="#create_extend_enhanced_ptc-427"><span class="linenos">427</span></a><span class="sd">    Args:</span>
</span><span id="create_extend_enhanced_ptc-428"><a href="#create_extend_enhanced_ptc-428"><span class="linenos">428</span></a><span class="sd">        start_year: First year of extension (2026 after current expiration)</span>
</span><span id="create_extend_enhanced_ptc-429"><a href="#create_extend_enhanced_ptc-429"><span class="linenos">429</span></a><span class="sd">        duration_years: Years to extend</span>
</span><span id="create_extend_enhanced_ptc-430"><a href="#create_extend_enhanced_ptc-430"><span class="linenos">430</span></a><span class="sd">        make_permanent: Whether to make permanent vs temporary</span>
</span><span id="create_extend_enhanced_ptc-431"><a href="#create_extend_enhanced_ptc-431"><span class="linenos">431</span></a>
</span><span id="create_extend_enhanced_ptc-432"><a href="#create_extend_enhanced_ptc-432"><span class="linenos">432</span></a><span class="sd">    Returns:</span>
</span><span id="create_extend_enhanced_ptc-433"><a href="#create_extend_enhanced_ptc-433"><span class="linenos">433</span></a><span class="sd">        PremiumTaxCreditPolicy for enhanced PTC extension</span>
</span><span id="create_extend_enhanced_ptc-434"><a href="#create_extend_enhanced_ptc-434"><span class="linenos">434</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_extend_enhanced_ptc-435"><a href="#create_extend_enhanced_ptc-435"><span class="linenos">435</span></a>    <span class="k">return</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_extend_enhanced_ptc-436"><a href="#create_extend_enhanced_ptc-436"><span class="linenos">436</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Extend Enhanced PTCs&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot; (Permanent)&quot;</span> <span class="k">if</span> <span class="n">make_permanent</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="create_extend_enhanced_ptc-437"><a href="#create_extend_enhanced_ptc-437"><span class="linenos">437</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extend ARPA/IRA enhanced premium tax credits beyond 2025&quot;</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-438"><a href="#create_extend_enhanced_ptc-438"><span class="linenos">438</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-439"><a href="#create_extend_enhanced_ptc-439"><span class="linenos">439</span></a>        <span class="n">scenario</span><span class="o">=</span><span class="n">PTCScenario</span><span class="o">.</span><span class="n">EXTEND_ENHANCED</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-440"><a href="#create_extend_enhanced_ptc-440"><span class="linenos">440</span></a>        <span class="n">extend_enhanced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-441"><a href="#create_extend_enhanced_ptc-441"><span class="linenos">441</span></a>        <span class="n">make_permanent</span><span class="o">=</span><span class="n">make_permanent</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-442"><a href="#create_extend_enhanced_ptc-442"><span class="linenos">442</span></a>        <span class="n">extension_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-443"><a href="#create_extend_enhanced_ptc-443"><span class="linenos">443</span></a>        <span class="n">coverage_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Behavioral in calibration</span>
</span><span id="create_extend_enhanced_ptc-444"><a href="#create_extend_enhanced_ptc-444"><span class="linenos">444</span></a>        <span class="n">adverse_selection_factor</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-445"><a href="#create_extend_enhanced_ptc-445"><span class="linenos">445</span></a>        <span class="c1"># Calibrated to CBO ~$350B over 10 years (with 4% healthcare growth)</span>
</span><span id="create_extend_enhanced_ptc-446"><a href="#create_extend_enhanced_ptc-446"><span class="linenos">446</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">30.5</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-447"><a href="#create_extend_enhanced_ptc-447"><span class="linenos">447</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-448"><a href="#create_extend_enhanced_ptc-448"><span class="linenos">448</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_extend_enhanced_ptc-449"><a href="#create_extend_enhanced_ptc-449"><span class="linenos">449</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to extend enhanced PTCs beyond 2025.</p>

<p>The enhanced PTCs from ARPA 2021 (extended by IRA 2022) expire end of 2025.
This policy extends them to prevent premium spikes and coverage loss.</p>

<p>CBO estimate: ~$350B over 2026-2035</p>

<p>Args:
    start_year: First year of extension (2026 after current expiration)
    duration_years: Years to extend
    make_permanent: Whether to make permanent vs temporary</p>

<p>Returns:
    PremiumTaxCreditPolicy for enhanced PTC extension</p>
</div>


                </section>
                <section id="create_let_enhanced_expire">
                            <input id="create_let_enhanced_expire-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_let_enhanced_expire</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#PremiumTaxCreditPolicy">PremiumTaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_let_enhanced_expire-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_let_enhanced_expire"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_let_enhanced_expire-452"><a href="#create_let_enhanced_expire-452"><span class="linenos">452</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_let_enhanced_expire</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_let_enhanced_expire-453"><a href="#create_let_enhanced_expire-453"><span class="linenos">453</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_let_enhanced_expire-454"><a href="#create_let_enhanced_expire-454"><span class="linenos">454</span></a><span class="sd">    Create policy representing enhanced PTCs expiring (current law baseline).</span>
</span><span id="create_let_enhanced_expire-455"><a href="#create_let_enhanced_expire-455"><span class="linenos">455</span></a>
</span><span id="create_let_enhanced_expire-456"><a href="#create_let_enhanced_expire-456"><span class="linenos">456</span></a><span class="sd">    Under current law, enhanced PTCs expire end of 2025, reverting to</span>
</span><span id="create_let_enhanced_expire-457"><a href="#create_let_enhanced_expire-457"><span class="linenos">457</span></a><span class="sd">    original ACA structure:</span>
</span><span id="create_let_enhanced_expire-458"><a href="#create_let_enhanced_expire-458"><span class="linenos">458</span></a><span class="sd">    - 100-400% FPL eligibility only</span>
</span><span id="create_let_enhanced_expire-459"><a href="#create_let_enhanced_expire-459"><span class="linenos">459</span></a><span class="sd">    - Higher premium caps</span>
</span><span id="create_let_enhanced_expire-460"><a href="#create_let_enhanced_expire-460"><span class="linenos">460</span></a><span class="sd">    - ~4 million lose coverage</span>
</span><span id="create_let_enhanced_expire-461"><a href="#create_let_enhanced_expire-461"><span class="linenos">461</span></a>
</span><span id="create_let_enhanced_expire-462"><a href="#create_let_enhanced_expire-462"><span class="linenos">462</span></a><span class="sd">    This is the baseline for comparison - zero budget cost but coverage effects.</span>
</span><span id="create_let_enhanced_expire-463"><a href="#create_let_enhanced_expire-463"><span class="linenos">463</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_let_enhanced_expire-464"><a href="#create_let_enhanced_expire-464"><span class="linenos">464</span></a>    <span class="k">return</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_let_enhanced_expire-465"><a href="#create_let_enhanced_expire-465"><span class="linenos">465</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Let Enhanced PTCs Expire&quot;</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-466"><a href="#create_let_enhanced_expire-466"><span class="linenos">466</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current law: enhanced PTCs expire end of 2025&quot;</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-467"><a href="#create_let_enhanced_expire-467"><span class="linenos">467</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-468"><a href="#create_let_enhanced_expire-468"><span class="linenos">468</span></a>        <span class="n">scenario</span><span class="o">=</span><span class="n">PTCScenario</span><span class="o">.</span><span class="n">ORIGINAL_ACA</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-469"><a href="#create_let_enhanced_expire-469"><span class="linenos">469</span></a>        <span class="n">extend_enhanced</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-470"><a href="#create_let_enhanced_expire-470"><span class="linenos">470</span></a>        <span class="n">make_permanent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-471"><a href="#create_let_enhanced_expire-471"><span class="linenos">471</span></a>        <span class="n">coverage_elasticity</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-472"><a href="#create_let_enhanced_expire-472"><span class="linenos">472</span></a>        <span class="c1"># No budget cost - this is the baseline</span>
</span><span id="create_let_enhanced_expire-473"><a href="#create_let_enhanced_expire-473"><span class="linenos">473</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-474"><a href="#create_let_enhanced_expire-474"><span class="linenos">474</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="mi">2026</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-475"><a href="#create_let_enhanced_expire-475"><span class="linenos">475</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="create_let_enhanced_expire-476"><a href="#create_let_enhanced_expire-476"><span class="linenos">476</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy representing enhanced PTCs expiring (current law baseline).</p>

<p>Under current law, enhanced PTCs expire end of 2025, reverting to
original ACA structure:</p>

<ul>
<li>100-400% FPL eligibility only</li>
<li>Higher premium caps</li>
<li>~4 million lose coverage</li>
</ul>

<p>This is the baseline for comparison - zero budget cost but coverage effects.</p>
</div>


                </section>
                <section id="create_repeal_ptc">
                            <input id="create_repeal_ptc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_repeal_ptc</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PremiumTaxCreditPolicy">PremiumTaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_repeal_ptc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_repeal_ptc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_repeal_ptc-479"><a href="#create_repeal_ptc-479"><span class="linenos">479</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_repeal_ptc</span><span class="p">(</span>
</span><span id="create_repeal_ptc-480"><a href="#create_repeal_ptc-480"><span class="linenos">480</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_repeal_ptc-481"><a href="#create_repeal_ptc-481"><span class="linenos">481</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_repeal_ptc-482"><a href="#create_repeal_ptc-482"><span class="linenos">482</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_repeal_ptc-483"><a href="#create_repeal_ptc-483"><span class="linenos">483</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_repeal_ptc-484"><a href="#create_repeal_ptc-484"><span class="linenos">484</span></a><span class="sd">    Create policy to repeal PTCs entirely.</span>
</span><span id="create_repeal_ptc-485"><a href="#create_repeal_ptc-485"><span class="linenos">485</span></a>
</span><span id="create_repeal_ptc-486"><a href="#create_repeal_ptc-486"><span class="linenos">486</span></a><span class="sd">    This would eliminate all ACA premium subsidies, saving ~$95B/year</span>
</span><span id="create_repeal_ptc-487"><a href="#create_repeal_ptc-487"><span class="linenos">487</span></a><span class="sd">    but causing ~19 million to lose subsidized coverage.</span>
</span><span id="create_repeal_ptc-488"><a href="#create_repeal_ptc-488"><span class="linenos">488</span></a>
</span><span id="create_repeal_ptc-489"><a href="#create_repeal_ptc-489"><span class="linenos">489</span></a><span class="sd">    CBO estimate: Saves ~$1.1T over 10 years but major coverage loss.</span>
</span><span id="create_repeal_ptc-490"><a href="#create_repeal_ptc-490"><span class="linenos">490</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_repeal_ptc-491"><a href="#create_repeal_ptc-491"><span class="linenos">491</span></a>    <span class="k">return</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_repeal_ptc-492"><a href="#create_repeal_ptc-492"><span class="linenos">492</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Repeal Premium Tax Credits&quot;</span><span class="p">,</span>
</span><span id="create_repeal_ptc-493"><a href="#create_repeal_ptc-493"><span class="linenos">493</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Eliminate ACA premium subsidies entirely&quot;</span><span class="p">,</span>
</span><span id="create_repeal_ptc-494"><a href="#create_repeal_ptc-494"><span class="linenos">494</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_repeal_ptc-495"><a href="#create_repeal_ptc-495"><span class="linenos">495</span></a>        <span class="n">scenario</span><span class="o">=</span><span class="n">PTCScenario</span><span class="o">.</span><span class="n">REPEAL_PTC</span><span class="p">,</span>
</span><span id="create_repeal_ptc-496"><a href="#create_repeal_ptc-496"><span class="linenos">496</span></a>        <span class="n">repeal_ptc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_repeal_ptc-497"><a href="#create_repeal_ptc-497"><span class="linenos">497</span></a>        <span class="n">coverage_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Not modeling coverage offset</span>
</span><span id="create_repeal_ptc-498"><a href="#create_repeal_ptc-498"><span class="linenos">498</span></a>        <span class="c1"># Calibrated: ~$1.1T savings over 10 years (with growth)</span>
</span><span id="create_repeal_ptc-499"><a href="#create_repeal_ptc-499"><span class="linenos">499</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">83.0</span><span class="p">,</span>  <span class="c1"># Saves money</span>
</span><span id="create_repeal_ptc-500"><a href="#create_repeal_ptc-500"><span class="linenos">500</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_repeal_ptc-501"><a href="#create_repeal_ptc-501"><span class="linenos">501</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_repeal_ptc-502"><a href="#create_repeal_ptc-502"><span class="linenos">502</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to repeal PTCs entirely.</p>

<p>This would eliminate all ACA premium subsidies, saving ~$95B/year
but causing ~19 million to lose subsidized coverage.</p>

<p>CBO estimate: Saves ~$1.1T over 10 years but major coverage loss.</p>
</div>


                </section>
                <section id="create_expand_ptc_eligibility">
                            <input id="create_expand_ptc_eligibility-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_expand_ptc_eligibility</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">new_upper_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">600</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PremiumTaxCreditPolicy">PremiumTaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_expand_ptc_eligibility-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_expand_ptc_eligibility"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_expand_ptc_eligibility-505"><a href="#create_expand_ptc_eligibility-505"><span class="linenos">505</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_expand_ptc_eligibility</span><span class="p">(</span>
</span><span id="create_expand_ptc_eligibility-506"><a href="#create_expand_ptc_eligibility-506"><span class="linenos">506</span></a>    <span class="n">new_upper_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span>  <span class="c1"># 600% FPL</span>
</span><span id="create_expand_ptc_eligibility-507"><a href="#create_expand_ptc_eligibility-507"><span class="linenos">507</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-508"><a href="#create_expand_ptc_eligibility-508"><span class="linenos">508</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-509"><a href="#create_expand_ptc_eligibility-509"><span class="linenos">509</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_expand_ptc_eligibility-510"><a href="#create_expand_ptc_eligibility-510"><span class="linenos">510</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_expand_ptc_eligibility-511"><a href="#create_expand_ptc_eligibility-511"><span class="linenos">511</span></a><span class="sd">    Create policy to expand PTC eligibility above 400% FPL.</span>
</span><span id="create_expand_ptc_eligibility-512"><a href="#create_expand_ptc_eligibility-512"><span class="linenos">512</span></a>
</span><span id="create_expand_ptc_eligibility-513"><a href="#create_expand_ptc_eligibility-513"><span class="linenos">513</span></a><span class="sd">    The enhanced PTCs already extend above 400% FPL with 8.5% cap.</span>
</span><span id="create_expand_ptc_eligibility-514"><a href="#create_expand_ptc_eligibility-514"><span class="linenos">514</span></a><span class="sd">    This makes that expansion explicit/permanent and could go further.</span>
</span><span id="create_expand_ptc_eligibility-515"><a href="#create_expand_ptc_eligibility-515"><span class="linenos">515</span></a>
</span><span id="create_expand_ptc_eligibility-516"><a href="#create_expand_ptc_eligibility-516"><span class="linenos">516</span></a><span class="sd">    Args:</span>
</span><span id="create_expand_ptc_eligibility-517"><a href="#create_expand_ptc_eligibility-517"><span class="linenos">517</span></a><span class="sd">        new_upper_limit: New FPL % limit (e.g., 600 = 600% FPL)</span>
</span><span id="create_expand_ptc_eligibility-518"><a href="#create_expand_ptc_eligibility-518"><span class="linenos">518</span></a><span class="sd">        start_year: First year</span>
</span><span id="create_expand_ptc_eligibility-519"><a href="#create_expand_ptc_eligibility-519"><span class="linenos">519</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_expand_ptc_eligibility-520"><a href="#create_expand_ptc_eligibility-520"><span class="linenos">520</span></a>
</span><span id="create_expand_ptc_eligibility-521"><a href="#create_expand_ptc_eligibility-521"><span class="linenos">521</span></a><span class="sd">    Returns:</span>
</span><span id="create_expand_ptc_eligibility-522"><a href="#create_expand_ptc_eligibility-522"><span class="linenos">522</span></a><span class="sd">        PremiumTaxCreditPolicy for eligibility expansion</span>
</span><span id="create_expand_ptc_eligibility-523"><a href="#create_expand_ptc_eligibility-523"><span class="linenos">523</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_expand_ptc_eligibility-524"><a href="#create_expand_ptc_eligibility-524"><span class="linenos">524</span></a>    <span class="c1"># Estimate cost: each 100% FPL expansion adds ~1M enrollees at ~$3K avg</span>
</span><span id="create_expand_ptc_eligibility-525"><a href="#create_expand_ptc_eligibility-525"><span class="linenos">525</span></a>    <span class="n">additional_fpl</span> <span class="o">=</span> <span class="n">new_upper_limit</span> <span class="o">-</span> <span class="mi">400</span>
</span><span id="create_expand_ptc_eligibility-526"><a href="#create_expand_ptc_eligibility-526"><span class="linenos">526</span></a>    <span class="n">additional_enrollees</span> <span class="o">=</span> <span class="p">(</span><span class="n">additional_fpl</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span>  <span class="c1"># ~1M per 100% FPL</span>
</span><span id="create_expand_ptc_eligibility-527"><a href="#create_expand_ptc_eligibility-527"><span class="linenos">527</span></a>    <span class="n">additional_cost</span> <span class="o">=</span> <span class="n">additional_enrollees</span> <span class="o">*</span> <span class="mf">3.0</span>  <span class="c1"># ~$3B per million</span>
</span><span id="create_expand_ptc_eligibility-528"><a href="#create_expand_ptc_eligibility-528"><span class="linenos">528</span></a>
</span><span id="create_expand_ptc_eligibility-529"><a href="#create_expand_ptc_eligibility-529"><span class="linenos">529</span></a>    <span class="k">return</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_expand_ptc_eligibility-530"><a href="#create_expand_ptc_eligibility-530"><span class="linenos">530</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Expand PTC to </span><span class="si">{</span><span class="n">new_upper_limit</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% FPL&quot;</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-531"><a href="#create_expand_ptc_eligibility-531"><span class="linenos">531</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Extend PTC eligibility to </span><span class="si">{</span><span class="n">new_upper_limit</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% of Federal Poverty Level&quot;</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-532"><a href="#create_expand_ptc_eligibility-532"><span class="linenos">532</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-533"><a href="#create_expand_ptc_eligibility-533"><span class="linenos">533</span></a>        <span class="n">scenario</span><span class="o">=</span><span class="n">PTCScenario</span><span class="o">.</span><span class="n">EXTEND_ENHANCED</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-534"><a href="#create_expand_ptc_eligibility-534"><span class="linenos">534</span></a>        <span class="n">extend_enhanced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-535"><a href="#create_expand_ptc_eligibility-535"><span class="linenos">535</span></a>        <span class="n">modify_income_limit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-536"><a href="#create_expand_ptc_eligibility-536"><span class="linenos">536</span></a>        <span class="n">new_upper_fpl_limit</span><span class="o">=</span><span class="n">new_upper_limit</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-537"><a href="#create_expand_ptc_eligibility-537"><span class="linenos">537</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="n">additional_cost</span> <span class="o">-</span> <span class="mf">30.5</span><span class="p">,</span>  <span class="c1"># Plus base extension</span>
</span><span id="create_expand_ptc_eligibility-538"><a href="#create_expand_ptc_eligibility-538"><span class="linenos">538</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-539"><a href="#create_expand_ptc_eligibility-539"><span class="linenos">539</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_expand_ptc_eligibility-540"><a href="#create_expand_ptc_eligibility-540"><span class="linenos">540</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to expand PTC eligibility above 400% FPL.</p>

<p>The enhanced PTCs already extend above 400% FPL with 8.5% cap.
This makes that expansion explicit/permanent and could go further.</p>

<p>Args:
    new_upper_limit: New FPL % limit (e.g., 600 = 600% FPL)
    start_year: First year
    duration_years: Duration</p>

<p>Returns:
    PremiumTaxCreditPolicy for eligibility expansion</p>
</div>


                </section>
                <section id="create_lower_premium_cap">
                            <input id="create_lower_premium_cap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_lower_premium_cap</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">new_max_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#PremiumTaxCreditPolicy">PremiumTaxCreditPolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_lower_premium_cap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_lower_premium_cap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_lower_premium_cap-543"><a href="#create_lower_premium_cap-543"><span class="linenos">543</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_lower_premium_cap</span><span class="p">(</span>
</span><span id="create_lower_premium_cap-544"><a href="#create_lower_premium_cap-544"><span class="linenos">544</span></a>    <span class="n">new_max_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># 5% of income</span>
</span><span id="create_lower_premium_cap-545"><a href="#create_lower_premium_cap-545"><span class="linenos">545</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-546"><a href="#create_lower_premium_cap-546"><span class="linenos">546</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-547"><a href="#create_lower_premium_cap-547"><span class="linenos">547</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">:</span>
</span><span id="create_lower_premium_cap-548"><a href="#create_lower_premium_cap-548"><span class="linenos">548</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_lower_premium_cap-549"><a href="#create_lower_premium_cap-549"><span class="linenos">549</span></a><span class="sd">    Create policy to lower the maximum premium cap.</span>
</span><span id="create_lower_premium_cap-550"><a href="#create_lower_premium_cap-550"><span class="linenos">550</span></a>
</span><span id="create_lower_premium_cap-551"><a href="#create_lower_premium_cap-551"><span class="linenos">551</span></a><span class="sd">    Current enhanced cap is 8.5% of income. Lowering increases subsidies.</span>
</span><span id="create_lower_premium_cap-552"><a href="#create_lower_premium_cap-552"><span class="linenos">552</span></a>
</span><span id="create_lower_premium_cap-553"><a href="#create_lower_premium_cap-553"><span class="linenos">553</span></a><span class="sd">    Args:</span>
</span><span id="create_lower_premium_cap-554"><a href="#create_lower_premium_cap-554"><span class="linenos">554</span></a><span class="sd">        new_max_cap: New maximum premium cap (e.g., 0.05 = 5%)</span>
</span><span id="create_lower_premium_cap-555"><a href="#create_lower_premium_cap-555"><span class="linenos">555</span></a><span class="sd">        start_year: First year</span>
</span><span id="create_lower_premium_cap-556"><a href="#create_lower_premium_cap-556"><span class="linenos">556</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_lower_premium_cap-557"><a href="#create_lower_premium_cap-557"><span class="linenos">557</span></a>
</span><span id="create_lower_premium_cap-558"><a href="#create_lower_premium_cap-558"><span class="linenos">558</span></a><span class="sd">    Returns:</span>
</span><span id="create_lower_premium_cap-559"><a href="#create_lower_premium_cap-559"><span class="linenos">559</span></a><span class="sd">        PremiumTaxCreditPolicy for lower premium cap</span>
</span><span id="create_lower_premium_cap-560"><a href="#create_lower_premium_cap-560"><span class="linenos">560</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_lower_premium_cap-561"><a href="#create_lower_premium_cap-561"><span class="linenos">561</span></a>    <span class="c1"># Estimate cost: each 1pp reduction adds ~$10B/year</span>
</span><span id="create_lower_premium_cap-562"><a href="#create_lower_premium_cap-562"><span class="linenos">562</span></a>    <span class="n">cap_reduction</span> <span class="o">=</span> <span class="mf">0.085</span> <span class="o">-</span> <span class="n">new_max_cap</span>
</span><span id="create_lower_premium_cap-563"><a href="#create_lower_premium_cap-563"><span class="linenos">563</span></a>    <span class="n">additional_cost</span> <span class="o">=</span> <span class="n">cap_reduction</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c1"># $10B per percentage point</span>
</span><span id="create_lower_premium_cap-564"><a href="#create_lower_premium_cap-564"><span class="linenos">564</span></a>
</span><span id="create_lower_premium_cap-565"><a href="#create_lower_premium_cap-565"><span class="linenos">565</span></a>    <span class="k">return</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">(</span>
</span><span id="create_lower_premium_cap-566"><a href="#create_lower_premium_cap-566"><span class="linenos">566</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Lower Premium Cap to </span><span class="si">{</span><span class="n">new_max_cap</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-567"><a href="#create_lower_premium_cap-567"><span class="linenos">567</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Reduce maximum premium cap from 8.5% to </span><span class="si">{</span><span class="n">new_max_cap</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% of income&quot;</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-568"><a href="#create_lower_premium_cap-568"><span class="linenos">568</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_CREDIT</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-569"><a href="#create_lower_premium_cap-569"><span class="linenos">569</span></a>        <span class="n">scenario</span><span class="o">=</span><span class="n">PTCScenario</span><span class="o">.</span><span class="n">EXTEND_ENHANCED</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-570"><a href="#create_lower_premium_cap-570"><span class="linenos">570</span></a>        <span class="n">extend_enhanced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-571"><a href="#create_lower_premium_cap-571"><span class="linenos">571</span></a>        <span class="n">modify_premium_cap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-572"><a href="#create_lower_premium_cap-572"><span class="linenos">572</span></a>        <span class="n">new_premium_cap_max</span><span class="o">=</span><span class="n">new_max_cap</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-573"><a href="#create_lower_premium_cap-573"><span class="linenos">573</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">30.5</span> <span class="o">-</span> <span class="n">additional_cost</span><span class="p">,</span>  <span class="c1"># Base + additional</span>
</span><span id="create_lower_premium_cap-574"><a href="#create_lower_premium_cap-574"><span class="linenos">574</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-575"><a href="#create_lower_premium_cap-575"><span class="linenos">575</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_lower_premium_cap-576"><a href="#create_lower_premium_cap-576"><span class="linenos">576</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to lower the maximum premium cap.</p>

<p>Current enhanced cap is 8.5% of income. Lowering increases subsidies.</p>

<p>Args:
    new_max_cap: New maximum premium cap (e.g., 0.05 = 5%)
    start_year: First year
    duration_years: Duration</p>

<p>Returns:
    PremiumTaxCreditPolicy for lower premium cap</p>
</div>


                </section>
                <section id="estimate_ptc_cost">
                            <input id="estimate_ptc_cost-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_ptc_cost</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#PremiumTaxCreditPolicy">PremiumTaxCreditPolicy</a></span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="estimate_ptc_cost-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#estimate_ptc_cost"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="estimate_ptc_cost-601"><a href="#estimate_ptc_cost-601"><span class="linenos">601</span></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_ptc_cost</span><span class="p">(</span><span class="n">policy</span><span class="p">:</span> <span class="n">PremiumTaxCreditPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="estimate_ptc_cost-602"><a href="#estimate_ptc_cost-602"><span class="linenos">602</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="estimate_ptc_cost-603"><a href="#estimate_ptc_cost-603"><span class="linenos">603</span></a><span class="sd">    Estimate total cost of a PTC policy over 10 years.</span>
</span><span id="estimate_ptc_cost-604"><a href="#estimate_ptc_cost-604"><span class="linenos">604</span></a>
</span><span id="estimate_ptc_cost-605"><a href="#estimate_ptc_cost-605"><span class="linenos">605</span></a><span class="sd">    Returns dict with:</span>
</span><span id="estimate_ptc_cost-606"><a href="#estimate_ptc_cost-606"><span class="linenos">606</span></a><span class="sd">        - annual_cost: Average annual cost</span>
</span><span id="estimate_ptc_cost-607"><a href="#estimate_ptc_cost-607"><span class="linenos">607</span></a><span class="sd">        - ten_year_cost: Total 10-year cost</span>
</span><span id="estimate_ptc_cost-608"><a href="#estimate_ptc_cost-608"><span class="linenos">608</span></a><span class="sd">        - coverage_effect: Coverage change (millions)</span>
</span><span id="estimate_ptc_cost-609"><a href="#estimate_ptc_cost-609"><span class="linenos">609</span></a><span class="sd">        - behavioral_offset: Behavioral adjustment</span>
</span><span id="estimate_ptc_cost-610"><a href="#estimate_ptc_cost-610"><span class="linenos">610</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="estimate_ptc_cost-611"><a href="#estimate_ptc_cost-611"><span class="linenos">611</span></a>    <span class="n">annual_static</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="estimate_ptc_cost-612"><a href="#estimate_ptc_cost-612"><span class="linenos">612</span></a>    <span class="n">behavioral</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">annual_static</span><span class="p">)</span>
</span><span id="estimate_ptc_cost-613"><a href="#estimate_ptc_cost-613"><span class="linenos">613</span></a>    <span class="n">coverage</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_coverage_effect</span><span class="p">()</span>
</span><span id="estimate_ptc_cost-614"><a href="#estimate_ptc_cost-614"><span class="linenos">614</span></a>
</span><span id="estimate_ptc_cost-615"><a href="#estimate_ptc_cost-615"><span class="linenos">615</span></a>    <span class="c1"># Apply healthcare growth (~4%/year)</span>
</span><span id="estimate_ptc_cost-616"><a href="#estimate_ptc_cost-616"><span class="linenos">616</span></a>    <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="estimate_ptc_cost-617"><a href="#estimate_ptc_cost-617"><span class="linenos">617</span></a>    <span class="n">annual_effects</span> <span class="o">=</span> <span class="n">annual_static</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.04</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_ptc_cost-618"><a href="#estimate_ptc_cost-618"><span class="linenos">618</span></a>    <span class="n">behavioral_effects</span> <span class="o">=</span> <span class="n">behavioral</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.04</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_ptc_cost-619"><a href="#estimate_ptc_cost-619"><span class="linenos">619</span></a>
</span><span id="estimate_ptc_cost-620"><a href="#estimate_ptc_cost-620"><span class="linenos">620</span></a>    <span class="n">ten_year_static</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">annual_effects</span><span class="p">)</span>
</span><span id="estimate_ptc_cost-621"><a href="#estimate_ptc_cost-621"><span class="linenos">621</span></a>    <span class="n">ten_year_behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">behavioral_effects</span><span class="p">)</span>
</span><span id="estimate_ptc_cost-622"><a href="#estimate_ptc_cost-622"><span class="linenos">622</span></a>
</span><span id="estimate_ptc_cost-623"><a href="#estimate_ptc_cost-623"><span class="linenos">623</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="estimate_ptc_cost-624"><a href="#estimate_ptc_cost-624"><span class="linenos">624</span></a>        <span class="s2">&quot;annual_static&quot;</span><span class="p">:</span> <span class="n">annual_static</span><span class="p">,</span>
</span><span id="estimate_ptc_cost-625"><a href="#estimate_ptc_cost-625"><span class="linenos">625</span></a>        <span class="s2">&quot;ten_year_static&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span><span class="p">,</span>
</span><span id="estimate_ptc_cost-626"><a href="#estimate_ptc_cost-626"><span class="linenos">626</span></a>        <span class="s2">&quot;behavioral_offset&quot;</span><span class="p">:</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_ptc_cost-627"><a href="#estimate_ptc_cost-627"><span class="linenos">627</span></a>        <span class="s2">&quot;net_effect&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span> <span class="o">+</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_ptc_cost-628"><a href="#estimate_ptc_cost-628"><span class="linenos">628</span></a>        <span class="s2">&quot;coverage_change_millions&quot;</span><span class="p">:</span> <span class="n">coverage</span><span class="p">[</span><span class="s2">&quot;coverage_change_millions&quot;</span><span class="p">],</span>
</span><span id="estimate_ptc_cost-629"><a href="#estimate_ptc_cost-629"><span class="linenos">629</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Estimate total cost of a PTC policy over 10 years.</p>

<p>Returns dict with:
    - annual_cost: Average annual cost
    - ten_year_cost: Total 10-year cost
    - coverage_effect: Coverage change (millions)
    - behavioral_offset: Behavioral adjustment</p>
</div>


                </section>
                <section id="PTC_VALIDATION_SCENARIOS">
                    <div class="attr variable">
            <span class="name">PTC_VALIDATION_SCENARIOS</span>        =
<input id="PTC_VALIDATION_SCENARIOS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="PTC_VALIDATION_SCENARIOS-view-value"></label><span class="default_value">{&#39;extend_enhanced_ptc&#39;: {&#39;description&#39;: &#39;Extend enhanced PTCs (ARPA/IRA)&#39;, &#39;policy_factory&#39;: &#39;create_extend_enhanced_ptc&#39;, &#39;expected_10yr&#39;: 350.0, &#39;source&#39;: &#39;CBO 2024&#39;, &#39;notes&#39;: &#39;Extend subsidies beyond 2025 sunset&#39;}, &#39;repeal_ptc&#39;: {&#39;description&#39;: &#39;Repeal premium tax credits&#39;, &#39;policy_factory&#39;: &#39;create_repeal_ptc&#39;, &#39;expected_10yr&#39;: -1100.0, &#39;source&#39;: &#39;CBO estimate&#39;, &#39;notes&#39;: &#39;Eliminate all ACA subsidies - major coverage loss&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#PTC_VALIDATION_SCENARIOS"></a>
    
    

                </section>
                <section id="TaxExpenditurePolicy">
                            <input id="TaxExpenditurePolicy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">TaxExpenditurePolicy</span><wbr>(<span class="base"><a href="#TaxPolicy">fiscal_model.TaxPolicy</a></span>):

                <label class="view-source-button" for="TaxExpenditurePolicy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxExpenditurePolicy-217"><a href="#TaxExpenditurePolicy-217"><span class="linenos">217</span></a><span class="nd">@dataclass</span>
</span><span id="TaxExpenditurePolicy-218"><a href="#TaxExpenditurePolicy-218"><span class="linenos">218</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TaxExpenditurePolicy</span><span class="p">(</span><span class="n">TaxPolicy</span><span class="p">):</span>
</span><span id="TaxExpenditurePolicy-219"><a href="#TaxExpenditurePolicy-219"><span class="linenos">219</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy-220"><a href="#TaxExpenditurePolicy-220"><span class="linenos">220</span></a><span class="sd">    Tax expenditure policy modeling changes to deductions, exclusions, and credits.</span>
</span><span id="TaxExpenditurePolicy-221"><a href="#TaxExpenditurePolicy-221"><span class="linenos">221</span></a>
</span><span id="TaxExpenditurePolicy-222"><a href="#TaxExpenditurePolicy-222"><span class="linenos">222</span></a><span class="sd">    Models reform options including:</span>
</span><span id="TaxExpenditurePolicy-223"><a href="#TaxExpenditurePolicy-223"><span class="linenos">223</span></a><span class="sd">    - Elimination (full repeal)</span>
</span><span id="TaxExpenditurePolicy-224"><a href="#TaxExpenditurePolicy-224"><span class="linenos">224</span></a><span class="sd">    - Caps (dollar or rate limits)</span>
</span><span id="TaxExpenditurePolicy-225"><a href="#TaxExpenditurePolicy-225"><span class="linenos">225</span></a><span class="sd">    - Income phase-outs</span>
</span><span id="TaxExpenditurePolicy-226"><a href="#TaxExpenditurePolicy-226"><span class="linenos">226</span></a><span class="sd">    - Conversion to credits</span>
</span><span id="TaxExpenditurePolicy-227"><a href="#TaxExpenditurePolicy-227"><span class="linenos">227</span></a>
</span><span id="TaxExpenditurePolicy-228"><a href="#TaxExpenditurePolicy-228"><span class="linenos">228</span></a><span class="sd">    Key parameters:</span>
</span><span id="TaxExpenditurePolicy-229"><a href="#TaxExpenditurePolicy-229"><span class="linenos">229</span></a><span class="sd">        expenditure_type: Category of tax expenditure</span>
</span><span id="TaxExpenditurePolicy-230"><a href="#TaxExpenditurePolicy-230"><span class="linenos">230</span></a><span class="sd">        action: Type of reform (eliminate, cap, phase_out, convert)</span>
</span><span id="TaxExpenditurePolicy-231"><a href="#TaxExpenditurePolicy-231"><span class="linenos">231</span></a><span class="sd">        cap_amount: Dollar cap (if action is &#39;cap&#39;)</span>
</span><span id="TaxExpenditurePolicy-232"><a href="#TaxExpenditurePolicy-232"><span class="linenos">232</span></a><span class="sd">        phase_out_start: Income where phase-out begins</span>
</span><span id="TaxExpenditurePolicy-233"><a href="#TaxExpenditurePolicy-233"><span class="linenos">233</span></a><span class="sd">        convert_to_credit: Convert deduction to credit (if applicable)</span>
</span><span id="TaxExpenditurePolicy-234"><a href="#TaxExpenditurePolicy-234"><span class="linenos">234</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy-235"><a href="#TaxExpenditurePolicy-235"><span class="linenos">235</span></a>
</span><span id="TaxExpenditurePolicy-236"><a href="#TaxExpenditurePolicy-236"><span class="linenos">236</span></a>    <span class="c1"># Expenditure identification</span>
</span><span id="TaxExpenditurePolicy-237"><a href="#TaxExpenditurePolicy-237"><span class="linenos">237</span></a>    <span class="n">expenditure_type</span><span class="p">:</span> <span class="n">TaxExpenditureType</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">CHARITABLE</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy-238"><a href="#TaxExpenditurePolicy-238"><span class="linenos">238</span></a>
</span><span id="TaxExpenditurePolicy-239"><a href="#TaxExpenditurePolicy-239"><span class="linenos">239</span></a>    <span class="c1"># Reform action</span>
</span><span id="TaxExpenditurePolicy-240"><a href="#TaxExpenditurePolicy-240"><span class="linenos">240</span></a>    <span class="n">action</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;eliminate&quot;</span><span class="p">,</span> <span class="s2">&quot;cap&quot;</span><span class="p">,</span> <span class="s2">&quot;phase_out&quot;</span><span class="p">,</span> <span class="s2">&quot;convert&quot;</span><span class="p">,</span> <span class="s2">&quot;expand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cap&quot;</span>
</span><span id="TaxExpenditurePolicy-241"><a href="#TaxExpenditurePolicy-241"><span class="linenos">241</span></a>
</span><span id="TaxExpenditurePolicy-242"><a href="#TaxExpenditurePolicy-242"><span class="linenos">242</span></a>    <span class="c1"># Cap parameters</span>
</span><span id="TaxExpenditurePolicy-243"><a href="#TaxExpenditurePolicy-243"><span class="linenos">243</span></a>    <span class="n">cap_amount</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Dollar cap on deduction/exclusion</span>
</span><span id="TaxExpenditurePolicy-244"><a href="#TaxExpenditurePolicy-244"><span class="linenos">244</span></a>    <span class="n">cap_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Rate cap (e.g., 28% for itemized)</span>
</span><span id="TaxExpenditurePolicy-245"><a href="#TaxExpenditurePolicy-245"><span class="linenos">245</span></a>
</span><span id="TaxExpenditurePolicy-246"><a href="#TaxExpenditurePolicy-246"><span class="linenos">246</span></a>    <span class="c1"># Phase-out parameters</span>
</span><span id="TaxExpenditurePolicy-247"><a href="#TaxExpenditurePolicy-247"><span class="linenos">247</span></a>    <span class="n">phase_out_start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Income where phase-out begins</span>
</span><span id="TaxExpenditurePolicy-248"><a href="#TaxExpenditurePolicy-248"><span class="linenos">248</span></a>    <span class="n">phase_out_end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Income where fully phased out</span>
</span><span id="TaxExpenditurePolicy-249"><a href="#TaxExpenditurePolicy-249"><span class="linenos">249</span></a>    <span class="n">phase_out_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.03</span>  <span class="c1"># 3% reduction per $1,000 (Pease-style)</span>
</span><span id="TaxExpenditurePolicy-250"><a href="#TaxExpenditurePolicy-250"><span class="linenos">250</span></a>
</span><span id="TaxExpenditurePolicy-251"><a href="#TaxExpenditurePolicy-251"><span class="linenos">251</span></a>    <span class="c1"># Conversion parameters</span>
</span><span id="TaxExpenditurePolicy-252"><a href="#TaxExpenditurePolicy-252"><span class="linenos">252</span></a>    <span class="n">convert_to_credit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Convert deduction to credit</span>
</span><span id="TaxExpenditurePolicy-253"><a href="#TaxExpenditurePolicy-253"><span class="linenos">253</span></a>    <span class="n">credit_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>  <span class="c1"># Credit rate if converting</span>
</span><span id="TaxExpenditurePolicy-254"><a href="#TaxExpenditurePolicy-254"><span class="linenos">254</span></a>
</span><span id="TaxExpenditurePolicy-255"><a href="#TaxExpenditurePolicy-255"><span class="linenos">255</span></a>    <span class="c1"># Expansion parameters (for policies like SALT cap repeal)</span>
</span><span id="TaxExpenditurePolicy-256"><a href="#TaxExpenditurePolicy-256"><span class="linenos">256</span></a>    <span class="n">expand_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># New higher limit</span>
</span><span id="TaxExpenditurePolicy-257"><a href="#TaxExpenditurePolicy-257"><span class="linenos">257</span></a>
</span><span id="TaxExpenditurePolicy-258"><a href="#TaxExpenditurePolicy-258"><span class="linenos">258</span></a>    <span class="c1"># Behavioral parameters</span>
</span><span id="TaxExpenditurePolicy-259"><a href="#TaxExpenditurePolicy-259"><span class="linenos">259</span></a>    <span class="n">behavioral_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Response to incentive changes</span>
</span><span id="TaxExpenditurePolicy-260"><a href="#TaxExpenditurePolicy-260"><span class="linenos">260</span></a>    <span class="n">participation_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Change in take-up rate</span>
</span><span id="TaxExpenditurePolicy-261"><a href="#TaxExpenditurePolicy-261"><span class="linenos">261</span></a>
</span><span id="TaxExpenditurePolicy-262"><a href="#TaxExpenditurePolicy-262"><span class="linenos">262</span></a>    <span class="c1"># Calibration</span>
</span><span id="TaxExpenditurePolicy-263"><a href="#TaxExpenditurePolicy-263"><span class="linenos">263</span></a>    <span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TaxExpenditurePolicy-264"><a href="#TaxExpenditurePolicy-264"><span class="linenos">264</span></a>
</span><span id="TaxExpenditurePolicy-265"><a href="#TaxExpenditurePolicy-265"><span class="linenos">265</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TaxExpenditurePolicy-266"><a href="#TaxExpenditurePolicy-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set policy type.&quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy-267"><a href="#TaxExpenditurePolicy-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">==</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">INCOME_TAX</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-268"><a href="#TaxExpenditurePolicy-268"><span class="linenos">268</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">policy_type</span> <span class="o">=</span> <span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span>
</span><span id="TaxExpenditurePolicy-269"><a href="#TaxExpenditurePolicy-269"><span class="linenos">269</span></a>
</span><span id="TaxExpenditurePolicy-270"><a href="#TaxExpenditurePolicy-270"><span class="linenos">270</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_expenditure_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-271"><a href="#TaxExpenditurePolicy-271"><span class="linenos">271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get baseline data for this expenditure type.&quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy-272"><a href="#TaxExpenditurePolicy-272"><span class="linenos">272</span></a>        <span class="n">type_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TaxExpenditurePolicy-273"><a href="#TaxExpenditurePolicy-273"><span class="linenos">273</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">EMPLOYER_HEALTH</span><span class="p">:</span> <span class="s2">&quot;employer_health&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-274"><a href="#TaxExpenditurePolicy-274"><span class="linenos">274</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">RETIREMENT_CONTRIBUTIONS</span><span class="p">:</span> <span class="s2">&quot;retirement_401k&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-275"><a href="#TaxExpenditurePolicy-275"><span class="linenos">275</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">MORTGAGE_INTEREST</span><span class="p">:</span> <span class="s2">&quot;mortgage_interest&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-276"><a href="#TaxExpenditurePolicy-276"><span class="linenos">276</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">SALT</span><span class="p">:</span> <span class="s2">&quot;salt&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-277"><a href="#TaxExpenditurePolicy-277"><span class="linenos">277</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">CHARITABLE</span><span class="p">:</span> <span class="s2">&quot;charitable&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-278"><a href="#TaxExpenditurePolicy-278"><span class="linenos">278</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">CAPITAL_GAINS</span><span class="p">:</span> <span class="s2">&quot;capital_gains_dividends&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-279"><a href="#TaxExpenditurePolicy-279"><span class="linenos">279</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">STEP_UP_BASIS</span><span class="p">:</span> <span class="s2">&quot;step_up_basis&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-280"><a href="#TaxExpenditurePolicy-280"><span class="linenos">280</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">LIKE_KIND_EXCHANGE</span><span class="p">:</span> <span class="s2">&quot;like_kind_exchange&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-281"><a href="#TaxExpenditurePolicy-281"><span class="linenos">281</span></a>        <span class="p">}</span>
</span><span id="TaxExpenditurePolicy-282"><a href="#TaxExpenditurePolicy-282"><span class="linenos">282</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">type_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expenditure_type</span><span class="p">,</span> <span class="s2">&quot;charitable&quot;</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy-283"><a href="#TaxExpenditurePolicy-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="TaxExpenditurePolicy-284"><a href="#TaxExpenditurePolicy-284"><span class="linenos">284</span></a>
</span><span id="TaxExpenditurePolicy-285"><a href="#TaxExpenditurePolicy-285"><span class="linenos">285</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="TaxExpenditurePolicy-286"><a href="#TaxExpenditurePolicy-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-287"><a href="#TaxExpenditurePolicy-287"><span class="linenos">287</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-288"><a href="#TaxExpenditurePolicy-288"><span class="linenos">288</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-289"><a href="#TaxExpenditurePolicy-289"><span class="linenos">289</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-290"><a href="#TaxExpenditurePolicy-290"><span class="linenos">290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy-291"><a href="#TaxExpenditurePolicy-291"><span class="linenos">291</span></a><span class="sd">        Estimate static revenue effect of tax expenditure reform.</span>
</span><span id="TaxExpenditurePolicy-292"><a href="#TaxExpenditurePolicy-292"><span class="linenos">292</span></a>
</span><span id="TaxExpenditurePolicy-293"><a href="#TaxExpenditurePolicy-293"><span class="linenos">293</span></a><span class="sd">        For tax expenditures:</span>
</span><span id="TaxExpenditurePolicy-294"><a href="#TaxExpenditurePolicy-294"><span class="linenos">294</span></a><span class="sd">        - Elimination = full revenue gain</span>
</span><span id="TaxExpenditurePolicy-295"><a href="#TaxExpenditurePolicy-295"><span class="linenos">295</span></a><span class="sd">        - Caps = partial revenue gain</span>
</span><span id="TaxExpenditurePolicy-296"><a href="#TaxExpenditurePolicy-296"><span class="linenos">296</span></a><span class="sd">        - Expansion = revenue loss</span>
</span><span id="TaxExpenditurePolicy-297"><a href="#TaxExpenditurePolicy-297"><span class="linenos">297</span></a>
</span><span id="TaxExpenditurePolicy-298"><a href="#TaxExpenditurePolicy-298"><span class="linenos">298</span></a><span class="sd">        Returns:</span>
</span><span id="TaxExpenditurePolicy-299"><a href="#TaxExpenditurePolicy-299"><span class="linenos">299</span></a><span class="sd">            Revenue change in billions (negative = revenue loss)</span>
</span><span id="TaxExpenditurePolicy-300"><a href="#TaxExpenditurePolicy-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy-301"><a href="#TaxExpenditurePolicy-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-302"><a href="#TaxExpenditurePolicy-302"><span class="linenos">302</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="TaxExpenditurePolicy-303"><a href="#TaxExpenditurePolicy-303"><span class="linenos">303</span></a>
</span><span id="TaxExpenditurePolicy-304"><a href="#TaxExpenditurePolicy-304"><span class="linenos">304</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_expenditure_data</span><span class="p">()</span>
</span><span id="TaxExpenditurePolicy-305"><a href="#TaxExpenditurePolicy-305"><span class="linenos">305</span></a>        <span class="n">baseline_cost</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy-306"><a href="#TaxExpenditurePolicy-306"><span class="linenos">306</span></a>
</span><span id="TaxExpenditurePolicy-307"><a href="#TaxExpenditurePolicy-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;eliminate&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-308"><a href="#TaxExpenditurePolicy-308"><span class="linenos">308</span></a>            <span class="c1"># Full elimination = recapture all expenditure</span>
</span><span id="TaxExpenditurePolicy-309"><a href="#TaxExpenditurePolicy-309"><span class="linenos">309</span></a>            <span class="k">return</span> <span class="n">baseline_cost</span>
</span><span id="TaxExpenditurePolicy-310"><a href="#TaxExpenditurePolicy-310"><span class="linenos">310</span></a>
</span><span id="TaxExpenditurePolicy-311"><a href="#TaxExpenditurePolicy-311"><span class="linenos">311</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;cap&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-312"><a href="#TaxExpenditurePolicy-312"><span class="linenos">312</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_amount</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-313"><a href="#TaxExpenditurePolicy-313"><span class="linenos">313</span></a>                <span class="c1"># Estimate share affected by cap</span>
</span><span id="TaxExpenditurePolicy-314"><a href="#TaxExpenditurePolicy-314"><span class="linenos">314</span></a>                <span class="n">avg_benefit</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;avg_benefit&quot;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy-315"><a href="#TaxExpenditurePolicy-315"><span class="linenos">315</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_amount</span> <span class="o">&gt;=</span> <span class="n">avg_benefit</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-316"><a href="#TaxExpenditurePolicy-316"><span class="linenos">316</span></a>                    <span class="c1"># Cap above average = small effect</span>
</span><span id="TaxExpenditurePolicy-317"><a href="#TaxExpenditurePolicy-317"><span class="linenos">317</span></a>                    <span class="n">share_affected</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">avg_benefit</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_amount</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy-318"><a href="#TaxExpenditurePolicy-318"><span class="linenos">318</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-319"><a href="#TaxExpenditurePolicy-319"><span class="linenos">319</span></a>                    <span class="c1"># Cap below average = larger effect</span>
</span><span id="TaxExpenditurePolicy-320"><a href="#TaxExpenditurePolicy-320"><span class="linenos">320</span></a>                    <span class="n">share_affected</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_amount</span> <span class="o">/</span> <span class="n">avg_benefit</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy-321"><a href="#TaxExpenditurePolicy-321"><span class="linenos">321</span></a>                <span class="k">return</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="n">share_affected</span>
</span><span id="TaxExpenditurePolicy-322"><a href="#TaxExpenditurePolicy-322"><span class="linenos">322</span></a>
</span><span id="TaxExpenditurePolicy-323"><a href="#TaxExpenditurePolicy-323"><span class="linenos">323</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-324"><a href="#TaxExpenditurePolicy-324"><span class="linenos">324</span></a>                <span class="c1"># Rate cap (e.g., 28% limit on deductions)</span>
</span><span id="TaxExpenditurePolicy-325"><a href="#TaxExpenditurePolicy-325"><span class="linenos">325</span></a>                <span class="c1"># Affects high-bracket taxpayers</span>
</span><span id="TaxExpenditurePolicy-326"><a href="#TaxExpenditurePolicy-326"><span class="linenos">326</span></a>                <span class="k">return</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="mf">0.15</span>  <span class="c1"># Rough estimate</span>
</span><span id="TaxExpenditurePolicy-327"><a href="#TaxExpenditurePolicy-327"><span class="linenos">327</span></a>
</span><span id="TaxExpenditurePolicy-328"><a href="#TaxExpenditurePolicy-328"><span class="linenos">328</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;phase_out&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-329"><a href="#TaxExpenditurePolicy-329"><span class="linenos">329</span></a>            <span class="c1"># Income-based phase-out</span>
</span><span id="TaxExpenditurePolicy-330"><a href="#TaxExpenditurePolicy-330"><span class="linenos">330</span></a>            <span class="c1"># Affects high earners</span>
</span><span id="TaxExpenditurePolicy-331"><a href="#TaxExpenditurePolicy-331"><span class="linenos">331</span></a>            <span class="k">return</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="mf">0.20</span>
</span><span id="TaxExpenditurePolicy-332"><a href="#TaxExpenditurePolicy-332"><span class="linenos">332</span></a>
</span><span id="TaxExpenditurePolicy-333"><a href="#TaxExpenditurePolicy-333"><span class="linenos">333</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;convert&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-334"><a href="#TaxExpenditurePolicy-334"><span class="linenos">334</span></a>            <span class="c1"># Converting deduction to credit</span>
</span><span id="TaxExpenditurePolicy-335"><a href="#TaxExpenditurePolicy-335"><span class="linenos">335</span></a>            <span class="c1"># Generally more progressive, modest revenue effect</span>
</span><span id="TaxExpenditurePolicy-336"><a href="#TaxExpenditurePolicy-336"><span class="linenos">336</span></a>            <span class="k">return</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="mf">0.10</span>
</span><span id="TaxExpenditurePolicy-337"><a href="#TaxExpenditurePolicy-337"><span class="linenos">337</span></a>
</span><span id="TaxExpenditurePolicy-338"><a href="#TaxExpenditurePolicy-338"><span class="linenos">338</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;expand&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-339"><a href="#TaxExpenditurePolicy-339"><span class="linenos">339</span></a>            <span class="c1"># Expansion (like SALT cap repeal)</span>
</span><span id="TaxExpenditurePolicy-340"><a href="#TaxExpenditurePolicy-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expenditure_type</span> <span class="o">==</span> <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">SALT</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-341"><a href="#TaxExpenditurePolicy-341"><span class="linenos">341</span></a>                <span class="n">no_cap_cost</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annual_cost_no_cap&quot;</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy-342"><a href="#TaxExpenditurePolicy-342"><span class="linenos">342</span></a>                <span class="n">current_cost</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy-343"><a href="#TaxExpenditurePolicy-343"><span class="linenos">343</span></a>                <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">no_cap_cost</span> <span class="o">-</span> <span class="n">current_cost</span><span class="p">)</span>  <span class="c1"># Revenue loss</span>
</span><span id="TaxExpenditurePolicy-344"><a href="#TaxExpenditurePolicy-344"><span class="linenos">344</span></a>
</span><span id="TaxExpenditurePolicy-345"><a href="#TaxExpenditurePolicy-345"><span class="linenos">345</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">baseline_cost</span> <span class="o">*</span> <span class="mf">0.20</span>  <span class="c1"># General expansion</span>
</span><span id="TaxExpenditurePolicy-346"><a href="#TaxExpenditurePolicy-346"><span class="linenos">346</span></a>
</span><span id="TaxExpenditurePolicy-347"><a href="#TaxExpenditurePolicy-347"><span class="linenos">347</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="TaxExpenditurePolicy-348"><a href="#TaxExpenditurePolicy-348"><span class="linenos">348</span></a>
</span><span id="TaxExpenditurePolicy-349"><a href="#TaxExpenditurePolicy-349"><span class="linenos">349</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-350"><a href="#TaxExpenditurePolicy-350"><span class="linenos">350</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy-351"><a href="#TaxExpenditurePolicy-351"><span class="linenos">351</span></a><span class="sd">        Estimate behavioral response to tax expenditure changes.</span>
</span><span id="TaxExpenditurePolicy-352"><a href="#TaxExpenditurePolicy-352"><span class="linenos">352</span></a>
</span><span id="TaxExpenditurePolicy-353"><a href="#TaxExpenditurePolicy-353"><span class="linenos">353</span></a><span class="sd">        Responses include:</span>
</span><span id="TaxExpenditurePolicy-354"><a href="#TaxExpenditurePolicy-354"><span class="linenos">354</span></a><span class="sd">        - Reduced activity (less charitable giving if deduction limited)</span>
</span><span id="TaxExpenditurePolicy-355"><a href="#TaxExpenditurePolicy-355"><span class="linenos">355</span></a><span class="sd">        - Timing shifts</span>
</span><span id="TaxExpenditurePolicy-356"><a href="#TaxExpenditurePolicy-356"><span class="linenos">356</span></a><span class="sd">        - Restructuring (e.g., retirement account choices)</span>
</span><span id="TaxExpenditurePolicy-357"><a href="#TaxExpenditurePolicy-357"><span class="linenos">357</span></a>
</span><span id="TaxExpenditurePolicy-358"><a href="#TaxExpenditurePolicy-358"><span class="linenos">358</span></a><span class="sd">        Returns:</span>
</span><span id="TaxExpenditurePolicy-359"><a href="#TaxExpenditurePolicy-359"><span class="linenos">359</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="TaxExpenditurePolicy-360"><a href="#TaxExpenditurePolicy-360"><span class="linenos">360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy-361"><a href="#TaxExpenditurePolicy-361"><span class="linenos">361</span></a>        <span class="c1"># Different elasticities by expenditure type</span>
</span><span id="TaxExpenditurePolicy-362"><a href="#TaxExpenditurePolicy-362"><span class="linenos">362</span></a>        <span class="n">type_elasticities</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TaxExpenditurePolicy-363"><a href="#TaxExpenditurePolicy-363"><span class="linenos">363</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">CHARITABLE</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>  <span class="c1"># Giving responds to incentives</span>
</span><span id="TaxExpenditurePolicy-364"><a href="#TaxExpenditurePolicy-364"><span class="linenos">364</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">MORTGAGE_INTEREST</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># Housing less elastic</span>
</span><span id="TaxExpenditurePolicy-365"><a href="#TaxExpenditurePolicy-365"><span class="linenos">365</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">RETIREMENT_CONTRIBUTIONS</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-366"><a href="#TaxExpenditurePolicy-366"><span class="linenos">366</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">EMPLOYER_HEALTH</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-367"><a href="#TaxExpenditurePolicy-367"><span class="linenos">367</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">SALT</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># Can&#39;t easily change state taxes</span>
</span><span id="TaxExpenditurePolicy-368"><a href="#TaxExpenditurePolicy-368"><span class="linenos">368</span></a>        <span class="p">}</span>
</span><span id="TaxExpenditurePolicy-369"><a href="#TaxExpenditurePolicy-369"><span class="linenos">369</span></a>
</span><span id="TaxExpenditurePolicy-370"><a href="#TaxExpenditurePolicy-370"><span class="linenos">370</span></a>        <span class="n">elasticity</span> <span class="o">=</span> <span class="n">type_elasticities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="TaxExpenditurePolicy-371"><a href="#TaxExpenditurePolicy-371"><span class="linenos">371</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expenditure_type</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy-372"><a href="#TaxExpenditurePolicy-372"><span class="linenos">372</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">behavioral_elasticity</span>
</span><span id="TaxExpenditurePolicy-373"><a href="#TaxExpenditurePolicy-373"><span class="linenos">373</span></a>        <span class="p">)</span>
</span><span id="TaxExpenditurePolicy-374"><a href="#TaxExpenditurePolicy-374"><span class="linenos">374</span></a>
</span><span id="TaxExpenditurePolicy-375"><a href="#TaxExpenditurePolicy-375"><span class="linenos">375</span></a>        <span class="c1"># Behavioral offset reduces revenue gain or loss</span>
</span><span id="TaxExpenditurePolicy-376"><a href="#TaxExpenditurePolicy-376"><span class="linenos">376</span></a>        <span class="n">offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="n">elasticity</span>
</span><span id="TaxExpenditurePolicy-377"><a href="#TaxExpenditurePolicy-377"><span class="linenos">377</span></a>
</span><span id="TaxExpenditurePolicy-378"><a href="#TaxExpenditurePolicy-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-379"><a href="#TaxExpenditurePolicy-379"><span class="linenos">379</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">offset</span>  <span class="c1"># Reduces revenue gain</span>
</span><span id="TaxExpenditurePolicy-380"><a href="#TaxExpenditurePolicy-380"><span class="linenos">380</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy-381"><a href="#TaxExpenditurePolicy-381"><span class="linenos">381</span></a>            <span class="k">return</span> <span class="n">offset</span>  <span class="c1"># Reduces revenue loss</span>
</span></pre></div>


            <div class="docstring"><p>Tax expenditure policy modeling changes to deductions, exclusions, and credits.</p>

<p>Models reform options including:</p>

<ul>
<li>Elimination (full repeal)</li>
<li>Caps (dollar or rate limits)</li>
<li>Income phase-outs</li>
<li>Conversion to credits</li>
</ul>

<p>Key parameters:
    expenditure_type: Category of tax expenditure
    action: Type of reform (eliminate, cap, phase_out, convert)
    cap_amount: Dollar cap (if action is 'cap')
    phase_out_start: Income where phase-out begins
    convert_to_credit: Convert deduction to credit (if applicable)</p>
</div>


                            <div id="TaxExpenditurePolicy.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TaxExpenditurePolicy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">policy_type</span><span class="p">:</span> <span class="n"><a href="#PolicyType">PolicyType</a></span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2025</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">phase_in_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">sunset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">rate_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affected_income_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_income_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">credit_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">credit_refundable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">deduction_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">affected_taxpayers_millions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">taxable_income_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">labor_supply_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">annual_revenue_change_billions</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">avg_taxable_income_in_bracket</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">marginal_rate_before</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">expenditure_type</span><span class="p">:</span> <span class="n"><a href="#TaxExpenditureType">TaxExpenditureType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#TaxExpenditureType.CHARITABLE">TaxExpenditureType.CHARITABLE</a></span><span class="p">:</span> <span class="s1">&#39;charitable&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">action</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;eliminate&#39;</span><span class="p">,</span> <span class="s1">&#39;cap&#39;</span><span class="p">,</span> <span class="s1">&#39;phase_out&#39;</span><span class="p">,</span> <span class="s1">&#39;convert&#39;</span><span class="p">,</span> <span class="s1">&#39;expand&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cap&#39;</span>,</span><span class="param">	<span class="n">cap_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cap_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">phase_out_start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">phase_out_end</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">phase_out_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.03</span>,</span><span class="param">	<span class="n">convert_to_credit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">credit_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>,</span><span class="param">	<span class="n">expand_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">behavioral_elasticity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span>,</span><span class="param">	<span class="n">participation_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.__init__"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.expenditure_type" class="classattr">
                                <div class="attr variable">
            <span class="name">expenditure_type</span><span class="annotation">: <a href="#TaxExpenditureType">TaxExpenditureType</a></span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.CHARITABLE">TaxExpenditureType.CHARITABLE</a>: &#39;charitable&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.expenditure_type"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.action" class="classattr">
                                <div class="attr variable">
            <span class="name">action</span><span class="annotation">: Literal[&#39;eliminate&#39;, &#39;cap&#39;, &#39;phase_out&#39;, &#39;convert&#39;, &#39;expand&#39;]</span>        =
<span class="default_value">&#39;cap&#39;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.action"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.cap_amount" class="classattr">
                                <div class="attr variable">
            <span class="name">cap_amount</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.cap_amount"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.cap_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">cap_rate</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.cap_rate"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.phase_out_start" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_out_start</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.phase_out_start"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.phase_out_end" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_out_end</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.phase_out_end"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.phase_out_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">phase_out_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.03</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.phase_out_rate"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.convert_to_credit" class="classattr">
                                <div class="attr variable">
            <span class="name">convert_to_credit</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.convert_to_credit"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.credit_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">credit_rate</span><span class="annotation">: float</span>        =
<span class="default_value">0.15</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.credit_rate"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.expand_limit" class="classattr">
                                <div class="attr variable">
            <span class="name">expand_limit</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.expand_limit"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.behavioral_elasticity" class="classattr">
                                <div class="attr variable">
            <span class="name">behavioral_elasticity</span><span class="annotation">: float</span>        =
<span class="default_value">0.2</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.behavioral_elasticity"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.participation_change" class="classattr">
                                <div class="attr variable">
            <span class="name">participation_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.participation_change"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.annual_revenue_change_billions" class="classattr">
                                <div class="attr variable">
            <span class="name">annual_revenue_change_billions</span><span class="annotation">: float | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.annual_revenue_change_billions"></a>
    
    

                            </div>
                            <div id="TaxExpenditurePolicy.get_expenditure_data" class="classattr">
                                        <input id="TaxExpenditurePolicy.get_expenditure_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_expenditure_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="TaxExpenditurePolicy.get_expenditure_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.get_expenditure_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxExpenditurePolicy.get_expenditure_data-270"><a href="#TaxExpenditurePolicy.get_expenditure_data-270"><span class="linenos">270</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_expenditure_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-271"><a href="#TaxExpenditurePolicy.get_expenditure_data-271"><span class="linenos">271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get baseline data for this expenditure type.&quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-272"><a href="#TaxExpenditurePolicy.get_expenditure_data-272"><span class="linenos">272</span></a>        <span class="n">type_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-273"><a href="#TaxExpenditurePolicy.get_expenditure_data-273"><span class="linenos">273</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">EMPLOYER_HEALTH</span><span class="p">:</span> <span class="s2">&quot;employer_health&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-274"><a href="#TaxExpenditurePolicy.get_expenditure_data-274"><span class="linenos">274</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">RETIREMENT_CONTRIBUTIONS</span><span class="p">:</span> <span class="s2">&quot;retirement_401k&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-275"><a href="#TaxExpenditurePolicy.get_expenditure_data-275"><span class="linenos">275</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">MORTGAGE_INTEREST</span><span class="p">:</span> <span class="s2">&quot;mortgage_interest&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-276"><a href="#TaxExpenditurePolicy.get_expenditure_data-276"><span class="linenos">276</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">SALT</span><span class="p">:</span> <span class="s2">&quot;salt&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-277"><a href="#TaxExpenditurePolicy.get_expenditure_data-277"><span class="linenos">277</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">CHARITABLE</span><span class="p">:</span> <span class="s2">&quot;charitable&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-278"><a href="#TaxExpenditurePolicy.get_expenditure_data-278"><span class="linenos">278</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">CAPITAL_GAINS</span><span class="p">:</span> <span class="s2">&quot;capital_gains_dividends&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-279"><a href="#TaxExpenditurePolicy.get_expenditure_data-279"><span class="linenos">279</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">STEP_UP_BASIS</span><span class="p">:</span> <span class="s2">&quot;step_up_basis&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-280"><a href="#TaxExpenditurePolicy.get_expenditure_data-280"><span class="linenos">280</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">LIKE_KIND_EXCHANGE</span><span class="p">:</span> <span class="s2">&quot;like_kind_exchange&quot;</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-281"><a href="#TaxExpenditurePolicy.get_expenditure_data-281"><span class="linenos">281</span></a>        <span class="p">}</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-282"><a href="#TaxExpenditurePolicy.get_expenditure_data-282"><span class="linenos">282</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">type_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expenditure_type</span><span class="p">,</span> <span class="s2">&quot;charitable&quot;</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy.get_expenditure_data-283"><a href="#TaxExpenditurePolicy.get_expenditure_data-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">{})</span>
</span></pre></div>


            <div class="docstring"><p>Get baseline data for this expenditure type.</p>
</div>


                            </div>
                            <div id="TaxExpenditurePolicy.estimate_static_revenue_effect" class="classattr">
                                        <input id="TaxExpenditurePolicy.estimate_static_revenue_effect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_static_revenue_effect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TaxExpenditurePolicy.estimate_static_revenue_effect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.estimate_static_revenue_effect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-285"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-285"><span class="linenos">285</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_static_revenue_effect</span><span class="p">(</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-286"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-287"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-287"><span class="linenos">287</span></a>        <span class="n">baseline_revenue</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-288"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-288"><span class="linenos">288</span></a>        <span class="n">use_real_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-289"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-289"><span class="linenos">289</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-290"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-290"><span class="linenos">290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-291"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-291"><span class="linenos">291</span></a><span class="sd">        Estimate static revenue effect of tax expenditure reform.</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-292"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-292"><span class="linenos">292</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-293"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-293"><span class="linenos">293</span></a><span class="sd">        For tax expenditures:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-294"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-294"><span class="linenos">294</span></a><span class="sd">        - Elimination = full revenue gain</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-295"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-295"><span class="linenos">295</span></a><span class="sd">        - Caps = partial revenue gain</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-296"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-296"><span class="linenos">296</span></a><span class="sd">        - Expansion = revenue loss</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-297"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-297"><span class="linenos">297</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-298"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-298"><span class="linenos">298</span></a><span class="sd">        Returns:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-299"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-299"><span class="linenos">299</span></a><span class="sd">            Revenue change in billions (negative = revenue loss)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-300"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-301"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-302"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-302"><span class="linenos">302</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">annual_revenue_change_billions</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-303"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-303"><span class="linenos">303</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-304"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-304"><span class="linenos">304</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_expenditure_data</span><span class="p">()</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-305"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-305"><span class="linenos">305</span></a>        <span class="n">baseline_cost</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-306"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-306"><span class="linenos">306</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-307"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;eliminate&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-308"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-308"><span class="linenos">308</span></a>            <span class="c1"># Full elimination = recapture all expenditure</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-309"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-309"><span class="linenos">309</span></a>            <span class="k">return</span> <span class="n">baseline_cost</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-310"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-310"><span class="linenos">310</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-311"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-311"><span class="linenos">311</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;cap&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-312"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-312"><span class="linenos">312</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_amount</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-313"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-313"><span class="linenos">313</span></a>                <span class="c1"># Estimate share affected by cap</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-314"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-314"><span class="linenos">314</span></a>                <span class="n">avg_benefit</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;avg_benefit&quot;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-315"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-315"><span class="linenos">315</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_amount</span> <span class="o">&gt;=</span> <span class="n">avg_benefit</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-316"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-316"><span class="linenos">316</span></a>                    <span class="c1"># Cap above average = small effect</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-317"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-317"><span class="linenos">317</span></a>                    <span class="n">share_affected</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">avg_benefit</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_amount</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-318"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-318"><span class="linenos">318</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-319"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-319"><span class="linenos">319</span></a>                    <span class="c1"># Cap below average = larger effect</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-320"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-320"><span class="linenos">320</span></a>                    <span class="n">share_affected</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_amount</span> <span class="o">/</span> <span class="n">avg_benefit</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-321"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-321"><span class="linenos">321</span></a>                <span class="k">return</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="n">share_affected</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-322"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-322"><span class="linenos">322</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-323"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-323"><span class="linenos">323</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-324"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-324"><span class="linenos">324</span></a>                <span class="c1"># Rate cap (e.g., 28% limit on deductions)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-325"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-325"><span class="linenos">325</span></a>                <span class="c1"># Affects high-bracket taxpayers</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-326"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-326"><span class="linenos">326</span></a>                <span class="k">return</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="mf">0.15</span>  <span class="c1"># Rough estimate</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-327"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-327"><span class="linenos">327</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-328"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-328"><span class="linenos">328</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;phase_out&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-329"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-329"><span class="linenos">329</span></a>            <span class="c1"># Income-based phase-out</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-330"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-330"><span class="linenos">330</span></a>            <span class="c1"># Affects high earners</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-331"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-331"><span class="linenos">331</span></a>            <span class="k">return</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="mf">0.20</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-332"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-332"><span class="linenos">332</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-333"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-333"><span class="linenos">333</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;convert&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-334"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-334"><span class="linenos">334</span></a>            <span class="c1"># Converting deduction to credit</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-335"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-335"><span class="linenos">335</span></a>            <span class="c1"># Generally more progressive, modest revenue effect</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-336"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-336"><span class="linenos">336</span></a>            <span class="k">return</span> <span class="n">baseline_cost</span> <span class="o">*</span> <span class="mf">0.10</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-337"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-337"><span class="linenos">337</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-338"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-338"><span class="linenos">338</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;expand&quot;</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-339"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-339"><span class="linenos">339</span></a>            <span class="c1"># Expansion (like SALT cap repeal)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-340"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expenditure_type</span> <span class="o">==</span> <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">SALT</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-341"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-341"><span class="linenos">341</span></a>                <span class="n">no_cap_cost</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annual_cost_no_cap&quot;</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-342"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-342"><span class="linenos">342</span></a>                <span class="n">current_cost</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">)</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-343"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-343"><span class="linenos">343</span></a>                <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">no_cap_cost</span> <span class="o">-</span> <span class="n">current_cost</span><span class="p">)</span>  <span class="c1"># Revenue loss</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-344"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-344"><span class="linenos">344</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-345"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-345"><span class="linenos">345</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">baseline_cost</span> <span class="o">*</span> <span class="mf">0.20</span>  <span class="c1"># General expansion</span>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-346"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-346"><span class="linenos">346</span></a>
</span><span id="TaxExpenditurePolicy.estimate_static_revenue_effect-347"><a href="#TaxExpenditurePolicy.estimate_static_revenue_effect-347"><span class="linenos">347</span></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span></pre></div>


            <div class="docstring"><p>Estimate static revenue effect of tax expenditure reform.</p>

<p>For tax expenditures:</p>

<ul>
<li>Elimination = full revenue gain</li>
<li>Caps = partial revenue gain</li>
<li>Expansion = revenue loss</li>
</ul>

<p>Returns:
    Revenue change in billions (negative = revenue loss)</p>
</div>


                            </div>
                            <div id="TaxExpenditurePolicy.estimate_behavioral_offset" class="classattr">
                                        <input id="TaxExpenditurePolicy.estimate_behavioral_offset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_behavioral_offset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="TaxExpenditurePolicy.estimate_behavioral_offset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxExpenditurePolicy.estimate_behavioral_offset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-349"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-349"><span class="linenos">349</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_behavioral_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">static_effect</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-350"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-350"><span class="linenos">350</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-351"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-351"><span class="linenos">351</span></a><span class="sd">        Estimate behavioral response to tax expenditure changes.</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-352"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-352"><span class="linenos">352</span></a>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-353"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-353"><span class="linenos">353</span></a><span class="sd">        Responses include:</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-354"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-354"><span class="linenos">354</span></a><span class="sd">        - Reduced activity (less charitable giving if deduction limited)</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-355"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-355"><span class="linenos">355</span></a><span class="sd">        - Timing shifts</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-356"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-356"><span class="linenos">356</span></a><span class="sd">        - Restructuring (e.g., retirement account choices)</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-357"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-357"><span class="linenos">357</span></a>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-358"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-358"><span class="linenos">358</span></a><span class="sd">        Returns:</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-359"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-359"><span class="linenos">359</span></a><span class="sd">            Behavioral offset in billions</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-360"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-360"><span class="linenos">360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-361"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-361"><span class="linenos">361</span></a>        <span class="c1"># Different elasticities by expenditure type</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-362"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-362"><span class="linenos">362</span></a>        <span class="n">type_elasticities</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-363"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-363"><span class="linenos">363</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">CHARITABLE</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>  <span class="c1"># Giving responds to incentives</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-364"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-364"><span class="linenos">364</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">MORTGAGE_INTEREST</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># Housing less elastic</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-365"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-365"><span class="linenos">365</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">RETIREMENT_CONTRIBUTIONS</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-366"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-366"><span class="linenos">366</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">EMPLOYER_HEALTH</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-367"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-367"><span class="linenos">367</span></a>            <span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">SALT</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># Can&#39;t easily change state taxes</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-368"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-368"><span class="linenos">368</span></a>        <span class="p">}</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-369"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-369"><span class="linenos">369</span></a>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-370"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-370"><span class="linenos">370</span></a>        <span class="n">elasticity</span> <span class="o">=</span> <span class="n">type_elasticities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-371"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-371"><span class="linenos">371</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expenditure_type</span><span class="p">,</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-372"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-372"><span class="linenos">372</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">behavioral_elasticity</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-373"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-373"><span class="linenos">373</span></a>        <span class="p">)</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-374"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-374"><span class="linenos">374</span></a>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-375"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-375"><span class="linenos">375</span></a>        <span class="c1"># Behavioral offset reduces revenue gain or loss</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-376"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-376"><span class="linenos">376</span></a>        <span class="n">offset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">static_effect</span><span class="p">)</span> <span class="o">*</span> <span class="n">elasticity</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-377"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-377"><span class="linenos">377</span></a>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-378"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="n">static_effect</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-379"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-379"><span class="linenos">379</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">offset</span>  <span class="c1"># Reduces revenue gain</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-380"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-380"><span class="linenos">380</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TaxExpenditurePolicy.estimate_behavioral_offset-381"><a href="#TaxExpenditurePolicy.estimate_behavioral_offset-381"><span class="linenos">381</span></a>            <span class="k">return</span> <span class="n">offset</span>  <span class="c1"># Reduces revenue loss</span>
</span></pre></div>


            <div class="docstring"><p>Estimate behavioral response to tax expenditure changes.</p>

<p>Responses include:</p>

<ul>
<li>Reduced activity (less charitable giving if deduction limited)</li>
<li>Timing shifts</li>
<li>Restructuring (e.g., retirement account choices)</li>
</ul>

<p>Returns:
    Behavioral offset in billions</p>
</div>


                            </div>
                </section>
                <section id="TaxExpenditureType">
                            <input id="TaxExpenditureType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TaxExpenditureType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="TaxExpenditureType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TaxExpenditureType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TaxExpenditureType-35"><a href="#TaxExpenditureType-35"><span class="linenos">35</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TaxExpenditureType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="TaxExpenditureType-36"><a href="#TaxExpenditureType-36"><span class="linenos">36</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Categories of tax expenditures.&quot;&quot;&quot;</span>
</span><span id="TaxExpenditureType-37"><a href="#TaxExpenditureType-37"><span class="linenos">37</span></a>    <span class="c1"># Exclusions (income never taxed)</span>
</span><span id="TaxExpenditureType-38"><a href="#TaxExpenditureType-38"><span class="linenos">38</span></a>    <span class="n">EMPLOYER_HEALTH</span> <span class="o">=</span> <span class="s2">&quot;employer_health&quot;</span>  <span class="c1"># Employer-paid health insurance</span>
</span><span id="TaxExpenditureType-39"><a href="#TaxExpenditureType-39"><span class="linenos">39</span></a>    <span class="n">RETIREMENT_CONTRIBUTIONS</span> <span class="o">=</span> <span class="s2">&quot;retirement_contrib&quot;</span>  <span class="c1"># 401k, IRA contributions</span>
</span><span id="TaxExpenditureType-40"><a href="#TaxExpenditureType-40"><span class="linenos">40</span></a>    <span class="n">RETIREMENT_EARNINGS</span> <span class="o">=</span> <span class="s2">&quot;retirement_earnings&quot;</span>  <span class="c1"># Tax-free growth in accounts</span>
</span><span id="TaxExpenditureType-41"><a href="#TaxExpenditureType-41"><span class="linenos">41</span></a>
</span><span id="TaxExpenditureType-42"><a href="#TaxExpenditureType-42"><span class="linenos">42</span></a>    <span class="c1"># Deductions (reduce taxable income)</span>
</span><span id="TaxExpenditureType-43"><a href="#TaxExpenditureType-43"><span class="linenos">43</span></a>    <span class="n">MORTGAGE_INTEREST</span> <span class="o">=</span> <span class="s2">&quot;mortgage_interest&quot;</span>
</span><span id="TaxExpenditureType-44"><a href="#TaxExpenditureType-44"><span class="linenos">44</span></a>    <span class="n">SALT</span> <span class="o">=</span> <span class="s2">&quot;salt&quot;</span>  <span class="c1"># State and local taxes</span>
</span><span id="TaxExpenditureType-45"><a href="#TaxExpenditureType-45"><span class="linenos">45</span></a>    <span class="n">CHARITABLE</span> <span class="o">=</span> <span class="s2">&quot;charitable&quot;</span>
</span><span id="TaxExpenditureType-46"><a href="#TaxExpenditureType-46"><span class="linenos">46</span></a>    <span class="n">MEDICAL_EXPENSES</span> <span class="o">=</span> <span class="s2">&quot;medical&quot;</span>
</span><span id="TaxExpenditureType-47"><a href="#TaxExpenditureType-47"><span class="linenos">47</span></a>
</span><span id="TaxExpenditureType-48"><a href="#TaxExpenditureType-48"><span class="linenos">48</span></a>    <span class="c1"># Preferential rates</span>
</span><span id="TaxExpenditureType-49"><a href="#TaxExpenditureType-49"><span class="linenos">49</span></a>    <span class="n">CAPITAL_GAINS</span> <span class="o">=</span> <span class="s2">&quot;capital_gains&quot;</span>  <span class="c1"># Lower rates (see capital_gains.py)</span>
</span><span id="TaxExpenditureType-50"><a href="#TaxExpenditureType-50"><span class="linenos">50</span></a>    <span class="n">DIVIDENDS</span> <span class="o">=</span> <span class="s2">&quot;dividends&quot;</span>  <span class="c1"># Qualified dividends</span>
</span><span id="TaxExpenditureType-51"><a href="#TaxExpenditureType-51"><span class="linenos">51</span></a>
</span><span id="TaxExpenditureType-52"><a href="#TaxExpenditureType-52"><span class="linenos">52</span></a>    <span class="c1"># Credits (direct reduction in tax)</span>
</span><span id="TaxExpenditureType-53"><a href="#TaxExpenditureType-53"><span class="linenos">53</span></a>    <span class="n">CHILD_TAX_CREDIT</span> <span class="o">=</span> <span class="s2">&quot;ctc&quot;</span>  <span class="c1"># See credits.py</span>
</span><span id="TaxExpenditureType-54"><a href="#TaxExpenditureType-54"><span class="linenos">54</span></a>    <span class="n">EITC</span> <span class="o">=</span> <span class="s2">&quot;eitc&quot;</span>  <span class="c1"># See credits.py</span>
</span><span id="TaxExpenditureType-55"><a href="#TaxExpenditureType-55"><span class="linenos">55</span></a>
</span><span id="TaxExpenditureType-56"><a href="#TaxExpenditureType-56"><span class="linenos">56</span></a>    <span class="c1"># Other</span>
</span><span id="TaxExpenditureType-57"><a href="#TaxExpenditureType-57"><span class="linenos">57</span></a>    <span class="n">STEP_UP_BASIS</span> <span class="o">=</span> <span class="s2">&quot;step_up&quot;</span>  <span class="c1"># Basis reset at death</span>
</span><span id="TaxExpenditureType-58"><a href="#TaxExpenditureType-58"><span class="linenos">58</span></a>    <span class="n">LIKE_KIND_EXCHANGE</span> <span class="o">=</span> <span class="s2">&quot;like_kind&quot;</span>  <span class="c1"># 1031 exchanges</span>
</span><span id="TaxExpenditureType-59"><a href="#TaxExpenditureType-59"><span class="linenos">59</span></a>    <span class="n">PASS_THROUGH_DEDUCTION</span> <span class="o">=</span> <span class="s2">&quot;pass_through&quot;</span>  <span class="c1"># Section 199A (see tcja.py)</span>
</span></pre></div>


            <div class="docstring"><p>Categories of tax expenditures.</p>
</div>


                            <div id="TaxExpenditureType.EMPLOYER_HEALTH" class="classattr">
                                <div class="attr variable">
            <span class="name">EMPLOYER_HEALTH</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.EMPLOYER_HEALTH">TaxExpenditureType.EMPLOYER_HEALTH</a>: &#39;employer_health&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.EMPLOYER_HEALTH"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.RETIREMENT_CONTRIBUTIONS" class="classattr">
                                <div class="attr variable">
            <span class="name">RETIREMENT_CONTRIBUTIONS</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.RETIREMENT_CONTRIBUTIONS">TaxExpenditureType.RETIREMENT_CONTRIBUTIONS</a>: &#39;retirement_contrib&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.RETIREMENT_CONTRIBUTIONS"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.RETIREMENT_EARNINGS" class="classattr">
                                <div class="attr variable">
            <span class="name">RETIREMENT_EARNINGS</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.RETIREMENT_EARNINGS">TaxExpenditureType.RETIREMENT_EARNINGS</a>: &#39;retirement_earnings&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.RETIREMENT_EARNINGS"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.MORTGAGE_INTEREST" class="classattr">
                                <div class="attr variable">
            <span class="name">MORTGAGE_INTEREST</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.MORTGAGE_INTEREST">TaxExpenditureType.MORTGAGE_INTEREST</a>: &#39;mortgage_interest&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.MORTGAGE_INTEREST"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.SALT" class="classattr">
                                <div class="attr variable">
            <span class="name">SALT</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.SALT">TaxExpenditureType.SALT</a>: &#39;salt&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.SALT"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.CHARITABLE" class="classattr">
                                <div class="attr variable">
            <span class="name">CHARITABLE</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.CHARITABLE">TaxExpenditureType.CHARITABLE</a>: &#39;charitable&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.CHARITABLE"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.MEDICAL_EXPENSES" class="classattr">
                                <div class="attr variable">
            <span class="name">MEDICAL_EXPENSES</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.MEDICAL_EXPENSES">TaxExpenditureType.MEDICAL_EXPENSES</a>: &#39;medical&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.MEDICAL_EXPENSES"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.CAPITAL_GAINS" class="classattr">
                                <div class="attr variable">
            <span class="name">CAPITAL_GAINS</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.CAPITAL_GAINS">TaxExpenditureType.CAPITAL_GAINS</a>: &#39;capital_gains&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.CAPITAL_GAINS"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.DIVIDENDS" class="classattr">
                                <div class="attr variable">
            <span class="name">DIVIDENDS</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.DIVIDENDS">TaxExpenditureType.DIVIDENDS</a>: &#39;dividends&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.DIVIDENDS"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.CHILD_TAX_CREDIT" class="classattr">
                                <div class="attr variable">
            <span class="name">CHILD_TAX_CREDIT</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.CHILD_TAX_CREDIT">TaxExpenditureType.CHILD_TAX_CREDIT</a>: &#39;ctc&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.CHILD_TAX_CREDIT"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.EITC" class="classattr">
                                <div class="attr variable">
            <span class="name">EITC</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.EITC">TaxExpenditureType.EITC</a>: &#39;eitc&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.EITC"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.STEP_UP_BASIS" class="classattr">
                                <div class="attr variable">
            <span class="name">STEP_UP_BASIS</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.STEP_UP_BASIS">TaxExpenditureType.STEP_UP_BASIS</a>: &#39;step_up&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.STEP_UP_BASIS"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.LIKE_KIND_EXCHANGE" class="classattr">
                                <div class="attr variable">
            <span class="name">LIKE_KIND_EXCHANGE</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.LIKE_KIND_EXCHANGE">TaxExpenditureType.LIKE_KIND_EXCHANGE</a>: &#39;like_kind&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.LIKE_KIND_EXCHANGE"></a>
    
    

                            </div>
                            <div id="TaxExpenditureType.PASS_THROUGH_DEDUCTION" class="classattr">
                                <div class="attr variable">
            <span class="name">PASS_THROUGH_DEDUCTION</span>        =
<span class="default_value">&lt;<a href="#TaxExpenditureType.PASS_THROUGH_DEDUCTION">TaxExpenditureType.PASS_THROUGH_DEDUCTION</a>: &#39;pass_through&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TaxExpenditureType.PASS_THROUGH_DEDUCTION"></a>
    
    

                            </div>
                </section>
                <section id="JCT_TAX_EXPENDITURES">
                    <div class="attr variable">
            <span class="name">JCT_TAX_EXPENDITURES</span>        =
<input id="JCT_TAX_EXPENDITURES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="JCT_TAX_EXPENDITURES-view-value"></label><span class="default_value">{&#39;employer_health&#39;: {&#39;annual_cost&#39;: 250.0, &#39;affected_millions&#39;: 155.0, &#39;avg_benefit&#39;: 1600, &#39;growth_rate&#39;: 0.04}, &#39;retirement_401k&#39;: {&#39;annual_cost&#39;: 251.0, &#39;affected_millions&#39;: 70.0, &#39;avg_benefit&#39;: 3600, &#39;growth_rate&#39;: 0.03}, &#39;retirement_db&#39;: {&#39;annual_cost&#39;: 122.0, &#39;affected_millions&#39;: 35.0, &#39;avg_benefit&#39;: 3500, &#39;growth_rate&#39;: 0.02}, &#39;retirement_ira&#39;: {&#39;annual_cost&#39;: 27.0, &#39;affected_millions&#39;: 50.0, &#39;avg_benefit&#39;: 540, &#39;growth_rate&#39;: 0.03}, &#39;mortgage_interest&#39;: {&#39;annual_cost&#39;: 25.0, &#39;annual_cost_no_limit&#39;: 100.0, &#39;affected_millions&#39;: 20.0, &#39;avg_benefit&#39;: 1250, &#39;growth_rate&#39;: 0.03}, &#39;salt&#39;: {&#39;annual_cost&#39;: 25.0, &#39;annual_cost_no_cap&#39;: 120.0, &#39;affected_millions&#39;: 15.0, &#39;avg_benefit&#39;: 1700, &#39;growth_rate&#39;: 0.03}, &#39;charitable&#39;: {&#39;annual_cost&#39;: 70.0, &#39;affected_millions&#39;: 25.0, &#39;avg_benefit&#39;: 2800, &#39;growth_rate&#39;: 0.03}, &#39;capital_gains_dividends&#39;: {&#39;annual_cost&#39;: 225.0, &#39;affected_millions&#39;: 25.0, &#39;avg_benefit&#39;: 9000, &#39;growth_rate&#39;: 0.04}, &#39;step_up_basis&#39;: {&#39;annual_cost&#39;: 50.0, &#39;affected_millions&#39;: 2.5, &#39;avg_benefit&#39;: 20000, &#39;growth_rate&#39;: 0.04}, &#39;like_kind_exchange&#39;: {&#39;annual_cost&#39;: 7.0, &#39;affected_millions&#39;: 0.5, &#39;avg_benefit&#39;: 14000, &#39;growth_rate&#39;: 0.03}}</span>

        
    </div>
    <a class="headerlink" href="#JCT_TAX_EXPENDITURES"></a>
    
    

                </section>
                <section id="REFORM_ESTIMATES">
                    <div class="attr variable">
            <span class="name">REFORM_ESTIMATES</span>        =
<input id="REFORM_ESTIMATES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="REFORM_ESTIMATES-view-value"></label><span class="default_value">{&#39;cap_employer_exclusion_50k&#39;: {&#39;revenue_10yr&#39;: 450.0, &#39;source&#39;: &#39;CBO&#39;, &#39;notes&#39;: &#39;Cap on excludable employer health contributions&#39;}, &#39;eliminate_employer_exclusion&#39;: {&#39;revenue_10yr&#39;: 2500.0, &#39;source&#39;: &#39;CBO estimate&#39;, &#39;notes&#39;: &#39;Would be largest base broadener but disruptive&#39;}, &#39;cap_retirement_contrib_20k&#39;: {&#39;revenue_10yr&#39;: 150.0, &#39;source&#39;: &#39;CBO&#39;, &#39;notes&#39;: &#39;Equalizes treatment across plan types&#39;}, &#39;require_roth_high_income&#39;: {&#39;revenue_10yr&#39;: 100.0, &#39;source&#39;: &#39;Biden proposal&#39;, &#39;notes&#39;: &#39;Shifts timing of revenue&#39;}, &#39;eliminate_mortgage_deduction&#39;: {&#39;revenue_10yr&#39;: 300.0, &#39;source&#39;: &#39;CBO&#39;, &#39;notes&#39;: &#39;Controversial - affects homeownership&#39;}, &#39;cap_mortgage_500k&#39;: {&#39;revenue_10yr&#39;: 30.0, &#39;source&#39;: &#39;CBO estimate&#39;, &#39;notes&#39;: &#39;Moderate reform&#39;}, &#39;repeal_salt_cap&#39;: {&#39;revenue_10yr&#39;: -1100.0, &#39;source&#39;: &#39;JCT&#39;, &#39;notes&#39;: &#39;Popular bipartisan proposal - costs money&#39;}, &#39;eliminate_salt&#39;: {&#39;revenue_10yr&#39;: 1200.0, &#39;source&#39;: &#39;JCT estimate&#39;, &#39;notes&#39;: &#39;Very controversial - affects high-tax states&#39;}, &#39;cap_charitable_deduction&#39;: {&#39;revenue_10yr&#39;: 200.0, &#39;source&#39;: &#39;Obama proposal&#39;, &#39;notes&#39;: &#39;Pease-style limit on high-income itemizers&#39;}, &#39;eliminate_charitable_deduction&#39;: {&#39;revenue_10yr&#39;: 700.0, &#39;source&#39;: &#39;Estimate&#39;, &#39;notes&#39;: &#39;Would significantly affect nonprofit sector&#39;}, &#39;eliminate_step_up&#39;: {&#39;revenue_10yr&#39;: 500.0, &#39;source&#39;: &#39;Biden proposal&#39;, &#39;notes&#39;: &#39;Tax gains at death (with $1M+ exemption)&#39;}, &#39;eliminate_like_kind&#39;: {&#39;revenue_10yr&#39;: 80.0, &#39;source&#39;: &#39;Biden proposal&#39;, &#39;notes&#39;: &#39;End 1031 exchange deferral&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#REFORM_ESTIMATES"></a>
    
    

                </section>
                <section id="create_cap_employer_health_exclusion">
                            <input id="create_cap_employer_health_exclusion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_cap_employer_health_exclusion</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">cap_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">50000</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_cap_employer_health_exclusion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_cap_employer_health_exclusion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_cap_employer_health_exclusion-388"><a href="#create_cap_employer_health_exclusion-388"><span class="linenos">388</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_cap_employer_health_exclusion</span><span class="p">(</span>
</span><span id="create_cap_employer_health_exclusion-389"><a href="#create_cap_employer_health_exclusion-389"><span class="linenos">389</span></a>    <span class="n">cap_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">50_000</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-390"><a href="#create_cap_employer_health_exclusion-390"><span class="linenos">390</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-391"><a href="#create_cap_employer_health_exclusion-391"><span class="linenos">391</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-392"><a href="#create_cap_employer_health_exclusion-392"><span class="linenos">392</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxExpenditurePolicy</span><span class="p">:</span>
</span><span id="create_cap_employer_health_exclusion-393"><a href="#create_cap_employer_health_exclusion-393"><span class="linenos">393</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_cap_employer_health_exclusion-394"><a href="#create_cap_employer_health_exclusion-394"><span class="linenos">394</span></a><span class="sd">    Create policy to cap employer health insurance exclusion.</span>
</span><span id="create_cap_employer_health_exclusion-395"><a href="#create_cap_employer_health_exclusion-395"><span class="linenos">395</span></a>
</span><span id="create_cap_employer_health_exclusion-396"><a href="#create_cap_employer_health_exclusion-396"><span class="linenos">396</span></a><span class="sd">    The exclusion of employer-paid health insurance from income is the</span>
</span><span id="create_cap_employer_health_exclusion-397"><a href="#create_cap_employer_health_exclusion-397"><span class="linenos">397</span></a><span class="sd">    third-largest tax expenditure (~$250B/year). Capping it would raise</span>
</span><span id="create_cap_employer_health_exclusion-398"><a href="#create_cap_employer_health_exclusion-398"><span class="linenos">398</span></a><span class="sd">    significant revenue while maintaining incentive for coverage.</span>
</span><span id="create_cap_employer_health_exclusion-399"><a href="#create_cap_employer_health_exclusion-399"><span class="linenos">399</span></a>
</span><span id="create_cap_employer_health_exclusion-400"><a href="#create_cap_employer_health_exclusion-400"><span class="linenos">400</span></a><span class="sd">    Args:</span>
</span><span id="create_cap_employer_health_exclusion-401"><a href="#create_cap_employer_health_exclusion-401"><span class="linenos">401</span></a><span class="sd">        cap_amount: Maximum excludable amount (e.g., $50,000 for family)</span>
</span><span id="create_cap_employer_health_exclusion-402"><a href="#create_cap_employer_health_exclusion-402"><span class="linenos">402</span></a><span class="sd">        start_year: First year</span>
</span><span id="create_cap_employer_health_exclusion-403"><a href="#create_cap_employer_health_exclusion-403"><span class="linenos">403</span></a><span class="sd">        duration_years: Duration</span>
</span><span id="create_cap_employer_health_exclusion-404"><a href="#create_cap_employer_health_exclusion-404"><span class="linenos">404</span></a>
</span><span id="create_cap_employer_health_exclusion-405"><a href="#create_cap_employer_health_exclusion-405"><span class="linenos">405</span></a><span class="sd">    CBO estimate: Capping at ~$50K raises ~$45B/year (~$450B/10yr)</span>
</span><span id="create_cap_employer_health_exclusion-406"><a href="#create_cap_employer_health_exclusion-406"><span class="linenos">406</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_cap_employer_health_exclusion-407"><a href="#create_cap_employer_health_exclusion-407"><span class="linenos">407</span></a>    <span class="k">return</span> <span class="n">TaxExpenditurePolicy</span><span class="p">(</span>
</span><span id="create_cap_employer_health_exclusion-408"><a href="#create_cap_employer_health_exclusion-408"><span class="linenos">408</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cap Employer Health Exclusion at $</span><span class="si">{</span><span class="n">cap_amount</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K&quot;</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-409"><a href="#create_cap_employer_health_exclusion-409"><span class="linenos">409</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cap tax exclusion for employer health insurance at $</span><span class="si">{</span><span class="n">cap_amount</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-410"><a href="#create_cap_employer_health_exclusion-410"><span class="linenos">410</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-411"><a href="#create_cap_employer_health_exclusion-411"><span class="linenos">411</span></a>        <span class="n">expenditure_type</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">EMPLOYER_HEALTH</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-412"><a href="#create_cap_employer_health_exclusion-412"><span class="linenos">412</span></a>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;cap&quot;</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-413"><a href="#create_cap_employer_health_exclusion-413"><span class="linenos">413</span></a>        <span class="n">cap_amount</span><span class="o">=</span><span class="n">cap_amount</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-414"><a href="#create_cap_employer_health_exclusion-414"><span class="linenos">414</span></a>        <span class="n">behavioral_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># In calibration</span>
</span><span id="create_cap_employer_health_exclusion-415"><a href="#create_cap_employer_health_exclusion-415"><span class="linenos">415</span></a>        <span class="c1"># Calibrated to CBO ~$450B over 10 years (with 4% healthcare growth)</span>
</span><span id="create_cap_employer_health_exclusion-416"><a href="#create_cap_employer_health_exclusion-416"><span class="linenos">416</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">31.2</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-417"><a href="#create_cap_employer_health_exclusion-417"><span class="linenos">417</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-418"><a href="#create_cap_employer_health_exclusion-418"><span class="linenos">418</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_cap_employer_health_exclusion-419"><a href="#create_cap_employer_health_exclusion-419"><span class="linenos">419</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to cap employer health insurance exclusion.</p>

<p>The exclusion of employer-paid health insurance from income is the
third-largest tax expenditure (~$250B/year). Capping it would raise
significant revenue while maintaining incentive for coverage.</p>

<p>Args:
    cap_amount: Maximum excludable amount (e.g., $50,000 for family)
    start_year: First year
    duration_years: Duration</p>

<p>CBO estimate: Capping at ~$50K raises ~$45B/year (~$450B/10yr)</p>
</div>


                </section>
                <section id="create_eliminate_mortgage_deduction">
                            <input id="create_eliminate_mortgage_deduction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_eliminate_mortgage_deduction</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_eliminate_mortgage_deduction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_eliminate_mortgage_deduction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_eliminate_mortgage_deduction-422"><a href="#create_eliminate_mortgage_deduction-422"><span class="linenos">422</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_eliminate_mortgage_deduction</span><span class="p">(</span>
</span><span id="create_eliminate_mortgage_deduction-423"><a href="#create_eliminate_mortgage_deduction-423"><span class="linenos">423</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-424"><a href="#create_eliminate_mortgage_deduction-424"><span class="linenos">424</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-425"><a href="#create_eliminate_mortgage_deduction-425"><span class="linenos">425</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxExpenditurePolicy</span><span class="p">:</span>
</span><span id="create_eliminate_mortgage_deduction-426"><a href="#create_eliminate_mortgage_deduction-426"><span class="linenos">426</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_eliminate_mortgage_deduction-427"><a href="#create_eliminate_mortgage_deduction-427"><span class="linenos">427</span></a><span class="sd">    Create policy to eliminate mortgage interest deduction.</span>
</span><span id="create_eliminate_mortgage_deduction-428"><a href="#create_eliminate_mortgage_deduction-428"><span class="linenos">428</span></a>
</span><span id="create_eliminate_mortgage_deduction-429"><a href="#create_eliminate_mortgage_deduction-429"><span class="linenos">429</span></a><span class="sd">    The mortgage interest deduction costs ~$25B/year under TCJA limits,</span>
</span><span id="create_eliminate_mortgage_deduction-430"><a href="#create_eliminate_mortgage_deduction-430"><span class="linenos">430</span></a><span class="sd">    ~$100B/year without limits. Full elimination would raise significant</span>
</span><span id="create_eliminate_mortgage_deduction-431"><a href="#create_eliminate_mortgage_deduction-431"><span class="linenos">431</span></a><span class="sd">    revenue but is politically difficult.</span>
</span><span id="create_eliminate_mortgage_deduction-432"><a href="#create_eliminate_mortgage_deduction-432"><span class="linenos">432</span></a>
</span><span id="create_eliminate_mortgage_deduction-433"><a href="#create_eliminate_mortgage_deduction-433"><span class="linenos">433</span></a><span class="sd">    CBO estimate: Full elimination raises ~$30B/year (~$300B/10yr)</span>
</span><span id="create_eliminate_mortgage_deduction-434"><a href="#create_eliminate_mortgage_deduction-434"><span class="linenos">434</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_eliminate_mortgage_deduction-435"><a href="#create_eliminate_mortgage_deduction-435"><span class="linenos">435</span></a>    <span class="k">return</span> <span class="n">TaxExpenditurePolicy</span><span class="p">(</span>
</span><span id="create_eliminate_mortgage_deduction-436"><a href="#create_eliminate_mortgage_deduction-436"><span class="linenos">436</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Eliminate Mortgage Interest Deduction&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-437"><a href="#create_eliminate_mortgage_deduction-437"><span class="linenos">437</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Repeal the mortgage interest deduction for home purchases&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-438"><a href="#create_eliminate_mortgage_deduction-438"><span class="linenos">438</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-439"><a href="#create_eliminate_mortgage_deduction-439"><span class="linenos">439</span></a>        <span class="n">expenditure_type</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">MORTGAGE_INTEREST</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-440"><a href="#create_eliminate_mortgage_deduction-440"><span class="linenos">440</span></a>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;eliminate&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-441"><a href="#create_eliminate_mortgage_deduction-441"><span class="linenos">441</span></a>        <span class="n">behavioral_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-442"><a href="#create_eliminate_mortgage_deduction-442"><span class="linenos">442</span></a>        <span class="c1"># Calibrated to CBO ~$300B over 10 years</span>
</span><span id="create_eliminate_mortgage_deduction-443"><a href="#create_eliminate_mortgage_deduction-443"><span class="linenos">443</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">26.2</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-444"><a href="#create_eliminate_mortgage_deduction-444"><span class="linenos">444</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-445"><a href="#create_eliminate_mortgage_deduction-445"><span class="linenos">445</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_eliminate_mortgage_deduction-446"><a href="#create_eliminate_mortgage_deduction-446"><span class="linenos">446</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to eliminate mortgage interest deduction.</p>

<p>The mortgage interest deduction costs ~$25B/year under TCJA limits,
~$100B/year without limits. Full elimination would raise significant
revenue but is politically difficult.</p>

<p>CBO estimate: Full elimination raises ~$30B/year (~$300B/10yr)</p>
</div>


                </section>
                <section id="create_repeal_salt_cap">
                            <input id="create_repeal_salt_cap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_repeal_salt_cap</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_repeal_salt_cap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_repeal_salt_cap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_repeal_salt_cap-449"><a href="#create_repeal_salt_cap-449"><span class="linenos">449</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_repeal_salt_cap</span><span class="p">(</span>
</span><span id="create_repeal_salt_cap-450"><a href="#create_repeal_salt_cap-450"><span class="linenos">450</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-451"><a href="#create_repeal_salt_cap-451"><span class="linenos">451</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-452"><a href="#create_repeal_salt_cap-452"><span class="linenos">452</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxExpenditurePolicy</span><span class="p">:</span>
</span><span id="create_repeal_salt_cap-453"><a href="#create_repeal_salt_cap-453"><span class="linenos">453</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_repeal_salt_cap-454"><a href="#create_repeal_salt_cap-454"><span class="linenos">454</span></a><span class="sd">    Create policy to repeal SALT deduction cap.</span>
</span><span id="create_repeal_salt_cap-455"><a href="#create_repeal_salt_cap-455"><span class="linenos">455</span></a>
</span><span id="create_repeal_salt_cap-456"><a href="#create_repeal_salt_cap-456"><span class="linenos">456</span></a><span class="sd">    The TCJA $10K SALT cap expires after 2025. This policy explicitly</span>
</span><span id="create_repeal_salt_cap-457"><a href="#create_repeal_salt_cap-457"><span class="linenos">457</span></a><span class="sd">    repeals the cap, restoring unlimited SALT deductions.</span>
</span><span id="create_repeal_salt_cap-458"><a href="#create_repeal_salt_cap-458"><span class="linenos">458</span></a>
</span><span id="create_repeal_salt_cap-459"><a href="#create_repeal_salt_cap-459"><span class="linenos">459</span></a><span class="sd">    JCT estimate: Costs ~$110B/year (~$1.1T over 10 years)</span>
</span><span id="create_repeal_salt_cap-460"><a href="#create_repeal_salt_cap-460"><span class="linenos">460</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_repeal_salt_cap-461"><a href="#create_repeal_salt_cap-461"><span class="linenos">461</span></a>    <span class="k">return</span> <span class="n">TaxExpenditurePolicy</span><span class="p">(</span>
</span><span id="create_repeal_salt_cap-462"><a href="#create_repeal_salt_cap-462"><span class="linenos">462</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Repeal SALT Cap&quot;</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-463"><a href="#create_repeal_salt_cap-463"><span class="linenos">463</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Remove $10,000 cap on state and local tax deduction&quot;</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-464"><a href="#create_repeal_salt_cap-464"><span class="linenos">464</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-465"><a href="#create_repeal_salt_cap-465"><span class="linenos">465</span></a>        <span class="n">expenditure_type</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">SALT</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-466"><a href="#create_repeal_salt_cap-466"><span class="linenos">466</span></a>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-467"><a href="#create_repeal_salt_cap-467"><span class="linenos">467</span></a>        <span class="n">behavioral_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-468"><a href="#create_repeal_salt_cap-468"><span class="linenos">468</span></a>        <span class="c1"># Calibrated to JCT ~$1.1T over 10 years</span>
</span><span id="create_repeal_salt_cap-469"><a href="#create_repeal_salt_cap-469"><span class="linenos">469</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=-</span><span class="mf">96.0</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-470"><a href="#create_repeal_salt_cap-470"><span class="linenos">470</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-471"><a href="#create_repeal_salt_cap-471"><span class="linenos">471</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_repeal_salt_cap-472"><a href="#create_repeal_salt_cap-472"><span class="linenos">472</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to repeal SALT deduction cap.</p>

<p>The TCJA $10K SALT cap expires after 2025. This policy explicitly
repeals the cap, restoring unlimited SALT deductions.</p>

<p>JCT estimate: Costs ~$110B/year (~$1.1T over 10 years)</p>
</div>


                </section>
                <section id="create_eliminate_salt_deduction">
                            <input id="create_eliminate_salt_deduction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_eliminate_salt_deduction</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_eliminate_salt_deduction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_eliminate_salt_deduction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_eliminate_salt_deduction-475"><a href="#create_eliminate_salt_deduction-475"><span class="linenos">475</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_eliminate_salt_deduction</span><span class="p">(</span>
</span><span id="create_eliminate_salt_deduction-476"><a href="#create_eliminate_salt_deduction-476"><span class="linenos">476</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-477"><a href="#create_eliminate_salt_deduction-477"><span class="linenos">477</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-478"><a href="#create_eliminate_salt_deduction-478"><span class="linenos">478</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxExpenditurePolicy</span><span class="p">:</span>
</span><span id="create_eliminate_salt_deduction-479"><a href="#create_eliminate_salt_deduction-479"><span class="linenos">479</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_eliminate_salt_deduction-480"><a href="#create_eliminate_salt_deduction-480"><span class="linenos">480</span></a><span class="sd">    Create policy to eliminate SALT deduction entirely.</span>
</span><span id="create_eliminate_salt_deduction-481"><a href="#create_eliminate_salt_deduction-481"><span class="linenos">481</span></a>
</span><span id="create_eliminate_salt_deduction-482"><a href="#create_eliminate_salt_deduction-482"><span class="linenos">482</span></a><span class="sd">    Full elimination of SALT (state and local tax) deduction would raise</span>
</span><span id="create_eliminate_salt_deduction-483"><a href="#create_eliminate_salt_deduction-483"><span class="linenos">483</span></a><span class="sd">    ~$120B/year but is very controversial in high-tax states.</span>
</span><span id="create_eliminate_salt_deduction-484"><a href="#create_eliminate_salt_deduction-484"><span class="linenos">484</span></a>
</span><span id="create_eliminate_salt_deduction-485"><a href="#create_eliminate_salt_deduction-485"><span class="linenos">485</span></a><span class="sd">    JCT estimate: ~$1.2T over 10 years</span>
</span><span id="create_eliminate_salt_deduction-486"><a href="#create_eliminate_salt_deduction-486"><span class="linenos">486</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_eliminate_salt_deduction-487"><a href="#create_eliminate_salt_deduction-487"><span class="linenos">487</span></a>    <span class="k">return</span> <span class="n">TaxExpenditurePolicy</span><span class="p">(</span>
</span><span id="create_eliminate_salt_deduction-488"><a href="#create_eliminate_salt_deduction-488"><span class="linenos">488</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Eliminate SALT Deduction&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-489"><a href="#create_eliminate_salt_deduction-489"><span class="linenos">489</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Completely eliminate state and local tax deduction&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-490"><a href="#create_eliminate_salt_deduction-490"><span class="linenos">490</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-491"><a href="#create_eliminate_salt_deduction-491"><span class="linenos">491</span></a>        <span class="n">expenditure_type</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">SALT</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-492"><a href="#create_eliminate_salt_deduction-492"><span class="linenos">492</span></a>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;eliminate&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-493"><a href="#create_eliminate_salt_deduction-493"><span class="linenos">493</span></a>        <span class="n">behavioral_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-494"><a href="#create_eliminate_salt_deduction-494"><span class="linenos">494</span></a>        <span class="c1"># Calibrated to JCT ~$1.2T over 10 years</span>
</span><span id="create_eliminate_salt_deduction-495"><a href="#create_eliminate_salt_deduction-495"><span class="linenos">495</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">104.7</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-496"><a href="#create_eliminate_salt_deduction-496"><span class="linenos">496</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-497"><a href="#create_eliminate_salt_deduction-497"><span class="linenos">497</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_eliminate_salt_deduction-498"><a href="#create_eliminate_salt_deduction-498"><span class="linenos">498</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to eliminate SALT deduction entirely.</p>

<p>Full elimination of SALT (state and local tax) deduction would raise
~$120B/year but is very controversial in high-tax states.</p>

<p>JCT estimate: ~$1.2T over 10 years</p>
</div>


                </section>
                <section id="create_cap_charitable_deduction">
                            <input id="create_cap_charitable_deduction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_cap_charitable_deduction</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">cap_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.28</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_cap_charitable_deduction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_cap_charitable_deduction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_cap_charitable_deduction-501"><a href="#create_cap_charitable_deduction-501"><span class="linenos">501</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_cap_charitable_deduction</span><span class="p">(</span>
</span><span id="create_cap_charitable_deduction-502"><a href="#create_cap_charitable_deduction-502"><span class="linenos">502</span></a>    <span class="n">cap_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.28</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-503"><a href="#create_cap_charitable_deduction-503"><span class="linenos">503</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-504"><a href="#create_cap_charitable_deduction-504"><span class="linenos">504</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-505"><a href="#create_cap_charitable_deduction-505"><span class="linenos">505</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxExpenditurePolicy</span><span class="p">:</span>
</span><span id="create_cap_charitable_deduction-506"><a href="#create_cap_charitable_deduction-506"><span class="linenos">506</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_cap_charitable_deduction-507"><a href="#create_cap_charitable_deduction-507"><span class="linenos">507</span></a><span class="sd">    Create policy to cap charitable deduction value at 28% rate.</span>
</span><span id="create_cap_charitable_deduction-508"><a href="#create_cap_charitable_deduction-508"><span class="linenos">508</span></a>
</span><span id="create_cap_charitable_deduction-509"><a href="#create_cap_charitable_deduction-509"><span class="linenos">509</span></a><span class="sd">    Limits the tax benefit of charitable deductions for high-bracket</span>
</span><span id="create_cap_charitable_deduction-510"><a href="#create_cap_charitable_deduction-510"><span class="linenos">510</span></a><span class="sd">    taxpayers to 28% regardless of their marginal rate.</span>
</span><span id="create_cap_charitable_deduction-511"><a href="#create_cap_charitable_deduction-511"><span class="linenos">511</span></a>
</span><span id="create_cap_charitable_deduction-512"><a href="#create_cap_charitable_deduction-512"><span class="linenos">512</span></a><span class="sd">    Obama/Biden proposal estimate: ~$200B over 10 years</span>
</span><span id="create_cap_charitable_deduction-513"><a href="#create_cap_charitable_deduction-513"><span class="linenos">513</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_cap_charitable_deduction-514"><a href="#create_cap_charitable_deduction-514"><span class="linenos">514</span></a>    <span class="k">return</span> <span class="n">TaxExpenditurePolicy</span><span class="p">(</span>
</span><span id="create_cap_charitable_deduction-515"><a href="#create_cap_charitable_deduction-515"><span class="linenos">515</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cap Charitable Deduction at </span><span class="si">{</span><span class="n">cap_rate</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-516"><a href="#create_cap_charitable_deduction-516"><span class="linenos">516</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Limit charitable deduction value to </span><span class="si">{</span><span class="n">cap_rate</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% rate&quot;</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-517"><a href="#create_cap_charitable_deduction-517"><span class="linenos">517</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-518"><a href="#create_cap_charitable_deduction-518"><span class="linenos">518</span></a>        <span class="n">expenditure_type</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">CHARITABLE</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-519"><a href="#create_cap_charitable_deduction-519"><span class="linenos">519</span></a>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;cap&quot;</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-520"><a href="#create_cap_charitable_deduction-520"><span class="linenos">520</span></a>        <span class="n">cap_rate</span><span class="o">=</span><span class="n">cap_rate</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-521"><a href="#create_cap_charitable_deduction-521"><span class="linenos">521</span></a>        <span class="n">behavioral_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-522"><a href="#create_cap_charitable_deduction-522"><span class="linenos">522</span></a>        <span class="c1"># Calibrated to ~$200B over 10 years (with 3% growth)</span>
</span><span id="create_cap_charitable_deduction-523"><a href="#create_cap_charitable_deduction-523"><span class="linenos">523</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">12.5</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-524"><a href="#create_cap_charitable_deduction-524"><span class="linenos">524</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-525"><a href="#create_cap_charitable_deduction-525"><span class="linenos">525</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_cap_charitable_deduction-526"><a href="#create_cap_charitable_deduction-526"><span class="linenos">526</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to cap charitable deduction value at 28% rate.</p>

<p>Limits the tax benefit of charitable deductions for high-bracket
taxpayers to 28% regardless of their marginal rate.</p>

<p>Obama/Biden proposal estimate: ~$200B over 10 years</p>
</div>


                </section>
                <section id="create_eliminate_step_up_basis">
                            <input id="create_eliminate_step_up_basis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_eliminate_step_up_basis</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">exemption</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000000</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_eliminate_step_up_basis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_eliminate_step_up_basis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_eliminate_step_up_basis-529"><a href="#create_eliminate_step_up_basis-529"><span class="linenos">529</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_eliminate_step_up_basis</span><span class="p">(</span>
</span><span id="create_eliminate_step_up_basis-530"><a href="#create_eliminate_step_up_basis-530"><span class="linenos">530</span></a>    <span class="n">exemption</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1_000_000</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-531"><a href="#create_eliminate_step_up_basis-531"><span class="linenos">531</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-532"><a href="#create_eliminate_step_up_basis-532"><span class="linenos">532</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-533"><a href="#create_eliminate_step_up_basis-533"><span class="linenos">533</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxExpenditurePolicy</span><span class="p">:</span>
</span><span id="create_eliminate_step_up_basis-534"><a href="#create_eliminate_step_up_basis-534"><span class="linenos">534</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_eliminate_step_up_basis-535"><a href="#create_eliminate_step_up_basis-535"><span class="linenos">535</span></a><span class="sd">    Create policy to eliminate step-up in basis at death.</span>
</span><span id="create_eliminate_step_up_basis-536"><a href="#create_eliminate_step_up_basis-536"><span class="linenos">536</span></a>
</span><span id="create_eliminate_step_up_basis-537"><a href="#create_eliminate_step_up_basis-537"><span class="linenos">537</span></a><span class="sd">    Currently, capital gains are forgiven when assets pass to heirs</span>
</span><span id="create_eliminate_step_up_basis-538"><a href="#create_eliminate_step_up_basis-538"><span class="linenos">538</span></a><span class="sd">    (basis &quot;steps up&quot; to fair market value). Eliminating this would</span>
</span><span id="create_eliminate_step_up_basis-539"><a href="#create_eliminate_step_up_basis-539"><span class="linenos">539</span></a><span class="sd">    require heirs to pay tax on unrealized gains.</span>
</span><span id="create_eliminate_step_up_basis-540"><a href="#create_eliminate_step_up_basis-540"><span class="linenos">540</span></a>
</span><span id="create_eliminate_step_up_basis-541"><a href="#create_eliminate_step_up_basis-541"><span class="linenos">541</span></a><span class="sd">    Biden proposal: Eliminate with $1M exemption, raises ~$500B/10yr</span>
</span><span id="create_eliminate_step_up_basis-542"><a href="#create_eliminate_step_up_basis-542"><span class="linenos">542</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_eliminate_step_up_basis-543"><a href="#create_eliminate_step_up_basis-543"><span class="linenos">543</span></a>    <span class="k">return</span> <span class="n">TaxExpenditurePolicy</span><span class="p">(</span>
</span><span id="create_eliminate_step_up_basis-544"><a href="#create_eliminate_step_up_basis-544"><span class="linenos">544</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Eliminate Step-Up Basis&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-545"><a href="#create_eliminate_step_up_basis-545"><span class="linenos">545</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Tax capital gains at death ($</span><span class="si">{</span><span class="n">exemption</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">M exemption)&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-546"><a href="#create_eliminate_step_up_basis-546"><span class="linenos">546</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-547"><a href="#create_eliminate_step_up_basis-547"><span class="linenos">547</span></a>        <span class="n">expenditure_type</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">STEP_UP_BASIS</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-548"><a href="#create_eliminate_step_up_basis-548"><span class="linenos">548</span></a>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;eliminate&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-549"><a href="#create_eliminate_step_up_basis-549"><span class="linenos">549</span></a>        <span class="n">cap_amount</span><span class="o">=</span><span class="n">exemption</span><span class="p">,</span>  <span class="c1"># Using cap_amount for exemption</span>
</span><span id="create_eliminate_step_up_basis-550"><a href="#create_eliminate_step_up_basis-550"><span class="linenos">550</span></a>        <span class="n">behavioral_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-551"><a href="#create_eliminate_step_up_basis-551"><span class="linenos">551</span></a>        <span class="c1"># Calibrated to Biden ~$500B over 10 years</span>
</span><span id="create_eliminate_step_up_basis-552"><a href="#create_eliminate_step_up_basis-552"><span class="linenos">552</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">43.6</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-553"><a href="#create_eliminate_step_up_basis-553"><span class="linenos">553</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-554"><a href="#create_eliminate_step_up_basis-554"><span class="linenos">554</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_eliminate_step_up_basis-555"><a href="#create_eliminate_step_up_basis-555"><span class="linenos">555</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to eliminate step-up in basis at death.</p>

<p>Currently, capital gains are forgiven when assets pass to heirs
(basis "steps up" to fair market value). Eliminating this would
require heirs to pay tax on unrealized gains.</p>

<p>Biden proposal: Eliminate with $1M exemption, raises ~$500B/10yr</p>
</div>


                </section>
                <section id="create_eliminate_like_kind_exchange">
                            <input id="create_eliminate_like_kind_exchange-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_eliminate_like_kind_exchange</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_eliminate_like_kind_exchange-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_eliminate_like_kind_exchange"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_eliminate_like_kind_exchange-558"><a href="#create_eliminate_like_kind_exchange-558"><span class="linenos">558</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_eliminate_like_kind_exchange</span><span class="p">(</span>
</span><span id="create_eliminate_like_kind_exchange-559"><a href="#create_eliminate_like_kind_exchange-559"><span class="linenos">559</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-560"><a href="#create_eliminate_like_kind_exchange-560"><span class="linenos">560</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-561"><a href="#create_eliminate_like_kind_exchange-561"><span class="linenos">561</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxExpenditurePolicy</span><span class="p">:</span>
</span><span id="create_eliminate_like_kind_exchange-562"><a href="#create_eliminate_like_kind_exchange-562"><span class="linenos">562</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_eliminate_like_kind_exchange-563"><a href="#create_eliminate_like_kind_exchange-563"><span class="linenos">563</span></a><span class="sd">    Create policy to eliminate like-kind (1031) exchanges.</span>
</span><span id="create_eliminate_like_kind_exchange-564"><a href="#create_eliminate_like_kind_exchange-564"><span class="linenos">564</span></a>
</span><span id="create_eliminate_like_kind_exchange-565"><a href="#create_eliminate_like_kind_exchange-565"><span class="linenos">565</span></a><span class="sd">    Section 1031 allows deferral of gains on real estate exchanges.</span>
</span><span id="create_eliminate_like_kind_exchange-566"><a href="#create_eliminate_like_kind_exchange-566"><span class="linenos">566</span></a><span class="sd">    Biden proposal would eliminate this deferral.</span>
</span><span id="create_eliminate_like_kind_exchange-567"><a href="#create_eliminate_like_kind_exchange-567"><span class="linenos">567</span></a>
</span><span id="create_eliminate_like_kind_exchange-568"><a href="#create_eliminate_like_kind_exchange-568"><span class="linenos">568</span></a><span class="sd">    Biden proposal estimate: ~$80B over 10 years</span>
</span><span id="create_eliminate_like_kind_exchange-569"><a href="#create_eliminate_like_kind_exchange-569"><span class="linenos">569</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_eliminate_like_kind_exchange-570"><a href="#create_eliminate_like_kind_exchange-570"><span class="linenos">570</span></a>    <span class="k">return</span> <span class="n">TaxExpenditurePolicy</span><span class="p">(</span>
</span><span id="create_eliminate_like_kind_exchange-571"><a href="#create_eliminate_like_kind_exchange-571"><span class="linenos">571</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Eliminate Like-Kind Exchanges&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-572"><a href="#create_eliminate_like_kind_exchange-572"><span class="linenos">572</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Repeal Section 1031 like-kind exchange deferral&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-573"><a href="#create_eliminate_like_kind_exchange-573"><span class="linenos">573</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-574"><a href="#create_eliminate_like_kind_exchange-574"><span class="linenos">574</span></a>        <span class="n">expenditure_type</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">LIKE_KIND_EXCHANGE</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-575"><a href="#create_eliminate_like_kind_exchange-575"><span class="linenos">575</span></a>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;eliminate&quot;</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-576"><a href="#create_eliminate_like_kind_exchange-576"><span class="linenos">576</span></a>        <span class="n">behavioral_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-577"><a href="#create_eliminate_like_kind_exchange-577"><span class="linenos">577</span></a>        <span class="c1"># Calibrated to ~$80B over 10 years</span>
</span><span id="create_eliminate_like_kind_exchange-578"><a href="#create_eliminate_like_kind_exchange-578"><span class="linenos">578</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-579"><a href="#create_eliminate_like_kind_exchange-579"><span class="linenos">579</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-580"><a href="#create_eliminate_like_kind_exchange-580"><span class="linenos">580</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_eliminate_like_kind_exchange-581"><a href="#create_eliminate_like_kind_exchange-581"><span class="linenos">581</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to eliminate like-kind (1031) exchanges.</p>

<p>Section 1031 allows deferral of gains on real estate exchanges.
Biden proposal would eliminate this deferral.</p>

<p>Biden proposal estimate: ~$80B over 10 years</p>
</div>


                </section>
                <section id="create_cap_retirement_contributions">
                            <input id="create_cap_retirement_contributions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_cap_retirement_contributions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">cap_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">20000</span>,</span><span class="param">	<span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span>,</span><span class="param">	<span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">) -> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span>:</span></span>

                <label class="view-source-button" for="create_cap_retirement_contributions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_cap_retirement_contributions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_cap_retirement_contributions-584"><a href="#create_cap_retirement_contributions-584"><span class="linenos">584</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_cap_retirement_contributions</span><span class="p">(</span>
</span><span id="create_cap_retirement_contributions-585"><a href="#create_cap_retirement_contributions-585"><span class="linenos">585</span></a>    <span class="n">cap_amount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">20_000</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-586"><a href="#create_cap_retirement_contributions-586"><span class="linenos">586</span></a>    <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2026</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-587"><a href="#create_cap_retirement_contributions-587"><span class="linenos">587</span></a>    <span class="n">duration_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-588"><a href="#create_cap_retirement_contributions-588"><span class="linenos">588</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaxExpenditurePolicy</span><span class="p">:</span>
</span><span id="create_cap_retirement_contributions-589"><a href="#create_cap_retirement_contributions-589"><span class="linenos">589</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_cap_retirement_contributions-590"><a href="#create_cap_retirement_contributions-590"><span class="linenos">590</span></a><span class="sd">    Create policy to cap tax-advantaged retirement contributions.</span>
</span><span id="create_cap_retirement_contributions-591"><a href="#create_cap_retirement_contributions-591"><span class="linenos">591</span></a>
</span><span id="create_cap_retirement_contributions-592"><a href="#create_cap_retirement_contributions-592"><span class="linenos">592</span></a><span class="sd">    Would equalize treatment across 401k, IRA, and DB plans by</span>
</span><span id="create_cap_retirement_contributions-593"><a href="#create_cap_retirement_contributions-593"><span class="linenos">593</span></a><span class="sd">    limiting total annual tax-advantaged contributions.</span>
</span><span id="create_cap_retirement_contributions-594"><a href="#create_cap_retirement_contributions-594"><span class="linenos">594</span></a>
</span><span id="create_cap_retirement_contributions-595"><a href="#create_cap_retirement_contributions-595"><span class="linenos">595</span></a><span class="sd">    CBO estimate: Cap at $20K raises ~$150B over 10 years</span>
</span><span id="create_cap_retirement_contributions-596"><a href="#create_cap_retirement_contributions-596"><span class="linenos">596</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_cap_retirement_contributions-597"><a href="#create_cap_retirement_contributions-597"><span class="linenos">597</span></a>    <span class="k">return</span> <span class="n">TaxExpenditurePolicy</span><span class="p">(</span>
</span><span id="create_cap_retirement_contributions-598"><a href="#create_cap_retirement_contributions-598"><span class="linenos">598</span></a>        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cap Retirement Contributions at $</span><span class="si">{</span><span class="n">cap_amount</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K&quot;</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-599"><a href="#create_cap_retirement_contributions-599"><span class="linenos">599</span></a>        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Limit tax-advantaged retirement contributions to $</span><span class="si">{</span><span class="n">cap_amount</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">/year&quot;</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-600"><a href="#create_cap_retirement_contributions-600"><span class="linenos">600</span></a>        <span class="n">policy_type</span><span class="o">=</span><span class="n">PolicyType</span><span class="o">.</span><span class="n">TAX_DEDUCTION</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-601"><a href="#create_cap_retirement_contributions-601"><span class="linenos">601</span></a>        <span class="n">expenditure_type</span><span class="o">=</span><span class="n">TaxExpenditureType</span><span class="o">.</span><span class="n">RETIREMENT_CONTRIBUTIONS</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-602"><a href="#create_cap_retirement_contributions-602"><span class="linenos">602</span></a>        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;cap&quot;</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-603"><a href="#create_cap_retirement_contributions-603"><span class="linenos">603</span></a>        <span class="n">cap_amount</span><span class="o">=</span><span class="n">cap_amount</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-604"><a href="#create_cap_retirement_contributions-604"><span class="linenos">604</span></a>        <span class="n">behavioral_elasticity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-605"><a href="#create_cap_retirement_contributions-605"><span class="linenos">605</span></a>        <span class="c1"># Calibrated to CBO ~$150B over 10 years</span>
</span><span id="create_cap_retirement_contributions-606"><a href="#create_cap_retirement_contributions-606"><span class="linenos">606</span></a>        <span class="n">annual_revenue_change_billions</span><span class="o">=</span><span class="mf">13.1</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-607"><a href="#create_cap_retirement_contributions-607"><span class="linenos">607</span></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">start_year</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-608"><a href="#create_cap_retirement_contributions-608"><span class="linenos">608</span></a>        <span class="n">duration_years</span><span class="o">=</span><span class="n">duration_years</span><span class="p">,</span>
</span><span id="create_cap_retirement_contributions-609"><a href="#create_cap_retirement_contributions-609"><span class="linenos">609</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create policy to cap tax-advantaged retirement contributions.</p>

<p>Would equalize treatment across 401k, IRA, and DB plans by
limiting total annual tax-advantaged contributions.</p>

<p>CBO estimate: Cap at $20K raises ~$150B over 10 years</p>
</div>


                </section>
                <section id="estimate_expenditure_revenue">
                            <input id="estimate_expenditure_revenue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">estimate_expenditure_revenue</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#TaxExpenditurePolicy">TaxExpenditurePolicy</a></span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="estimate_expenditure_revenue-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#estimate_expenditure_revenue"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="estimate_expenditure_revenue-662"><a href="#estimate_expenditure_revenue-662"><span class="linenos">662</span></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_expenditure_revenue</span><span class="p">(</span><span class="n">policy</span><span class="p">:</span> <span class="n">TaxExpenditurePolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="estimate_expenditure_revenue-663"><a href="#estimate_expenditure_revenue-663"><span class="linenos">663</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="estimate_expenditure_revenue-664"><a href="#estimate_expenditure_revenue-664"><span class="linenos">664</span></a><span class="sd">    Estimate total revenue effect of tax expenditure policy.</span>
</span><span id="estimate_expenditure_revenue-665"><a href="#estimate_expenditure_revenue-665"><span class="linenos">665</span></a>
</span><span id="estimate_expenditure_revenue-666"><a href="#estimate_expenditure_revenue-666"><span class="linenos">666</span></a><span class="sd">    Returns dict with:</span>
</span><span id="estimate_expenditure_revenue-667"><a href="#estimate_expenditure_revenue-667"><span class="linenos">667</span></a><span class="sd">        - annual_static: Average annual static effect</span>
</span><span id="estimate_expenditure_revenue-668"><a href="#estimate_expenditure_revenue-668"><span class="linenos">668</span></a><span class="sd">        - ten_year_static: Total 10-year static effect</span>
</span><span id="estimate_expenditure_revenue-669"><a href="#estimate_expenditure_revenue-669"><span class="linenos">669</span></a><span class="sd">        - behavioral_offset: Total behavioral offset</span>
</span><span id="estimate_expenditure_revenue-670"><a href="#estimate_expenditure_revenue-670"><span class="linenos">670</span></a><span class="sd">        - net_effect: Final effect after behavioral response</span>
</span><span id="estimate_expenditure_revenue-671"><a href="#estimate_expenditure_revenue-671"><span class="linenos">671</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="estimate_expenditure_revenue-672"><a href="#estimate_expenditure_revenue-672"><span class="linenos">672</span></a>    <span class="n">annual_static</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_static_revenue_effect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="estimate_expenditure_revenue-673"><a href="#estimate_expenditure_revenue-673"><span class="linenos">673</span></a>    <span class="n">behavioral</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">estimate_behavioral_offset</span><span class="p">(</span><span class="n">annual_static</span><span class="p">)</span>
</span><span id="estimate_expenditure_revenue-674"><a href="#estimate_expenditure_revenue-674"><span class="linenos">674</span></a>
</span><span id="estimate_expenditure_revenue-675"><a href="#estimate_expenditure_revenue-675"><span class="linenos">675</span></a>    <span class="c1"># Growth rate depends on type</span>
</span><span id="estimate_expenditure_revenue-676"><a href="#estimate_expenditure_revenue-676"><span class="linenos">676</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">get_expenditure_data</span><span class="p">()</span>
</span><span id="estimate_expenditure_revenue-677"><a href="#estimate_expenditure_revenue-677"><span class="linenos">677</span></a>    <span class="n">growth_rate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;growth_rate&quot;</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">)</span>
</span><span id="estimate_expenditure_revenue-678"><a href="#estimate_expenditure_revenue-678"><span class="linenos">678</span></a>
</span><span id="estimate_expenditure_revenue-679"><a href="#estimate_expenditure_revenue-679"><span class="linenos">679</span></a>    <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="estimate_expenditure_revenue-680"><a href="#estimate_expenditure_revenue-680"><span class="linenos">680</span></a>    <span class="n">annual_effects</span> <span class="o">=</span> <span class="n">annual_static</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_expenditure_revenue-681"><a href="#estimate_expenditure_revenue-681"><span class="linenos">681</span></a>    <span class="n">behavioral_effects</span> <span class="o">=</span> <span class="n">behavioral</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">growth_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">years</span><span class="p">)</span>
</span><span id="estimate_expenditure_revenue-682"><a href="#estimate_expenditure_revenue-682"><span class="linenos">682</span></a>
</span><span id="estimate_expenditure_revenue-683"><a href="#estimate_expenditure_revenue-683"><span class="linenos">683</span></a>    <span class="n">ten_year_static</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">annual_effects</span><span class="p">)</span>
</span><span id="estimate_expenditure_revenue-684"><a href="#estimate_expenditure_revenue-684"><span class="linenos">684</span></a>    <span class="n">ten_year_behavioral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">behavioral_effects</span><span class="p">)</span>
</span><span id="estimate_expenditure_revenue-685"><a href="#estimate_expenditure_revenue-685"><span class="linenos">685</span></a>
</span><span id="estimate_expenditure_revenue-686"><a href="#estimate_expenditure_revenue-686"><span class="linenos">686</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="estimate_expenditure_revenue-687"><a href="#estimate_expenditure_revenue-687"><span class="linenos">687</span></a>        <span class="s2">&quot;annual_static&quot;</span><span class="p">:</span> <span class="n">annual_static</span><span class="p">,</span>
</span><span id="estimate_expenditure_revenue-688"><a href="#estimate_expenditure_revenue-688"><span class="linenos">688</span></a>        <span class="s2">&quot;ten_year_static&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span><span class="p">,</span>
</span><span id="estimate_expenditure_revenue-689"><a href="#estimate_expenditure_revenue-689"><span class="linenos">689</span></a>        <span class="s2">&quot;behavioral_offset&quot;</span><span class="p">:</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_expenditure_revenue-690"><a href="#estimate_expenditure_revenue-690"><span class="linenos">690</span></a>        <span class="s2">&quot;net_effect&quot;</span><span class="p">:</span> <span class="n">ten_year_static</span> <span class="o">+</span> <span class="n">ten_year_behavioral</span><span class="p">,</span>
</span><span id="estimate_expenditure_revenue-691"><a href="#estimate_expenditure_revenue-691"><span class="linenos">691</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Estimate total revenue effect of tax expenditure policy.</p>

<p>Returns dict with:
    - annual_static: Average annual static effect
    - ten_year_static: Total 10-year static effect
    - behavioral_offset: Total behavioral offset
    - net_effect: Final effect after behavioral response</p>
</div>


                </section>
                <section id="get_all_expenditure_estimates">
                            <input id="get_all_expenditure_estimates-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_all_expenditure_estimates</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="get_all_expenditure_estimates-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_all_expenditure_estimates"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_all_expenditure_estimates-694"><a href="#get_all_expenditure_estimates-694"><span class="linenos">694</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_all_expenditure_estimates</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="get_all_expenditure_estimates-695"><a href="#get_all_expenditure_estimates-695"><span class="linenos">695</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_all_expenditure_estimates-696"><a href="#get_all_expenditure_estimates-696"><span class="linenos">696</span></a><span class="sd">    Get summary of all tax expenditure baseline costs.</span>
</span><span id="get_all_expenditure_estimates-697"><a href="#get_all_expenditure_estimates-697"><span class="linenos">697</span></a>
</span><span id="get_all_expenditure_estimates-698"><a href="#get_all_expenditure_estimates-698"><span class="linenos">698</span></a><span class="sd">    Returns dict mapping expenditure type to annual cost.</span>
</span><span id="get_all_expenditure_estimates-699"><a href="#get_all_expenditure_estimates-699"><span class="linenos">699</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_all_expenditure_estimates-700"><a href="#get_all_expenditure_estimates-700"><span class="linenos">700</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="get_all_expenditure_estimates-701"><a href="#get_all_expenditure_estimates-701"><span class="linenos">701</span></a>        <span class="s2">&quot;Employer Health Insurance&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;employer_health&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-702"><a href="#get_all_expenditure_estimates-702"><span class="linenos">702</span></a>        <span class="s2">&quot;401(k) and DC Plans&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;retirement_401k&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-703"><a href="#get_all_expenditure_estimates-703"><span class="linenos">703</span></a>        <span class="s2">&quot;Defined Benefit Plans&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;retirement_db&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-704"><a href="#get_all_expenditure_estimates-704"><span class="linenos">704</span></a>        <span class="s2">&quot;IRAs&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;retirement_ira&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-705"><a href="#get_all_expenditure_estimates-705"><span class="linenos">705</span></a>        <span class="s2">&quot;Capital Gains/Dividends&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;capital_gains_dividends&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-706"><a href="#get_all_expenditure_estimates-706"><span class="linenos">706</span></a>        <span class="s2">&quot;SALT (with $10K cap)&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;salt&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-707"><a href="#get_all_expenditure_estimates-707"><span class="linenos">707</span></a>        <span class="s2">&quot;SALT (no cap)&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;salt&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost_no_cap&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-708"><a href="#get_all_expenditure_estimates-708"><span class="linenos">708</span></a>        <span class="s2">&quot;Mortgage Interest&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;mortgage_interest&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-709"><a href="#get_all_expenditure_estimates-709"><span class="linenos">709</span></a>        <span class="s2">&quot;Charitable Contributions&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;charitable&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-710"><a href="#get_all_expenditure_estimates-710"><span class="linenos">710</span></a>        <span class="s2">&quot;Step-Up Basis&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;step_up_basis&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-711"><a href="#get_all_expenditure_estimates-711"><span class="linenos">711</span></a>        <span class="s2">&quot;Like-Kind Exchange&quot;</span><span class="p">:</span> <span class="n">JCT_TAX_EXPENDITURES</span><span class="p">[</span><span class="s2">&quot;like_kind_exchange&quot;</span><span class="p">][</span><span class="s2">&quot;annual_cost&quot;</span><span class="p">],</span>
</span><span id="get_all_expenditure_estimates-712"><a href="#get_all_expenditure_estimates-712"><span class="linenos">712</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get summary of all tax expenditure baseline costs.</p>

<p>Returns dict mapping expenditure type to annual cost.</p>
</div>


                </section>
                <section id="TAX_EXPENDITURE_VALIDATION_SCENARIOS">
                    <div class="attr variable">
            <span class="name">TAX_EXPENDITURE_VALIDATION_SCENARIOS</span>        =
<input id="TAX_EXPENDITURE_VALIDATION_SCENARIOS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="TAX_EXPENDITURE_VALIDATION_SCENARIOS-view-value"></label><span class="default_value">{&#39;cap_employer_health&#39;: {&#39;description&#39;: &#39;Cap employer health exclusion at $50K&#39;, &#39;policy_factory&#39;: &#39;create_cap_employer_health_exclusion&#39;, &#39;expected_10yr&#39;: -450.0, &#39;source&#39;: &#39;CBO&#39;, &#39;notes&#39;: &#39;Third-largest tax expenditure&#39;}, &#39;eliminate_mortgage&#39;: {&#39;description&#39;: &#39;Eliminate mortgage interest deduction&#39;, &#39;policy_factory&#39;: &#39;create_eliminate_mortgage_deduction&#39;, &#39;expected_10yr&#39;: -300.0, &#39;source&#39;: &#39;CBO&#39;, &#39;notes&#39;: &#39;Controversial housing policy&#39;}, &#39;repeal_salt_cap&#39;: {&#39;description&#39;: &#39;Repeal SALT $10K cap&#39;, &#39;policy_factory&#39;: &#39;create_repeal_salt_cap&#39;, &#39;expected_10yr&#39;: 1100.0, &#39;source&#39;: &#39;JCT&#39;, &#39;notes&#39;: &#39;Bipartisan proposal, benefits high-tax states&#39;}, &#39;eliminate_salt&#39;: {&#39;description&#39;: &#39;Eliminate SALT deduction entirely&#39;, &#39;policy_factory&#39;: &#39;create_eliminate_salt_deduction&#39;, &#39;expected_10yr&#39;: -1200.0, &#39;source&#39;: &#39;JCT estimate&#39;, &#39;notes&#39;: &#39;Very controversial&#39;}, &#39;cap_charitable&#39;: {&#39;description&#39;: &#39;Cap charitable deduction at 28%&#39;, &#39;policy_factory&#39;: &#39;create_cap_charitable_deduction&#39;, &#39;expected_10yr&#39;: -200.0, &#39;source&#39;: &#39;Obama/Biden proposal&#39;, &#39;notes&#39;: &#39;Pease-style limitation&#39;}, &#39;eliminate_step_up&#39;: {&#39;description&#39;: &#39;Eliminate step-up in basis&#39;, &#39;policy_factory&#39;: &#39;create_eliminate_step_up_basis&#39;, &#39;expected_10yr&#39;: -500.0, &#39;source&#39;: &#39;Biden proposal&#39;, &#39;notes&#39;: &#39;Tax gains at death with $1M exemption&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#TAX_EXPENDITURE_VALIDATION_SCENARIOS"></a>
    
    

                </section>
                <section id="DistributionalEngine">
                            <input id="DistributionalEngine-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DistributionalEngine</span>:

                <label class="view-source-button" for="DistributionalEngine-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalEngine"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalEngine-262"><a href="#DistributionalEngine-262"><span class="linenos"> 262</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DistributionalEngine</span><span class="p">:</span>
</span><span id="DistributionalEngine-263"><a href="#DistributionalEngine-263"><span class="linenos"> 263</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-264"><a href="#DistributionalEngine-264"><span class="linenos"> 264</span></a><span class="sd">    Engine for computing distributional effects of tax policies.</span>
</span><span id="DistributionalEngine-265"><a href="#DistributionalEngine-265"><span class="linenos"> 265</span></a>
</span><span id="DistributionalEngine-266"><a href="#DistributionalEngine-266"><span class="linenos"> 266</span></a><span class="sd">    Uses IRS Statistics of Income data to calculate how tax changes</span>
</span><span id="DistributionalEngine-267"><a href="#DistributionalEngine-267"><span class="linenos"> 267</span></a><span class="sd">    affect different income groups.</span>
</span><span id="DistributionalEngine-268"><a href="#DistributionalEngine-268"><span class="linenos"> 268</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-269"><a href="#DistributionalEngine-269"><span class="linenos"> 269</span></a>
</span><span id="DistributionalEngine-270"><a href="#DistributionalEngine-270"><span class="linenos"> 270</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2022</span><span class="p">):</span>
</span><span id="DistributionalEngine-271"><a href="#DistributionalEngine-271"><span class="linenos"> 271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-272"><a href="#DistributionalEngine-272"><span class="linenos"> 272</span></a><span class="sd">        Initialize the distributional engine.</span>
</span><span id="DistributionalEngine-273"><a href="#DistributionalEngine-273"><span class="linenos"> 273</span></a>
</span><span id="DistributionalEngine-274"><a href="#DistributionalEngine-274"><span class="linenos"> 274</span></a><span class="sd">        Args:</span>
</span><span id="DistributionalEngine-275"><a href="#DistributionalEngine-275"><span class="linenos"> 275</span></a><span class="sd">            data_year: Year of IRS SOI data to use</span>
</span><span id="DistributionalEngine-276"><a href="#DistributionalEngine-276"><span class="linenos"> 276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-277"><a href="#DistributionalEngine-277"><span class="linenos"> 277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_year</span> <span class="o">=</span> <span class="n">data_year</span>
</span><span id="DistributionalEngine-278"><a href="#DistributionalEngine-278"><span class="linenos"> 278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_irs_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DistributionalEngine-279"><a href="#DistributionalEngine-279"><span class="linenos"> 279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DistributionalEngine-280"><a href="#DistributionalEngine-280"><span class="linenos"> 280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_total_returns</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DistributionalEngine-281"><a href="#DistributionalEngine-281"><span class="linenos"> 281</span></a>
</span><span id="DistributionalEngine-282"><a href="#DistributionalEngine-282"><span class="linenos"> 282</span></a>    <span class="nd">@property</span>
</span><span id="DistributionalEngine-283"><a href="#DistributionalEngine-283"><span class="linenos"> 283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">irs_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IRSSOIData</span><span class="p">:</span>
</span><span id="DistributionalEngine-284"><a href="#DistributionalEngine-284"><span class="linenos"> 284</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Lazy load IRS data.&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-285"><a href="#DistributionalEngine-285"><span class="linenos"> 285</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_irs_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine-286"><a href="#DistributionalEngine-286"><span class="linenos"> 286</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_irs_data</span> <span class="o">=</span> <span class="n">IRSSOIData</span><span class="p">()</span>
</span><span id="DistributionalEngine-287"><a href="#DistributionalEngine-287"><span class="linenos"> 287</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_irs_data</span>
</span><span id="DistributionalEngine-288"><a href="#DistributionalEngine-288"><span class="linenos"> 288</span></a>
</span><span id="DistributionalEngine-289"><a href="#DistributionalEngine-289"><span class="linenos"> 289</span></a>    <span class="nd">@property</span>
</span><span id="DistributionalEngine-290"><a href="#DistributionalEngine-290"><span class="linenos"> 290</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">brackets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TaxBracketData</span><span class="p">]:</span>
</span><span id="DistributionalEngine-291"><a href="#DistributionalEngine-291"><span class="linenos"> 291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Lazy load bracket data.&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-292"><a href="#DistributionalEngine-292"><span class="linenos"> 292</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine-293"><a href="#DistributionalEngine-293"><span class="linenos"> 293</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DistributionalEngine-294"><a href="#DistributionalEngine-294"><span class="linenos"> 294</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">irs_data</span><span class="o">.</span><span class="n">get_bracket_distribution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_year</span><span class="p">)</span>
</span><span id="DistributionalEngine-295"><a href="#DistributionalEngine-295"><span class="linenos"> 295</span></a>            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DistributionalEngine-296"><a href="#DistributionalEngine-296"><span class="linenos"> 296</span></a>                <span class="c1"># Use synthetic data if IRS files not available</span>
</span><span id="DistributionalEngine-297"><a href="#DistributionalEngine-297"><span class="linenos"> 297</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_synthetic_brackets</span><span class="p">()</span>
</span><span id="DistributionalEngine-298"><a href="#DistributionalEngine-298"><span class="linenos"> 298</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span>
</span><span id="DistributionalEngine-299"><a href="#DistributionalEngine-299"><span class="linenos"> 299</span></a>
</span><span id="DistributionalEngine-300"><a href="#DistributionalEngine-300"><span class="linenos"> 300</span></a>    <span class="nd">@property</span>
</span><span id="DistributionalEngine-301"><a href="#DistributionalEngine-301"><span class="linenos"> 301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_returns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="DistributionalEngine-302"><a href="#DistributionalEngine-302"><span class="linenos"> 302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total number of tax returns.&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-303"><a href="#DistributionalEngine-303"><span class="linenos"> 303</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_returns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine-304"><a href="#DistributionalEngine-304"><span class="linenos"> 304</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_total_returns</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">num_returns</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brackets</span><span class="p">)</span>
</span><span id="DistributionalEngine-305"><a href="#DistributionalEngine-305"><span class="linenos"> 305</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_returns</span>
</span><span id="DistributionalEngine-306"><a href="#DistributionalEngine-306"><span class="linenos"> 306</span></a>
</span><span id="DistributionalEngine-307"><a href="#DistributionalEngine-307"><span class="linenos"> 307</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_synthetic_brackets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TaxBracketData</span><span class="p">]:</span>
</span><span id="DistributionalEngine-308"><a href="#DistributionalEngine-308"><span class="linenos"> 308</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-309"><a href="#DistributionalEngine-309"><span class="linenos"> 309</span></a><span class="sd">        Generate synthetic bracket data based on typical distributions.</span>
</span><span id="DistributionalEngine-310"><a href="#DistributionalEngine-310"><span class="linenos"> 310</span></a>
</span><span id="DistributionalEngine-311"><a href="#DistributionalEngine-311"><span class="linenos"> 311</span></a><span class="sd">        Used when actual IRS SOI data files are not available.</span>
</span><span id="DistributionalEngine-312"><a href="#DistributionalEngine-312"><span class="linenos"> 312</span></a><span class="sd">        Based on 2022 IRS statistics.</span>
</span><span id="DistributionalEngine-313"><a href="#DistributionalEngine-313"><span class="linenos"> 313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-314"><a href="#DistributionalEngine-314"><span class="linenos"> 314</span></a>        <span class="c1"># Typical bracket distribution based on IRS 2022 data</span>
</span><span id="DistributionalEngine-315"><a href="#DistributionalEngine-315"><span class="linenos"> 315</span></a>        <span class="n">synthetic_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine-316"><a href="#DistributionalEngine-316"><span class="linenos"> 316</span></a>            <span class="c1"># (floor, ceiling, returns_M, agi_B, taxable_B, tax_B)</span>
</span><span id="DistributionalEngine-317"><a href="#DistributionalEngine-317"><span class="linenos"> 317</span></a>            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5_000</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
</span><span id="DistributionalEngine-318"><a href="#DistributionalEngine-318"><span class="linenos"> 318</span></a>            <span class="p">(</span><span class="mi">5_000</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
</span><span id="DistributionalEngine-319"><a href="#DistributionalEngine-319"><span class="linenos"> 319</span></a>            <span class="p">(</span><span class="mi">10_000</span><span class="p">,</span> <span class="mi">15_000</span><span class="p">,</span> <span class="mf">10.8</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">),</span>
</span><span id="DistributionalEngine-320"><a href="#DistributionalEngine-320"><span class="linenos"> 320</span></a>            <span class="p">(</span><span class="mi">15_000</span><span class="p">,</span> <span class="mi">20_000</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">),</span>
</span><span id="DistributionalEngine-321"><a href="#DistributionalEngine-321"><span class="linenos"> 321</span></a>            <span class="p">(</span><span class="mi">20_000</span><span class="p">,</span> <span class="mi">25_000</span><span class="p">,</span> <span class="mf">8.2</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">),</span>
</span><span id="DistributionalEngine-322"><a href="#DistributionalEngine-322"><span class="linenos"> 322</span></a>            <span class="p">(</span><span class="mi">25_000</span><span class="p">,</span> <span class="mi">30_000</span><span class="p">,</span> <span class="mf">7.3</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mf">7.1</span><span class="p">),</span>
</span><span id="DistributionalEngine-323"><a href="#DistributionalEngine-323"><span class="linenos"> 323</span></a>            <span class="p">(</span><span class="mi">30_000</span><span class="p">,</span> <span class="mi">40_000</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mi">437</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mf">18.5</span><span class="p">),</span>
</span><span id="DistributionalEngine-324"><a href="#DistributionalEngine-324"><span class="linenos"> 324</span></a>            <span class="p">(</span><span class="mi">40_000</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mi">455</span><span class="p">,</span> <span class="mi">265</span><span class="p">,</span> <span class="mf">24.2</span><span class="p">),</span>
</span><span id="DistributionalEngine-325"><a href="#DistributionalEngine-325"><span class="linenos"> 325</span></a>            <span class="p">(</span><span class="mi">50_000</span><span class="p">,</span> <span class="mi">75_000</span><span class="p">,</span> <span class="mf">18.2</span><span class="p">,</span> <span class="mi">1140</span><span class="p">,</span> <span class="mi">720</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-326"><a href="#DistributionalEngine-326"><span class="linenos"> 326</span></a>            <span class="p">(</span><span class="mi">75_000</span><span class="p">,</span> <span class="mi">100_000</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mi">1100</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mf">90.5</span><span class="p">),</span>
</span><span id="DistributionalEngine-327"><a href="#DistributionalEngine-327"><span class="linenos"> 327</span></a>            <span class="p">(</span><span class="mi">100_000</span><span class="p">,</span> <span class="mi">200_000</span><span class="p">,</span> <span class="mf">21.5</span><span class="p">,</span> <span class="mi">3050</span><span class="p">,</span> <span class="mi">2200</span><span class="p">,</span> <span class="mf">310.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-328"><a href="#DistributionalEngine-328"><span class="linenos"> 328</span></a>            <span class="p">(</span><span class="mi">200_000</span><span class="p">,</span> <span class="mi">500_000</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="mi">2550</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mf">380.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-329"><a href="#DistributionalEngine-329"><span class="linenos"> 329</span></a>            <span class="p">(</span><span class="mi">500_000</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-330"><a href="#DistributionalEngine-330"><span class="linenos"> 330</span></a>            <span class="p">(</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="mi">1_500_000</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mi">510</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-331"><a href="#DistributionalEngine-331"><span class="linenos"> 331</span></a>            <span class="p">(</span><span class="mi">1_500_000</span><span class="p">,</span> <span class="mi">2_000_000</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mf">78.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-332"><a href="#DistributionalEngine-332"><span class="linenos"> 332</span></a>            <span class="p">(</span><span class="mi">2_000_000</span><span class="p">,</span> <span class="mi">5_000_000</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">660</span><span class="p">,</span> <span class="mf">195.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-333"><a href="#DistributionalEngine-333"><span class="linenos"> 333</span></a>            <span class="p">(</span><span class="mi">5_000_000</span><span class="p">,</span> <span class="mi">10_000_000</span><span class="p">,</span> <span class="mf">0.065</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mf">125.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-334"><a href="#DistributionalEngine-334"><span class="linenos"> 334</span></a>            <span class="p">(</span><span class="mi">10_000_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">0.045</span><span class="p">,</span> <span class="mi">850</span><span class="p">,</span> <span class="mi">780</span><span class="p">,</span> <span class="mf">260.0</span><span class="p">),</span>
</span><span id="DistributionalEngine-335"><a href="#DistributionalEngine-335"><span class="linenos"> 335</span></a>        <span class="p">]</span>
</span><span id="DistributionalEngine-336"><a href="#DistributionalEngine-336"><span class="linenos"> 336</span></a>
</span><span id="DistributionalEngine-337"><a href="#DistributionalEngine-337"><span class="linenos"> 337</span></a>        <span class="n">brackets</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine-338"><a href="#DistributionalEngine-338"><span class="linenos"> 338</span></a>        <span class="k">for</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span><span class="p">,</span> <span class="n">returns_m</span><span class="p">,</span> <span class="n">agi_b</span><span class="p">,</span> <span class="n">taxable_b</span><span class="p">,</span> <span class="n">tax_b</span> <span class="ow">in</span> <span class="n">synthetic_data</span><span class="p">:</span>
</span><span id="DistributionalEngine-339"><a href="#DistributionalEngine-339"><span class="linenos"> 339</span></a>            <span class="n">brackets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TaxBracketData</span><span class="p">(</span>
</span><span id="DistributionalEngine-340"><a href="#DistributionalEngine-340"><span class="linenos"> 340</span></a>                <span class="n">year</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_year</span><span class="p">,</span>
</span><span id="DistributionalEngine-341"><a href="#DistributionalEngine-341"><span class="linenos"> 341</span></a>                <span class="n">agi_floor</span><span class="o">=</span><span class="n">floor</span><span class="p">,</span>
</span><span id="DistributionalEngine-342"><a href="#DistributionalEngine-342"><span class="linenos"> 342</span></a>                <span class="n">agi_ceiling</span><span class="o">=</span><span class="n">ceiling</span><span class="p">,</span>
</span><span id="DistributionalEngine-343"><a href="#DistributionalEngine-343"><span class="linenos"> 343</span></a>                <span class="n">num_returns</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">returns_m</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">),</span>
</span><span id="DistributionalEngine-344"><a href="#DistributionalEngine-344"><span class="linenos"> 344</span></a>                <span class="n">total_agi</span><span class="o">=</span><span class="n">agi_b</span><span class="p">,</span>
</span><span id="DistributionalEngine-345"><a href="#DistributionalEngine-345"><span class="linenos"> 345</span></a>                <span class="n">taxable_income</span><span class="o">=</span><span class="n">taxable_b</span><span class="p">,</span>
</span><span id="DistributionalEngine-346"><a href="#DistributionalEngine-346"><span class="linenos"> 346</span></a>                <span class="n">total_tax</span><span class="o">=</span><span class="n">tax_b</span><span class="p">,</span>
</span><span id="DistributionalEngine-347"><a href="#DistributionalEngine-347"><span class="linenos"> 347</span></a>            <span class="p">))</span>
</span><span id="DistributionalEngine-348"><a href="#DistributionalEngine-348"><span class="linenos"> 348</span></a>
</span><span id="DistributionalEngine-349"><a href="#DistributionalEngine-349"><span class="linenos"> 349</span></a>        <span class="k">return</span> <span class="n">brackets</span>
</span><span id="DistributionalEngine-350"><a href="#DistributionalEngine-350"><span class="linenos"> 350</span></a>
</span><span id="DistributionalEngine-351"><a href="#DistributionalEngine-351"><span class="linenos"> 351</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_income_groups</span><span class="p">(</span>
</span><span id="DistributionalEngine-352"><a href="#DistributionalEngine-352"><span class="linenos"> 352</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine-353"><a href="#DistributionalEngine-353"><span class="linenos"> 353</span></a>        <span class="n">group_type</span><span class="p">:</span> <span class="n">IncomeGroupType</span> <span class="o">=</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">QUINTILE</span><span class="p">,</span>
</span><span id="DistributionalEngine-354"><a href="#DistributionalEngine-354"><span class="linenos"> 354</span></a>        <span class="n">custom_brackets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DistributionalEngine-355"><a href="#DistributionalEngine-355"><span class="linenos"> 355</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">IncomeGroup</span><span class="p">]:</span>
</span><span id="DistributionalEngine-356"><a href="#DistributionalEngine-356"><span class="linenos"> 356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-357"><a href="#DistributionalEngine-357"><span class="linenos"> 357</span></a><span class="sd">        Create income groups by aggregating IRS brackets.</span>
</span><span id="DistributionalEngine-358"><a href="#DistributionalEngine-358"><span class="linenos"> 358</span></a>
</span><span id="DistributionalEngine-359"><a href="#DistributionalEngine-359"><span class="linenos"> 359</span></a><span class="sd">        Args:</span>
</span><span id="DistributionalEngine-360"><a href="#DistributionalEngine-360"><span class="linenos"> 360</span></a><span class="sd">            group_type: Type of income grouping</span>
</span><span id="DistributionalEngine-361"><a href="#DistributionalEngine-361"><span class="linenos"> 361</span></a><span class="sd">            custom_brackets: Custom bracket definitions if group_type is CUSTOM</span>
</span><span id="DistributionalEngine-362"><a href="#DistributionalEngine-362"><span class="linenos"> 362</span></a>
</span><span id="DistributionalEngine-363"><a href="#DistributionalEngine-363"><span class="linenos"> 363</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionalEngine-364"><a href="#DistributionalEngine-364"><span class="linenos"> 364</span></a><span class="sd">            List of IncomeGroup objects with aggregated statistics</span>
</span><span id="DistributionalEngine-365"><a href="#DistributionalEngine-365"><span class="linenos"> 365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-366"><a href="#DistributionalEngine-366"><span class="linenos"> 366</span></a>        <span class="c1"># Define bracket boundaries based on group type</span>
</span><span id="DistributionalEngine-367"><a href="#DistributionalEngine-367"><span class="linenos"> 367</span></a>        <span class="k">if</span> <span class="n">group_type</span> <span class="o">==</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">QUINTILE</span><span class="p">:</span>
</span><span id="DistributionalEngine-368"><a href="#DistributionalEngine-368"><span class="linenos"> 368</span></a>            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine-369"><a href="#DistributionalEngine-369"><span class="linenos"> 369</span></a>                <span class="p">(</span><span class="s2">&quot;Lowest Quintile&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-370"><a href="#DistributionalEngine-370"><span class="linenos"> 370</span></a>                <span class="p">(</span><span class="s2">&quot;Second Quintile&quot;</span><span class="p">,</span> <span class="mi">35_000</span><span class="p">,</span> <span class="mi">65_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-371"><a href="#DistributionalEngine-371"><span class="linenos"> 371</span></a>                <span class="p">(</span><span class="s2">&quot;Middle Quintile&quot;</span><span class="p">,</span> <span class="mi">65_000</span><span class="p">,</span> <span class="mi">105_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-372"><a href="#DistributionalEngine-372"><span class="linenos"> 372</span></a>                <span class="p">(</span><span class="s2">&quot;Fourth Quintile&quot;</span><span class="p">,</span> <span class="mi">105_000</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-373"><a href="#DistributionalEngine-373"><span class="linenos"> 373</span></a>                <span class="p">(</span><span class="s2">&quot;Top Quintile&quot;</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="DistributionalEngine-374"><a href="#DistributionalEngine-374"><span class="linenos"> 374</span></a>            <span class="p">]</span>
</span><span id="DistributionalEngine-375"><a href="#DistributionalEngine-375"><span class="linenos"> 375</span></a>        <span class="k">elif</span> <span class="n">group_type</span> <span class="o">==</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">DECILE</span><span class="p">:</span>
</span><span id="DistributionalEngine-376"><a href="#DistributionalEngine-376"><span class="linenos"> 376</span></a>            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine-377"><a href="#DistributionalEngine-377"><span class="linenos"> 377</span></a>                <span class="p">(</span><span class="s2">&quot;1st Decile&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-378"><a href="#DistributionalEngine-378"><span class="linenos"> 378</span></a>                <span class="p">(</span><span class="s2">&quot;2nd Decile&quot;</span><span class="p">,</span> <span class="mi">15_000</span><span class="p">,</span> <span class="mi">28_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-379"><a href="#DistributionalEngine-379"><span class="linenos"> 379</span></a>                <span class="p">(</span><span class="s2">&quot;3rd Decile&quot;</span><span class="p">,</span> <span class="mi">28_000</span><span class="p">,</span> <span class="mi">42_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-380"><a href="#DistributionalEngine-380"><span class="linenos"> 380</span></a>                <span class="p">(</span><span class="s2">&quot;4th Decile&quot;</span><span class="p">,</span> <span class="mi">42_000</span><span class="p">,</span> <span class="mi">55_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-381"><a href="#DistributionalEngine-381"><span class="linenos"> 381</span></a>                <span class="p">(</span><span class="s2">&quot;5th Decile&quot;</span><span class="p">,</span> <span class="mi">55_000</span><span class="p">,</span> <span class="mi">72_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-382"><a href="#DistributionalEngine-382"><span class="linenos"> 382</span></a>                <span class="p">(</span><span class="s2">&quot;6th Decile&quot;</span><span class="p">,</span> <span class="mi">72_000</span><span class="p">,</span> <span class="mi">92_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-383"><a href="#DistributionalEngine-383"><span class="linenos"> 383</span></a>                <span class="p">(</span><span class="s2">&quot;7th Decile&quot;</span><span class="p">,</span> <span class="mi">92_000</span><span class="p">,</span> <span class="mi">118_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-384"><a href="#DistributionalEngine-384"><span class="linenos"> 384</span></a>                <span class="p">(</span><span class="s2">&quot;8th Decile&quot;</span><span class="p">,</span> <span class="mi">118_000</span><span class="p">,</span> <span class="mi">155_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-385"><a href="#DistributionalEngine-385"><span class="linenos"> 385</span></a>                <span class="p">(</span><span class="s2">&quot;9th Decile&quot;</span><span class="p">,</span> <span class="mi">155_000</span><span class="p">,</span> <span class="mi">220_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-386"><a href="#DistributionalEngine-386"><span class="linenos"> 386</span></a>                <span class="p">(</span><span class="s2">&quot;10th Decile&quot;</span><span class="p">,</span> <span class="mi">220_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="DistributionalEngine-387"><a href="#DistributionalEngine-387"><span class="linenos"> 387</span></a>            <span class="p">]</span>
</span><span id="DistributionalEngine-388"><a href="#DistributionalEngine-388"><span class="linenos"> 388</span></a>        <span class="k">elif</span> <span class="n">group_type</span> <span class="o">==</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">JCT_DOLLAR</span><span class="p">:</span>
</span><span id="DistributionalEngine-389"><a href="#DistributionalEngine-389"><span class="linenos"> 389</span></a>            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine-390"><a href="#DistributionalEngine-390"><span class="linenos"> 390</span></a>                <span class="p">(</span><span class="s2">&quot;Less than $10K&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-391"><a href="#DistributionalEngine-391"><span class="linenos"> 391</span></a>                <span class="p">(</span><span class="s2">&quot;$10K-$20K&quot;</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mi">20_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-392"><a href="#DistributionalEngine-392"><span class="linenos"> 392</span></a>                <span class="p">(</span><span class="s2">&quot;$20K-$30K&quot;</span><span class="p">,</span> <span class="mi">20_000</span><span class="p">,</span> <span class="mi">30_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-393"><a href="#DistributionalEngine-393"><span class="linenos"> 393</span></a>                <span class="p">(</span><span class="s2">&quot;$30K-$40K&quot;</span><span class="p">,</span> <span class="mi">30_000</span><span class="p">,</span> <span class="mi">40_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-394"><a href="#DistributionalEngine-394"><span class="linenos"> 394</span></a>                <span class="p">(</span><span class="s2">&quot;$40K-$50K&quot;</span><span class="p">,</span> <span class="mi">40_000</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-395"><a href="#DistributionalEngine-395"><span class="linenos"> 395</span></a>                <span class="p">(</span><span class="s2">&quot;$50K-$75K&quot;</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">,</span> <span class="mi">75_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-396"><a href="#DistributionalEngine-396"><span class="linenos"> 396</span></a>                <span class="p">(</span><span class="s2">&quot;$75K-$100K&quot;</span><span class="p">,</span> <span class="mi">75_000</span><span class="p">,</span> <span class="mi">100_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-397"><a href="#DistributionalEngine-397"><span class="linenos"> 397</span></a>                <span class="p">(</span><span class="s2">&quot;$100K-$200K&quot;</span><span class="p">,</span> <span class="mi">100_000</span><span class="p">,</span> <span class="mi">200_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-398"><a href="#DistributionalEngine-398"><span class="linenos"> 398</span></a>                <span class="p">(</span><span class="s2">&quot;$200K-$500K&quot;</span><span class="p">,</span> <span class="mi">200_000</span><span class="p">,</span> <span class="mi">500_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-399"><a href="#DistributionalEngine-399"><span class="linenos"> 399</span></a>                <span class="p">(</span><span class="s2">&quot;$500K-$1M&quot;</span><span class="p">,</span> <span class="mi">500_000</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-400"><a href="#DistributionalEngine-400"><span class="linenos"> 400</span></a>                <span class="p">(</span><span class="s2">&quot;$1M and over&quot;</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="DistributionalEngine-401"><a href="#DistributionalEngine-401"><span class="linenos"> 401</span></a>            <span class="p">]</span>
</span><span id="DistributionalEngine-402"><a href="#DistributionalEngine-402"><span class="linenos"> 402</span></a>        <span class="k">elif</span> <span class="n">group_type</span> <span class="o">==</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="p">:</span>
</span><span id="DistributionalEngine-403"><a href="#DistributionalEngine-403"><span class="linenos"> 403</span></a>            <span class="k">if</span> <span class="n">custom_brackets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine-404"><a href="#DistributionalEngine-404"><span class="linenos"> 404</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;custom_brackets required for CUSTOM group type&quot;</span><span class="p">)</span>
</span><span id="DistributionalEngine-405"><a href="#DistributionalEngine-405"><span class="linenos"> 405</span></a>            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine-406"><a href="#DistributionalEngine-406"><span class="linenos"> 406</span></a>                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">floor</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K-$</span><span class="si">{</span><span class="n">ceiling</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K&quot;</span> <span class="k">if</span> <span class="n">ceiling</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">floor</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K+&quot;</span><span class="p">,</span>
</span><span id="DistributionalEngine-407"><a href="#DistributionalEngine-407"><span class="linenos"> 407</span></a>                 <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span><span class="p">)</span>
</span><span id="DistributionalEngine-408"><a href="#DistributionalEngine-408"><span class="linenos"> 408</span></a>                <span class="k">for</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span> <span class="ow">in</span> <span class="n">custom_brackets</span>
</span><span id="DistributionalEngine-409"><a href="#DistributionalEngine-409"><span class="linenos"> 409</span></a>            <span class="p">]</span>
</span><span id="DistributionalEngine-410"><a href="#DistributionalEngine-410"><span class="linenos"> 410</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-411"><a href="#DistributionalEngine-411"><span class="linenos"> 411</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown group type: </span><span class="si">{</span><span class="n">group_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DistributionalEngine-412"><a href="#DistributionalEngine-412"><span class="linenos"> 412</span></a>
</span><span id="DistributionalEngine-413"><a href="#DistributionalEngine-413"><span class="linenos"> 413</span></a>        <span class="c1"># Aggregate IRS brackets into income groups</span>
</span><span id="DistributionalEngine-414"><a href="#DistributionalEngine-414"><span class="linenos"> 414</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine-415"><a href="#DistributionalEngine-415"><span class="linenos"> 415</span></a>        <span class="n">total_returns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span>
</span><span id="DistributionalEngine-416"><a href="#DistributionalEngine-416"><span class="linenos"> 416</span></a>
</span><span id="DistributionalEngine-417"><a href="#DistributionalEngine-417"><span class="linenos"> 417</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
</span><span id="DistributionalEngine-418"><a href="#DistributionalEngine-418"><span class="linenos"> 418</span></a>            <span class="c1"># Find all IRS brackets that overlap with this income group</span>
</span><span id="DistributionalEngine-419"><a href="#DistributionalEngine-419"><span class="linenos"> 419</span></a>            <span class="n">group_returns</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-420"><a href="#DistributionalEngine-420"><span class="linenos"> 420</span></a>            <span class="n">group_agi</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-421"><a href="#DistributionalEngine-421"><span class="linenos"> 421</span></a>            <span class="n">group_taxable</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-422"><a href="#DistributionalEngine-422"><span class="linenos"> 422</span></a>            <span class="n">group_tax</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-423"><a href="#DistributionalEngine-423"><span class="linenos"> 423</span></a>
</span><span id="DistributionalEngine-424"><a href="#DistributionalEngine-424"><span class="linenos"> 424</span></a>            <span class="k">for</span> <span class="n">bracket</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brackets</span><span class="p">:</span>
</span><span id="DistributionalEngine-425"><a href="#DistributionalEngine-425"><span class="linenos"> 425</span></a>                <span class="c1"># Check if bracket overlaps with this group</span>
</span><span id="DistributionalEngine-426"><a href="#DistributionalEngine-426"><span class="linenos"> 426</span></a>                <span class="n">bracket_floor</span> <span class="o">=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_floor</span>
</span><span id="DistributionalEngine-427"><a href="#DistributionalEngine-427"><span class="linenos"> 427</span></a>                <span class="n">bracket_ceiling</span> <span class="o">=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_ceiling</span> <span class="k">if</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine-428"><a href="#DistributionalEngine-428"><span class="linenos"> 428</span></a>                <span class="n">group_ceiling</span> <span class="o">=</span> <span class="n">ceiling</span> <span class="k">if</span> <span class="n">ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine-429"><a href="#DistributionalEngine-429"><span class="linenos"> 429</span></a>
</span><span id="DistributionalEngine-430"><a href="#DistributionalEngine-430"><span class="linenos"> 430</span></a>                <span class="c1"># Calculate overlap fraction</span>
</span><span id="DistributionalEngine-431"><a href="#DistributionalEngine-431"><span class="linenos"> 431</span></a>                <span class="n">overlap_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bracket_floor</span><span class="p">,</span> <span class="n">floor</span><span class="p">)</span>
</span><span id="DistributionalEngine-432"><a href="#DistributionalEngine-432"><span class="linenos"> 432</span></a>                <span class="n">overlap_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">bracket_ceiling</span><span class="p">,</span> <span class="n">group_ceiling</span><span class="p">)</span>
</span><span id="DistributionalEngine-433"><a href="#DistributionalEngine-433"><span class="linenos"> 433</span></a>
</span><span id="DistributionalEngine-434"><a href="#DistributionalEngine-434"><span class="linenos"> 434</span></a>                <span class="k">if</span> <span class="n">overlap_start</span> <span class="o">&lt;</span> <span class="n">overlap_end</span><span class="p">:</span>
</span><span id="DistributionalEngine-435"><a href="#DistributionalEngine-435"><span class="linenos"> 435</span></a>                    <span class="c1"># There is overlap</span>
</span><span id="DistributionalEngine-436"><a href="#DistributionalEngine-436"><span class="linenos"> 436</span></a>                    <span class="n">bracket_width</span> <span class="o">=</span> <span class="n">bracket_ceiling</span> <span class="o">-</span> <span class="n">bracket_floor</span>
</span><span id="DistributionalEngine-437"><a href="#DistributionalEngine-437"><span class="linenos"> 437</span></a>                    <span class="n">overlap_width</span> <span class="o">=</span> <span class="n">overlap_end</span> <span class="o">-</span> <span class="n">overlap_start</span>
</span><span id="DistributionalEngine-438"><a href="#DistributionalEngine-438"><span class="linenos"> 438</span></a>
</span><span id="DistributionalEngine-439"><a href="#DistributionalEngine-439"><span class="linenos"> 439</span></a>                    <span class="k">if</span> <span class="n">bracket_width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-440"><a href="#DistributionalEngine-440"><span class="linenos"> 440</span></a>                        <span class="n">overlap_fraction</span> <span class="o">=</span> <span class="n">overlap_width</span> <span class="o">/</span> <span class="n">bracket_width</span>
</span><span id="DistributionalEngine-441"><a href="#DistributionalEngine-441"><span class="linenos"> 441</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-442"><a href="#DistributionalEngine-442"><span class="linenos"> 442</span></a>                        <span class="n">overlap_fraction</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="DistributionalEngine-443"><a href="#DistributionalEngine-443"><span class="linenos"> 443</span></a>
</span><span id="DistributionalEngine-444"><a href="#DistributionalEngine-444"><span class="linenos"> 444</span></a>                    <span class="c1"># For simplicity, use full bracket if &gt;50% overlap</span>
</span><span id="DistributionalEngine-445"><a href="#DistributionalEngine-445"><span class="linenos"> 445</span></a>                    <span class="c1"># This avoids complex income distribution assumptions</span>
</span><span id="DistributionalEngine-446"><a href="#DistributionalEngine-446"><span class="linenos"> 446</span></a>                    <span class="k">if</span> <span class="n">overlap_fraction</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="ow">or</span> <span class="n">bracket_floor</span> <span class="o">&gt;=</span> <span class="n">floor</span><span class="p">:</span>
</span><span id="DistributionalEngine-447"><a href="#DistributionalEngine-447"><span class="linenos"> 447</span></a>                        <span class="n">group_returns</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="DistributionalEngine-448"><a href="#DistributionalEngine-448"><span class="linenos"> 448</span></a>                        <span class="n">group_agi</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">total_agi</span>
</span><span id="DistributionalEngine-449"><a href="#DistributionalEngine-449"><span class="linenos"> 449</span></a>                        <span class="n">group_taxable</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">taxable_income</span>
</span><span id="DistributionalEngine-450"><a href="#DistributionalEngine-450"><span class="linenos"> 450</span></a>                        <span class="n">group_tax</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">total_tax</span>
</span><span id="DistributionalEngine-451"><a href="#DistributionalEngine-451"><span class="linenos"> 451</span></a>
</span><span id="DistributionalEngine-452"><a href="#DistributionalEngine-452"><span class="linenos"> 452</span></a>            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IncomeGroup</span><span class="p">(</span>
</span><span id="DistributionalEngine-453"><a href="#DistributionalEngine-453"><span class="linenos"> 453</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="DistributionalEngine-454"><a href="#DistributionalEngine-454"><span class="linenos"> 454</span></a>                <span class="n">floor</span><span class="o">=</span><span class="n">floor</span><span class="p">,</span>
</span><span id="DistributionalEngine-455"><a href="#DistributionalEngine-455"><span class="linenos"> 455</span></a>                <span class="n">ceiling</span><span class="o">=</span><span class="n">ceiling</span><span class="p">,</span>
</span><span id="DistributionalEngine-456"><a href="#DistributionalEngine-456"><span class="linenos"> 456</span></a>                <span class="n">num_returns</span><span class="o">=</span><span class="n">group_returns</span><span class="p">,</span>
</span><span id="DistributionalEngine-457"><a href="#DistributionalEngine-457"><span class="linenos"> 457</span></a>                <span class="n">total_agi</span><span class="o">=</span><span class="n">group_agi</span><span class="p">,</span>
</span><span id="DistributionalEngine-458"><a href="#DistributionalEngine-458"><span class="linenos"> 458</span></a>                <span class="n">total_taxable_income</span><span class="o">=</span><span class="n">group_taxable</span><span class="p">,</span>
</span><span id="DistributionalEngine-459"><a href="#DistributionalEngine-459"><span class="linenos"> 459</span></a>                <span class="n">baseline_tax</span><span class="o">=</span><span class="n">group_tax</span><span class="p">,</span>
</span><span id="DistributionalEngine-460"><a href="#DistributionalEngine-460"><span class="linenos"> 460</span></a>                <span class="n">population_share</span><span class="o">=</span><span class="n">group_returns</span> <span class="o">/</span> <span class="n">total_returns</span> <span class="k">if</span> <span class="n">total_returns</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="DistributionalEngine-461"><a href="#DistributionalEngine-461"><span class="linenos"> 461</span></a>            <span class="p">))</span>
</span><span id="DistributionalEngine-462"><a href="#DistributionalEngine-462"><span class="linenos"> 462</span></a>
</span><span id="DistributionalEngine-463"><a href="#DistributionalEngine-463"><span class="linenos"> 463</span></a>        <span class="k">return</span> <span class="n">groups</span>
</span><span id="DistributionalEngine-464"><a href="#DistributionalEngine-464"><span class="linenos"> 464</span></a>
</span><span id="DistributionalEngine-465"><a href="#DistributionalEngine-465"><span class="linenos"> 465</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_policy</span><span class="p">(</span>
</span><span id="DistributionalEngine-466"><a href="#DistributionalEngine-466"><span class="linenos"> 466</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine-467"><a href="#DistributionalEngine-467"><span class="linenos"> 467</span></a>        <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="DistributionalEngine-468"><a href="#DistributionalEngine-468"><span class="linenos"> 468</span></a>        <span class="n">group_type</span><span class="p">:</span> <span class="n">IncomeGroupType</span> <span class="o">=</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">QUINTILE</span><span class="p">,</span>
</span><span id="DistributionalEngine-469"><a href="#DistributionalEngine-469"><span class="linenos"> 469</span></a>        <span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DistributionalEngine-470"><a href="#DistributionalEngine-470"><span class="linenos"> 470</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalAnalysis</span><span class="p">:</span>
</span><span id="DistributionalEngine-471"><a href="#DistributionalEngine-471"><span class="linenos"> 471</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-472"><a href="#DistributionalEngine-472"><span class="linenos"> 472</span></a><span class="sd">        Analyze distributional effects of a tax policy.</span>
</span><span id="DistributionalEngine-473"><a href="#DistributionalEngine-473"><span class="linenos"> 473</span></a>
</span><span id="DistributionalEngine-474"><a href="#DistributionalEngine-474"><span class="linenos"> 474</span></a><span class="sd">        Supports multiple policy types:</span>
</span><span id="DistributionalEngine-475"><a href="#DistributionalEngine-475"><span class="linenos"> 475</span></a><span class="sd">        - TaxPolicy: Basic rate change policies</span>
</span><span id="DistributionalEngine-476"><a href="#DistributionalEngine-476"><span class="linenos"> 476</span></a><span class="sd">        - TaxCreditPolicy: CTC, EITC with phase-in/out</span>
</span><span id="DistributionalEngine-477"><a href="#DistributionalEngine-477"><span class="linenos"> 477</span></a><span class="sd">        - TCJAExtensionPolicy: Multi-component package</span>
</span><span id="DistributionalEngine-478"><a href="#DistributionalEngine-478"><span class="linenos"> 478</span></a><span class="sd">        - CorporateTaxPolicy: Corporate with incidence assumptions</span>
</span><span id="DistributionalEngine-479"><a href="#DistributionalEngine-479"><span class="linenos"> 479</span></a><span class="sd">        - PayrollTaxPolicy: Payroll tax changes</span>
</span><span id="DistributionalEngine-480"><a href="#DistributionalEngine-480"><span class="linenos"> 480</span></a>
</span><span id="DistributionalEngine-481"><a href="#DistributionalEngine-481"><span class="linenos"> 481</span></a><span class="sd">        Args:</span>
</span><span id="DistributionalEngine-482"><a href="#DistributionalEngine-482"><span class="linenos"> 482</span></a><span class="sd">            policy: Tax policy to analyze</span>
</span><span id="DistributionalEngine-483"><a href="#DistributionalEngine-483"><span class="linenos"> 483</span></a><span class="sd">            group_type: Type of income grouping</span>
</span><span id="DistributionalEngine-484"><a href="#DistributionalEngine-484"><span class="linenos"> 484</span></a><span class="sd">            year: Analysis year (defaults to policy start year)</span>
</span><span id="DistributionalEngine-485"><a href="#DistributionalEngine-485"><span class="linenos"> 485</span></a>
</span><span id="DistributionalEngine-486"><a href="#DistributionalEngine-486"><span class="linenos"> 486</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionalEngine-487"><a href="#DistributionalEngine-487"><span class="linenos"> 487</span></a><span class="sd">            DistributionalAnalysis with results for each income group</span>
</span><span id="DistributionalEngine-488"><a href="#DistributionalEngine-488"><span class="linenos"> 488</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-489"><a href="#DistributionalEngine-489"><span class="linenos"> 489</span></a>        <span class="k">if</span> <span class="n">year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine-490"><a href="#DistributionalEngine-490"><span class="linenos"> 490</span></a>            <span class="n">year</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;start_year&#39;</span><span class="p">,</span> <span class="mi">2025</span><span class="p">)</span>
</span><span id="DistributionalEngine-491"><a href="#DistributionalEngine-491"><span class="linenos"> 491</span></a>
</span><span id="DistributionalEngine-492"><a href="#DistributionalEngine-492"><span class="linenos"> 492</span></a>        <span class="c1"># Create income groups</span>
</span><span id="DistributionalEngine-493"><a href="#DistributionalEngine-493"><span class="linenos"> 493</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_income_groups</span><span class="p">(</span><span class="n">group_type</span><span class="p">)</span>
</span><span id="DistributionalEngine-494"><a href="#DistributionalEngine-494"><span class="linenos"> 494</span></a>
</span><span id="DistributionalEngine-495"><a href="#DistributionalEngine-495"><span class="linenos"> 495</span></a>        <span class="c1"># Dispatch to appropriate handler based on policy type</span>
</span><span id="DistributionalEngine-496"><a href="#DistributionalEngine-496"><span class="linenos"> 496</span></a>        <span class="n">policy_class_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="DistributionalEngine-497"><a href="#DistributionalEngine-497"><span class="linenos"> 497</span></a>
</span><span id="DistributionalEngine-498"><a href="#DistributionalEngine-498"><span class="linenos"> 498</span></a>        <span class="c1"># Calculate tax change for each group using appropriate handler</span>
</span><span id="DistributionalEngine-499"><a href="#DistributionalEngine-499"><span class="linenos"> 499</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine-500"><a href="#DistributionalEngine-500"><span class="linenos"> 500</span></a>        <span class="n">total_tax_change</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-501"><a href="#DistributionalEngine-501"><span class="linenos"> 501</span></a>        <span class="n">total_affected</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-502"><a href="#DistributionalEngine-502"><span class="linenos"> 502</span></a>
</span><span id="DistributionalEngine-503"><a href="#DistributionalEngine-503"><span class="linenos"> 503</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="DistributionalEngine-504"><a href="#DistributionalEngine-504"><span class="linenos"> 504</span></a>            <span class="c1"># Dispatch based on policy type</span>
</span><span id="DistributionalEngine-505"><a href="#DistributionalEngine-505"><span class="linenos"> 505</span></a>            <span class="k">if</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;TaxCreditPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine-506"><a href="#DistributionalEngine-506"><span class="linenos"> 506</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_credit_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-507"><a href="#DistributionalEngine-507"><span class="linenos"> 507</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;TCJAExtensionPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine-508"><a href="#DistributionalEngine-508"><span class="linenos"> 508</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_tcja_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-509"><a href="#DistributionalEngine-509"><span class="linenos"> 509</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;CorporateTaxPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine-510"><a href="#DistributionalEngine-510"><span class="linenos"> 510</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_corporate_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-511"><a href="#DistributionalEngine-511"><span class="linenos"> 511</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;PayrollTaxPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine-512"><a href="#DistributionalEngine-512"><span class="linenos"> 512</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_payroll_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-513"><a href="#DistributionalEngine-513"><span class="linenos"> 513</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-514"><a href="#DistributionalEngine-514"><span class="linenos"> 514</span></a>                <span class="c1"># Default to basic TaxPolicy handling</span>
</span><span id="DistributionalEngine-515"><a href="#DistributionalEngine-515"><span class="linenos"> 515</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_group_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-516"><a href="#DistributionalEngine-516"><span class="linenos"> 516</span></a>
</span><span id="DistributionalEngine-517"><a href="#DistributionalEngine-517"><span class="linenos"> 517</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="DistributionalEngine-518"><a href="#DistributionalEngine-518"><span class="linenos"> 518</span></a>            <span class="n">total_tax_change</span> <span class="o">+=</span> <span class="n">result</span><span class="o">.</span><span class="n">tax_change_total</span>
</span><span id="DistributionalEngine-519"><a href="#DistributionalEngine-519"><span class="linenos"> 519</span></a>            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">pct_with_increase</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">result</span><span class="o">.</span><span class="n">pct_with_decrease</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-520"><a href="#DistributionalEngine-520"><span class="linenos"> 520</span></a>                <span class="n">total_affected</span> <span class="o">+=</span> <span class="n">group</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="DistributionalEngine-521"><a href="#DistributionalEngine-521"><span class="linenos"> 521</span></a>
</span><span id="DistributionalEngine-522"><a href="#DistributionalEngine-522"><span class="linenos"> 522</span></a>        <span class="c1"># Calculate share of total change for each group</span>
</span><span id="DistributionalEngine-523"><a href="#DistributionalEngine-523"><span class="linenos"> 523</span></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">total_tax_change</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>  <span class="c1"># Avoid division by zero</span>
</span><span id="DistributionalEngine-524"><a href="#DistributionalEngine-524"><span class="linenos"> 524</span></a>            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="DistributionalEngine-525"><a href="#DistributionalEngine-525"><span class="linenos"> 525</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">share_of_total_change</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">total_tax_change</span>
</span><span id="DistributionalEngine-526"><a href="#DistributionalEngine-526"><span class="linenos"> 526</span></a>
</span><span id="DistributionalEngine-527"><a href="#DistributionalEngine-527"><span class="linenos"> 527</span></a>        <span class="k">return</span> <span class="n">DistributionalAnalysis</span><span class="p">(</span>
</span><span id="DistributionalEngine-528"><a href="#DistributionalEngine-528"><span class="linenos"> 528</span></a>            <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
</span><span id="DistributionalEngine-529"><a href="#DistributionalEngine-529"><span class="linenos"> 529</span></a>            <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
</span><span id="DistributionalEngine-530"><a href="#DistributionalEngine-530"><span class="linenos"> 530</span></a>            <span class="n">group_type</span><span class="o">=</span><span class="n">group_type</span><span class="p">,</span>
</span><span id="DistributionalEngine-531"><a href="#DistributionalEngine-531"><span class="linenos"> 531</span></a>            <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span>
</span><span id="DistributionalEngine-532"><a href="#DistributionalEngine-532"><span class="linenos"> 532</span></a>            <span class="n">total_tax_change</span><span class="o">=</span><span class="n">total_tax_change</span><span class="p">,</span>
</span><span id="DistributionalEngine-533"><a href="#DistributionalEngine-533"><span class="linenos"> 533</span></a>            <span class="n">total_affected_returns</span><span class="o">=</span><span class="n">total_affected</span><span class="p">,</span>
</span><span id="DistributionalEngine-534"><a href="#DistributionalEngine-534"><span class="linenos"> 534</span></a>        <span class="p">)</span>
</span><span id="DistributionalEngine-535"><a href="#DistributionalEngine-535"><span class="linenos"> 535</span></a>
</span><span id="DistributionalEngine-536"><a href="#DistributionalEngine-536"><span class="linenos"> 536</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_group_effect</span><span class="p">(</span>
</span><span id="DistributionalEngine-537"><a href="#DistributionalEngine-537"><span class="linenos"> 537</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine-538"><a href="#DistributionalEngine-538"><span class="linenos"> 538</span></a>        <span class="n">policy</span><span class="p">:</span> <span class="n">TaxPolicy</span><span class="p">,</span>
</span><span id="DistributionalEngine-539"><a href="#DistributionalEngine-539"><span class="linenos"> 539</span></a>        <span class="n">group</span><span class="p">:</span> <span class="n">IncomeGroup</span><span class="p">,</span>
</span><span id="DistributionalEngine-540"><a href="#DistributionalEngine-540"><span class="linenos"> 540</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalResult</span><span class="p">:</span>
</span><span id="DistributionalEngine-541"><a href="#DistributionalEngine-541"><span class="linenos"> 541</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-542"><a href="#DistributionalEngine-542"><span class="linenos"> 542</span></a><span class="sd">        Calculate tax change effect for one income group.</span>
</span><span id="DistributionalEngine-543"><a href="#DistributionalEngine-543"><span class="linenos"> 543</span></a>
</span><span id="DistributionalEngine-544"><a href="#DistributionalEngine-544"><span class="linenos"> 544</span></a><span class="sd">        This uses the policy&#39;s rate change and threshold to determine</span>
</span><span id="DistributionalEngine-545"><a href="#DistributionalEngine-545"><span class="linenos"> 545</span></a><span class="sd">        how much of the group is affected and the magnitude of change.</span>
</span><span id="DistributionalEngine-546"><a href="#DistributionalEngine-546"><span class="linenos"> 546</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-547"><a href="#DistributionalEngine-547"><span class="linenos"> 547</span></a>        <span class="c1"># Get policy parameters</span>
</span><span id="DistributionalEngine-548"><a href="#DistributionalEngine-548"><span class="linenos"> 548</span></a>        <span class="n">rate_change</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;rate_change&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="DistributionalEngine-549"><a href="#DistributionalEngine-549"><span class="linenos"> 549</span></a>        <span class="n">threshold</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;affected_income_threshold&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DistributionalEngine-550"><a href="#DistributionalEngine-550"><span class="linenos"> 550</span></a>
</span><span id="DistributionalEngine-551"><a href="#DistributionalEngine-551"><span class="linenos"> 551</span></a>        <span class="c1"># Determine what fraction of this group is affected</span>
</span><span id="DistributionalEngine-552"><a href="#DistributionalEngine-552"><span class="linenos"> 552</span></a>        <span class="c1"># If policy threshold is below group floor, entire group affected</span>
</span><span id="DistributionalEngine-553"><a href="#DistributionalEngine-553"><span class="linenos"> 553</span></a>        <span class="c1"># If threshold is above group ceiling, no one affected</span>
</span><span id="DistributionalEngine-554"><a href="#DistributionalEngine-554"><span class="linenos"> 554</span></a>        <span class="c1"># If in between, partial effect</span>
</span><span id="DistributionalEngine-555"><a href="#DistributionalEngine-555"><span class="linenos"> 555</span></a>
</span><span id="DistributionalEngine-556"><a href="#DistributionalEngine-556"><span class="linenos"> 556</span></a>        <span class="n">group_ceiling</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine-557"><a href="#DistributionalEngine-557"><span class="linenos"> 557</span></a>
</span><span id="DistributionalEngine-558"><a href="#DistributionalEngine-558"><span class="linenos"> 558</span></a>        <span class="k">if</span> <span class="n">threshold</span> <span class="o">&gt;=</span> <span class="n">group_ceiling</span><span class="p">:</span>
</span><span id="DistributionalEngine-559"><a href="#DistributionalEngine-559"><span class="linenos"> 559</span></a>            <span class="c1"># No one in this group is affected</span>
</span><span id="DistributionalEngine-560"><a href="#DistributionalEngine-560"><span class="linenos"> 560</span></a>            <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-561"><a href="#DistributionalEngine-561"><span class="linenos"> 561</span></a>        <span class="k">elif</span> <span class="n">threshold</span> <span class="o">&lt;=</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span><span class="p">:</span>
</span><span id="DistributionalEngine-562"><a href="#DistributionalEngine-562"><span class="linenos"> 562</span></a>            <span class="c1"># Everyone in this group is affected</span>
</span><span id="DistributionalEngine-563"><a href="#DistributionalEngine-563"><span class="linenos"> 563</span></a>            <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="DistributionalEngine-564"><a href="#DistributionalEngine-564"><span class="linenos"> 564</span></a>        <span class="k">elif</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine-565"><a href="#DistributionalEngine-565"><span class="linenos"> 565</span></a>            <span class="c1"># Top bracket (no ceiling) - need to estimate fraction above threshold</span>
</span><span id="DistributionalEngine-566"><a href="#DistributionalEngine-566"><span class="linenos"> 566</span></a>            <span class="c1"># Use average AGI to estimate what fraction is above threshold</span>
</span><span id="DistributionalEngine-567"><a href="#DistributionalEngine-567"><span class="linenos"> 567</span></a>            <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_agi</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
</span><span id="DistributionalEngine-568"><a href="#DistributionalEngine-568"><span class="linenos"> 568</span></a>                <span class="c1"># Most of this group is above threshold</span>
</span><span id="DistributionalEngine-569"><a href="#DistributionalEngine-569"><span class="linenos"> 569</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">avg_agi</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_agi</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="DistributionalEngine-570"><a href="#DistributionalEngine-570"><span class="linenos"> 570</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-571"><a href="#DistributionalEngine-571"><span class="linenos"> 571</span></a>                <span class="c1"># Threshold is above average - fewer affected</span>
</span><span id="DistributionalEngine-572"><a href="#DistributionalEngine-572"><span class="linenos"> 572</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="p">(</span><span class="n">threshold</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_agi</span><span class="p">)</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_agi</span><span class="p">)</span>
</span><span id="DistributionalEngine-573"><a href="#DistributionalEngine-573"><span class="linenos"> 573</span></a>            <span class="n">affected_fraction</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">affected_fraction</span><span class="p">))</span>  <span class="c1"># Clamp to [0, 1]</span>
</span><span id="DistributionalEngine-574"><a href="#DistributionalEngine-574"><span class="linenos"> 574</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-575"><a href="#DistributionalEngine-575"><span class="linenos"> 575</span></a>            <span class="c1"># Partial effect - estimate fraction above threshold</span>
</span><span id="DistributionalEngine-576"><a href="#DistributionalEngine-576"><span class="linenos"> 576</span></a>            <span class="c1"># Use simple linear approximation within the group</span>
</span><span id="DistributionalEngine-577"><a href="#DistributionalEngine-577"><span class="linenos"> 577</span></a>            <span class="n">group_width</span> <span class="o">=</span> <span class="n">group_ceiling</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span>
</span><span id="DistributionalEngine-578"><a href="#DistributionalEngine-578"><span class="linenos"> 578</span></a>            <span class="n">affected_width</span> <span class="o">=</span> <span class="n">group_ceiling</span> <span class="o">-</span> <span class="n">threshold</span>
</span><span id="DistributionalEngine-579"><a href="#DistributionalEngine-579"><span class="linenos"> 579</span></a>            <span class="n">affected_fraction</span> <span class="o">=</span> <span class="n">affected_width</span> <span class="o">/</span> <span class="n">group_width</span> <span class="k">if</span> <span class="n">group_width</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-580"><a href="#DistributionalEngine-580"><span class="linenos"> 580</span></a>
</span><span id="DistributionalEngine-581"><a href="#DistributionalEngine-581"><span class="linenos"> 581</span></a>        <span class="c1"># Calculate tax change</span>
</span><span id="DistributionalEngine-582"><a href="#DistributionalEngine-582"><span class="linenos"> 582</span></a>        <span class="n">affected_taxable</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">total_taxable_income</span> <span class="o">*</span> <span class="n">affected_fraction</span>
</span><span id="DistributionalEngine-583"><a href="#DistributionalEngine-583"><span class="linenos"> 583</span></a>        <span class="n">tax_change_total</span> <span class="o">=</span> <span class="n">rate_change</span> <span class="o">*</span> <span class="n">affected_taxable</span>  <span class="c1"># In billions</span>
</span><span id="DistributionalEngine-584"><a href="#DistributionalEngine-584"><span class="linenos"> 584</span></a>
</span><span id="DistributionalEngine-585"><a href="#DistributionalEngine-585"><span class="linenos"> 585</span></a>        <span class="c1"># Calculate per-return metrics</span>
</span><span id="DistributionalEngine-586"><a href="#DistributionalEngine-586"><span class="linenos"> 586</span></a>        <span class="n">affected_returns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">*</span> <span class="n">affected_fraction</span><span class="p">)</span>
</span><span id="DistributionalEngine-587"><a href="#DistributionalEngine-587"><span class="linenos"> 587</span></a>        <span class="k">if</span> <span class="n">affected_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-588"><a href="#DistributionalEngine-588"><span class="linenos"> 588</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="n">affected_returns</span>
</span><span id="DistributionalEngine-589"><a href="#DistributionalEngine-589"><span class="linenos"> 589</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-590"><a href="#DistributionalEngine-590"><span class="linenos"> 590</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-591"><a href="#DistributionalEngine-591"><span class="linenos"> 591</span></a>
</span><span id="DistributionalEngine-592"><a href="#DistributionalEngine-592"><span class="linenos"> 592</span></a>        <span class="c1"># Calculate as percent of income (after-tax)</span>
</span><span id="DistributionalEngine-593"><a href="#DistributionalEngine-593"><span class="linenos"> 593</span></a>        <span class="n">after_tax_income</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span>
</span><span id="DistributionalEngine-594"><a href="#DistributionalEngine-594"><span class="linenos"> 594</span></a>        <span class="k">if</span> <span class="n">after_tax_income</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-595"><a href="#DistributionalEngine-595"><span class="linenos"> 595</span></a>            <span class="n">tax_change_pct_income</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">after_tax_income</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-596"><a href="#DistributionalEngine-596"><span class="linenos"> 596</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-597"><a href="#DistributionalEngine-597"><span class="linenos"> 597</span></a>            <span class="n">tax_change_pct_income</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-598"><a href="#DistributionalEngine-598"><span class="linenos"> 598</span></a>
</span><span id="DistributionalEngine-599"><a href="#DistributionalEngine-599"><span class="linenos"> 599</span></a>        <span class="c1"># Effective tax rates</span>
</span><span id="DistributionalEngine-600"><a href="#DistributionalEngine-600"><span class="linenos"> 600</span></a>        <span class="n">baseline_etr</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">effective_tax_rate</span>
</span><span id="DistributionalEngine-601"><a href="#DistributionalEngine-601"><span class="linenos"> 601</span></a>        <span class="n">new_tax</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">+</span> <span class="n">tax_change_total</span>
</span><span id="DistributionalEngine-602"><a href="#DistributionalEngine-602"><span class="linenos"> 602</span></a>        <span class="n">new_etr</span> <span class="o">=</span> <span class="n">new_tax</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-603"><a href="#DistributionalEngine-603"><span class="linenos"> 603</span></a>
</span><span id="DistributionalEngine-604"><a href="#DistributionalEngine-604"><span class="linenos"> 604</span></a>        <span class="c1"># Winners/losers (simplified - assumes all affected move same direction)</span>
</span><span id="DistributionalEngine-605"><a href="#DistributionalEngine-605"><span class="linenos"> 605</span></a>        <span class="k">if</span> <span class="n">rate_change</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Tax increase</span>
</span><span id="DistributionalEngine-606"><a href="#DistributionalEngine-606"><span class="linenos"> 606</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="n">affected_fraction</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-607"><a href="#DistributionalEngine-607"><span class="linenos"> 607</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-608"><a href="#DistributionalEngine-608"><span class="linenos"> 608</span></a>        <span class="k">elif</span> <span class="n">rate_change</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Tax cut</span>
</span><span id="DistributionalEngine-609"><a href="#DistributionalEngine-609"><span class="linenos"> 609</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-610"><a href="#DistributionalEngine-610"><span class="linenos"> 610</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="n">affected_fraction</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-611"><a href="#DistributionalEngine-611"><span class="linenos"> 611</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-612"><a href="#DistributionalEngine-612"><span class="linenos"> 612</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-613"><a href="#DistributionalEngine-613"><span class="linenos"> 613</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-614"><a href="#DistributionalEngine-614"><span class="linenos"> 614</span></a>
</span><span id="DistributionalEngine-615"><a href="#DistributionalEngine-615"><span class="linenos"> 615</span></a>        <span class="n">pct_unchanged</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">pct_with_increase</span> <span class="o">-</span> <span class="n">pct_with_decrease</span>
</span><span id="DistributionalEngine-616"><a href="#DistributionalEngine-616"><span class="linenos"> 616</span></a>
</span><span id="DistributionalEngine-617"><a href="#DistributionalEngine-617"><span class="linenos"> 617</span></a>        <span class="k">return</span> <span class="n">DistributionalResult</span><span class="p">(</span>
</span><span id="DistributionalEngine-618"><a href="#DistributionalEngine-618"><span class="linenos"> 618</span></a>            <span class="n">income_group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
</span><span id="DistributionalEngine-619"><a href="#DistributionalEngine-619"><span class="linenos"> 619</span></a>            <span class="n">tax_change_total</span><span class="o">=</span><span class="n">tax_change_total</span><span class="p">,</span>
</span><span id="DistributionalEngine-620"><a href="#DistributionalEngine-620"><span class="linenos"> 620</span></a>            <span class="n">tax_change_avg</span><span class="o">=</span><span class="n">tax_change_avg</span><span class="p">,</span>
</span><span id="DistributionalEngine-621"><a href="#DistributionalEngine-621"><span class="linenos"> 621</span></a>            <span class="n">tax_change_pct_income</span><span class="o">=</span><span class="n">tax_change_pct_income</span><span class="p">,</span>
</span><span id="DistributionalEngine-622"><a href="#DistributionalEngine-622"><span class="linenos"> 622</span></a>            <span class="n">share_of_total_change</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Calculated later</span>
</span><span id="DistributionalEngine-623"><a href="#DistributionalEngine-623"><span class="linenos"> 623</span></a>            <span class="n">pct_with_increase</span><span class="o">=</span><span class="n">pct_with_increase</span><span class="p">,</span>
</span><span id="DistributionalEngine-624"><a href="#DistributionalEngine-624"><span class="linenos"> 624</span></a>            <span class="n">pct_with_decrease</span><span class="o">=</span><span class="n">pct_with_decrease</span><span class="p">,</span>
</span><span id="DistributionalEngine-625"><a href="#DistributionalEngine-625"><span class="linenos"> 625</span></a>            <span class="n">pct_unchanged</span><span class="o">=</span><span class="n">pct_unchanged</span><span class="p">,</span>
</span><span id="DistributionalEngine-626"><a href="#DistributionalEngine-626"><span class="linenos"> 626</span></a>            <span class="n">baseline_etr</span><span class="o">=</span><span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-627"><a href="#DistributionalEngine-627"><span class="linenos"> 627</span></a>            <span class="n">new_etr</span><span class="o">=</span><span class="n">new_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-628"><a href="#DistributionalEngine-628"><span class="linenos"> 628</span></a>            <span class="n">etr_change</span><span class="o">=</span><span class="n">new_etr</span> <span class="o">-</span> <span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-629"><a href="#DistributionalEngine-629"><span class="linenos"> 629</span></a>        <span class="p">)</span>
</span><span id="DistributionalEngine-630"><a href="#DistributionalEngine-630"><span class="linenos"> 630</span></a>
</span><span id="DistributionalEngine-631"><a href="#DistributionalEngine-631"><span class="linenos"> 631</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_credit_effect</span><span class="p">(</span>
</span><span id="DistributionalEngine-632"><a href="#DistributionalEngine-632"><span class="linenos"> 632</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine-633"><a href="#DistributionalEngine-633"><span class="linenos"> 633</span></a>        <span class="n">policy</span><span class="p">,</span>  <span class="c1"># TaxCreditPolicy</span>
</span><span id="DistributionalEngine-634"><a href="#DistributionalEngine-634"><span class="linenos"> 634</span></a>        <span class="n">group</span><span class="p">:</span> <span class="n">IncomeGroup</span><span class="p">,</span>
</span><span id="DistributionalEngine-635"><a href="#DistributionalEngine-635"><span class="linenos"> 635</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalResult</span><span class="p">:</span>
</span><span id="DistributionalEngine-636"><a href="#DistributionalEngine-636"><span class="linenos"> 636</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-637"><a href="#DistributionalEngine-637"><span class="linenos"> 637</span></a><span class="sd">        Calculate distributional effect for tax credit policies (CTC, EITC).</span>
</span><span id="DistributionalEngine-638"><a href="#DistributionalEngine-638"><span class="linenos"> 638</span></a>
</span><span id="DistributionalEngine-639"><a href="#DistributionalEngine-639"><span class="linenos"> 639</span></a><span class="sd">        Tax credits are structured with:</span>
</span><span id="DistributionalEngine-640"><a href="#DistributionalEngine-640"><span class="linenos"> 640</span></a><span class="sd">        - Phase-in: Credit increases with income up to a maximum</span>
</span><span id="DistributionalEngine-641"><a href="#DistributionalEngine-641"><span class="linenos"> 641</span></a><span class="sd">        - Plateau: Maximum credit in a range</span>
</span><span id="DistributionalEngine-642"><a href="#DistributionalEngine-642"><span class="linenos"> 642</span></a><span class="sd">        - Phase-out: Credit decreases above a threshold</span>
</span><span id="DistributionalEngine-643"><a href="#DistributionalEngine-643"><span class="linenos"> 643</span></a>
</span><span id="DistributionalEngine-644"><a href="#DistributionalEngine-644"><span class="linenos"> 644</span></a><span class="sd">        Lower-income groups typically benefit more from refundable credits.</span>
</span><span id="DistributionalEngine-645"><a href="#DistributionalEngine-645"><span class="linenos"> 645</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-646"><a href="#DistributionalEngine-646"><span class="linenos"> 646</span></a>        <span class="c1"># Get policy parameters</span>
</span><span id="DistributionalEngine-647"><a href="#DistributionalEngine-647"><span class="linenos"> 647</span></a>        <span class="n">credit_change</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;credit_change_per_unit&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DistributionalEngine-648"><a href="#DistributionalEngine-648"><span class="linenos"> 648</span></a>        <span class="k">if</span> <span class="n">credit_change</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-649"><a href="#DistributionalEngine-649"><span class="linenos"> 649</span></a>            <span class="c1"># Try alternate attribute names</span>
</span><span id="DistributionalEngine-650"><a href="#DistributionalEngine-650"><span class="linenos"> 650</span></a>            <span class="n">credit_change</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;max_credit_change&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DistributionalEngine-651"><a href="#DistributionalEngine-651"><span class="linenos"> 651</span></a>
</span><span id="DistributionalEngine-652"><a href="#DistributionalEngine-652"><span class="linenos"> 652</span></a>        <span class="n">units_millions</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;units_affected_millions&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DistributionalEngine-653"><a href="#DistributionalEngine-653"><span class="linenos"> 653</span></a>        <span class="n">is_refundable</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;is_refundable&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="DistributionalEngine-654"><a href="#DistributionalEngine-654"><span class="linenos"> 654</span></a>
</span><span id="DistributionalEngine-655"><a href="#DistributionalEngine-655"><span class="linenos"> 655</span></a>        <span class="c1"># Phase-out thresholds (credits phase out at higher incomes)</span>
</span><span id="DistributionalEngine-656"><a href="#DistributionalEngine-656"><span class="linenos"> 656</span></a>        <span class="c1"># Try multiple attribute names for compatibility</span>
</span><span id="DistributionalEngine-657"><a href="#DistributionalEngine-657"><span class="linenos"> 657</span></a>        <span class="n">phase_out_start</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;phase_out_threshold_single&#39;</span><span class="p">,</span>
</span><span id="DistributionalEngine-658"><a href="#DistributionalEngine-658"><span class="linenos"> 658</span></a>                           <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;phase_out_threshold&#39;</span><span class="p">,</span> <span class="mi">200_000</span><span class="p">))</span>
</span><span id="DistributionalEngine-659"><a href="#DistributionalEngine-659"><span class="linenos"> 659</span></a>        <span class="n">phase_out_rate</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;phase_out_rate&#39;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
</span><span id="DistributionalEngine-660"><a href="#DistributionalEngine-660"><span class="linenos"> 660</span></a>
</span><span id="DistributionalEngine-661"><a href="#DistributionalEngine-661"><span class="linenos"> 661</span></a>        <span class="c1"># Phase-in thresholds (EITC-style, credit phases in with earnings)</span>
</span><span id="DistributionalEngine-662"><a href="#DistributionalEngine-662"><span class="linenos"> 662</span></a>        <span class="n">phase_in_end</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;phase_in_end&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DistributionalEngine-663"><a href="#DistributionalEngine-663"><span class="linenos"> 663</span></a>
</span><span id="DistributionalEngine-664"><a href="#DistributionalEngine-664"><span class="linenos"> 664</span></a>        <span class="n">group_ceiling</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine-665"><a href="#DistributionalEngine-665"><span class="linenos"> 665</span></a>
</span><span id="DistributionalEngine-666"><a href="#DistributionalEngine-666"><span class="linenos"> 666</span></a>        <span class="c1"># Determine what fraction of this group receives the credit</span>
</span><span id="DistributionalEngine-667"><a href="#DistributionalEngine-667"><span class="linenos"> 667</span></a>        <span class="c1"># Credits tend to benefit middle and lower incomes</span>
</span><span id="DistributionalEngine-668"><a href="#DistributionalEngine-668"><span class="linenos"> 668</span></a>        <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&gt;=</span> <span class="n">phase_out_start</span><span class="p">:</span>
</span><span id="DistributionalEngine-669"><a href="#DistributionalEngine-669"><span class="linenos"> 669</span></a>            <span class="c1"># Above phase-out start - reduced benefit</span>
</span><span id="DistributionalEngine-670"><a href="#DistributionalEngine-670"><span class="linenos"> 670</span></a>            <span class="k">if</span> <span class="n">phase_out_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-671"><a href="#DistributionalEngine-671"><span class="linenos"> 671</span></a>                <span class="c1"># Calculate how much credit is phased out</span>
</span><span id="DistributionalEngine-672"><a href="#DistributionalEngine-672"><span class="linenos"> 672</span></a>                <span class="n">excess_income</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_agi</span> <span class="o">-</span> <span class="n">phase_out_start</span>
</span><span id="DistributionalEngine-673"><a href="#DistributionalEngine-673"><span class="linenos"> 673</span></a>                <span class="n">credit_reduction</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">excess_income</span> <span class="o">*</span> <span class="n">phase_out_rate</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">credit_change</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DistributionalEngine-674"><a href="#DistributionalEngine-674"><span class="linenos"> 674</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">credit_reduction</span><span class="p">)</span>
</span><span id="DistributionalEngine-675"><a href="#DistributionalEngine-675"><span class="linenos"> 675</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-676"><a href="#DistributionalEngine-676"><span class="linenos"> 676</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-677"><a href="#DistributionalEngine-677"><span class="linenos"> 677</span></a>        <span class="k">elif</span> <span class="n">phase_in_end</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">group_ceiling</span> <span class="o">&lt;=</span> <span class="n">phase_in_end</span><span class="p">:</span>
</span><span id="DistributionalEngine-678"><a href="#DistributionalEngine-678"><span class="linenos"> 678</span></a>            <span class="c1"># Below phase-in end - partial benefit (EITC-style)</span>
</span><span id="DistributionalEngine-679"><a href="#DistributionalEngine-679"><span class="linenos"> 679</span></a>            <span class="n">affected_fraction</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_agi</span> <span class="o">/</span> <span class="n">phase_in_end</span> <span class="k">if</span> <span class="n">phase_in_end</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">1.0</span>
</span><span id="DistributionalEngine-680"><a href="#DistributionalEngine-680"><span class="linenos"> 680</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-681"><a href="#DistributionalEngine-681"><span class="linenos"> 681</span></a>            <span class="c1"># In plateau range - full benefit</span>
</span><span id="DistributionalEngine-682"><a href="#DistributionalEngine-682"><span class="linenos"> 682</span></a>            <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="DistributionalEngine-683"><a href="#DistributionalEngine-683"><span class="linenos"> 683</span></a>
</span><span id="DistributionalEngine-684"><a href="#DistributionalEngine-684"><span class="linenos"> 684</span></a>        <span class="c1"># For non-refundable credits, lower incomes may not benefit fully</span>
</span><span id="DistributionalEngine-685"><a href="#DistributionalEngine-685"><span class="linenos"> 685</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_refundable</span> <span class="ow">and</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_tax</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">credit_change</span><span class="p">):</span>
</span><span id="DistributionalEngine-686"><a href="#DistributionalEngine-686"><span class="linenos"> 686</span></a>            <span class="c1"># Credit limited by tax liability</span>
</span><span id="DistributionalEngine-687"><a href="#DistributionalEngine-687"><span class="linenos"> 687</span></a>            <span class="n">effective_credit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">credit_change</span><span class="p">),</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_tax</span><span class="p">)</span>
</span><span id="DistributionalEngine-688"><a href="#DistributionalEngine-688"><span class="linenos"> 688</span></a>            <span class="n">credit_fraction</span> <span class="o">=</span> <span class="n">effective_credit</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">credit_change</span><span class="p">)</span> <span class="k">if</span> <span class="n">credit_change</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-689"><a href="#DistributionalEngine-689"><span class="linenos"> 689</span></a>            <span class="n">affected_fraction</span> <span class="o">*=</span> <span class="n">credit_fraction</span>
</span><span id="DistributionalEngine-690"><a href="#DistributionalEngine-690"><span class="linenos"> 690</span></a>
</span><span id="DistributionalEngine-691"><a href="#DistributionalEngine-691"><span class="linenos"> 691</span></a>        <span class="c1"># Estimate recipients in this group based on income distribution</span>
</span><span id="DistributionalEngine-692"><a href="#DistributionalEngine-692"><span class="linenos"> 692</span></a>        <span class="c1"># Credits tend to be claimed more by middle-income groups</span>
</span><span id="DistributionalEngine-693"><a href="#DistributionalEngine-693"><span class="linenos"> 693</span></a>        <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&lt;</span> <span class="mi">50_000</span><span class="p">:</span>
</span><span id="DistributionalEngine-694"><a href="#DistributionalEngine-694"><span class="linenos"> 694</span></a>            <span class="n">recipient_share</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Lower income gets ~30% of credits</span>
</span><span id="DistributionalEngine-695"><a href="#DistributionalEngine-695"><span class="linenos"> 695</span></a>        <span class="k">elif</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&lt;</span> <span class="mi">100_000</span><span class="p">:</span>
</span><span id="DistributionalEngine-696"><a href="#DistributionalEngine-696"><span class="linenos"> 696</span></a>            <span class="n">recipient_share</span> <span class="o">=</span> <span class="mf">0.35</span>  <span class="c1"># Middle income gets ~35%</span>
</span><span id="DistributionalEngine-697"><a href="#DistributionalEngine-697"><span class="linenos"> 697</span></a>        <span class="k">elif</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&lt;</span> <span class="mi">200_000</span><span class="p">:</span>
</span><span id="DistributionalEngine-698"><a href="#DistributionalEngine-698"><span class="linenos"> 698</span></a>            <span class="n">recipient_share</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># Upper-middle gets ~25%</span>
</span><span id="DistributionalEngine-699"><a href="#DistributionalEngine-699"><span class="linenos"> 699</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-700"><a href="#DistributionalEngine-700"><span class="linenos"> 700</span></a>            <span class="n">recipient_share</span> <span class="o">=</span> <span class="mf">0.10</span>  <span class="c1"># High income gets ~10%</span>
</span><span id="DistributionalEngine-701"><a href="#DistributionalEngine-701"><span class="linenos"> 701</span></a>
</span><span id="DistributionalEngine-702"><a href="#DistributionalEngine-702"><span class="linenos"> 702</span></a>        <span class="c1"># Adjust for population share</span>
</span><span id="DistributionalEngine-703"><a href="#DistributionalEngine-703"><span class="linenos"> 703</span></a>        <span class="n">recipient_share</span> <span class="o">*=</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>  <span class="c1"># Normalize</span>
</span><span id="DistributionalEngine-704"><a href="#DistributionalEngine-704"><span class="linenos"> 704</span></a>
</span><span id="DistributionalEngine-705"><a href="#DistributionalEngine-705"><span class="linenos"> 705</span></a>        <span class="c1"># Calculate tax change (credits reduce taxes, so negative)</span>
</span><span id="DistributionalEngine-706"><a href="#DistributionalEngine-706"><span class="linenos"> 706</span></a>        <span class="n">units_in_group</span> <span class="o">=</span> <span class="n">units_millions</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="n">recipient_share</span>
</span><span id="DistributionalEngine-707"><a href="#DistributionalEngine-707"><span class="linenos"> 707</span></a>        <span class="n">tax_change_total</span> <span class="o">=</span> <span class="o">-</span><span class="n">credit_change</span> <span class="o">*</span> <span class="n">units_in_group</span> <span class="o">*</span> <span class="n">affected_fraction</span> <span class="o">/</span> <span class="mf">1e9</span>  <span class="c1"># In billions</span>
</span><span id="DistributionalEngine-708"><a href="#DistributionalEngine-708"><span class="linenos"> 708</span></a>
</span><span id="DistributionalEngine-709"><a href="#DistributionalEngine-709"><span class="linenos"> 709</span></a>        <span class="c1"># Per-return metrics</span>
</span><span id="DistributionalEngine-710"><a href="#DistributionalEngine-710"><span class="linenos"> 710</span></a>        <span class="n">affected_returns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">units_in_group</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">num_returns</span><span class="p">)</span> <span class="o">*</span> <span class="n">affected_fraction</span><span class="p">)</span>
</span><span id="DistributionalEngine-711"><a href="#DistributionalEngine-711"><span class="linenos"> 711</span></a>        <span class="k">if</span> <span class="n">affected_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-712"><a href="#DistributionalEngine-712"><span class="linenos"> 712</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="n">affected_returns</span>
</span><span id="DistributionalEngine-713"><a href="#DistributionalEngine-713"><span class="linenos"> 713</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-714"><a href="#DistributionalEngine-714"><span class="linenos"> 714</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-715"><a href="#DistributionalEngine-715"><span class="linenos"> 715</span></a>
</span><span id="DistributionalEngine-716"><a href="#DistributionalEngine-716"><span class="linenos"> 716</span></a>        <span class="c1"># Calculate as percent of income</span>
</span><span id="DistributionalEngine-717"><a href="#DistributionalEngine-717"><span class="linenos"> 717</span></a>        <span class="n">after_tax_income</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span>
</span><span id="DistributionalEngine-718"><a href="#DistributionalEngine-718"><span class="linenos"> 718</span></a>        <span class="n">tax_change_pct_income</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">after_tax_income</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">after_tax_income</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-719"><a href="#DistributionalEngine-719"><span class="linenos"> 719</span></a>
</span><span id="DistributionalEngine-720"><a href="#DistributionalEngine-720"><span class="linenos"> 720</span></a>        <span class="c1"># Effective tax rates</span>
</span><span id="DistributionalEngine-721"><a href="#DistributionalEngine-721"><span class="linenos"> 721</span></a>        <span class="n">baseline_etr</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">effective_tax_rate</span>
</span><span id="DistributionalEngine-722"><a href="#DistributionalEngine-722"><span class="linenos"> 722</span></a>        <span class="n">new_tax</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">+</span> <span class="n">tax_change_total</span>
</span><span id="DistributionalEngine-723"><a href="#DistributionalEngine-723"><span class="linenos"> 723</span></a>        <span class="n">new_etr</span> <span class="o">=</span> <span class="n">new_tax</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-724"><a href="#DistributionalEngine-724"><span class="linenos"> 724</span></a>
</span><span id="DistributionalEngine-725"><a href="#DistributionalEngine-725"><span class="linenos"> 725</span></a>        <span class="c1"># Winners/losers (credits typically benefit, so tax decrease)</span>
</span><span id="DistributionalEngine-726"><a href="#DistributionalEngine-726"><span class="linenos"> 726</span></a>        <span class="k">if</span> <span class="n">credit_change</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Expansion = tax cut</span>
</span><span id="DistributionalEngine-727"><a href="#DistributionalEngine-727"><span class="linenos"> 727</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="n">recipient_share</span> <span class="o">*</span> <span class="n">affected_fraction</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-728"><a href="#DistributionalEngine-728"><span class="linenos"> 728</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-729"><a href="#DistributionalEngine-729"><span class="linenos"> 729</span></a>        <span class="k">elif</span> <span class="n">credit_change</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Reduction = tax increase</span>
</span><span id="DistributionalEngine-730"><a href="#DistributionalEngine-730"><span class="linenos"> 730</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="n">recipient_share</span> <span class="o">*</span> <span class="n">affected_fraction</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-731"><a href="#DistributionalEngine-731"><span class="linenos"> 731</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-732"><a href="#DistributionalEngine-732"><span class="linenos"> 732</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-733"><a href="#DistributionalEngine-733"><span class="linenos"> 733</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-734"><a href="#DistributionalEngine-734"><span class="linenos"> 734</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-735"><a href="#DistributionalEngine-735"><span class="linenos"> 735</span></a>
</span><span id="DistributionalEngine-736"><a href="#DistributionalEngine-736"><span class="linenos"> 736</span></a>        <span class="n">pct_unchanged</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">pct_with_increase</span> <span class="o">-</span> <span class="n">pct_with_decrease</span>
</span><span id="DistributionalEngine-737"><a href="#DistributionalEngine-737"><span class="linenos"> 737</span></a>
</span><span id="DistributionalEngine-738"><a href="#DistributionalEngine-738"><span class="linenos"> 738</span></a>        <span class="k">return</span> <span class="n">DistributionalResult</span><span class="p">(</span>
</span><span id="DistributionalEngine-739"><a href="#DistributionalEngine-739"><span class="linenos"> 739</span></a>            <span class="n">income_group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
</span><span id="DistributionalEngine-740"><a href="#DistributionalEngine-740"><span class="linenos"> 740</span></a>            <span class="n">tax_change_total</span><span class="o">=</span><span class="n">tax_change_total</span><span class="p">,</span>
</span><span id="DistributionalEngine-741"><a href="#DistributionalEngine-741"><span class="linenos"> 741</span></a>            <span class="n">tax_change_avg</span><span class="o">=</span><span class="n">tax_change_avg</span><span class="p">,</span>
</span><span id="DistributionalEngine-742"><a href="#DistributionalEngine-742"><span class="linenos"> 742</span></a>            <span class="n">tax_change_pct_income</span><span class="o">=</span><span class="n">tax_change_pct_income</span><span class="p">,</span>
</span><span id="DistributionalEngine-743"><a href="#DistributionalEngine-743"><span class="linenos"> 743</span></a>            <span class="n">share_of_total_change</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="DistributionalEngine-744"><a href="#DistributionalEngine-744"><span class="linenos"> 744</span></a>            <span class="n">pct_with_increase</span><span class="o">=</span><span class="n">pct_with_increase</span><span class="p">,</span>
</span><span id="DistributionalEngine-745"><a href="#DistributionalEngine-745"><span class="linenos"> 745</span></a>            <span class="n">pct_with_decrease</span><span class="o">=</span><span class="n">pct_with_decrease</span><span class="p">,</span>
</span><span id="DistributionalEngine-746"><a href="#DistributionalEngine-746"><span class="linenos"> 746</span></a>            <span class="n">pct_unchanged</span><span class="o">=</span><span class="n">pct_unchanged</span><span class="p">,</span>
</span><span id="DistributionalEngine-747"><a href="#DistributionalEngine-747"><span class="linenos"> 747</span></a>            <span class="n">baseline_etr</span><span class="o">=</span><span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-748"><a href="#DistributionalEngine-748"><span class="linenos"> 748</span></a>            <span class="n">new_etr</span><span class="o">=</span><span class="n">new_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-749"><a href="#DistributionalEngine-749"><span class="linenos"> 749</span></a>            <span class="n">etr_change</span><span class="o">=</span><span class="n">new_etr</span> <span class="o">-</span> <span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-750"><a href="#DistributionalEngine-750"><span class="linenos"> 750</span></a>        <span class="p">)</span>
</span><span id="DistributionalEngine-751"><a href="#DistributionalEngine-751"><span class="linenos"> 751</span></a>
</span><span id="DistributionalEngine-752"><a href="#DistributionalEngine-752"><span class="linenos"> 752</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_tcja_effect</span><span class="p">(</span>
</span><span id="DistributionalEngine-753"><a href="#DistributionalEngine-753"><span class="linenos"> 753</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine-754"><a href="#DistributionalEngine-754"><span class="linenos"> 754</span></a>        <span class="n">policy</span><span class="p">,</span>  <span class="c1"># TCJAExtensionPolicy</span>
</span><span id="DistributionalEngine-755"><a href="#DistributionalEngine-755"><span class="linenos"> 755</span></a>        <span class="n">group</span><span class="p">:</span> <span class="n">IncomeGroup</span><span class="p">,</span>
</span><span id="DistributionalEngine-756"><a href="#DistributionalEngine-756"><span class="linenos"> 756</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalResult</span><span class="p">:</span>
</span><span id="DistributionalEngine-757"><a href="#DistributionalEngine-757"><span class="linenos"> 757</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-758"><a href="#DistributionalEngine-758"><span class="linenos"> 758</span></a><span class="sd">        Calculate distributional effect for TCJA extension.</span>
</span><span id="DistributionalEngine-759"><a href="#DistributionalEngine-759"><span class="linenos"> 759</span></a>
</span><span id="DistributionalEngine-760"><a href="#DistributionalEngine-760"><span class="linenos"> 760</span></a><span class="sd">        TCJA has multiple components with different distributions:</span>
</span><span id="DistributionalEngine-761"><a href="#DistributionalEngine-761"><span class="linenos"> 761</span></a><span class="sd">        - Rate cuts: Benefit all brackets, top brackets more in $ terms</span>
</span><span id="DistributionalEngine-762"><a href="#DistributionalEngine-762"><span class="linenos"> 762</span></a><span class="sd">        - Standard deduction: Benefit itemizers (middle/upper income)</span>
</span><span id="DistributionalEngine-763"><a href="#DistributionalEngine-763"><span class="linenos"> 763</span></a><span class="sd">        - Personal exemption elimination: Hurt large families</span>
</span><span id="DistributionalEngine-764"><a href="#DistributionalEngine-764"><span class="linenos"> 764</span></a><span class="sd">        - SALT cap: Hurt high-tax state residents (upper income)</span>
</span><span id="DistributionalEngine-765"><a href="#DistributionalEngine-765"><span class="linenos"> 765</span></a><span class="sd">        - CTC expansion: Benefit middle income with children</span>
</span><span id="DistributionalEngine-766"><a href="#DistributionalEngine-766"><span class="linenos"> 766</span></a><span class="sd">        - Pass-through deduction: Benefit business owners (upper income)</span>
</span><span id="DistributionalEngine-767"><a href="#DistributionalEngine-767"><span class="linenos"> 767</span></a>
</span><span id="DistributionalEngine-768"><a href="#DistributionalEngine-768"><span class="linenos"> 768</span></a><span class="sd">        Distribution estimate based on TPC analysis of TCJA.</span>
</span><span id="DistributionalEngine-769"><a href="#DistributionalEngine-769"><span class="linenos"> 769</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-770"><a href="#DistributionalEngine-770"><span class="linenos"> 770</span></a>        <span class="c1"># Get total cost and components</span>
</span><span id="DistributionalEngine-771"><a href="#DistributionalEngine-771"><span class="linenos"> 771</span></a>        <span class="n">ten_year_cost</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;ten_year_cost_billions&#39;</span><span class="p">,</span> <span class="mi">4600</span><span class="p">)</span>
</span><span id="DistributionalEngine-772"><a href="#DistributionalEngine-772"><span class="linenos"> 772</span></a>        <span class="n">extend_salt_cap</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;extend_salt_cap&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="DistributionalEngine-773"><a href="#DistributionalEngine-773"><span class="linenos"> 773</span></a>
</span><span id="DistributionalEngine-774"><a href="#DistributionalEngine-774"><span class="linenos"> 774</span></a>        <span class="c1"># Annual cost (first year)</span>
</span><span id="DistributionalEngine-775"><a href="#DistributionalEngine-775"><span class="linenos"> 775</span></a>        <span class="n">annual_cost</span> <span class="o">=</span> <span class="n">ten_year_cost</span> <span class="o">/</span> <span class="mf">10.0</span>
</span><span id="DistributionalEngine-776"><a href="#DistributionalEngine-776"><span class="linenos"> 776</span></a>
</span><span id="DistributionalEngine-777"><a href="#DistributionalEngine-777"><span class="linenos"> 777</span></a>        <span class="c1"># TPC-based distribution shares by income quintile</span>
</span><span id="DistributionalEngine-778"><a href="#DistributionalEngine-778"><span class="linenos"> 778</span></a>        <span class="c1"># Based on TPC &quot;Distributional Analysis of TCJA&quot; (2017)</span>
</span><span id="DistributionalEngine-779"><a href="#DistributionalEngine-779"><span class="linenos"> 779</span></a>        <span class="c1"># TCJA benefits skew toward higher incomes</span>
</span><span id="DistributionalEngine-780"><a href="#DistributionalEngine-780"><span class="linenos"> 780</span></a>        <span class="k">if</span> <span class="n">extend_salt_cap</span><span class="p">:</span>
</span><span id="DistributionalEngine-781"><a href="#DistributionalEngine-781"><span class="linenos"> 781</span></a>            <span class="c1"># With SALT cap: top benefits most</span>
</span><span id="DistributionalEngine-782"><a href="#DistributionalEngine-782"><span class="linenos"> 782</span></a>            <span class="n">distribution_shares</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DistributionalEngine-783"><a href="#DistributionalEngine-783"><span class="linenos"> 783</span></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35_000</span><span class="p">):</span> <span class="mf">0.02</span><span class="p">,</span>        <span class="c1"># Bottom quintile: 2%</span>
</span><span id="DistributionalEngine-784"><a href="#DistributionalEngine-784"><span class="linenos"> 784</span></a>                <span class="p">(</span><span class="mi">35_000</span><span class="p">,</span> <span class="mi">65_000</span><span class="p">):</span> <span class="mf">0.05</span><span class="p">,</span>   <span class="c1"># Second quintile: 5%</span>
</span><span id="DistributionalEngine-785"><a href="#DistributionalEngine-785"><span class="linenos"> 785</span></a>                <span class="p">(</span><span class="mi">65_000</span><span class="p">,</span> <span class="mi">105_000</span><span class="p">):</span> <span class="mf">0.10</span><span class="p">,</span>  <span class="c1"># Middle quintile: 10%</span>
</span><span id="DistributionalEngine-786"><a href="#DistributionalEngine-786"><span class="linenos"> 786</span></a>                <span class="p">(</span><span class="mi">105_000</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">):</span> <span class="mf">0.18</span><span class="p">,</span> <span class="c1"># Fourth quintile: 18%</span>
</span><span id="DistributionalEngine-787"><a href="#DistributionalEngine-787"><span class="linenos"> 787</span></a>                <span class="p">(</span><span class="mi">170_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span> <span class="mf">0.65</span><span class="p">,</span>    <span class="c1"># Top quintile: 65%</span>
</span><span id="DistributionalEngine-788"><a href="#DistributionalEngine-788"><span class="linenos"> 788</span></a>            <span class="p">}</span>
</span><span id="DistributionalEngine-789"><a href="#DistributionalEngine-789"><span class="linenos"> 789</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-790"><a href="#DistributionalEngine-790"><span class="linenos"> 790</span></a>            <span class="c1"># Without SALT cap: even more tilted to top</span>
</span><span id="DistributionalEngine-791"><a href="#DistributionalEngine-791"><span class="linenos"> 791</span></a>            <span class="n">distribution_shares</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DistributionalEngine-792"><a href="#DistributionalEngine-792"><span class="linenos"> 792</span></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35_000</span><span class="p">):</span> <span class="mf">0.02</span><span class="p">,</span>
</span><span id="DistributionalEngine-793"><a href="#DistributionalEngine-793"><span class="linenos"> 793</span></a>                <span class="p">(</span><span class="mi">35_000</span><span class="p">,</span> <span class="mi">65_000</span><span class="p">):</span> <span class="mf">0.04</span><span class="p">,</span>
</span><span id="DistributionalEngine-794"><a href="#DistributionalEngine-794"><span class="linenos"> 794</span></a>                <span class="p">(</span><span class="mi">65_000</span><span class="p">,</span> <span class="mi">105_000</span><span class="p">):</span> <span class="mf">0.08</span><span class="p">,</span>
</span><span id="DistributionalEngine-795"><a href="#DistributionalEngine-795"><span class="linenos"> 795</span></a>                <span class="p">(</span><span class="mi">105_000</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">):</span> <span class="mf">0.16</span><span class="p">,</span>
</span><span id="DistributionalEngine-796"><a href="#DistributionalEngine-796"><span class="linenos"> 796</span></a>                <span class="p">(</span><span class="mi">170_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span> <span class="mf">0.70</span><span class="p">,</span>
</span><span id="DistributionalEngine-797"><a href="#DistributionalEngine-797"><span class="linenos"> 797</span></a>            <span class="p">}</span>
</span><span id="DistributionalEngine-798"><a href="#DistributionalEngine-798"><span class="linenos"> 798</span></a>
</span><span id="DistributionalEngine-799"><a href="#DistributionalEngine-799"><span class="linenos"> 799</span></a>        <span class="c1"># Find share for this group</span>
</span><span id="DistributionalEngine-800"><a href="#DistributionalEngine-800"><span class="linenos"> 800</span></a>        <span class="n">group_share</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-801"><a href="#DistributionalEngine-801"><span class="linenos"> 801</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span><span class="p">),</span> <span class="n">share</span> <span class="ow">in</span> <span class="n">distribution_shares</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DistributionalEngine-802"><a href="#DistributionalEngine-802"><span class="linenos"> 802</span></a>            <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">==</span> <span class="n">floor</span><span class="p">:</span>
</span><span id="DistributionalEngine-803"><a href="#DistributionalEngine-803"><span class="linenos"> 803</span></a>                <span class="n">group_share</span> <span class="o">=</span> <span class="n">share</span>
</span><span id="DistributionalEngine-804"><a href="#DistributionalEngine-804"><span class="linenos"> 804</span></a>                <span class="k">break</span>
</span><span id="DistributionalEngine-805"><a href="#DistributionalEngine-805"><span class="linenos"> 805</span></a>
</span><span id="DistributionalEngine-806"><a href="#DistributionalEngine-806"><span class="linenos"> 806</span></a>        <span class="c1"># If not in predefined quintiles, interpolate based on income</span>
</span><span id="DistributionalEngine-807"><a href="#DistributionalEngine-807"><span class="linenos"> 807</span></a>        <span class="k">if</span> <span class="n">group_share</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="DistributionalEngine-808"><a href="#DistributionalEngine-808"><span class="linenos"> 808</span></a>            <span class="c1"># Estimate based on income position</span>
</span><span id="DistributionalEngine-809"><a href="#DistributionalEngine-809"><span class="linenos"> 809</span></a>            <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="ow">and</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="o">&lt;=</span> <span class="mi">35_000</span><span class="p">:</span>
</span><span id="DistributionalEngine-810"><a href="#DistributionalEngine-810"><span class="linenos"> 810</span></a>                <span class="n">group_share</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
</span><span id="DistributionalEngine-811"><a href="#DistributionalEngine-811"><span class="linenos"> 811</span></a>            <span class="k">elif</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&gt;=</span> <span class="mi">170_000</span><span class="p">:</span>
</span><span id="DistributionalEngine-812"><a href="#DistributionalEngine-812"><span class="linenos"> 812</span></a>                <span class="n">group_share</span> <span class="o">=</span> <span class="mf">0.65</span> <span class="o">*</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
</span><span id="DistributionalEngine-813"><a href="#DistributionalEngine-813"><span class="linenos"> 813</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-814"><a href="#DistributionalEngine-814"><span class="linenos"> 814</span></a>                <span class="n">group_share</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
</span><span id="DistributionalEngine-815"><a href="#DistributionalEngine-815"><span class="linenos"> 815</span></a>
</span><span id="DistributionalEngine-816"><a href="#DistributionalEngine-816"><span class="linenos"> 816</span></a>        <span class="c1"># TCJA extension increases deficit (costs money)</span>
</span><span id="DistributionalEngine-817"><a href="#DistributionalEngine-817"><span class="linenos"> 817</span></a>        <span class="c1"># From taxpayer perspective: positive = tax cut (benefit)</span>
</span><span id="DistributionalEngine-818"><a href="#DistributionalEngine-818"><span class="linenos"> 818</span></a>        <span class="c1"># tax_change_total is positive when taxes decrease</span>
</span><span id="DistributionalEngine-819"><a href="#DistributionalEngine-819"><span class="linenos"> 819</span></a>        <span class="n">tax_change_total</span> <span class="o">=</span> <span class="o">-</span><span class="n">annual_cost</span> <span class="o">*</span> <span class="n">group_share</span>  <span class="c1"># Negative = tax cut</span>
</span><span id="DistributionalEngine-820"><a href="#DistributionalEngine-820"><span class="linenos"> 820</span></a>
</span><span id="DistributionalEngine-821"><a href="#DistributionalEngine-821"><span class="linenos"> 821</span></a>        <span class="c1"># Per-return metrics</span>
</span><span id="DistributionalEngine-822"><a href="#DistributionalEngine-822"><span class="linenos"> 822</span></a>        <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-823"><a href="#DistributionalEngine-823"><span class="linenos"> 823</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="DistributionalEngine-824"><a href="#DistributionalEngine-824"><span class="linenos"> 824</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-825"><a href="#DistributionalEngine-825"><span class="linenos"> 825</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-826"><a href="#DistributionalEngine-826"><span class="linenos"> 826</span></a>
</span><span id="DistributionalEngine-827"><a href="#DistributionalEngine-827"><span class="linenos"> 827</span></a>        <span class="c1"># Calculate as percent of income</span>
</span><span id="DistributionalEngine-828"><a href="#DistributionalEngine-828"><span class="linenos"> 828</span></a>        <span class="n">after_tax_income</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span>
</span><span id="DistributionalEngine-829"><a href="#DistributionalEngine-829"><span class="linenos"> 829</span></a>        <span class="n">tax_change_pct_income</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">after_tax_income</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">after_tax_income</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-830"><a href="#DistributionalEngine-830"><span class="linenos"> 830</span></a>
</span><span id="DistributionalEngine-831"><a href="#DistributionalEngine-831"><span class="linenos"> 831</span></a>        <span class="c1"># Effective tax rates</span>
</span><span id="DistributionalEngine-832"><a href="#DistributionalEngine-832"><span class="linenos"> 832</span></a>        <span class="n">baseline_etr</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">effective_tax_rate</span>
</span><span id="DistributionalEngine-833"><a href="#DistributionalEngine-833"><span class="linenos"> 833</span></a>        <span class="n">new_tax</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">+</span> <span class="n">tax_change_total</span>
</span><span id="DistributionalEngine-834"><a href="#DistributionalEngine-834"><span class="linenos"> 834</span></a>        <span class="n">new_etr</span> <span class="o">=</span> <span class="n">new_tax</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-835"><a href="#DistributionalEngine-835"><span class="linenos"> 835</span></a>
</span><span id="DistributionalEngine-836"><a href="#DistributionalEngine-836"><span class="linenos"> 836</span></a>        <span class="c1"># TCJA extension = tax cut for almost everyone</span>
</span><span id="DistributionalEngine-837"><a href="#DistributionalEngine-837"><span class="linenos"> 837</span></a>        <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">95.0</span><span class="p">,</span> <span class="n">group_share</span> <span class="o">*</span> <span class="mi">500</span><span class="p">)</span>  <span class="c1"># Most get a cut</span>
</span><span id="DistributionalEngine-838"><a href="#DistributionalEngine-838"><span class="linenos"> 838</span></a>        <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Very few face increase</span>
</span><span id="DistributionalEngine-839"><a href="#DistributionalEngine-839"><span class="linenos"> 839</span></a>        <span class="n">pct_unchanged</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">pct_with_decrease</span>
</span><span id="DistributionalEngine-840"><a href="#DistributionalEngine-840"><span class="linenos"> 840</span></a>
</span><span id="DistributionalEngine-841"><a href="#DistributionalEngine-841"><span class="linenos"> 841</span></a>        <span class="k">return</span> <span class="n">DistributionalResult</span><span class="p">(</span>
</span><span id="DistributionalEngine-842"><a href="#DistributionalEngine-842"><span class="linenos"> 842</span></a>            <span class="n">income_group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
</span><span id="DistributionalEngine-843"><a href="#DistributionalEngine-843"><span class="linenos"> 843</span></a>            <span class="n">tax_change_total</span><span class="o">=</span><span class="n">tax_change_total</span><span class="p">,</span>
</span><span id="DistributionalEngine-844"><a href="#DistributionalEngine-844"><span class="linenos"> 844</span></a>            <span class="n">tax_change_avg</span><span class="o">=</span><span class="n">tax_change_avg</span><span class="p">,</span>
</span><span id="DistributionalEngine-845"><a href="#DistributionalEngine-845"><span class="linenos"> 845</span></a>            <span class="n">tax_change_pct_income</span><span class="o">=</span><span class="n">tax_change_pct_income</span><span class="p">,</span>
</span><span id="DistributionalEngine-846"><a href="#DistributionalEngine-846"><span class="linenos"> 846</span></a>            <span class="n">share_of_total_change</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="DistributionalEngine-847"><a href="#DistributionalEngine-847"><span class="linenos"> 847</span></a>            <span class="n">pct_with_increase</span><span class="o">=</span><span class="n">pct_with_increase</span><span class="p">,</span>
</span><span id="DistributionalEngine-848"><a href="#DistributionalEngine-848"><span class="linenos"> 848</span></a>            <span class="n">pct_with_decrease</span><span class="o">=</span><span class="n">pct_with_decrease</span><span class="p">,</span>
</span><span id="DistributionalEngine-849"><a href="#DistributionalEngine-849"><span class="linenos"> 849</span></a>            <span class="n">pct_unchanged</span><span class="o">=</span><span class="n">pct_unchanged</span><span class="p">,</span>
</span><span id="DistributionalEngine-850"><a href="#DistributionalEngine-850"><span class="linenos"> 850</span></a>            <span class="n">baseline_etr</span><span class="o">=</span><span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-851"><a href="#DistributionalEngine-851"><span class="linenos"> 851</span></a>            <span class="n">new_etr</span><span class="o">=</span><span class="n">new_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-852"><a href="#DistributionalEngine-852"><span class="linenos"> 852</span></a>            <span class="n">etr_change</span><span class="o">=</span><span class="n">new_etr</span> <span class="o">-</span> <span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-853"><a href="#DistributionalEngine-853"><span class="linenos"> 853</span></a>        <span class="p">)</span>
</span><span id="DistributionalEngine-854"><a href="#DistributionalEngine-854"><span class="linenos"> 854</span></a>
</span><span id="DistributionalEngine-855"><a href="#DistributionalEngine-855"><span class="linenos"> 855</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_corporate_effect</span><span class="p">(</span>
</span><span id="DistributionalEngine-856"><a href="#DistributionalEngine-856"><span class="linenos"> 856</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine-857"><a href="#DistributionalEngine-857"><span class="linenos"> 857</span></a>        <span class="n">policy</span><span class="p">,</span>  <span class="c1"># CorporateTaxPolicy</span>
</span><span id="DistributionalEngine-858"><a href="#DistributionalEngine-858"><span class="linenos"> 858</span></a>        <span class="n">group</span><span class="p">:</span> <span class="n">IncomeGroup</span><span class="p">,</span>
</span><span id="DistributionalEngine-859"><a href="#DistributionalEngine-859"><span class="linenos"> 859</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalResult</span><span class="p">:</span>
</span><span id="DistributionalEngine-860"><a href="#DistributionalEngine-860"><span class="linenos"> 860</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-861"><a href="#DistributionalEngine-861"><span class="linenos"> 861</span></a><span class="sd">        Calculate distributional effect for corporate tax changes.</span>
</span><span id="DistributionalEngine-862"><a href="#DistributionalEngine-862"><span class="linenos"> 862</span></a>
</span><span id="DistributionalEngine-863"><a href="#DistributionalEngine-863"><span class="linenos"> 863</span></a><span class="sd">        Corporate tax incidence falls on:</span>
</span><span id="DistributionalEngine-864"><a href="#DistributionalEngine-864"><span class="linenos"> 864</span></a><span class="sd">        - Shareholders (capital income): ~50-70%</span>
</span><span id="DistributionalEngine-865"><a href="#DistributionalEngine-865"><span class="linenos"> 865</span></a><span class="sd">        - Workers (wages): ~20-40%</span>
</span><span id="DistributionalEngine-866"><a href="#DistributionalEngine-866"><span class="linenos"> 866</span></a><span class="sd">        - Consumers (prices): ~10-20%</span>
</span><span id="DistributionalEngine-867"><a href="#DistributionalEngine-867"><span class="linenos"> 867</span></a>
</span><span id="DistributionalEngine-868"><a href="#DistributionalEngine-868"><span class="linenos"> 868</span></a><span class="sd">        Using CBO/TPC assumptions:</span>
</span><span id="DistributionalEngine-869"><a href="#DistributionalEngine-869"><span class="linenos"> 869</span></a><span class="sd">        - 75% on capital owners (concentrated at top)</span>
</span><span id="DistributionalEngine-870"><a href="#DistributionalEngine-870"><span class="linenos"> 870</span></a><span class="sd">        - 25% on workers (across income distribution)</span>
</span><span id="DistributionalEngine-871"><a href="#DistributionalEngine-871"><span class="linenos"> 871</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-872"><a href="#DistributionalEngine-872"><span class="linenos"> 872</span></a>        <span class="c1"># Get policy parameters</span>
</span><span id="DistributionalEngine-873"><a href="#DistributionalEngine-873"><span class="linenos"> 873</span></a>        <span class="n">rate_change</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;rate_change&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DistributionalEngine-874"><a href="#DistributionalEngine-874"><span class="linenos"> 874</span></a>        <span class="n">baseline_revenue</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;baseline_revenue_billions&#39;</span><span class="p">,</span> <span class="mi">475</span><span class="p">)</span>
</span><span id="DistributionalEngine-875"><a href="#DistributionalEngine-875"><span class="linenos"> 875</span></a>
</span><span id="DistributionalEngine-876"><a href="#DistributionalEngine-876"><span class="linenos"> 876</span></a>        <span class="c1"># Static revenue effect</span>
</span><span id="DistributionalEngine-877"><a href="#DistributionalEngine-877"><span class="linenos"> 877</span></a>        <span class="n">static_revenue_change</span> <span class="o">=</span> <span class="n">baseline_revenue</span> <span class="o">*</span> <span class="p">(</span><span class="n">rate_change</span> <span class="o">/</span> <span class="mf">0.21</span><span class="p">)</span>  <span class="c1"># Scale by rate change</span>
</span><span id="DistributionalEngine-878"><a href="#DistributionalEngine-878"><span class="linenos"> 878</span></a>
</span><span id="DistributionalEngine-879"><a href="#DistributionalEngine-879"><span class="linenos"> 879</span></a>        <span class="c1"># With behavioral response</span>
</span><span id="DistributionalEngine-880"><a href="#DistributionalEngine-880"><span class="linenos"> 880</span></a>        <span class="n">elasticity</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;corporate_elasticity&#39;</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
</span><span id="DistributionalEngine-881"><a href="#DistributionalEngine-881"><span class="linenos"> 881</span></a>        <span class="n">behavioral_offset</span> <span class="o">=</span> <span class="n">static_revenue_change</span> <span class="o">*</span> <span class="n">elasticity</span> <span class="o">*</span> <span class="mf">0.5</span>
</span><span id="DistributionalEngine-882"><a href="#DistributionalEngine-882"><span class="linenos"> 882</span></a>        <span class="n">revenue_change</span> <span class="o">=</span> <span class="n">static_revenue_change</span> <span class="o">-</span> <span class="n">behavioral_offset</span>
</span><span id="DistributionalEngine-883"><a href="#DistributionalEngine-883"><span class="linenos"> 883</span></a>
</span><span id="DistributionalEngine-884"><a href="#DistributionalEngine-884"><span class="linenos"> 884</span></a>        <span class="c1"># Incidence assumptions (CBO/TPC standard)</span>
</span><span id="DistributionalEngine-885"><a href="#DistributionalEngine-885"><span class="linenos"> 885</span></a>        <span class="n">capital_share</span> <span class="o">=</span> <span class="mf">0.75</span>  <span class="c1"># 75% on capital owners</span>
</span><span id="DistributionalEngine-886"><a href="#DistributionalEngine-886"><span class="linenos"> 886</span></a>        <span class="n">labor_share</span> <span class="o">=</span> <span class="mf">0.25</span>   <span class="c1"># 25% on workers</span>
</span><span id="DistributionalEngine-887"><a href="#DistributionalEngine-887"><span class="linenos"> 887</span></a>
</span><span id="DistributionalEngine-888"><a href="#DistributionalEngine-888"><span class="linenos"> 888</span></a>        <span class="c1"># Capital income is concentrated at top</span>
</span><span id="DistributionalEngine-889"><a href="#DistributionalEngine-889"><span class="linenos"> 889</span></a>        <span class="c1"># Based on Federal Reserve SCF data</span>
</span><span id="DistributionalEngine-890"><a href="#DistributionalEngine-890"><span class="linenos"> 890</span></a>        <span class="n">capital_income_shares</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DistributionalEngine-891"><a href="#DistributionalEngine-891"><span class="linenos"> 891</span></a>            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35_000</span><span class="p">):</span> <span class="mf">0.01</span><span class="p">,</span>        <span class="c1"># Bottom quintile: 1%</span>
</span><span id="DistributionalEngine-892"><a href="#DistributionalEngine-892"><span class="linenos"> 892</span></a>            <span class="p">(</span><span class="mi">35_000</span><span class="p">,</span> <span class="mi">65_000</span><span class="p">):</span> <span class="mf">0.02</span><span class="p">,</span>   <span class="c1"># Second: 2%</span>
</span><span id="DistributionalEngine-893"><a href="#DistributionalEngine-893"><span class="linenos"> 893</span></a>            <span class="p">(</span><span class="mi">65_000</span><span class="p">,</span> <span class="mi">105_000</span><span class="p">):</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># Middle: 5%</span>
</span><span id="DistributionalEngine-894"><a href="#DistributionalEngine-894"><span class="linenos"> 894</span></a>            <span class="p">(</span><span class="mi">105_000</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">):</span> <span class="mf">0.12</span><span class="p">,</span> <span class="c1"># Fourth: 12%</span>
</span><span id="DistributionalEngine-895"><a href="#DistributionalEngine-895"><span class="linenos"> 895</span></a>            <span class="p">(</span><span class="mi">170_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span> <span class="mf">0.80</span><span class="p">,</span>    <span class="c1"># Top: 80%</span>
</span><span id="DistributionalEngine-896"><a href="#DistributionalEngine-896"><span class="linenos"> 896</span></a>        <span class="p">}</span>
</span><span id="DistributionalEngine-897"><a href="#DistributionalEngine-897"><span class="linenos"> 897</span></a>
</span><span id="DistributionalEngine-898"><a href="#DistributionalEngine-898"><span class="linenos"> 898</span></a>        <span class="c1"># Labor income more evenly distributed</span>
</span><span id="DistributionalEngine-899"><a href="#DistributionalEngine-899"><span class="linenos"> 899</span></a>        <span class="n">labor_income_shares</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DistributionalEngine-900"><a href="#DistributionalEngine-900"><span class="linenos"> 900</span></a>            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35_000</span><span class="p">):</span> <span class="mf">0.08</span><span class="p">,</span>
</span><span id="DistributionalEngine-901"><a href="#DistributionalEngine-901"><span class="linenos"> 901</span></a>            <span class="p">(</span><span class="mi">35_000</span><span class="p">,</span> <span class="mi">65_000</span><span class="p">):</span> <span class="mf">0.12</span><span class="p">,</span>
</span><span id="DistributionalEngine-902"><a href="#DistributionalEngine-902"><span class="linenos"> 902</span></a>            <span class="p">(</span><span class="mi">65_000</span><span class="p">,</span> <span class="mi">105_000</span><span class="p">):</span> <span class="mf">0.18</span><span class="p">,</span>
</span><span id="DistributionalEngine-903"><a href="#DistributionalEngine-903"><span class="linenos"> 903</span></a>            <span class="p">(</span><span class="mi">105_000</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">):</span> <span class="mf">0.25</span><span class="p">,</span>
</span><span id="DistributionalEngine-904"><a href="#DistributionalEngine-904"><span class="linenos"> 904</span></a>            <span class="p">(</span><span class="mi">170_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span> <span class="mf">0.37</span><span class="p">,</span>
</span><span id="DistributionalEngine-905"><a href="#DistributionalEngine-905"><span class="linenos"> 905</span></a>        <span class="p">}</span>
</span><span id="DistributionalEngine-906"><a href="#DistributionalEngine-906"><span class="linenos"> 906</span></a>
</span><span id="DistributionalEngine-907"><a href="#DistributionalEngine-907"><span class="linenos"> 907</span></a>        <span class="c1"># Find shares for this group</span>
</span><span id="DistributionalEngine-908"><a href="#DistributionalEngine-908"><span class="linenos"> 908</span></a>        <span class="n">capital_share_group</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-909"><a href="#DistributionalEngine-909"><span class="linenos"> 909</span></a>        <span class="n">labor_share_group</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-910"><a href="#DistributionalEngine-910"><span class="linenos"> 910</span></a>
</span><span id="DistributionalEngine-911"><a href="#DistributionalEngine-911"><span class="linenos"> 911</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span><span class="p">),</span> <span class="n">share</span> <span class="ow">in</span> <span class="n">capital_income_shares</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DistributionalEngine-912"><a href="#DistributionalEngine-912"><span class="linenos"> 912</span></a>            <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">==</span> <span class="n">floor</span><span class="p">:</span>
</span><span id="DistributionalEngine-913"><a href="#DistributionalEngine-913"><span class="linenos"> 913</span></a>                <span class="n">capital_share_group</span> <span class="o">=</span> <span class="n">share</span>
</span><span id="DistributionalEngine-914"><a href="#DistributionalEngine-914"><span class="linenos"> 914</span></a>                <span class="n">labor_share_group</span> <span class="o">=</span> <span class="n">labor_income_shares</span><span class="p">[(</span><span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span><span class="p">)]</span>
</span><span id="DistributionalEngine-915"><a href="#DistributionalEngine-915"><span class="linenos"> 915</span></a>                <span class="k">break</span>
</span><span id="DistributionalEngine-916"><a href="#DistributionalEngine-916"><span class="linenos"> 916</span></a>
</span><span id="DistributionalEngine-917"><a href="#DistributionalEngine-917"><span class="linenos"> 917</span></a>        <span class="c1"># If not in predefined quintiles, estimate</span>
</span><span id="DistributionalEngine-918"><a href="#DistributionalEngine-918"><span class="linenos"> 918</span></a>        <span class="k">if</span> <span class="n">capital_share_group</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="DistributionalEngine-919"><a href="#DistributionalEngine-919"><span class="linenos"> 919</span></a>            <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&gt;=</span> <span class="mi">170_000</span><span class="p">:</span>
</span><span id="DistributionalEngine-920"><a href="#DistributionalEngine-920"><span class="linenos"> 920</span></a>                <span class="n">capital_share_group</span> <span class="o">=</span> <span class="mf">0.80</span> <span class="o">*</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
</span><span id="DistributionalEngine-921"><a href="#DistributionalEngine-921"><span class="linenos"> 921</span></a>                <span class="n">labor_share_group</span> <span class="o">=</span> <span class="mf">0.37</span> <span class="o">*</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
</span><span id="DistributionalEngine-922"><a href="#DistributionalEngine-922"><span class="linenos"> 922</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-923"><a href="#DistributionalEngine-923"><span class="linenos"> 923</span></a>                <span class="n">capital_share_group</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
</span><span id="DistributionalEngine-924"><a href="#DistributionalEngine-924"><span class="linenos"> 924</span></a>                <span class="n">labor_share_group</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
</span><span id="DistributionalEngine-925"><a href="#DistributionalEngine-925"><span class="linenos"> 925</span></a>
</span><span id="DistributionalEngine-926"><a href="#DistributionalEngine-926"><span class="linenos"> 926</span></a>        <span class="c1"># Total burden on this group</span>
</span><span id="DistributionalEngine-927"><a href="#DistributionalEngine-927"><span class="linenos"> 927</span></a>        <span class="n">group_burden_share</span> <span class="o">=</span> <span class="p">(</span><span class="n">capital_share</span> <span class="o">*</span> <span class="n">capital_share_group</span> <span class="o">+</span>
</span><span id="DistributionalEngine-928"><a href="#DistributionalEngine-928"><span class="linenos"> 928</span></a>                             <span class="n">labor_share</span> <span class="o">*</span> <span class="n">labor_share_group</span><span class="p">)</span>
</span><span id="DistributionalEngine-929"><a href="#DistributionalEngine-929"><span class="linenos"> 929</span></a>
</span><span id="DistributionalEngine-930"><a href="#DistributionalEngine-930"><span class="linenos"> 930</span></a>        <span class="c1"># Tax change (positive = tax increase, so rate increase hurts)</span>
</span><span id="DistributionalEngine-931"><a href="#DistributionalEngine-931"><span class="linenos"> 931</span></a>        <span class="n">tax_change_total</span> <span class="o">=</span> <span class="n">revenue_change</span> <span class="o">*</span> <span class="n">group_burden_share</span>
</span><span id="DistributionalEngine-932"><a href="#DistributionalEngine-932"><span class="linenos"> 932</span></a>
</span><span id="DistributionalEngine-933"><a href="#DistributionalEngine-933"><span class="linenos"> 933</span></a>        <span class="c1"># Per-return metrics</span>
</span><span id="DistributionalEngine-934"><a href="#DistributionalEngine-934"><span class="linenos"> 934</span></a>        <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-935"><a href="#DistributionalEngine-935"><span class="linenos"> 935</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="DistributionalEngine-936"><a href="#DistributionalEngine-936"><span class="linenos"> 936</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-937"><a href="#DistributionalEngine-937"><span class="linenos"> 937</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-938"><a href="#DistributionalEngine-938"><span class="linenos"> 938</span></a>
</span><span id="DistributionalEngine-939"><a href="#DistributionalEngine-939"><span class="linenos"> 939</span></a>        <span class="c1"># Calculate as percent of income</span>
</span><span id="DistributionalEngine-940"><a href="#DistributionalEngine-940"><span class="linenos"> 940</span></a>        <span class="n">after_tax_income</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span>
</span><span id="DistributionalEngine-941"><a href="#DistributionalEngine-941"><span class="linenos"> 941</span></a>        <span class="n">tax_change_pct_income</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">after_tax_income</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">after_tax_income</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-942"><a href="#DistributionalEngine-942"><span class="linenos"> 942</span></a>
</span><span id="DistributionalEngine-943"><a href="#DistributionalEngine-943"><span class="linenos"> 943</span></a>        <span class="c1"># Effective tax rates (indirect effect)</span>
</span><span id="DistributionalEngine-944"><a href="#DistributionalEngine-944"><span class="linenos"> 944</span></a>        <span class="n">baseline_etr</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">effective_tax_rate</span>
</span><span id="DistributionalEngine-945"><a href="#DistributionalEngine-945"><span class="linenos"> 945</span></a>        <span class="n">new_tax</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">+</span> <span class="n">tax_change_total</span>
</span><span id="DistributionalEngine-946"><a href="#DistributionalEngine-946"><span class="linenos"> 946</span></a>        <span class="n">new_etr</span> <span class="o">=</span> <span class="n">new_tax</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-947"><a href="#DistributionalEngine-947"><span class="linenos"> 947</span></a>
</span><span id="DistributionalEngine-948"><a href="#DistributionalEngine-948"><span class="linenos"> 948</span></a>        <span class="c1"># Winners/losers</span>
</span><span id="DistributionalEngine-949"><a href="#DistributionalEngine-949"><span class="linenos"> 949</span></a>        <span class="k">if</span> <span class="n">rate_change</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Tax increase</span>
</span><span id="DistributionalEngine-950"><a href="#DistributionalEngine-950"><span class="linenos"> 950</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="n">group_burden_share</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-951"><a href="#DistributionalEngine-951"><span class="linenos"> 951</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-952"><a href="#DistributionalEngine-952"><span class="linenos"> 952</span></a>        <span class="k">elif</span> <span class="n">rate_change</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Tax cut</span>
</span><span id="DistributionalEngine-953"><a href="#DistributionalEngine-953"><span class="linenos"> 953</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-954"><a href="#DistributionalEngine-954"><span class="linenos"> 954</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="n">group_burden_share</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-955"><a href="#DistributionalEngine-955"><span class="linenos"> 955</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-956"><a href="#DistributionalEngine-956"><span class="linenos"> 956</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-957"><a href="#DistributionalEngine-957"><span class="linenos"> 957</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-958"><a href="#DistributionalEngine-958"><span class="linenos"> 958</span></a>
</span><span id="DistributionalEngine-959"><a href="#DistributionalEngine-959"><span class="linenos"> 959</span></a>        <span class="n">pct_unchanged</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">pct_with_increase</span> <span class="o">-</span> <span class="n">pct_with_decrease</span>
</span><span id="DistributionalEngine-960"><a href="#DistributionalEngine-960"><span class="linenos"> 960</span></a>
</span><span id="DistributionalEngine-961"><a href="#DistributionalEngine-961"><span class="linenos"> 961</span></a>        <span class="k">return</span> <span class="n">DistributionalResult</span><span class="p">(</span>
</span><span id="DistributionalEngine-962"><a href="#DistributionalEngine-962"><span class="linenos"> 962</span></a>            <span class="n">income_group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
</span><span id="DistributionalEngine-963"><a href="#DistributionalEngine-963"><span class="linenos"> 963</span></a>            <span class="n">tax_change_total</span><span class="o">=</span><span class="n">tax_change_total</span><span class="p">,</span>
</span><span id="DistributionalEngine-964"><a href="#DistributionalEngine-964"><span class="linenos"> 964</span></a>            <span class="n">tax_change_avg</span><span class="o">=</span><span class="n">tax_change_avg</span><span class="p">,</span>
</span><span id="DistributionalEngine-965"><a href="#DistributionalEngine-965"><span class="linenos"> 965</span></a>            <span class="n">tax_change_pct_income</span><span class="o">=</span><span class="n">tax_change_pct_income</span><span class="p">,</span>
</span><span id="DistributionalEngine-966"><a href="#DistributionalEngine-966"><span class="linenos"> 966</span></a>            <span class="n">share_of_total_change</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="DistributionalEngine-967"><a href="#DistributionalEngine-967"><span class="linenos"> 967</span></a>            <span class="n">pct_with_increase</span><span class="o">=</span><span class="n">pct_with_increase</span><span class="p">,</span>
</span><span id="DistributionalEngine-968"><a href="#DistributionalEngine-968"><span class="linenos"> 968</span></a>            <span class="n">pct_with_decrease</span><span class="o">=</span><span class="n">pct_with_decrease</span><span class="p">,</span>
</span><span id="DistributionalEngine-969"><a href="#DistributionalEngine-969"><span class="linenos"> 969</span></a>            <span class="n">pct_unchanged</span><span class="o">=</span><span class="n">pct_unchanged</span><span class="p">,</span>
</span><span id="DistributionalEngine-970"><a href="#DistributionalEngine-970"><span class="linenos"> 970</span></a>            <span class="n">baseline_etr</span><span class="o">=</span><span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-971"><a href="#DistributionalEngine-971"><span class="linenos"> 971</span></a>            <span class="n">new_etr</span><span class="o">=</span><span class="n">new_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-972"><a href="#DistributionalEngine-972"><span class="linenos"> 972</span></a>            <span class="n">etr_change</span><span class="o">=</span><span class="n">new_etr</span> <span class="o">-</span> <span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-973"><a href="#DistributionalEngine-973"><span class="linenos"> 973</span></a>        <span class="p">)</span>
</span><span id="DistributionalEngine-974"><a href="#DistributionalEngine-974"><span class="linenos"> 974</span></a>
</span><span id="DistributionalEngine-975"><a href="#DistributionalEngine-975"><span class="linenos"> 975</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_payroll_effect</span><span class="p">(</span>
</span><span id="DistributionalEngine-976"><a href="#DistributionalEngine-976"><span class="linenos"> 976</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine-977"><a href="#DistributionalEngine-977"><span class="linenos"> 977</span></a>        <span class="n">policy</span><span class="p">,</span>  <span class="c1"># PayrollTaxPolicy</span>
</span><span id="DistributionalEngine-978"><a href="#DistributionalEngine-978"><span class="linenos"> 978</span></a>        <span class="n">group</span><span class="p">:</span> <span class="n">IncomeGroup</span><span class="p">,</span>
</span><span id="DistributionalEngine-979"><a href="#DistributionalEngine-979"><span class="linenos"> 979</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalResult</span><span class="p">:</span>
</span><span id="DistributionalEngine-980"><a href="#DistributionalEngine-980"><span class="linenos"> 980</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-981"><a href="#DistributionalEngine-981"><span class="linenos"> 981</span></a><span class="sd">        Calculate distributional effect for payroll tax changes.</span>
</span><span id="DistributionalEngine-982"><a href="#DistributionalEngine-982"><span class="linenos"> 982</span></a>
</span><span id="DistributionalEngine-983"><a href="#DistributionalEngine-983"><span class="linenos"> 983</span></a><span class="sd">        Payroll taxes:</span>
</span><span id="DistributionalEngine-984"><a href="#DistributionalEngine-984"><span class="linenos"> 984</span></a><span class="sd">        - Social Security: 12.4% on wages up to cap (~$168K in 2024)</span>
</span><span id="DistributionalEngine-985"><a href="#DistributionalEngine-985"><span class="linenos"> 985</span></a><span class="sd">        - Medicare: 2.9% on all wages + 0.9% NIIT above $200K/$250K</span>
</span><span id="DistributionalEngine-986"><a href="#DistributionalEngine-986"><span class="linenos"> 986</span></a>
</span><span id="DistributionalEngine-987"><a href="#DistributionalEngine-987"><span class="linenos"> 987</span></a><span class="sd">        Changes typically affect:</span>
</span><span id="DistributionalEngine-988"><a href="#DistributionalEngine-988"><span class="linenos"> 988</span></a><span class="sd">        - Cap changes: Only affects income above current cap</span>
</span><span id="DistributionalEngine-989"><a href="#DistributionalEngine-989"><span class="linenos"> 989</span></a><span class="sd">        - Rate changes: Proportional to wages in affected range</span>
</span><span id="DistributionalEngine-990"><a href="#DistributionalEngine-990"><span class="linenos"> 990</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-991"><a href="#DistributionalEngine-991"><span class="linenos"> 991</span></a>        <span class="c1"># Get policy parameters</span>
</span><span id="DistributionalEngine-992"><a href="#DistributionalEngine-992"><span class="linenos"> 992</span></a>        <span class="n">ss_cap_change</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;ss_cap_change&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DistributionalEngine-993"><a href="#DistributionalEngine-993"><span class="linenos"> 993</span></a>        <span class="n">current_cap</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;current_ss_cap&#39;</span><span class="p">,</span> <span class="mi">168_600</span><span class="p">)</span>
</span><span id="DistributionalEngine-994"><a href="#DistributionalEngine-994"><span class="linenos"> 994</span></a>        <span class="n">new_cap</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;new_ss_cap&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="DistributionalEngine-995"><a href="#DistributionalEngine-995"><span class="linenos"> 995</span></a>        <span class="n">rate_change</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;rate_change&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DistributionalEngine-996"><a href="#DistributionalEngine-996"><span class="linenos"> 996</span></a>        <span class="n">niit_expansion</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;expand_niit&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="DistributionalEngine-997"><a href="#DistributionalEngine-997"><span class="linenos"> 997</span></a>
</span><span id="DistributionalEngine-998"><a href="#DistributionalEngine-998"><span class="linenos"> 998</span></a>        <span class="n">group_ceiling</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine-999"><a href="#DistributionalEngine-999"><span class="linenos"> 999</span></a>
</span><span id="DistributionalEngine-1000"><a href="#DistributionalEngine-1000"><span class="linenos">1000</span></a>        <span class="c1"># Determine effect based on policy type</span>
</span><span id="DistributionalEngine-1001"><a href="#DistributionalEngine-1001"><span class="linenos">1001</span></a>        <span class="k">if</span> <span class="n">new_cap</span> <span class="ow">and</span> <span class="n">new_cap</span> <span class="o">&gt;</span> <span class="n">current_cap</span><span class="p">:</span>
</span><span id="DistributionalEngine-1002"><a href="#DistributionalEngine-1002"><span class="linenos">1002</span></a>            <span class="c1"># SS cap increase - affects income between old and new cap</span>
</span><span id="DistributionalEngine-1003"><a href="#DistributionalEngine-1003"><span class="linenos">1003</span></a>            <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&gt;=</span> <span class="n">new_cap</span><span class="p">:</span>
</span><span id="DistributionalEngine-1004"><a href="#DistributionalEngine-1004"><span class="linenos">1004</span></a>                <span class="c1"># Above new cap - fully affected</span>
</span><span id="DistributionalEngine-1005"><a href="#DistributionalEngine-1005"><span class="linenos">1005</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="DistributionalEngine-1006"><a href="#DistributionalEngine-1006"><span class="linenos">1006</span></a>                <span class="n">income_affected</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">new_cap</span> <span class="o">-</span> <span class="n">current_cap</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">avg_agi</span> <span class="o">-</span> <span class="n">current_cap</span><span class="p">)</span>
</span><span id="DistributionalEngine-1007"><a href="#DistributionalEngine-1007"><span class="linenos">1007</span></a>            <span class="k">elif</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&gt;=</span> <span class="n">current_cap</span><span class="p">:</span>
</span><span id="DistributionalEngine-1008"><a href="#DistributionalEngine-1008"><span class="linenos">1008</span></a>                <span class="c1"># Between caps - partially affected</span>
</span><span id="DistributionalEngine-1009"><a href="#DistributionalEngine-1009"><span class="linenos">1009</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">group_ceiling</span> <span class="o">-</span> <span class="n">current_cap</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">new_cap</span> <span class="o">-</span> <span class="n">current_cap</span><span class="p">))</span>
</span><span id="DistributionalEngine-1010"><a href="#DistributionalEngine-1010"><span class="linenos">1010</span></a>                <span class="n">income_affected</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_cap</span> <span class="o">-</span> <span class="n">current_cap</span><span class="p">)</span> <span class="o">*</span> <span class="n">affected_fraction</span>
</span><span id="DistributionalEngine-1011"><a href="#DistributionalEngine-1011"><span class="linenos">1011</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-1012"><a href="#DistributionalEngine-1012"><span class="linenos">1012</span></a>                <span class="c1"># Below current cap - not affected by cap change</span>
</span><span id="DistributionalEngine-1013"><a href="#DistributionalEngine-1013"><span class="linenos">1013</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1014"><a href="#DistributionalEngine-1014"><span class="linenos">1014</span></a>                <span class="n">income_affected</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1015"><a href="#DistributionalEngine-1015"><span class="linenos">1015</span></a>
</span><span id="DistributionalEngine-1016"><a href="#DistributionalEngine-1016"><span class="linenos">1016</span></a>            <span class="c1"># SS tax rate is 12.4% (6.2% employee + 6.2% employer)</span>
</span><span id="DistributionalEngine-1017"><a href="#DistributionalEngine-1017"><span class="linenos">1017</span></a>            <span class="n">tax_change_total</span> <span class="o">=</span> <span class="n">income_affected</span> <span class="o">*</span> <span class="mf">0.124</span> <span class="o">*</span> <span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="mf">1e9</span>
</span><span id="DistributionalEngine-1018"><a href="#DistributionalEngine-1018"><span class="linenos">1018</span></a>
</span><span id="DistributionalEngine-1019"><a href="#DistributionalEngine-1019"><span class="linenos">1019</span></a>        <span class="k">elif</span> <span class="n">rate_change</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-1020"><a href="#DistributionalEngine-1020"><span class="linenos">1020</span></a>            <span class="c1"># Rate change on existing base</span>
</span><span id="DistributionalEngine-1021"><a href="#DistributionalEngine-1021"><span class="linenos">1021</span></a>            <span class="c1"># Affects all income up to cap</span>
</span><span id="DistributionalEngine-1022"><a href="#DistributionalEngine-1022"><span class="linenos">1022</span></a>            <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span> <span class="o">&gt;=</span> <span class="n">current_cap</span><span class="p">:</span>
</span><span id="DistributionalEngine-1023"><a href="#DistributionalEngine-1023"><span class="linenos">1023</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1024"><a href="#DistributionalEngine-1024"><span class="linenos">1024</span></a>            <span class="k">elif</span> <span class="n">group_ceiling</span> <span class="o">&lt;=</span> <span class="n">current_cap</span><span class="p">:</span>
</span><span id="DistributionalEngine-1025"><a href="#DistributionalEngine-1025"><span class="linenos">1025</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="DistributionalEngine-1026"><a href="#DistributionalEngine-1026"><span class="linenos">1026</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-1027"><a href="#DistributionalEngine-1027"><span class="linenos">1027</span></a>                <span class="n">affected_fraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_cap</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">group_ceiling</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">floor</span><span class="p">)</span>
</span><span id="DistributionalEngine-1028"><a href="#DistributionalEngine-1028"><span class="linenos">1028</span></a>
</span><span id="DistributionalEngine-1029"><a href="#DistributionalEngine-1029"><span class="linenos">1029</span></a>            <span class="n">taxable_wages</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">*</span> <span class="n">affected_fraction</span> <span class="o">*</span> <span class="mf">0.7</span>  <span class="c1"># ~70% of AGI is wages</span>
</span><span id="DistributionalEngine-1030"><a href="#DistributionalEngine-1030"><span class="linenos">1030</span></a>            <span class="n">tax_change_total</span> <span class="o">=</span> <span class="n">taxable_wages</span> <span class="o">*</span> <span class="n">rate_change</span>
</span><span id="DistributionalEngine-1031"><a href="#DistributionalEngine-1031"><span class="linenos">1031</span></a>
</span><span id="DistributionalEngine-1032"><a href="#DistributionalEngine-1032"><span class="linenos">1032</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-1033"><a href="#DistributionalEngine-1033"><span class="linenos">1033</span></a>            <span class="c1"># No significant change</span>
</span><span id="DistributionalEngine-1034"><a href="#DistributionalEngine-1034"><span class="linenos">1034</span></a>            <span class="n">tax_change_total</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1035"><a href="#DistributionalEngine-1035"><span class="linenos">1035</span></a>            <span class="n">affected_fraction</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1036"><a href="#DistributionalEngine-1036"><span class="linenos">1036</span></a>
</span><span id="DistributionalEngine-1037"><a href="#DistributionalEngine-1037"><span class="linenos">1037</span></a>        <span class="c1"># Per-return metrics</span>
</span><span id="DistributionalEngine-1038"><a href="#DistributionalEngine-1038"><span class="linenos">1038</span></a>        <span class="n">affected_returns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">*</span> <span class="n">affected_fraction</span><span class="p">)</span>
</span><span id="DistributionalEngine-1039"><a href="#DistributionalEngine-1039"><span class="linenos">1039</span></a>        <span class="k">if</span> <span class="n">affected_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine-1040"><a href="#DistributionalEngine-1040"><span class="linenos">1040</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="n">affected_returns</span>
</span><span id="DistributionalEngine-1041"><a href="#DistributionalEngine-1041"><span class="linenos">1041</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-1042"><a href="#DistributionalEngine-1042"><span class="linenos">1042</span></a>            <span class="n">tax_change_avg</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1043"><a href="#DistributionalEngine-1043"><span class="linenos">1043</span></a>
</span><span id="DistributionalEngine-1044"><a href="#DistributionalEngine-1044"><span class="linenos">1044</span></a>        <span class="c1"># Calculate as percent of income</span>
</span><span id="DistributionalEngine-1045"><a href="#DistributionalEngine-1045"><span class="linenos">1045</span></a>        <span class="n">after_tax_income</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">-</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span>
</span><span id="DistributionalEngine-1046"><a href="#DistributionalEngine-1046"><span class="linenos">1046</span></a>        <span class="n">tax_change_pct_income</span> <span class="o">=</span> <span class="p">(</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">after_tax_income</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">after_tax_income</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-1047"><a href="#DistributionalEngine-1047"><span class="linenos">1047</span></a>
</span><span id="DistributionalEngine-1048"><a href="#DistributionalEngine-1048"><span class="linenos">1048</span></a>        <span class="c1"># Effective tax rates</span>
</span><span id="DistributionalEngine-1049"><a href="#DistributionalEngine-1049"><span class="linenos">1049</span></a>        <span class="n">baseline_etr</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">effective_tax_rate</span>
</span><span id="DistributionalEngine-1050"><a href="#DistributionalEngine-1050"><span class="linenos">1050</span></a>        <span class="n">new_tax</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">+</span> <span class="n">tax_change_total</span>
</span><span id="DistributionalEngine-1051"><a href="#DistributionalEngine-1051"><span class="linenos">1051</span></a>        <span class="n">new_etr</span> <span class="o">=</span> <span class="n">new_tax</span> <span class="o">/</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-1052"><a href="#DistributionalEngine-1052"><span class="linenos">1052</span></a>
</span><span id="DistributionalEngine-1053"><a href="#DistributionalEngine-1053"><span class="linenos">1053</span></a>        <span class="c1"># Winners/losers</span>
</span><span id="DistributionalEngine-1054"><a href="#DistributionalEngine-1054"><span class="linenos">1054</span></a>        <span class="k">if</span> <span class="n">tax_change_total</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Tax increase</span>
</span><span id="DistributionalEngine-1055"><a href="#DistributionalEngine-1055"><span class="linenos">1055</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="n">affected_fraction</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-1056"><a href="#DistributionalEngine-1056"><span class="linenos">1056</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1057"><a href="#DistributionalEngine-1057"><span class="linenos">1057</span></a>        <span class="k">elif</span> <span class="n">tax_change_total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Tax cut</span>
</span><span id="DistributionalEngine-1058"><a href="#DistributionalEngine-1058"><span class="linenos">1058</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1059"><a href="#DistributionalEngine-1059"><span class="linenos">1059</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="n">affected_fraction</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DistributionalEngine-1060"><a href="#DistributionalEngine-1060"><span class="linenos">1060</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-1061"><a href="#DistributionalEngine-1061"><span class="linenos">1061</span></a>            <span class="n">pct_with_increase</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1062"><a href="#DistributionalEngine-1062"><span class="linenos">1062</span></a>            <span class="n">pct_with_decrease</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1063"><a href="#DistributionalEngine-1063"><span class="linenos">1063</span></a>
</span><span id="DistributionalEngine-1064"><a href="#DistributionalEngine-1064"><span class="linenos">1064</span></a>        <span class="n">pct_unchanged</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">pct_with_increase</span> <span class="o">-</span> <span class="n">pct_with_decrease</span>
</span><span id="DistributionalEngine-1065"><a href="#DistributionalEngine-1065"><span class="linenos">1065</span></a>
</span><span id="DistributionalEngine-1066"><a href="#DistributionalEngine-1066"><span class="linenos">1066</span></a>        <span class="k">return</span> <span class="n">DistributionalResult</span><span class="p">(</span>
</span><span id="DistributionalEngine-1067"><a href="#DistributionalEngine-1067"><span class="linenos">1067</span></a>            <span class="n">income_group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
</span><span id="DistributionalEngine-1068"><a href="#DistributionalEngine-1068"><span class="linenos">1068</span></a>            <span class="n">tax_change_total</span><span class="o">=</span><span class="n">tax_change_total</span><span class="p">,</span>
</span><span id="DistributionalEngine-1069"><a href="#DistributionalEngine-1069"><span class="linenos">1069</span></a>            <span class="n">tax_change_avg</span><span class="o">=</span><span class="n">tax_change_avg</span><span class="p">,</span>
</span><span id="DistributionalEngine-1070"><a href="#DistributionalEngine-1070"><span class="linenos">1070</span></a>            <span class="n">tax_change_pct_income</span><span class="o">=</span><span class="n">tax_change_pct_income</span><span class="p">,</span>
</span><span id="DistributionalEngine-1071"><a href="#DistributionalEngine-1071"><span class="linenos">1071</span></a>            <span class="n">share_of_total_change</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="DistributionalEngine-1072"><a href="#DistributionalEngine-1072"><span class="linenos">1072</span></a>            <span class="n">pct_with_increase</span><span class="o">=</span><span class="n">pct_with_increase</span><span class="p">,</span>
</span><span id="DistributionalEngine-1073"><a href="#DistributionalEngine-1073"><span class="linenos">1073</span></a>            <span class="n">pct_with_decrease</span><span class="o">=</span><span class="n">pct_with_decrease</span><span class="p">,</span>
</span><span id="DistributionalEngine-1074"><a href="#DistributionalEngine-1074"><span class="linenos">1074</span></a>            <span class="n">pct_unchanged</span><span class="o">=</span><span class="n">pct_unchanged</span><span class="p">,</span>
</span><span id="DistributionalEngine-1075"><a href="#DistributionalEngine-1075"><span class="linenos">1075</span></a>            <span class="n">baseline_etr</span><span class="o">=</span><span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-1076"><a href="#DistributionalEngine-1076"><span class="linenos">1076</span></a>            <span class="n">new_etr</span><span class="o">=</span><span class="n">new_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-1077"><a href="#DistributionalEngine-1077"><span class="linenos">1077</span></a>            <span class="n">etr_change</span><span class="o">=</span><span class="n">new_etr</span> <span class="o">-</span> <span class="n">baseline_etr</span><span class="p">,</span>
</span><span id="DistributionalEngine-1078"><a href="#DistributionalEngine-1078"><span class="linenos">1078</span></a>        <span class="p">)</span>
</span><span id="DistributionalEngine-1079"><a href="#DistributionalEngine-1079"><span class="linenos">1079</span></a>
</span><span id="DistributionalEngine-1080"><a href="#DistributionalEngine-1080"><span class="linenos">1080</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_top_income_breakout</span><span class="p">(</span>
</span><span id="DistributionalEngine-1081"><a href="#DistributionalEngine-1081"><span class="linenos">1081</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine-1082"><a href="#DistributionalEngine-1082"><span class="linenos">1082</span></a>        <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="DistributionalEngine-1083"><a href="#DistributionalEngine-1083"><span class="linenos">1083</span></a>        <span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DistributionalEngine-1084"><a href="#DistributionalEngine-1084"><span class="linenos">1084</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalAnalysis</span><span class="p">:</span>
</span><span id="DistributionalEngine-1085"><a href="#DistributionalEngine-1085"><span class="linenos">1085</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-1086"><a href="#DistributionalEngine-1086"><span class="linenos">1086</span></a><span class="sd">        Create detailed breakout for top income groups.</span>
</span><span id="DistributionalEngine-1087"><a href="#DistributionalEngine-1087"><span class="linenos">1087</span></a>
</span><span id="DistributionalEngine-1088"><a href="#DistributionalEngine-1088"><span class="linenos">1088</span></a><span class="sd">        Includes Top 20%, Top 10%, Top 5%, Top 1%, Top 0.1%.</span>
</span><span id="DistributionalEngine-1089"><a href="#DistributionalEngine-1089"><span class="linenos">1089</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine-1090"><a href="#DistributionalEngine-1090"><span class="linenos">1090</span></a>        <span class="n">custom_brackets</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine-1091"><a href="#DistributionalEngine-1091"><span class="linenos">1091</span></a>            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">),</span>           <span class="c1"># Bottom 80%</span>
</span><span id="DistributionalEngine-1092"><a href="#DistributionalEngine-1092"><span class="linenos">1092</span></a>            <span class="p">(</span><span class="mi">170_000</span><span class="p">,</span> <span class="mi">215_000</span><span class="p">),</span>     <span class="c1"># 80-90%</span>
</span><span id="DistributionalEngine-1093"><a href="#DistributionalEngine-1093"><span class="linenos">1093</span></a>            <span class="p">(</span><span class="mi">215_000</span><span class="p">,</span> <span class="mi">335_000</span><span class="p">),</span>     <span class="c1"># 90-95%</span>
</span><span id="DistributionalEngine-1094"><a href="#DistributionalEngine-1094"><span class="linenos">1094</span></a>            <span class="p">(</span><span class="mi">335_000</span><span class="p">,</span> <span class="mi">800_000</span><span class="p">),</span>     <span class="c1"># 95-99%</span>
</span><span id="DistributionalEngine-1095"><a href="#DistributionalEngine-1095"><span class="linenos">1095</span></a>            <span class="p">(</span><span class="mi">800_000</span><span class="p">,</span> <span class="mi">3_500_000</span><span class="p">),</span>   <span class="c1"># 99-99.9%</span>
</span><span id="DistributionalEngine-1096"><a href="#DistributionalEngine-1096"><span class="linenos">1096</span></a>            <span class="p">(</span><span class="mi">3_500_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>      <span class="c1"># Top 0.1%</span>
</span><span id="DistributionalEngine-1097"><a href="#DistributionalEngine-1097"><span class="linenos">1097</span></a>        <span class="p">]</span>
</span><span id="DistributionalEngine-1098"><a href="#DistributionalEngine-1098"><span class="linenos">1098</span></a>
</span><span id="DistributionalEngine-1099"><a href="#DistributionalEngine-1099"><span class="linenos">1099</span></a>        <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine-1100"><a href="#DistributionalEngine-1100"><span class="linenos">1100</span></a>            <span class="p">(</span><span class="s2">&quot;Bottom 80%&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-1101"><a href="#DistributionalEngine-1101"><span class="linenos">1101</span></a>            <span class="p">(</span><span class="s2">&quot;80th-90th Percentile&quot;</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">,</span> <span class="mi">215_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-1102"><a href="#DistributionalEngine-1102"><span class="linenos">1102</span></a>            <span class="p">(</span><span class="s2">&quot;90th-95th Percentile&quot;</span><span class="p">,</span> <span class="mi">215_000</span><span class="p">,</span> <span class="mi">335_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-1103"><a href="#DistributionalEngine-1103"><span class="linenos">1103</span></a>            <span class="p">(</span><span class="s2">&quot;95th-99th Percentile&quot;</span><span class="p">,</span> <span class="mi">335_000</span><span class="p">,</span> <span class="mi">800_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-1104"><a href="#DistributionalEngine-1104"><span class="linenos">1104</span></a>            <span class="p">(</span><span class="s2">&quot;Top 1% (excl. 0.1%)&quot;</span><span class="p">,</span> <span class="mi">800_000</span><span class="p">,</span> <span class="mi">3_500_000</span><span class="p">),</span>
</span><span id="DistributionalEngine-1105"><a href="#DistributionalEngine-1105"><span class="linenos">1105</span></a>            <span class="p">(</span><span class="s2">&quot;Top 0.1%&quot;</span><span class="p">,</span> <span class="mi">3_500_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="DistributionalEngine-1106"><a href="#DistributionalEngine-1106"><span class="linenos">1106</span></a>        <span class="p">]</span>
</span><span id="DistributionalEngine-1107"><a href="#DistributionalEngine-1107"><span class="linenos">1107</span></a>
</span><span id="DistributionalEngine-1108"><a href="#DistributionalEngine-1108"><span class="linenos">1108</span></a>        <span class="c1"># Create custom groups</span>
</span><span id="DistributionalEngine-1109"><a href="#DistributionalEngine-1109"><span class="linenos">1109</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine-1110"><a href="#DistributionalEngine-1110"><span class="linenos">1110</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
</span><span id="DistributionalEngine-1111"><a href="#DistributionalEngine-1111"><span class="linenos">1111</span></a>            <span class="n">group_returns</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DistributionalEngine-1112"><a href="#DistributionalEngine-1112"><span class="linenos">1112</span></a>            <span class="n">group_agi</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1113"><a href="#DistributionalEngine-1113"><span class="linenos">1113</span></a>            <span class="n">group_taxable</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1114"><a href="#DistributionalEngine-1114"><span class="linenos">1114</span></a>            <span class="n">group_tax</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1115"><a href="#DistributionalEngine-1115"><span class="linenos">1115</span></a>
</span><span id="DistributionalEngine-1116"><a href="#DistributionalEngine-1116"><span class="linenos">1116</span></a>            <span class="k">for</span> <span class="n">bracket</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brackets</span><span class="p">:</span>
</span><span id="DistributionalEngine-1117"><a href="#DistributionalEngine-1117"><span class="linenos">1117</span></a>                <span class="n">bracket_floor</span> <span class="o">=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_floor</span>
</span><span id="DistributionalEngine-1118"><a href="#DistributionalEngine-1118"><span class="linenos">1118</span></a>                <span class="n">bracket_ceiling</span> <span class="o">=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_ceiling</span> <span class="k">if</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine-1119"><a href="#DistributionalEngine-1119"><span class="linenos">1119</span></a>                <span class="n">group_ceiling</span> <span class="o">=</span> <span class="n">ceiling</span> <span class="k">if</span> <span class="n">ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine-1120"><a href="#DistributionalEngine-1120"><span class="linenos">1120</span></a>
</span><span id="DistributionalEngine-1121"><a href="#DistributionalEngine-1121"><span class="linenos">1121</span></a>                <span class="k">if</span> <span class="n">bracket_floor</span> <span class="o">&gt;=</span> <span class="n">floor</span> <span class="ow">and</span> <span class="n">bracket_floor</span> <span class="o">&lt;</span> <span class="n">group_ceiling</span><span class="p">:</span>
</span><span id="DistributionalEngine-1122"><a href="#DistributionalEngine-1122"><span class="linenos">1122</span></a>                    <span class="k">if</span> <span class="n">ceiling</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">bracket_ceiling</span> <span class="o">&lt;=</span> <span class="n">group_ceiling</span><span class="p">:</span>
</span><span id="DistributionalEngine-1123"><a href="#DistributionalEngine-1123"><span class="linenos">1123</span></a>                        <span class="n">group_returns</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="DistributionalEngine-1124"><a href="#DistributionalEngine-1124"><span class="linenos">1124</span></a>                        <span class="n">group_agi</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">total_agi</span>
</span><span id="DistributionalEngine-1125"><a href="#DistributionalEngine-1125"><span class="linenos">1125</span></a>                        <span class="n">group_taxable</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">taxable_income</span>
</span><span id="DistributionalEngine-1126"><a href="#DistributionalEngine-1126"><span class="linenos">1126</span></a>                        <span class="n">group_tax</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">total_tax</span>
</span><span id="DistributionalEngine-1127"><a href="#DistributionalEngine-1127"><span class="linenos">1127</span></a>
</span><span id="DistributionalEngine-1128"><a href="#DistributionalEngine-1128"><span class="linenos">1128</span></a>            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IncomeGroup</span><span class="p">(</span>
</span><span id="DistributionalEngine-1129"><a href="#DistributionalEngine-1129"><span class="linenos">1129</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="DistributionalEngine-1130"><a href="#DistributionalEngine-1130"><span class="linenos">1130</span></a>                <span class="n">floor</span><span class="o">=</span><span class="n">floor</span><span class="p">,</span>
</span><span id="DistributionalEngine-1131"><a href="#DistributionalEngine-1131"><span class="linenos">1131</span></a>                <span class="n">ceiling</span><span class="o">=</span><span class="n">ceiling</span><span class="p">,</span>
</span><span id="DistributionalEngine-1132"><a href="#DistributionalEngine-1132"><span class="linenos">1132</span></a>                <span class="n">num_returns</span><span class="o">=</span><span class="n">group_returns</span><span class="p">,</span>
</span><span id="DistributionalEngine-1133"><a href="#DistributionalEngine-1133"><span class="linenos">1133</span></a>                <span class="n">total_agi</span><span class="o">=</span><span class="n">group_agi</span><span class="p">,</span>
</span><span id="DistributionalEngine-1134"><a href="#DistributionalEngine-1134"><span class="linenos">1134</span></a>                <span class="n">total_taxable_income</span><span class="o">=</span><span class="n">group_taxable</span><span class="p">,</span>
</span><span id="DistributionalEngine-1135"><a href="#DistributionalEngine-1135"><span class="linenos">1135</span></a>                <span class="n">baseline_tax</span><span class="o">=</span><span class="n">group_tax</span><span class="p">,</span>
</span><span id="DistributionalEngine-1136"><a href="#DistributionalEngine-1136"><span class="linenos">1136</span></a>                <span class="n">population_share</span><span class="o">=</span><span class="n">group_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="DistributionalEngine-1137"><a href="#DistributionalEngine-1137"><span class="linenos">1137</span></a>            <span class="p">))</span>
</span><span id="DistributionalEngine-1138"><a href="#DistributionalEngine-1138"><span class="linenos">1138</span></a>
</span><span id="DistributionalEngine-1139"><a href="#DistributionalEngine-1139"><span class="linenos">1139</span></a>        <span class="c1"># Analyze policy for these groups</span>
</span><span id="DistributionalEngine-1140"><a href="#DistributionalEngine-1140"><span class="linenos">1140</span></a>        <span class="k">if</span> <span class="n">year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine-1141"><a href="#DistributionalEngine-1141"><span class="linenos">1141</span></a>            <span class="n">year</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;start_year&#39;</span><span class="p">,</span> <span class="mi">2025</span><span class="p">)</span>
</span><span id="DistributionalEngine-1142"><a href="#DistributionalEngine-1142"><span class="linenos">1142</span></a>
</span><span id="DistributionalEngine-1143"><a href="#DistributionalEngine-1143"><span class="linenos">1143</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine-1144"><a href="#DistributionalEngine-1144"><span class="linenos">1144</span></a>        <span class="n">total_tax_change</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine-1145"><a href="#DistributionalEngine-1145"><span class="linenos">1145</span></a>        <span class="n">policy_class_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="DistributionalEngine-1146"><a href="#DistributionalEngine-1146"><span class="linenos">1146</span></a>
</span><span id="DistributionalEngine-1147"><a href="#DistributionalEngine-1147"><span class="linenos">1147</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="DistributionalEngine-1148"><a href="#DistributionalEngine-1148"><span class="linenos">1148</span></a>            <span class="c1"># Dispatch based on policy type</span>
</span><span id="DistributionalEngine-1149"><a href="#DistributionalEngine-1149"><span class="linenos">1149</span></a>            <span class="k">if</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;TaxCreditPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine-1150"><a href="#DistributionalEngine-1150"><span class="linenos">1150</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_credit_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-1151"><a href="#DistributionalEngine-1151"><span class="linenos">1151</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;TCJAExtensionPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine-1152"><a href="#DistributionalEngine-1152"><span class="linenos">1152</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_tcja_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-1153"><a href="#DistributionalEngine-1153"><span class="linenos">1153</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;CorporateTaxPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine-1154"><a href="#DistributionalEngine-1154"><span class="linenos">1154</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_corporate_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-1155"><a href="#DistributionalEngine-1155"><span class="linenos">1155</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;PayrollTaxPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine-1156"><a href="#DistributionalEngine-1156"><span class="linenos">1156</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_payroll_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-1157"><a href="#DistributionalEngine-1157"><span class="linenos">1157</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine-1158"><a href="#DistributionalEngine-1158"><span class="linenos">1158</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_group_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine-1159"><a href="#DistributionalEngine-1159"><span class="linenos">1159</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="DistributionalEngine-1160"><a href="#DistributionalEngine-1160"><span class="linenos">1160</span></a>            <span class="n">total_tax_change</span> <span class="o">+=</span> <span class="n">result</span><span class="o">.</span><span class="n">tax_change_total</span>
</span><span id="DistributionalEngine-1161"><a href="#DistributionalEngine-1161"><span class="linenos">1161</span></a>
</span><span id="DistributionalEngine-1162"><a href="#DistributionalEngine-1162"><span class="linenos">1162</span></a>        <span class="c1"># Calculate share of total change</span>
</span><span id="DistributionalEngine-1163"><a href="#DistributionalEngine-1163"><span class="linenos">1163</span></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">total_tax_change</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
</span><span id="DistributionalEngine-1164"><a href="#DistributionalEngine-1164"><span class="linenos">1164</span></a>            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="DistributionalEngine-1165"><a href="#DistributionalEngine-1165"><span class="linenos">1165</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">share_of_total_change</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">total_tax_change</span>
</span><span id="DistributionalEngine-1166"><a href="#DistributionalEngine-1166"><span class="linenos">1166</span></a>
</span><span id="DistributionalEngine-1167"><a href="#DistributionalEngine-1167"><span class="linenos">1167</span></a>        <span class="k">return</span> <span class="n">DistributionalAnalysis</span><span class="p">(</span>
</span><span id="DistributionalEngine-1168"><a href="#DistributionalEngine-1168"><span class="linenos">1168</span></a>            <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
</span><span id="DistributionalEngine-1169"><a href="#DistributionalEngine-1169"><span class="linenos">1169</span></a>            <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
</span><span id="DistributionalEngine-1170"><a href="#DistributionalEngine-1170"><span class="linenos">1170</span></a>            <span class="n">group_type</span><span class="o">=</span><span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="p">,</span>
</span><span id="DistributionalEngine-1171"><a href="#DistributionalEngine-1171"><span class="linenos">1171</span></a>            <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span>
</span><span id="DistributionalEngine-1172"><a href="#DistributionalEngine-1172"><span class="linenos">1172</span></a>            <span class="n">total_tax_change</span><span class="o">=</span><span class="n">total_tax_change</span><span class="p">,</span>
</span><span id="DistributionalEngine-1173"><a href="#DistributionalEngine-1173"><span class="linenos">1173</span></a>            <span class="n">total_affected_returns</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">num_returns</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">),</span>
</span><span id="DistributionalEngine-1174"><a href="#DistributionalEngine-1174"><span class="linenos">1174</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Engine for computing distributional effects of tax policies.</p>

<p>Uses IRS Statistics of Income data to calculate how tax changes
affect different income groups.</p>
</div>


                            <div id="DistributionalEngine.__init__" class="classattr">
                                        <input id="DistributionalEngine.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DistributionalEngine</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2022</span></span>)</span>

                <label class="view-source-button" for="DistributionalEngine.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalEngine.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalEngine.__init__-270"><a href="#DistributionalEngine.__init__-270"><span class="linenos">270</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2022</span><span class="p">):</span>
</span><span id="DistributionalEngine.__init__-271"><a href="#DistributionalEngine.__init__-271"><span class="linenos">271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.__init__-272"><a href="#DistributionalEngine.__init__-272"><span class="linenos">272</span></a><span class="sd">        Initialize the distributional engine.</span>
</span><span id="DistributionalEngine.__init__-273"><a href="#DistributionalEngine.__init__-273"><span class="linenos">273</span></a>
</span><span id="DistributionalEngine.__init__-274"><a href="#DistributionalEngine.__init__-274"><span class="linenos">274</span></a><span class="sd">        Args:</span>
</span><span id="DistributionalEngine.__init__-275"><a href="#DistributionalEngine.__init__-275"><span class="linenos">275</span></a><span class="sd">            data_year: Year of IRS SOI data to use</span>
</span><span id="DistributionalEngine.__init__-276"><a href="#DistributionalEngine.__init__-276"><span class="linenos">276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.__init__-277"><a href="#DistributionalEngine.__init__-277"><span class="linenos">277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_year</span> <span class="o">=</span> <span class="n">data_year</span>
</span><span id="DistributionalEngine.__init__-278"><a href="#DistributionalEngine.__init__-278"><span class="linenos">278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_irs_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DistributionalEngine.__init__-279"><a href="#DistributionalEngine.__init__-279"><span class="linenos">279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DistributionalEngine.__init__-280"><a href="#DistributionalEngine.__init__-280"><span class="linenos">280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_total_returns</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the distributional engine.</p>

<p>Args:
    data_year: Year of IRS SOI data to use</p>
</div>


                            </div>
                            <div id="DistributionalEngine.data_year" class="classattr">
                                <div class="attr variable">
            <span class="name">data_year</span>

        
    </div>
    <a class="headerlink" href="#DistributionalEngine.data_year"></a>
    
    

                            </div>
                            <div id="DistributionalEngine.irs_data" class="classattr">
                                        <input id="DistributionalEngine.irs_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">irs_data</span><span class="annotation">: fiscal_model.data.irs_soi.IRSSOIData</span>

                <label class="view-source-button" for="DistributionalEngine.irs_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalEngine.irs_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalEngine.irs_data-282"><a href="#DistributionalEngine.irs_data-282"><span class="linenos">282</span></a>    <span class="nd">@property</span>
</span><span id="DistributionalEngine.irs_data-283"><a href="#DistributionalEngine.irs_data-283"><span class="linenos">283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">irs_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IRSSOIData</span><span class="p">:</span>
</span><span id="DistributionalEngine.irs_data-284"><a href="#DistributionalEngine.irs_data-284"><span class="linenos">284</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Lazy load IRS data.&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.irs_data-285"><a href="#DistributionalEngine.irs_data-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_irs_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine.irs_data-286"><a href="#DistributionalEngine.irs_data-286"><span class="linenos">286</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_irs_data</span> <span class="o">=</span> <span class="n">IRSSOIData</span><span class="p">()</span>
</span><span id="DistributionalEngine.irs_data-287"><a href="#DistributionalEngine.irs_data-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_irs_data</span>
</span></pre></div>


            <div class="docstring"><p>Lazy load IRS data.</p>
</div>


                            </div>
                            <div id="DistributionalEngine.brackets" class="classattr">
                                        <input id="DistributionalEngine.brackets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">brackets</span><span class="annotation">: List[fiscal_model.data.irs_soi.TaxBracketData]</span>

                <label class="view-source-button" for="DistributionalEngine.brackets-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalEngine.brackets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalEngine.brackets-289"><a href="#DistributionalEngine.brackets-289"><span class="linenos">289</span></a>    <span class="nd">@property</span>
</span><span id="DistributionalEngine.brackets-290"><a href="#DistributionalEngine.brackets-290"><span class="linenos">290</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">brackets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TaxBracketData</span><span class="p">]:</span>
</span><span id="DistributionalEngine.brackets-291"><a href="#DistributionalEngine.brackets-291"><span class="linenos">291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Lazy load bracket data.&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.brackets-292"><a href="#DistributionalEngine.brackets-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine.brackets-293"><a href="#DistributionalEngine.brackets-293"><span class="linenos">293</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DistributionalEngine.brackets-294"><a href="#DistributionalEngine.brackets-294"><span class="linenos">294</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">irs_data</span><span class="o">.</span><span class="n">get_bracket_distribution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_year</span><span class="p">)</span>
</span><span id="DistributionalEngine.brackets-295"><a href="#DistributionalEngine.brackets-295"><span class="linenos">295</span></a>            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DistributionalEngine.brackets-296"><a href="#DistributionalEngine.brackets-296"><span class="linenos">296</span></a>                <span class="c1"># Use synthetic data if IRS files not available</span>
</span><span id="DistributionalEngine.brackets-297"><a href="#DistributionalEngine.brackets-297"><span class="linenos">297</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_synthetic_brackets</span><span class="p">()</span>
</span><span id="DistributionalEngine.brackets-298"><a href="#DistributionalEngine.brackets-298"><span class="linenos">298</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_brackets</span>
</span></pre></div>


            <div class="docstring"><p>Lazy load bracket data.</p>
</div>


                            </div>
                            <div id="DistributionalEngine.total_returns" class="classattr">
                                        <input id="DistributionalEngine.total_returns-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">total_returns</span><span class="annotation">: int</span>

                <label class="view-source-button" for="DistributionalEngine.total_returns-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalEngine.total_returns"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalEngine.total_returns-300"><a href="#DistributionalEngine.total_returns-300"><span class="linenos">300</span></a>    <span class="nd">@property</span>
</span><span id="DistributionalEngine.total_returns-301"><a href="#DistributionalEngine.total_returns-301"><span class="linenos">301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_returns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="DistributionalEngine.total_returns-302"><a href="#DistributionalEngine.total_returns-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Total number of tax returns.&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.total_returns-303"><a href="#DistributionalEngine.total_returns-303"><span class="linenos">303</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_returns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine.total_returns-304"><a href="#DistributionalEngine.total_returns-304"><span class="linenos">304</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_total_returns</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">num_returns</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brackets</span><span class="p">)</span>
</span><span id="DistributionalEngine.total_returns-305"><a href="#DistributionalEngine.total_returns-305"><span class="linenos">305</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_returns</span>
</span></pre></div>


            <div class="docstring"><p>Total number of tax returns.</p>
</div>


                            </div>
                            <div id="DistributionalEngine.create_income_groups" class="classattr">
                                        <input id="DistributionalEngine.create_income_groups-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_income_groups</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">group_type</span><span class="p">:</span> <span class="n"><a href="#IncomeGroupType">IncomeGroupType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#IncomeGroupType.QUINTILE">IncomeGroupType.QUINTILE</a></span><span class="p">:</span> <span class="s1">&#39;quintile&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">custom_brackets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n"><a href="#IncomeGroup">IncomeGroup</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DistributionalEngine.create_income_groups-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalEngine.create_income_groups"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalEngine.create_income_groups-351"><a href="#DistributionalEngine.create_income_groups-351"><span class="linenos">351</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_income_groups</span><span class="p">(</span>
</span><span id="DistributionalEngine.create_income_groups-352"><a href="#DistributionalEngine.create_income_groups-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-353"><a href="#DistributionalEngine.create_income_groups-353"><span class="linenos">353</span></a>        <span class="n">group_type</span><span class="p">:</span> <span class="n">IncomeGroupType</span> <span class="o">=</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">QUINTILE</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-354"><a href="#DistributionalEngine.create_income_groups-354"><span class="linenos">354</span></a>        <span class="n">custom_brackets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-355"><a href="#DistributionalEngine.create_income_groups-355"><span class="linenos">355</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">IncomeGroup</span><span class="p">]:</span>
</span><span id="DistributionalEngine.create_income_groups-356"><a href="#DistributionalEngine.create_income_groups-356"><span class="linenos">356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.create_income_groups-357"><a href="#DistributionalEngine.create_income_groups-357"><span class="linenos">357</span></a><span class="sd">        Create income groups by aggregating IRS brackets.</span>
</span><span id="DistributionalEngine.create_income_groups-358"><a href="#DistributionalEngine.create_income_groups-358"><span class="linenos">358</span></a>
</span><span id="DistributionalEngine.create_income_groups-359"><a href="#DistributionalEngine.create_income_groups-359"><span class="linenos">359</span></a><span class="sd">        Args:</span>
</span><span id="DistributionalEngine.create_income_groups-360"><a href="#DistributionalEngine.create_income_groups-360"><span class="linenos">360</span></a><span class="sd">            group_type: Type of income grouping</span>
</span><span id="DistributionalEngine.create_income_groups-361"><a href="#DistributionalEngine.create_income_groups-361"><span class="linenos">361</span></a><span class="sd">            custom_brackets: Custom bracket definitions if group_type is CUSTOM</span>
</span><span id="DistributionalEngine.create_income_groups-362"><a href="#DistributionalEngine.create_income_groups-362"><span class="linenos">362</span></a>
</span><span id="DistributionalEngine.create_income_groups-363"><a href="#DistributionalEngine.create_income_groups-363"><span class="linenos">363</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionalEngine.create_income_groups-364"><a href="#DistributionalEngine.create_income_groups-364"><span class="linenos">364</span></a><span class="sd">            List of IncomeGroup objects with aggregated statistics</span>
</span><span id="DistributionalEngine.create_income_groups-365"><a href="#DistributionalEngine.create_income_groups-365"><span class="linenos">365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.create_income_groups-366"><a href="#DistributionalEngine.create_income_groups-366"><span class="linenos">366</span></a>        <span class="c1"># Define bracket boundaries based on group type</span>
</span><span id="DistributionalEngine.create_income_groups-367"><a href="#DistributionalEngine.create_income_groups-367"><span class="linenos">367</span></a>        <span class="k">if</span> <span class="n">group_type</span> <span class="o">==</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">QUINTILE</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-368"><a href="#DistributionalEngine.create_income_groups-368"><span class="linenos">368</span></a>            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine.create_income_groups-369"><a href="#DistributionalEngine.create_income_groups-369"><span class="linenos">369</span></a>                <span class="p">(</span><span class="s2">&quot;Lowest Quintile&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-370"><a href="#DistributionalEngine.create_income_groups-370"><span class="linenos">370</span></a>                <span class="p">(</span><span class="s2">&quot;Second Quintile&quot;</span><span class="p">,</span> <span class="mi">35_000</span><span class="p">,</span> <span class="mi">65_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-371"><a href="#DistributionalEngine.create_income_groups-371"><span class="linenos">371</span></a>                <span class="p">(</span><span class="s2">&quot;Middle Quintile&quot;</span><span class="p">,</span> <span class="mi">65_000</span><span class="p">,</span> <span class="mi">105_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-372"><a href="#DistributionalEngine.create_income_groups-372"><span class="linenos">372</span></a>                <span class="p">(</span><span class="s2">&quot;Fourth Quintile&quot;</span><span class="p">,</span> <span class="mi">105_000</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-373"><a href="#DistributionalEngine.create_income_groups-373"><span class="linenos">373</span></a>                <span class="p">(</span><span class="s2">&quot;Top Quintile&quot;</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-374"><a href="#DistributionalEngine.create_income_groups-374"><span class="linenos">374</span></a>            <span class="p">]</span>
</span><span id="DistributionalEngine.create_income_groups-375"><a href="#DistributionalEngine.create_income_groups-375"><span class="linenos">375</span></a>        <span class="k">elif</span> <span class="n">group_type</span> <span class="o">==</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">DECILE</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-376"><a href="#DistributionalEngine.create_income_groups-376"><span class="linenos">376</span></a>            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine.create_income_groups-377"><a href="#DistributionalEngine.create_income_groups-377"><span class="linenos">377</span></a>                <span class="p">(</span><span class="s2">&quot;1st Decile&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-378"><a href="#DistributionalEngine.create_income_groups-378"><span class="linenos">378</span></a>                <span class="p">(</span><span class="s2">&quot;2nd Decile&quot;</span><span class="p">,</span> <span class="mi">15_000</span><span class="p">,</span> <span class="mi">28_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-379"><a href="#DistributionalEngine.create_income_groups-379"><span class="linenos">379</span></a>                <span class="p">(</span><span class="s2">&quot;3rd Decile&quot;</span><span class="p">,</span> <span class="mi">28_000</span><span class="p">,</span> <span class="mi">42_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-380"><a href="#DistributionalEngine.create_income_groups-380"><span class="linenos">380</span></a>                <span class="p">(</span><span class="s2">&quot;4th Decile&quot;</span><span class="p">,</span> <span class="mi">42_000</span><span class="p">,</span> <span class="mi">55_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-381"><a href="#DistributionalEngine.create_income_groups-381"><span class="linenos">381</span></a>                <span class="p">(</span><span class="s2">&quot;5th Decile&quot;</span><span class="p">,</span> <span class="mi">55_000</span><span class="p">,</span> <span class="mi">72_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-382"><a href="#DistributionalEngine.create_income_groups-382"><span class="linenos">382</span></a>                <span class="p">(</span><span class="s2">&quot;6th Decile&quot;</span><span class="p">,</span> <span class="mi">72_000</span><span class="p">,</span> <span class="mi">92_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-383"><a href="#DistributionalEngine.create_income_groups-383"><span class="linenos">383</span></a>                <span class="p">(</span><span class="s2">&quot;7th Decile&quot;</span><span class="p">,</span> <span class="mi">92_000</span><span class="p">,</span> <span class="mi">118_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-384"><a href="#DistributionalEngine.create_income_groups-384"><span class="linenos">384</span></a>                <span class="p">(</span><span class="s2">&quot;8th Decile&quot;</span><span class="p">,</span> <span class="mi">118_000</span><span class="p">,</span> <span class="mi">155_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-385"><a href="#DistributionalEngine.create_income_groups-385"><span class="linenos">385</span></a>                <span class="p">(</span><span class="s2">&quot;9th Decile&quot;</span><span class="p">,</span> <span class="mi">155_000</span><span class="p">,</span> <span class="mi">220_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-386"><a href="#DistributionalEngine.create_income_groups-386"><span class="linenos">386</span></a>                <span class="p">(</span><span class="s2">&quot;10th Decile&quot;</span><span class="p">,</span> <span class="mi">220_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-387"><a href="#DistributionalEngine.create_income_groups-387"><span class="linenos">387</span></a>            <span class="p">]</span>
</span><span id="DistributionalEngine.create_income_groups-388"><a href="#DistributionalEngine.create_income_groups-388"><span class="linenos">388</span></a>        <span class="k">elif</span> <span class="n">group_type</span> <span class="o">==</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">JCT_DOLLAR</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-389"><a href="#DistributionalEngine.create_income_groups-389"><span class="linenos">389</span></a>            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine.create_income_groups-390"><a href="#DistributionalEngine.create_income_groups-390"><span class="linenos">390</span></a>                <span class="p">(</span><span class="s2">&quot;Less than $10K&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-391"><a href="#DistributionalEngine.create_income_groups-391"><span class="linenos">391</span></a>                <span class="p">(</span><span class="s2">&quot;$10K-$20K&quot;</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mi">20_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-392"><a href="#DistributionalEngine.create_income_groups-392"><span class="linenos">392</span></a>                <span class="p">(</span><span class="s2">&quot;$20K-$30K&quot;</span><span class="p">,</span> <span class="mi">20_000</span><span class="p">,</span> <span class="mi">30_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-393"><a href="#DistributionalEngine.create_income_groups-393"><span class="linenos">393</span></a>                <span class="p">(</span><span class="s2">&quot;$30K-$40K&quot;</span><span class="p">,</span> <span class="mi">30_000</span><span class="p">,</span> <span class="mi">40_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-394"><a href="#DistributionalEngine.create_income_groups-394"><span class="linenos">394</span></a>                <span class="p">(</span><span class="s2">&quot;$40K-$50K&quot;</span><span class="p">,</span> <span class="mi">40_000</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-395"><a href="#DistributionalEngine.create_income_groups-395"><span class="linenos">395</span></a>                <span class="p">(</span><span class="s2">&quot;$50K-$75K&quot;</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">,</span> <span class="mi">75_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-396"><a href="#DistributionalEngine.create_income_groups-396"><span class="linenos">396</span></a>                <span class="p">(</span><span class="s2">&quot;$75K-$100K&quot;</span><span class="p">,</span> <span class="mi">75_000</span><span class="p">,</span> <span class="mi">100_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-397"><a href="#DistributionalEngine.create_income_groups-397"><span class="linenos">397</span></a>                <span class="p">(</span><span class="s2">&quot;$100K-$200K&quot;</span><span class="p">,</span> <span class="mi">100_000</span><span class="p">,</span> <span class="mi">200_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-398"><a href="#DistributionalEngine.create_income_groups-398"><span class="linenos">398</span></a>                <span class="p">(</span><span class="s2">&quot;$200K-$500K&quot;</span><span class="p">,</span> <span class="mi">200_000</span><span class="p">,</span> <span class="mi">500_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-399"><a href="#DistributionalEngine.create_income_groups-399"><span class="linenos">399</span></a>                <span class="p">(</span><span class="s2">&quot;$500K-$1M&quot;</span><span class="p">,</span> <span class="mi">500_000</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-400"><a href="#DistributionalEngine.create_income_groups-400"><span class="linenos">400</span></a>                <span class="p">(</span><span class="s2">&quot;$1M and over&quot;</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_income_groups-401"><a href="#DistributionalEngine.create_income_groups-401"><span class="linenos">401</span></a>            <span class="p">]</span>
</span><span id="DistributionalEngine.create_income_groups-402"><a href="#DistributionalEngine.create_income_groups-402"><span class="linenos">402</span></a>        <span class="k">elif</span> <span class="n">group_type</span> <span class="o">==</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-403"><a href="#DistributionalEngine.create_income_groups-403"><span class="linenos">403</span></a>            <span class="k">if</span> <span class="n">custom_brackets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-404"><a href="#DistributionalEngine.create_income_groups-404"><span class="linenos">404</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;custom_brackets required for CUSTOM group type&quot;</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_income_groups-405"><a href="#DistributionalEngine.create_income_groups-405"><span class="linenos">405</span></a>            <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine.create_income_groups-406"><a href="#DistributionalEngine.create_income_groups-406"><span class="linenos">406</span></a>                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">floor</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K-$</span><span class="si">{</span><span class="n">ceiling</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K&quot;</span> <span class="k">if</span> <span class="n">ceiling</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">floor</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">K+&quot;</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-407"><a href="#DistributionalEngine.create_income_groups-407"><span class="linenos">407</span></a>                 <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_income_groups-408"><a href="#DistributionalEngine.create_income_groups-408"><span class="linenos">408</span></a>                <span class="k">for</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span> <span class="ow">in</span> <span class="n">custom_brackets</span>
</span><span id="DistributionalEngine.create_income_groups-409"><a href="#DistributionalEngine.create_income_groups-409"><span class="linenos">409</span></a>            <span class="p">]</span>
</span><span id="DistributionalEngine.create_income_groups-410"><a href="#DistributionalEngine.create_income_groups-410"><span class="linenos">410</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-411"><a href="#DistributionalEngine.create_income_groups-411"><span class="linenos">411</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown group type: </span><span class="si">{</span><span class="n">group_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_income_groups-412"><a href="#DistributionalEngine.create_income_groups-412"><span class="linenos">412</span></a>
</span><span id="DistributionalEngine.create_income_groups-413"><a href="#DistributionalEngine.create_income_groups-413"><span class="linenos">413</span></a>        <span class="c1"># Aggregate IRS brackets into income groups</span>
</span><span id="DistributionalEngine.create_income_groups-414"><a href="#DistributionalEngine.create_income_groups-414"><span class="linenos">414</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine.create_income_groups-415"><a href="#DistributionalEngine.create_income_groups-415"><span class="linenos">415</span></a>        <span class="n">total_returns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span>
</span><span id="DistributionalEngine.create_income_groups-416"><a href="#DistributionalEngine.create_income_groups-416"><span class="linenos">416</span></a>
</span><span id="DistributionalEngine.create_income_groups-417"><a href="#DistributionalEngine.create_income_groups-417"><span class="linenos">417</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-418"><a href="#DistributionalEngine.create_income_groups-418"><span class="linenos">418</span></a>            <span class="c1"># Find all IRS brackets that overlap with this income group</span>
</span><span id="DistributionalEngine.create_income_groups-419"><a href="#DistributionalEngine.create_income_groups-419"><span class="linenos">419</span></a>            <span class="n">group_returns</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DistributionalEngine.create_income_groups-420"><a href="#DistributionalEngine.create_income_groups-420"><span class="linenos">420</span></a>            <span class="n">group_agi</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine.create_income_groups-421"><a href="#DistributionalEngine.create_income_groups-421"><span class="linenos">421</span></a>            <span class="n">group_taxable</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine.create_income_groups-422"><a href="#DistributionalEngine.create_income_groups-422"><span class="linenos">422</span></a>            <span class="n">group_tax</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine.create_income_groups-423"><a href="#DistributionalEngine.create_income_groups-423"><span class="linenos">423</span></a>
</span><span id="DistributionalEngine.create_income_groups-424"><a href="#DistributionalEngine.create_income_groups-424"><span class="linenos">424</span></a>            <span class="k">for</span> <span class="n">bracket</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brackets</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-425"><a href="#DistributionalEngine.create_income_groups-425"><span class="linenos">425</span></a>                <span class="c1"># Check if bracket overlaps with this group</span>
</span><span id="DistributionalEngine.create_income_groups-426"><a href="#DistributionalEngine.create_income_groups-426"><span class="linenos">426</span></a>                <span class="n">bracket_floor</span> <span class="o">=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_floor</span>
</span><span id="DistributionalEngine.create_income_groups-427"><a href="#DistributionalEngine.create_income_groups-427"><span class="linenos">427</span></a>                <span class="n">bracket_ceiling</span> <span class="o">=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_ceiling</span> <span class="k">if</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_income_groups-428"><a href="#DistributionalEngine.create_income_groups-428"><span class="linenos">428</span></a>                <span class="n">group_ceiling</span> <span class="o">=</span> <span class="n">ceiling</span> <span class="k">if</span> <span class="n">ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_income_groups-429"><a href="#DistributionalEngine.create_income_groups-429"><span class="linenos">429</span></a>
</span><span id="DistributionalEngine.create_income_groups-430"><a href="#DistributionalEngine.create_income_groups-430"><span class="linenos">430</span></a>                <span class="c1"># Calculate overlap fraction</span>
</span><span id="DistributionalEngine.create_income_groups-431"><a href="#DistributionalEngine.create_income_groups-431"><span class="linenos">431</span></a>                <span class="n">overlap_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bracket_floor</span><span class="p">,</span> <span class="n">floor</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_income_groups-432"><a href="#DistributionalEngine.create_income_groups-432"><span class="linenos">432</span></a>                <span class="n">overlap_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">bracket_ceiling</span><span class="p">,</span> <span class="n">group_ceiling</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_income_groups-433"><a href="#DistributionalEngine.create_income_groups-433"><span class="linenos">433</span></a>
</span><span id="DistributionalEngine.create_income_groups-434"><a href="#DistributionalEngine.create_income_groups-434"><span class="linenos">434</span></a>                <span class="k">if</span> <span class="n">overlap_start</span> <span class="o">&lt;</span> <span class="n">overlap_end</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-435"><a href="#DistributionalEngine.create_income_groups-435"><span class="linenos">435</span></a>                    <span class="c1"># There is overlap</span>
</span><span id="DistributionalEngine.create_income_groups-436"><a href="#DistributionalEngine.create_income_groups-436"><span class="linenos">436</span></a>                    <span class="n">bracket_width</span> <span class="o">=</span> <span class="n">bracket_ceiling</span> <span class="o">-</span> <span class="n">bracket_floor</span>
</span><span id="DistributionalEngine.create_income_groups-437"><a href="#DistributionalEngine.create_income_groups-437"><span class="linenos">437</span></a>                    <span class="n">overlap_width</span> <span class="o">=</span> <span class="n">overlap_end</span> <span class="o">-</span> <span class="n">overlap_start</span>
</span><span id="DistributionalEngine.create_income_groups-438"><a href="#DistributionalEngine.create_income_groups-438"><span class="linenos">438</span></a>
</span><span id="DistributionalEngine.create_income_groups-439"><a href="#DistributionalEngine.create_income_groups-439"><span class="linenos">439</span></a>                    <span class="k">if</span> <span class="n">bracket_width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-440"><a href="#DistributionalEngine.create_income_groups-440"><span class="linenos">440</span></a>                        <span class="n">overlap_fraction</span> <span class="o">=</span> <span class="n">overlap_width</span> <span class="o">/</span> <span class="n">bracket_width</span>
</span><span id="DistributionalEngine.create_income_groups-441"><a href="#DistributionalEngine.create_income_groups-441"><span class="linenos">441</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-442"><a href="#DistributionalEngine.create_income_groups-442"><span class="linenos">442</span></a>                        <span class="n">overlap_fraction</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="DistributionalEngine.create_income_groups-443"><a href="#DistributionalEngine.create_income_groups-443"><span class="linenos">443</span></a>
</span><span id="DistributionalEngine.create_income_groups-444"><a href="#DistributionalEngine.create_income_groups-444"><span class="linenos">444</span></a>                    <span class="c1"># For simplicity, use full bracket if &gt;50% overlap</span>
</span><span id="DistributionalEngine.create_income_groups-445"><a href="#DistributionalEngine.create_income_groups-445"><span class="linenos">445</span></a>                    <span class="c1"># This avoids complex income distribution assumptions</span>
</span><span id="DistributionalEngine.create_income_groups-446"><a href="#DistributionalEngine.create_income_groups-446"><span class="linenos">446</span></a>                    <span class="k">if</span> <span class="n">overlap_fraction</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="ow">or</span> <span class="n">bracket_floor</span> <span class="o">&gt;=</span> <span class="n">floor</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_income_groups-447"><a href="#DistributionalEngine.create_income_groups-447"><span class="linenos">447</span></a>                        <span class="n">group_returns</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="DistributionalEngine.create_income_groups-448"><a href="#DistributionalEngine.create_income_groups-448"><span class="linenos">448</span></a>                        <span class="n">group_agi</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">total_agi</span>
</span><span id="DistributionalEngine.create_income_groups-449"><a href="#DistributionalEngine.create_income_groups-449"><span class="linenos">449</span></a>                        <span class="n">group_taxable</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">taxable_income</span>
</span><span id="DistributionalEngine.create_income_groups-450"><a href="#DistributionalEngine.create_income_groups-450"><span class="linenos">450</span></a>                        <span class="n">group_tax</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">total_tax</span>
</span><span id="DistributionalEngine.create_income_groups-451"><a href="#DistributionalEngine.create_income_groups-451"><span class="linenos">451</span></a>
</span><span id="DistributionalEngine.create_income_groups-452"><a href="#DistributionalEngine.create_income_groups-452"><span class="linenos">452</span></a>            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IncomeGroup</span><span class="p">(</span>
</span><span id="DistributionalEngine.create_income_groups-453"><a href="#DistributionalEngine.create_income_groups-453"><span class="linenos">453</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-454"><a href="#DistributionalEngine.create_income_groups-454"><span class="linenos">454</span></a>                <span class="n">floor</span><span class="o">=</span><span class="n">floor</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-455"><a href="#DistributionalEngine.create_income_groups-455"><span class="linenos">455</span></a>                <span class="n">ceiling</span><span class="o">=</span><span class="n">ceiling</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-456"><a href="#DistributionalEngine.create_income_groups-456"><span class="linenos">456</span></a>                <span class="n">num_returns</span><span class="o">=</span><span class="n">group_returns</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-457"><a href="#DistributionalEngine.create_income_groups-457"><span class="linenos">457</span></a>                <span class="n">total_agi</span><span class="o">=</span><span class="n">group_agi</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-458"><a href="#DistributionalEngine.create_income_groups-458"><span class="linenos">458</span></a>                <span class="n">total_taxable_income</span><span class="o">=</span><span class="n">group_taxable</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-459"><a href="#DistributionalEngine.create_income_groups-459"><span class="linenos">459</span></a>                <span class="n">baseline_tax</span><span class="o">=</span><span class="n">group_tax</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-460"><a href="#DistributionalEngine.create_income_groups-460"><span class="linenos">460</span></a>                <span class="n">population_share</span><span class="o">=</span><span class="n">group_returns</span> <span class="o">/</span> <span class="n">total_returns</span> <span class="k">if</span> <span class="n">total_returns</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_income_groups-461"><a href="#DistributionalEngine.create_income_groups-461"><span class="linenos">461</span></a>            <span class="p">))</span>
</span><span id="DistributionalEngine.create_income_groups-462"><a href="#DistributionalEngine.create_income_groups-462"><span class="linenos">462</span></a>
</span><span id="DistributionalEngine.create_income_groups-463"><a href="#DistributionalEngine.create_income_groups-463"><span class="linenos">463</span></a>        <span class="k">return</span> <span class="n">groups</span>
</span></pre></div>


            <div class="docstring"><p>Create income groups by aggregating IRS brackets.</p>

<p>Args:
    group_type: Type of income grouping
    custom_brackets: Custom bracket definitions if group_type is CUSTOM</p>

<p>Returns:
    List of IncomeGroup objects with aggregated statistics</p>
</div>


                            </div>
                            <div id="DistributionalEngine.analyze_policy" class="classattr">
                                        <input id="DistributionalEngine.analyze_policy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">analyze_policy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">group_type</span><span class="p">:</span> <span class="n"><a href="#IncomeGroupType">IncomeGroupType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#IncomeGroupType.QUINTILE">IncomeGroupType.QUINTILE</a></span><span class="p">:</span> <span class="s1">&#39;quintile&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#DistributionalAnalysis">DistributionalAnalysis</a></span>:</span></span>

                <label class="view-source-button" for="DistributionalEngine.analyze_policy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalEngine.analyze_policy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalEngine.analyze_policy-465"><a href="#DistributionalEngine.analyze_policy-465"><span class="linenos">465</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_policy</span><span class="p">(</span>
</span><span id="DistributionalEngine.analyze_policy-466"><a href="#DistributionalEngine.analyze_policy-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-467"><a href="#DistributionalEngine.analyze_policy-467"><span class="linenos">467</span></a>        <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-468"><a href="#DistributionalEngine.analyze_policy-468"><span class="linenos">468</span></a>        <span class="n">group_type</span><span class="p">:</span> <span class="n">IncomeGroupType</span> <span class="o">=</span> <span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">QUINTILE</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-469"><a href="#DistributionalEngine.analyze_policy-469"><span class="linenos">469</span></a>        <span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-470"><a href="#DistributionalEngine.analyze_policy-470"><span class="linenos">470</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalAnalysis</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-471"><a href="#DistributionalEngine.analyze_policy-471"><span class="linenos">471</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.analyze_policy-472"><a href="#DistributionalEngine.analyze_policy-472"><span class="linenos">472</span></a><span class="sd">        Analyze distributional effects of a tax policy.</span>
</span><span id="DistributionalEngine.analyze_policy-473"><a href="#DistributionalEngine.analyze_policy-473"><span class="linenos">473</span></a>
</span><span id="DistributionalEngine.analyze_policy-474"><a href="#DistributionalEngine.analyze_policy-474"><span class="linenos">474</span></a><span class="sd">        Supports multiple policy types:</span>
</span><span id="DistributionalEngine.analyze_policy-475"><a href="#DistributionalEngine.analyze_policy-475"><span class="linenos">475</span></a><span class="sd">        - TaxPolicy: Basic rate change policies</span>
</span><span id="DistributionalEngine.analyze_policy-476"><a href="#DistributionalEngine.analyze_policy-476"><span class="linenos">476</span></a><span class="sd">        - TaxCreditPolicy: CTC, EITC with phase-in/out</span>
</span><span id="DistributionalEngine.analyze_policy-477"><a href="#DistributionalEngine.analyze_policy-477"><span class="linenos">477</span></a><span class="sd">        - TCJAExtensionPolicy: Multi-component package</span>
</span><span id="DistributionalEngine.analyze_policy-478"><a href="#DistributionalEngine.analyze_policy-478"><span class="linenos">478</span></a><span class="sd">        - CorporateTaxPolicy: Corporate with incidence assumptions</span>
</span><span id="DistributionalEngine.analyze_policy-479"><a href="#DistributionalEngine.analyze_policy-479"><span class="linenos">479</span></a><span class="sd">        - PayrollTaxPolicy: Payroll tax changes</span>
</span><span id="DistributionalEngine.analyze_policy-480"><a href="#DistributionalEngine.analyze_policy-480"><span class="linenos">480</span></a>
</span><span id="DistributionalEngine.analyze_policy-481"><a href="#DistributionalEngine.analyze_policy-481"><span class="linenos">481</span></a><span class="sd">        Args:</span>
</span><span id="DistributionalEngine.analyze_policy-482"><a href="#DistributionalEngine.analyze_policy-482"><span class="linenos">482</span></a><span class="sd">            policy: Tax policy to analyze</span>
</span><span id="DistributionalEngine.analyze_policy-483"><a href="#DistributionalEngine.analyze_policy-483"><span class="linenos">483</span></a><span class="sd">            group_type: Type of income grouping</span>
</span><span id="DistributionalEngine.analyze_policy-484"><a href="#DistributionalEngine.analyze_policy-484"><span class="linenos">484</span></a><span class="sd">            year: Analysis year (defaults to policy start year)</span>
</span><span id="DistributionalEngine.analyze_policy-485"><a href="#DistributionalEngine.analyze_policy-485"><span class="linenos">485</span></a>
</span><span id="DistributionalEngine.analyze_policy-486"><a href="#DistributionalEngine.analyze_policy-486"><span class="linenos">486</span></a><span class="sd">        Returns:</span>
</span><span id="DistributionalEngine.analyze_policy-487"><a href="#DistributionalEngine.analyze_policy-487"><span class="linenos">487</span></a><span class="sd">            DistributionalAnalysis with results for each income group</span>
</span><span id="DistributionalEngine.analyze_policy-488"><a href="#DistributionalEngine.analyze_policy-488"><span class="linenos">488</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.analyze_policy-489"><a href="#DistributionalEngine.analyze_policy-489"><span class="linenos">489</span></a>        <span class="k">if</span> <span class="n">year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-490"><a href="#DistributionalEngine.analyze_policy-490"><span class="linenos">490</span></a>            <span class="n">year</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;start_year&#39;</span><span class="p">,</span> <span class="mi">2025</span><span class="p">)</span>
</span><span id="DistributionalEngine.analyze_policy-491"><a href="#DistributionalEngine.analyze_policy-491"><span class="linenos">491</span></a>
</span><span id="DistributionalEngine.analyze_policy-492"><a href="#DistributionalEngine.analyze_policy-492"><span class="linenos">492</span></a>        <span class="c1"># Create income groups</span>
</span><span id="DistributionalEngine.analyze_policy-493"><a href="#DistributionalEngine.analyze_policy-493"><span class="linenos">493</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_income_groups</span><span class="p">(</span><span class="n">group_type</span><span class="p">)</span>
</span><span id="DistributionalEngine.analyze_policy-494"><a href="#DistributionalEngine.analyze_policy-494"><span class="linenos">494</span></a>
</span><span id="DistributionalEngine.analyze_policy-495"><a href="#DistributionalEngine.analyze_policy-495"><span class="linenos">495</span></a>        <span class="c1"># Dispatch to appropriate handler based on policy type</span>
</span><span id="DistributionalEngine.analyze_policy-496"><a href="#DistributionalEngine.analyze_policy-496"><span class="linenos">496</span></a>        <span class="n">policy_class_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="DistributionalEngine.analyze_policy-497"><a href="#DistributionalEngine.analyze_policy-497"><span class="linenos">497</span></a>
</span><span id="DistributionalEngine.analyze_policy-498"><a href="#DistributionalEngine.analyze_policy-498"><span class="linenos">498</span></a>        <span class="c1"># Calculate tax change for each group using appropriate handler</span>
</span><span id="DistributionalEngine.analyze_policy-499"><a href="#DistributionalEngine.analyze_policy-499"><span class="linenos">499</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine.analyze_policy-500"><a href="#DistributionalEngine.analyze_policy-500"><span class="linenos">500</span></a>        <span class="n">total_tax_change</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine.analyze_policy-501"><a href="#DistributionalEngine.analyze_policy-501"><span class="linenos">501</span></a>        <span class="n">total_affected</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DistributionalEngine.analyze_policy-502"><a href="#DistributionalEngine.analyze_policy-502"><span class="linenos">502</span></a>
</span><span id="DistributionalEngine.analyze_policy-503"><a href="#DistributionalEngine.analyze_policy-503"><span class="linenos">503</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-504"><a href="#DistributionalEngine.analyze_policy-504"><span class="linenos">504</span></a>            <span class="c1"># Dispatch based on policy type</span>
</span><span id="DistributionalEngine.analyze_policy-505"><a href="#DistributionalEngine.analyze_policy-505"><span class="linenos">505</span></a>            <span class="k">if</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;TaxCreditPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-506"><a href="#DistributionalEngine.analyze_policy-506"><span class="linenos">506</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_credit_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.analyze_policy-507"><a href="#DistributionalEngine.analyze_policy-507"><span class="linenos">507</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;TCJAExtensionPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-508"><a href="#DistributionalEngine.analyze_policy-508"><span class="linenos">508</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_tcja_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.analyze_policy-509"><a href="#DistributionalEngine.analyze_policy-509"><span class="linenos">509</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;CorporateTaxPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-510"><a href="#DistributionalEngine.analyze_policy-510"><span class="linenos">510</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_corporate_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.analyze_policy-511"><a href="#DistributionalEngine.analyze_policy-511"><span class="linenos">511</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;PayrollTaxPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-512"><a href="#DistributionalEngine.analyze_policy-512"><span class="linenos">512</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_payroll_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.analyze_policy-513"><a href="#DistributionalEngine.analyze_policy-513"><span class="linenos">513</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-514"><a href="#DistributionalEngine.analyze_policy-514"><span class="linenos">514</span></a>                <span class="c1"># Default to basic TaxPolicy handling</span>
</span><span id="DistributionalEngine.analyze_policy-515"><a href="#DistributionalEngine.analyze_policy-515"><span class="linenos">515</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_group_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.analyze_policy-516"><a href="#DistributionalEngine.analyze_policy-516"><span class="linenos">516</span></a>
</span><span id="DistributionalEngine.analyze_policy-517"><a href="#DistributionalEngine.analyze_policy-517"><span class="linenos">517</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="DistributionalEngine.analyze_policy-518"><a href="#DistributionalEngine.analyze_policy-518"><span class="linenos">518</span></a>            <span class="n">total_tax_change</span> <span class="o">+=</span> <span class="n">result</span><span class="o">.</span><span class="n">tax_change_total</span>
</span><span id="DistributionalEngine.analyze_policy-519"><a href="#DistributionalEngine.analyze_policy-519"><span class="linenos">519</span></a>            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">pct_with_increase</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">result</span><span class="o">.</span><span class="n">pct_with_decrease</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-520"><a href="#DistributionalEngine.analyze_policy-520"><span class="linenos">520</span></a>                <span class="n">total_affected</span> <span class="o">+=</span> <span class="n">group</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="DistributionalEngine.analyze_policy-521"><a href="#DistributionalEngine.analyze_policy-521"><span class="linenos">521</span></a>
</span><span id="DistributionalEngine.analyze_policy-522"><a href="#DistributionalEngine.analyze_policy-522"><span class="linenos">522</span></a>        <span class="c1"># Calculate share of total change for each group</span>
</span><span id="DistributionalEngine.analyze_policy-523"><a href="#DistributionalEngine.analyze_policy-523"><span class="linenos">523</span></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">total_tax_change</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>  <span class="c1"># Avoid division by zero</span>
</span><span id="DistributionalEngine.analyze_policy-524"><a href="#DistributionalEngine.analyze_policy-524"><span class="linenos">524</span></a>            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="DistributionalEngine.analyze_policy-525"><a href="#DistributionalEngine.analyze_policy-525"><span class="linenos">525</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">share_of_total_change</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">total_tax_change</span>
</span><span id="DistributionalEngine.analyze_policy-526"><a href="#DistributionalEngine.analyze_policy-526"><span class="linenos">526</span></a>
</span><span id="DistributionalEngine.analyze_policy-527"><a href="#DistributionalEngine.analyze_policy-527"><span class="linenos">527</span></a>        <span class="k">return</span> <span class="n">DistributionalAnalysis</span><span class="p">(</span>
</span><span id="DistributionalEngine.analyze_policy-528"><a href="#DistributionalEngine.analyze_policy-528"><span class="linenos">528</span></a>            <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-529"><a href="#DistributionalEngine.analyze_policy-529"><span class="linenos">529</span></a>            <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-530"><a href="#DistributionalEngine.analyze_policy-530"><span class="linenos">530</span></a>            <span class="n">group_type</span><span class="o">=</span><span class="n">group_type</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-531"><a href="#DistributionalEngine.analyze_policy-531"><span class="linenos">531</span></a>            <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-532"><a href="#DistributionalEngine.analyze_policy-532"><span class="linenos">532</span></a>            <span class="n">total_tax_change</span><span class="o">=</span><span class="n">total_tax_change</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-533"><a href="#DistributionalEngine.analyze_policy-533"><span class="linenos">533</span></a>            <span class="n">total_affected_returns</span><span class="o">=</span><span class="n">total_affected</span><span class="p">,</span>
</span><span id="DistributionalEngine.analyze_policy-534"><a href="#DistributionalEngine.analyze_policy-534"><span class="linenos">534</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Analyze distributional effects of a tax policy.</p>

<p>Supports multiple policy types:</p>

<ul>
<li>TaxPolicy: Basic rate change policies</li>
<li>TaxCreditPolicy: CTC, EITC with phase-in/out</li>
<li>TCJAExtensionPolicy: Multi-component package</li>
<li>CorporateTaxPolicy: Corporate with incidence assumptions</li>
<li>PayrollTaxPolicy: Payroll tax changes</li>
</ul>

<p>Args:
    policy: Tax policy to analyze
    group_type: Type of income grouping
    year: Analysis year (defaults to policy start year)</p>

<p>Returns:
    DistributionalAnalysis with results for each income group</p>
</div>


                            </div>
                            <div id="DistributionalEngine.create_top_income_breakout" class="classattr">
                                        <input id="DistributionalEngine.create_top_income_breakout-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_top_income_breakout</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#DistributionalAnalysis">DistributionalAnalysis</a></span>:</span></span>

                <label class="view-source-button" for="DistributionalEngine.create_top_income_breakout-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalEngine.create_top_income_breakout"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalEngine.create_top_income_breakout-1080"><a href="#DistributionalEngine.create_top_income_breakout-1080"><span class="linenos">1080</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_top_income_breakout</span><span class="p">(</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1081"><a href="#DistributionalEngine.create_top_income_breakout-1081"><span class="linenos">1081</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1082"><a href="#DistributionalEngine.create_top_income_breakout-1082"><span class="linenos">1082</span></a>        <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1083"><a href="#DistributionalEngine.create_top_income_breakout-1083"><span class="linenos">1083</span></a>        <span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1084"><a href="#DistributionalEngine.create_top_income_breakout-1084"><span class="linenos">1084</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DistributionalAnalysis</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1085"><a href="#DistributionalEngine.create_top_income_breakout-1085"><span class="linenos">1085</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1086"><a href="#DistributionalEngine.create_top_income_breakout-1086"><span class="linenos">1086</span></a><span class="sd">        Create detailed breakout for top income groups.</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1087"><a href="#DistributionalEngine.create_top_income_breakout-1087"><span class="linenos">1087</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1088"><a href="#DistributionalEngine.create_top_income_breakout-1088"><span class="linenos">1088</span></a><span class="sd">        Includes Top 20%, Top 10%, Top 5%, Top 1%, Top 0.1%.</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1089"><a href="#DistributionalEngine.create_top_income_breakout-1089"><span class="linenos">1089</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1090"><a href="#DistributionalEngine.create_top_income_breakout-1090"><span class="linenos">1090</span></a>        <span class="n">custom_brackets</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1091"><a href="#DistributionalEngine.create_top_income_breakout-1091"><span class="linenos">1091</span></a>            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">),</span>           <span class="c1"># Bottom 80%</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1092"><a href="#DistributionalEngine.create_top_income_breakout-1092"><span class="linenos">1092</span></a>            <span class="p">(</span><span class="mi">170_000</span><span class="p">,</span> <span class="mi">215_000</span><span class="p">),</span>     <span class="c1"># 80-90%</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1093"><a href="#DistributionalEngine.create_top_income_breakout-1093"><span class="linenos">1093</span></a>            <span class="p">(</span><span class="mi">215_000</span><span class="p">,</span> <span class="mi">335_000</span><span class="p">),</span>     <span class="c1"># 90-95%</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1094"><a href="#DistributionalEngine.create_top_income_breakout-1094"><span class="linenos">1094</span></a>            <span class="p">(</span><span class="mi">335_000</span><span class="p">,</span> <span class="mi">800_000</span><span class="p">),</span>     <span class="c1"># 95-99%</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1095"><a href="#DistributionalEngine.create_top_income_breakout-1095"><span class="linenos">1095</span></a>            <span class="p">(</span><span class="mi">800_000</span><span class="p">,</span> <span class="mi">3_500_000</span><span class="p">),</span>   <span class="c1"># 99-99.9%</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1096"><a href="#DistributionalEngine.create_top_income_breakout-1096"><span class="linenos">1096</span></a>            <span class="p">(</span><span class="mi">3_500_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>      <span class="c1"># Top 0.1%</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1097"><a href="#DistributionalEngine.create_top_income_breakout-1097"><span class="linenos">1097</span></a>        <span class="p">]</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1098"><a href="#DistributionalEngine.create_top_income_breakout-1098"><span class="linenos">1098</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1099"><a href="#DistributionalEngine.create_top_income_breakout-1099"><span class="linenos">1099</span></a>        <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1100"><a href="#DistributionalEngine.create_top_income_breakout-1100"><span class="linenos">1100</span></a>            <span class="p">(</span><span class="s2">&quot;Bottom 80%&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1101"><a href="#DistributionalEngine.create_top_income_breakout-1101"><span class="linenos">1101</span></a>            <span class="p">(</span><span class="s2">&quot;80th-90th Percentile&quot;</span><span class="p">,</span> <span class="mi">170_000</span><span class="p">,</span> <span class="mi">215_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1102"><a href="#DistributionalEngine.create_top_income_breakout-1102"><span class="linenos">1102</span></a>            <span class="p">(</span><span class="s2">&quot;90th-95th Percentile&quot;</span><span class="p">,</span> <span class="mi">215_000</span><span class="p">,</span> <span class="mi">335_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1103"><a href="#DistributionalEngine.create_top_income_breakout-1103"><span class="linenos">1103</span></a>            <span class="p">(</span><span class="s2">&quot;95th-99th Percentile&quot;</span><span class="p">,</span> <span class="mi">335_000</span><span class="p">,</span> <span class="mi">800_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1104"><a href="#DistributionalEngine.create_top_income_breakout-1104"><span class="linenos">1104</span></a>            <span class="p">(</span><span class="s2">&quot;Top 1% (excl. 0.1%)&quot;</span><span class="p">,</span> <span class="mi">800_000</span><span class="p">,</span> <span class="mi">3_500_000</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1105"><a href="#DistributionalEngine.create_top_income_breakout-1105"><span class="linenos">1105</span></a>            <span class="p">(</span><span class="s2">&quot;Top 0.1%&quot;</span><span class="p">,</span> <span class="mi">3_500_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1106"><a href="#DistributionalEngine.create_top_income_breakout-1106"><span class="linenos">1106</span></a>        <span class="p">]</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1107"><a href="#DistributionalEngine.create_top_income_breakout-1107"><span class="linenos">1107</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1108"><a href="#DistributionalEngine.create_top_income_breakout-1108"><span class="linenos">1108</span></a>        <span class="c1"># Create custom groups</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1109"><a href="#DistributionalEngine.create_top_income_breakout-1109"><span class="linenos">1109</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1110"><a href="#DistributionalEngine.create_top_income_breakout-1110"><span class="linenos">1110</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceiling</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1111"><a href="#DistributionalEngine.create_top_income_breakout-1111"><span class="linenos">1111</span></a>            <span class="n">group_returns</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1112"><a href="#DistributionalEngine.create_top_income_breakout-1112"><span class="linenos">1112</span></a>            <span class="n">group_agi</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1113"><a href="#DistributionalEngine.create_top_income_breakout-1113"><span class="linenos">1113</span></a>            <span class="n">group_taxable</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1114"><a href="#DistributionalEngine.create_top_income_breakout-1114"><span class="linenos">1114</span></a>            <span class="n">group_tax</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1115"><a href="#DistributionalEngine.create_top_income_breakout-1115"><span class="linenos">1115</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1116"><a href="#DistributionalEngine.create_top_income_breakout-1116"><span class="linenos">1116</span></a>            <span class="k">for</span> <span class="n">bracket</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brackets</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1117"><a href="#DistributionalEngine.create_top_income_breakout-1117"><span class="linenos">1117</span></a>                <span class="n">bracket_floor</span> <span class="o">=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_floor</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1118"><a href="#DistributionalEngine.create_top_income_breakout-1118"><span class="linenos">1118</span></a>                <span class="n">bracket_ceiling</span> <span class="o">=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_ceiling</span> <span class="k">if</span> <span class="n">bracket</span><span class="o">.</span><span class="n">agi_ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1119"><a href="#DistributionalEngine.create_top_income_breakout-1119"><span class="linenos">1119</span></a>                <span class="n">group_ceiling</span> <span class="o">=</span> <span class="n">ceiling</span> <span class="k">if</span> <span class="n">ceiling</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1120"><a href="#DistributionalEngine.create_top_income_breakout-1120"><span class="linenos">1120</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1121"><a href="#DistributionalEngine.create_top_income_breakout-1121"><span class="linenos">1121</span></a>                <span class="k">if</span> <span class="n">bracket_floor</span> <span class="o">&gt;=</span> <span class="n">floor</span> <span class="ow">and</span> <span class="n">bracket_floor</span> <span class="o">&lt;</span> <span class="n">group_ceiling</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1122"><a href="#DistributionalEngine.create_top_income_breakout-1122"><span class="linenos">1122</span></a>                    <span class="k">if</span> <span class="n">ceiling</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">bracket_ceiling</span> <span class="o">&lt;=</span> <span class="n">group_ceiling</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1123"><a href="#DistributionalEngine.create_top_income_breakout-1123"><span class="linenos">1123</span></a>                        <span class="n">group_returns</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1124"><a href="#DistributionalEngine.create_top_income_breakout-1124"><span class="linenos">1124</span></a>                        <span class="n">group_agi</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">total_agi</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1125"><a href="#DistributionalEngine.create_top_income_breakout-1125"><span class="linenos">1125</span></a>                        <span class="n">group_taxable</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">taxable_income</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1126"><a href="#DistributionalEngine.create_top_income_breakout-1126"><span class="linenos">1126</span></a>                        <span class="n">group_tax</span> <span class="o">+=</span> <span class="n">bracket</span><span class="o">.</span><span class="n">total_tax</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1127"><a href="#DistributionalEngine.create_top_income_breakout-1127"><span class="linenos">1127</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1128"><a href="#DistributionalEngine.create_top_income_breakout-1128"><span class="linenos">1128</span></a>            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IncomeGroup</span><span class="p">(</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1129"><a href="#DistributionalEngine.create_top_income_breakout-1129"><span class="linenos">1129</span></a>                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1130"><a href="#DistributionalEngine.create_top_income_breakout-1130"><span class="linenos">1130</span></a>                <span class="n">floor</span><span class="o">=</span><span class="n">floor</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1131"><a href="#DistributionalEngine.create_top_income_breakout-1131"><span class="linenos">1131</span></a>                <span class="n">ceiling</span><span class="o">=</span><span class="n">ceiling</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1132"><a href="#DistributionalEngine.create_top_income_breakout-1132"><span class="linenos">1132</span></a>                <span class="n">num_returns</span><span class="o">=</span><span class="n">group_returns</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1133"><a href="#DistributionalEngine.create_top_income_breakout-1133"><span class="linenos">1133</span></a>                <span class="n">total_agi</span><span class="o">=</span><span class="n">group_agi</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1134"><a href="#DistributionalEngine.create_top_income_breakout-1134"><span class="linenos">1134</span></a>                <span class="n">total_taxable_income</span><span class="o">=</span><span class="n">group_taxable</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1135"><a href="#DistributionalEngine.create_top_income_breakout-1135"><span class="linenos">1135</span></a>                <span class="n">baseline_tax</span><span class="o">=</span><span class="n">group_tax</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1136"><a href="#DistributionalEngine.create_top_income_breakout-1136"><span class="linenos">1136</span></a>                <span class="n">population_share</span><span class="o">=</span><span class="n">group_returns</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_returns</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1137"><a href="#DistributionalEngine.create_top_income_breakout-1137"><span class="linenos">1137</span></a>            <span class="p">))</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1138"><a href="#DistributionalEngine.create_top_income_breakout-1138"><span class="linenos">1138</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1139"><a href="#DistributionalEngine.create_top_income_breakout-1139"><span class="linenos">1139</span></a>        <span class="c1"># Analyze policy for these groups</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1140"><a href="#DistributionalEngine.create_top_income_breakout-1140"><span class="linenos">1140</span></a>        <span class="k">if</span> <span class="n">year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1141"><a href="#DistributionalEngine.create_top_income_breakout-1141"><span class="linenos">1141</span></a>            <span class="n">year</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="s1">&#39;start_year&#39;</span><span class="p">,</span> <span class="mi">2025</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1142"><a href="#DistributionalEngine.create_top_income_breakout-1142"><span class="linenos">1142</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1143"><a href="#DistributionalEngine.create_top_income_breakout-1143"><span class="linenos">1143</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1144"><a href="#DistributionalEngine.create_top_income_breakout-1144"><span class="linenos">1144</span></a>        <span class="n">total_tax_change</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1145"><a href="#DistributionalEngine.create_top_income_breakout-1145"><span class="linenos">1145</span></a>        <span class="n">policy_class_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1146"><a href="#DistributionalEngine.create_top_income_breakout-1146"><span class="linenos">1146</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1147"><a href="#DistributionalEngine.create_top_income_breakout-1147"><span class="linenos">1147</span></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1148"><a href="#DistributionalEngine.create_top_income_breakout-1148"><span class="linenos">1148</span></a>            <span class="c1"># Dispatch based on policy type</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1149"><a href="#DistributionalEngine.create_top_income_breakout-1149"><span class="linenos">1149</span></a>            <span class="k">if</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;TaxCreditPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1150"><a href="#DistributionalEngine.create_top_income_breakout-1150"><span class="linenos">1150</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_credit_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1151"><a href="#DistributionalEngine.create_top_income_breakout-1151"><span class="linenos">1151</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;TCJAExtensionPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1152"><a href="#DistributionalEngine.create_top_income_breakout-1152"><span class="linenos">1152</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_tcja_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1153"><a href="#DistributionalEngine.create_top_income_breakout-1153"><span class="linenos">1153</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;CorporateTaxPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1154"><a href="#DistributionalEngine.create_top_income_breakout-1154"><span class="linenos">1154</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_corporate_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1155"><a href="#DistributionalEngine.create_top_income_breakout-1155"><span class="linenos">1155</span></a>            <span class="k">elif</span> <span class="n">policy_class_name</span> <span class="o">==</span> <span class="s2">&quot;PayrollTaxPolicy&quot;</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1156"><a href="#DistributionalEngine.create_top_income_breakout-1156"><span class="linenos">1156</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_payroll_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1157"><a href="#DistributionalEngine.create_top_income_breakout-1157"><span class="linenos">1157</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1158"><a href="#DistributionalEngine.create_top_income_breakout-1158"><span class="linenos">1158</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_group_effect</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1159"><a href="#DistributionalEngine.create_top_income_breakout-1159"><span class="linenos">1159</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1160"><a href="#DistributionalEngine.create_top_income_breakout-1160"><span class="linenos">1160</span></a>            <span class="n">total_tax_change</span> <span class="o">+=</span> <span class="n">result</span><span class="o">.</span><span class="n">tax_change_total</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1161"><a href="#DistributionalEngine.create_top_income_breakout-1161"><span class="linenos">1161</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1162"><a href="#DistributionalEngine.create_top_income_breakout-1162"><span class="linenos">1162</span></a>        <span class="c1"># Calculate share of total change</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1163"><a href="#DistributionalEngine.create_top_income_breakout-1163"><span class="linenos">1163</span></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">total_tax_change</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1164"><a href="#DistributionalEngine.create_top_income_breakout-1164"><span class="linenos">1164</span></a>            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1165"><a href="#DistributionalEngine.create_top_income_breakout-1165"><span class="linenos">1165</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">share_of_total_change</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">tax_change_total</span> <span class="o">/</span> <span class="n">total_tax_change</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1166"><a href="#DistributionalEngine.create_top_income_breakout-1166"><span class="linenos">1166</span></a>
</span><span id="DistributionalEngine.create_top_income_breakout-1167"><a href="#DistributionalEngine.create_top_income_breakout-1167"><span class="linenos">1167</span></a>        <span class="k">return</span> <span class="n">DistributionalAnalysis</span><span class="p">(</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1168"><a href="#DistributionalEngine.create_top_income_breakout-1168"><span class="linenos">1168</span></a>            <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1169"><a href="#DistributionalEngine.create_top_income_breakout-1169"><span class="linenos">1169</span></a>            <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1170"><a href="#DistributionalEngine.create_top_income_breakout-1170"><span class="linenos">1170</span></a>            <span class="n">group_type</span><span class="o">=</span><span class="n">IncomeGroupType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1171"><a href="#DistributionalEngine.create_top_income_breakout-1171"><span class="linenos">1171</span></a>            <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1172"><a href="#DistributionalEngine.create_top_income_breakout-1172"><span class="linenos">1172</span></a>            <span class="n">total_tax_change</span><span class="o">=</span><span class="n">total_tax_change</span><span class="p">,</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1173"><a href="#DistributionalEngine.create_top_income_breakout-1173"><span class="linenos">1173</span></a>            <span class="n">total_affected_returns</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">num_returns</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">),</span>
</span><span id="DistributionalEngine.create_top_income_breakout-1174"><a href="#DistributionalEngine.create_top_income_breakout-1174"><span class="linenos">1174</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create detailed breakout for top income groups.</p>

<p>Includes Top 20%, Top 10%, Top 5%, Top 1%, Top 0.1%.</p>
</div>


                            </div>
                </section>
                <section id="DistributionalAnalysis">
                            <input id="DistributionalAnalysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">DistributionalAnalysis</span>:

                <label class="view-source-button" for="DistributionalAnalysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalAnalysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalAnalysis-185"><a href="#DistributionalAnalysis-185"><span class="linenos">185</span></a><span class="nd">@dataclass</span>
</span><span id="DistributionalAnalysis-186"><a href="#DistributionalAnalysis-186"><span class="linenos">186</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DistributionalAnalysis</span><span class="p">:</span>
</span><span id="DistributionalAnalysis-187"><a href="#DistributionalAnalysis-187"><span class="linenos">187</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis-188"><a href="#DistributionalAnalysis-188"><span class="linenos">188</span></a><span class="sd">    Complete distributional analysis of a tax policy.</span>
</span><span id="DistributionalAnalysis-189"><a href="#DistributionalAnalysis-189"><span class="linenos">189</span></a>
</span><span id="DistributionalAnalysis-190"><a href="#DistributionalAnalysis-190"><span class="linenos">190</span></a><span class="sd">    Attributes:</span>
</span><span id="DistributionalAnalysis-191"><a href="#DistributionalAnalysis-191"><span class="linenos">191</span></a><span class="sd">        policy: The policy being analyzed</span>
</span><span id="DistributionalAnalysis-192"><a href="#DistributionalAnalysis-192"><span class="linenos">192</span></a><span class="sd">        year: Analysis year</span>
</span><span id="DistributionalAnalysis-193"><a href="#DistributionalAnalysis-193"><span class="linenos">193</span></a><span class="sd">        group_type: Type of income grouping used</span>
</span><span id="DistributionalAnalysis-194"><a href="#DistributionalAnalysis-194"><span class="linenos">194</span></a><span class="sd">        results: List of DistributionalResult for each income group</span>
</span><span id="DistributionalAnalysis-195"><a href="#DistributionalAnalysis-195"><span class="linenos">195</span></a><span class="sd">        total_tax_change: Total tax change across all groups (billions)</span>
</span><span id="DistributionalAnalysis-196"><a href="#DistributionalAnalysis-196"><span class="linenos">196</span></a><span class="sd">        total_affected_returns: Number of returns affected</span>
</span><span id="DistributionalAnalysis-197"><a href="#DistributionalAnalysis-197"><span class="linenos">197</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis-198"><a href="#DistributionalAnalysis-198"><span class="linenos">198</span></a>    <span class="n">policy</span><span class="p">:</span> <span class="n">Policy</span>
</span><span id="DistributionalAnalysis-199"><a href="#DistributionalAnalysis-199"><span class="linenos">199</span></a>    <span class="n">year</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="DistributionalAnalysis-200"><a href="#DistributionalAnalysis-200"><span class="linenos">200</span></a>    <span class="n">group_type</span><span class="p">:</span> <span class="n">IncomeGroupType</span>
</span><span id="DistributionalAnalysis-201"><a href="#DistributionalAnalysis-201"><span class="linenos">201</span></a>    <span class="n">results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DistributionalResult</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="DistributionalAnalysis-202"><a href="#DistributionalAnalysis-202"><span class="linenos">202</span></a>    <span class="n">total_tax_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalAnalysis-203"><a href="#DistributionalAnalysis-203"><span class="linenos">203</span></a>    <span class="n">total_affected_returns</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DistributionalAnalysis-204"><a href="#DistributionalAnalysis-204"><span class="linenos">204</span></a>
</span><span id="DistributionalAnalysis-205"><a href="#DistributionalAnalysis-205"><span class="linenos">205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_winners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">DistributionalResult</span><span class="p">]:</span>
</span><span id="DistributionalAnalysis-206"><a href="#DistributionalAnalysis-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get income groups that receive a net tax cut.&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis-207"><a href="#DistributionalAnalysis-207"><span class="linenos">207</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="DistributionalAnalysis-208"><a href="#DistributionalAnalysis-208"><span class="linenos">208</span></a>
</span><span id="DistributionalAnalysis-209"><a href="#DistributionalAnalysis-209"><span class="linenos">209</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_losers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">DistributionalResult</span><span class="p">]:</span>
</span><span id="DistributionalAnalysis-210"><a href="#DistributionalAnalysis-210"><span class="linenos">210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get income groups that face a net tax increase.&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis-211"><a href="#DistributionalAnalysis-211"><span class="linenos">211</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="DistributionalAnalysis-212"><a href="#DistributionalAnalysis-212"><span class="linenos">212</span></a>
</span><span id="DistributionalAnalysis-213"><a href="#DistributionalAnalysis-213"><span class="linenos">213</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DistributionalAnalysis-214"><a href="#DistributionalAnalysis-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert results to a pandas DataFrame for display.&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis-215"><a href="#DistributionalAnalysis-215"><span class="linenos">215</span></a>        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalAnalysis-216"><a href="#DistributionalAnalysis-216"><span class="linenos">216</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">:</span>
</span><span id="DistributionalAnalysis-217"><a href="#DistributionalAnalysis-217"><span class="linenos">217</span></a>            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="DistributionalAnalysis-218"><a href="#DistributionalAnalysis-218"><span class="linenos">218</span></a>                <span class="s2">&quot;Income Group&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-219"><a href="#DistributionalAnalysis-219"><span class="linenos">219</span></a>                <span class="s2">&quot;AGI Range&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">floor</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span>
</span><span id="DistributionalAnalysis-220"><a href="#DistributionalAnalysis-220"><span class="linenos">220</span></a>                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-$</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">ceiling</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span>
</span><span id="DistributionalAnalysis-221"><a href="#DistributionalAnalysis-221"><span class="linenos">221</span></a>                <span class="s2">&quot;Returns (M)&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-222"><a href="#DistributionalAnalysis-222"><span class="linenos">222</span></a>                <span class="s2">&quot;Avg AGI&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">avg_agi</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-223"><a href="#DistributionalAnalysis-223"><span class="linenos">223</span></a>                <span class="s2">&quot;Tax Change ($B)&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_total</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-224"><a href="#DistributionalAnalysis-224"><span class="linenos">224</span></a>                <span class="s2">&quot;Avg Tax Change ($)&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-225"><a href="#DistributionalAnalysis-225"><span class="linenos">225</span></a>                <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f Income&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_pct_income</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-226"><a href="#DistributionalAnalysis-226"><span class="linenos">226</span></a>                <span class="s2">&quot;Share of Total&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">share_of_total_change</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-227"><a href="#DistributionalAnalysis-227"><span class="linenos">227</span></a>                <span class="s2">&quot;% Tax Increase&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">pct_with_increase</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-228"><a href="#DistributionalAnalysis-228"><span class="linenos">228</span></a>                <span class="s2">&quot;% Tax Decrease&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">pct_with_decrease</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-229"><a href="#DistributionalAnalysis-229"><span class="linenos">229</span></a>                <span class="s2">&quot;Baseline ETR&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">baseline_etr</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-230"><a href="#DistributionalAnalysis-230"><span class="linenos">230</span></a>                <span class="s2">&quot;New ETR&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">new_etr</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-231"><a href="#DistributionalAnalysis-231"><span class="linenos">231</span></a>                <span class="s2">&quot;ETR Change (ppts)&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">etr_change</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-232"><a href="#DistributionalAnalysis-232"><span class="linenos">232</span></a>            <span class="p">})</span>
</span><span id="DistributionalAnalysis-233"><a href="#DistributionalAnalysis-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</span><span id="DistributionalAnalysis-234"><a href="#DistributionalAnalysis-234"><span class="linenos">234</span></a>
</span><span id="DistributionalAnalysis-235"><a href="#DistributionalAnalysis-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DistributionalAnalysis-236"><a href="#DistributionalAnalysis-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate text summary of distributional effects.&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis-237"><a href="#DistributionalAnalysis-237"><span class="linenos">237</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalAnalysis-238"><a href="#DistributionalAnalysis-238"><span class="linenos">238</span></a>            <span class="sa">f</span><span class="s2">&quot;Distributional Analysis: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-239"><a href="#DistributionalAnalysis-239"><span class="linenos">239</span></a>            <span class="sa">f</span><span class="s2">&quot;Year: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-240"><a href="#DistributionalAnalysis-240"><span class="linenos">240</span></a>            <span class="sa">f</span><span class="s2">&quot;Grouping: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">group_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-241"><a href="#DistributionalAnalysis-241"><span class="linenos">241</span></a>            <span class="sa">f</span><span class="s2">&quot;Total Tax Change: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_tax_change</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-242"><a href="#DistributionalAnalysis-242"><span class="linenos">242</span></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-243"><a href="#DistributionalAnalysis-243"><span class="linenos">243</span></a>            <span class="s2">&quot;By Income Group:&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-244"><a href="#DistributionalAnalysis-244"><span class="linenos">244</span></a>            <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">,</span>
</span><span id="DistributionalAnalysis-245"><a href="#DistributionalAnalysis-245"><span class="linenos">245</span></a>        <span class="p">]</span>
</span><span id="DistributionalAnalysis-246"><a href="#DistributionalAnalysis-246"><span class="linenos">246</span></a>
</span><span id="DistributionalAnalysis-247"><a href="#DistributionalAnalysis-247"><span class="linenos">247</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">:</span>
</span><span id="DistributionalAnalysis-248"><a href="#DistributionalAnalysis-248"><span class="linenos">248</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="DistributionalAnalysis-249"><a href="#DistributionalAnalysis-249"><span class="linenos">249</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="DistributionalAnalysis-250"><a href="#DistributionalAnalysis-250"><span class="linenos">250</span></a>                <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s2">20s</span><span class="si">}</span><span class="s2">: &quot;</span>
</span><span id="DistributionalAnalysis-251"><a href="#DistributionalAnalysis-251"><span class="linenos">251</span></a>                <span class="sa">f</span><span class="s2">&quot;Avg change </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s2">$</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="DistributionalAnalysis-252"><a href="#DistributionalAnalysis-252"><span class="linenos">252</span></a>                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">share_of_total_change</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of total)&quot;</span>
</span><span id="DistributionalAnalysis-253"><a href="#DistributionalAnalysis-253"><span class="linenos">253</span></a>            <span class="p">)</span>
</span><span id="DistributionalAnalysis-254"><a href="#DistributionalAnalysis-254"><span class="linenos">254</span></a>
</span><span id="DistributionalAnalysis-255"><a href="#DistributionalAnalysis-255"><span class="linenos">255</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Complete distributional analysis of a tax policy.</p>

<p>Attributes:
    policy: The policy being analyzed
    year: Analysis year
    group_type: Type of income grouping used
    results: List of DistributionalResult for each income group
    total_tax_change: Total tax change across all groups (billions)
    total_affected_returns: Number of returns affected</p>
</div>


                            <div id="DistributionalAnalysis.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">DistributionalAnalysis</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">policy</span><span class="p">:</span> <span class="n"><a href="#Policy">Policy</a></span>,</span><span class="param">	<span class="n">year</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">group_type</span><span class="p">:</span> <span class="n"><a href="#IncomeGroupType">IncomeGroupType</a></span>,</span><span class="param">	<span class="n">results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n"><a href="#DistributionalResult">DistributionalResult</a></span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">total_tax_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">total_affected_returns</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DistributionalAnalysis.__init__"></a>
    
    

                            </div>
                            <div id="DistributionalAnalysis.policy" class="classattr">
                                <div class="attr variable">
            <span class="name">policy</span><span class="annotation">: <a href="#Policy">Policy</a></span>

        
    </div>
    <a class="headerlink" href="#DistributionalAnalysis.policy"></a>
    
    

                            </div>
                            <div id="DistributionalAnalysis.year" class="classattr">
                                <div class="attr variable">
            <span class="name">year</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#DistributionalAnalysis.year"></a>
    
    

                            </div>
                            <div id="DistributionalAnalysis.group_type" class="classattr">
                                <div class="attr variable">
            <span class="name">group_type</span><span class="annotation">: <a href="#IncomeGroupType">IncomeGroupType</a></span>

        
    </div>
    <a class="headerlink" href="#DistributionalAnalysis.group_type"></a>
    
    

                            </div>
                            <div id="DistributionalAnalysis.results" class="classattr">
                                <div class="attr variable">
            <span class="name">results</span><span class="annotation">: List[<a href="#DistributionalResult">DistributionalResult</a>]</span>

        
    </div>
    <a class="headerlink" href="#DistributionalAnalysis.results"></a>
    
    

                            </div>
                            <div id="DistributionalAnalysis.total_tax_change" class="classattr">
                                <div class="attr variable">
            <span class="name">total_tax_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalAnalysis.total_tax_change"></a>
    
    

                            </div>
                            <div id="DistributionalAnalysis.total_affected_returns" class="classattr">
                                <div class="attr variable">
            <span class="name">total_affected_returns</span><span class="annotation">: int</span>        =
<span class="default_value">0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalAnalysis.total_affected_returns"></a>
    
    

                            </div>
                            <div id="DistributionalAnalysis.get_winners" class="classattr">
                                        <input id="DistributionalAnalysis.get_winners-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_winners</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n"><a href="#DistributionalResult">DistributionalResult</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DistributionalAnalysis.get_winners-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalAnalysis.get_winners"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalAnalysis.get_winners-205"><a href="#DistributionalAnalysis.get_winners-205"><span class="linenos">205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_winners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">DistributionalResult</span><span class="p">]:</span>
</span><span id="DistributionalAnalysis.get_winners-206"><a href="#DistributionalAnalysis.get_winners-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get income groups that receive a net tax cut.&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis.get_winners-207"><a href="#DistributionalAnalysis.get_winners-207"><span class="linenos">207</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get income groups that receive a net tax cut.</p>
</div>


                            </div>
                            <div id="DistributionalAnalysis.get_losers" class="classattr">
                                        <input id="DistributionalAnalysis.get_losers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_losers</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n"><a href="#DistributionalResult">DistributionalResult</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DistributionalAnalysis.get_losers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalAnalysis.get_losers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalAnalysis.get_losers-209"><a href="#DistributionalAnalysis.get_losers-209"><span class="linenos">209</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_losers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">DistributionalResult</span><span class="p">]:</span>
</span><span id="DistributionalAnalysis.get_losers-210"><a href="#DistributionalAnalysis.get_losers-210"><span class="linenos">210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get income groups that face a net tax increase.&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis.get_losers-211"><a href="#DistributionalAnalysis.get_losers-211"><span class="linenos">211</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get income groups that face a net tax increase.</p>
</div>


                            </div>
                            <div id="DistributionalAnalysis.to_dataframe" class="classattr">
                                        <input id="DistributionalAnalysis.to_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DistributionalAnalysis.to_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalAnalysis.to_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalAnalysis.to_dataframe-213"><a href="#DistributionalAnalysis.to_dataframe-213"><span class="linenos">213</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DistributionalAnalysis.to_dataframe-214"><a href="#DistributionalAnalysis.to_dataframe-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert results to a pandas DataFrame for display.&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis.to_dataframe-215"><a href="#DistributionalAnalysis.to_dataframe-215"><span class="linenos">215</span></a>        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DistributionalAnalysis.to_dataframe-216"><a href="#DistributionalAnalysis.to_dataframe-216"><span class="linenos">216</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">:</span>
</span><span id="DistributionalAnalysis.to_dataframe-217"><a href="#DistributionalAnalysis.to_dataframe-217"><span class="linenos">217</span></a>            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="DistributionalAnalysis.to_dataframe-218"><a href="#DistributionalAnalysis.to_dataframe-218"><span class="linenos">218</span></a>                <span class="s2">&quot;Income Group&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-219"><a href="#DistributionalAnalysis.to_dataframe-219"><span class="linenos">219</span></a>                <span class="s2">&quot;AGI Range&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">floor</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span>
</span><span id="DistributionalAnalysis.to_dataframe-220"><a href="#DistributionalAnalysis.to_dataframe-220"><span class="linenos">220</span></a>                            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-$</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">ceiling</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span><span class="p">),</span>
</span><span id="DistributionalAnalysis.to_dataframe-221"><a href="#DistributionalAnalysis.to_dataframe-221"><span class="linenos">221</span></a>                <span class="s2">&quot;Returns (M)&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-222"><a href="#DistributionalAnalysis.to_dataframe-222"><span class="linenos">222</span></a>                <span class="s2">&quot;Avg AGI&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">avg_agi</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-223"><a href="#DistributionalAnalysis.to_dataframe-223"><span class="linenos">223</span></a>                <span class="s2">&quot;Tax Change ($B)&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_total</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-224"><a href="#DistributionalAnalysis.to_dataframe-224"><span class="linenos">224</span></a>                <span class="s2">&quot;Avg Tax Change ($)&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-225"><a href="#DistributionalAnalysis.to_dataframe-225"><span class="linenos">225</span></a>                <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f Income&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_pct_income</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-226"><a href="#DistributionalAnalysis.to_dataframe-226"><span class="linenos">226</span></a>                <span class="s2">&quot;Share of Total&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">share_of_total_change</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-227"><a href="#DistributionalAnalysis.to_dataframe-227"><span class="linenos">227</span></a>                <span class="s2">&quot;% Tax Increase&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">pct_with_increase</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-228"><a href="#DistributionalAnalysis.to_dataframe-228"><span class="linenos">228</span></a>                <span class="s2">&quot;% Tax Decrease&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">pct_with_decrease</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-229"><a href="#DistributionalAnalysis.to_dataframe-229"><span class="linenos">229</span></a>                <span class="s2">&quot;Baseline ETR&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">baseline_etr</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-230"><a href="#DistributionalAnalysis.to_dataframe-230"><span class="linenos">230</span></a>                <span class="s2">&quot;New ETR&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">new_etr</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-231"><a href="#DistributionalAnalysis.to_dataframe-231"><span class="linenos">231</span></a>                <span class="s2">&quot;ETR Change (ppts)&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">etr_change</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.to_dataframe-232"><a href="#DistributionalAnalysis.to_dataframe-232"><span class="linenos">232</span></a>            <span class="p">})</span>
</span><span id="DistributionalAnalysis.to_dataframe-233"><a href="#DistributionalAnalysis.to_dataframe-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert results to a pandas DataFrame for display.</p>
</div>


                            </div>
                            <div id="DistributionalAnalysis.summary" class="classattr">
                                        <input id="DistributionalAnalysis.summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="DistributionalAnalysis.summary-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalAnalysis.summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalAnalysis.summary-235"><a href="#DistributionalAnalysis.summary-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DistributionalAnalysis.summary-236"><a href="#DistributionalAnalysis.summary-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate text summary of distributional effects.&quot;&quot;&quot;</span>
</span><span id="DistributionalAnalysis.summary-237"><a href="#DistributionalAnalysis.summary-237"><span class="linenos">237</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DistributionalAnalysis.summary-238"><a href="#DistributionalAnalysis.summary-238"><span class="linenos">238</span></a>            <span class="sa">f</span><span class="s2">&quot;Distributional Analysis: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.summary-239"><a href="#DistributionalAnalysis.summary-239"><span class="linenos">239</span></a>            <span class="sa">f</span><span class="s2">&quot;Year: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.summary-240"><a href="#DistributionalAnalysis.summary-240"><span class="linenos">240</span></a>            <span class="sa">f</span><span class="s2">&quot;Grouping: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">group_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.summary-241"><a href="#DistributionalAnalysis.summary-241"><span class="linenos">241</span></a>            <span class="sa">f</span><span class="s2">&quot;Total Tax Change: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_tax_change</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">B&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.summary-242"><a href="#DistributionalAnalysis.summary-242"><span class="linenos">242</span></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.summary-243"><a href="#DistributionalAnalysis.summary-243"><span class="linenos">243</span></a>            <span class="s2">&quot;By Income Group:&quot;</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.summary-244"><a href="#DistributionalAnalysis.summary-244"><span class="linenos">244</span></a>            <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">,</span>
</span><span id="DistributionalAnalysis.summary-245"><a href="#DistributionalAnalysis.summary-245"><span class="linenos">245</span></a>        <span class="p">]</span>
</span><span id="DistributionalAnalysis.summary-246"><a href="#DistributionalAnalysis.summary-246"><span class="linenos">246</span></a>
</span><span id="DistributionalAnalysis.summary-247"><a href="#DistributionalAnalysis.summary-247"><span class="linenos">247</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">:</span>
</span><span id="DistributionalAnalysis.summary-248"><a href="#DistributionalAnalysis.summary-248"><span class="linenos">248</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="DistributionalAnalysis.summary-249"><a href="#DistributionalAnalysis.summary-249"><span class="linenos">249</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="DistributionalAnalysis.summary-250"><a href="#DistributionalAnalysis.summary-250"><span class="linenos">250</span></a>                <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">name</span><span class="si">:</span><span class="s2">20s</span><span class="si">}</span><span class="s2">: &quot;</span>
</span><span id="DistributionalAnalysis.summary-251"><a href="#DistributionalAnalysis.summary-251"><span class="linenos">251</span></a>                <span class="sa">f</span><span class="s2">&quot;Avg change </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s2">$</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="DistributionalAnalysis.summary-252"><a href="#DistributionalAnalysis.summary-252"><span class="linenos">252</span></a>                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">share_of_total_change</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of total)&quot;</span>
</span><span id="DistributionalAnalysis.summary-253"><a href="#DistributionalAnalysis.summary-253"><span class="linenos">253</span></a>            <span class="p">)</span>
</span><span id="DistributionalAnalysis.summary-254"><a href="#DistributionalAnalysis.summary-254"><span class="linenos">254</span></a>
</span><span id="DistributionalAnalysis.summary-255"><a href="#DistributionalAnalysis.summary-255"><span class="linenos">255</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate text summary of distributional effects.</p>
</div>


                            </div>
                </section>
                <section id="DistributionalResult">
                            <input id="DistributionalResult-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">DistributionalResult</span>:

                <label class="view-source-button" for="DistributionalResult-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DistributionalResult"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DistributionalResult-154"><a href="#DistributionalResult-154"><span class="linenos">154</span></a><span class="nd">@dataclass</span>
</span><span id="DistributionalResult-155"><a href="#DistributionalResult-155"><span class="linenos">155</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DistributionalResult</span><span class="p">:</span>
</span><span id="DistributionalResult-156"><a href="#DistributionalResult-156"><span class="linenos">156</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DistributionalResult-157"><a href="#DistributionalResult-157"><span class="linenos">157</span></a><span class="sd">    Result of distributional analysis for one income group.</span>
</span><span id="DistributionalResult-158"><a href="#DistributionalResult-158"><span class="linenos">158</span></a>
</span><span id="DistributionalResult-159"><a href="#DistributionalResult-159"><span class="linenos">159</span></a><span class="sd">    Attributes:</span>
</span><span id="DistributionalResult-160"><a href="#DistributionalResult-160"><span class="linenos">160</span></a><span class="sd">        income_group: The income group analyzed</span>
</span><span id="DistributionalResult-161"><a href="#DistributionalResult-161"><span class="linenos">161</span></a><span class="sd">        tax_change_total: Total tax change for this group (billions)</span>
</span><span id="DistributionalResult-162"><a href="#DistributionalResult-162"><span class="linenos">162</span></a><span class="sd">        tax_change_avg: Average tax change per return (dollars)</span>
</span><span id="DistributionalResult-163"><a href="#DistributionalResult-163"><span class="linenos">163</span></a><span class="sd">        tax_change_pct_income: Tax change as % of after-tax income</span>
</span><span id="DistributionalResult-164"><a href="#DistributionalResult-164"><span class="linenos">164</span></a><span class="sd">        share_of_total_change: This group&#39;s share of total tax change (0-1)</span>
</span><span id="DistributionalResult-165"><a href="#DistributionalResult-165"><span class="linenos">165</span></a><span class="sd">        pct_with_increase: Percent of filers with tax increase (0-100)</span>
</span><span id="DistributionalResult-166"><a href="#DistributionalResult-166"><span class="linenos">166</span></a><span class="sd">        pct_with_decrease: Percent of filers with tax decrease (0-100)</span>
</span><span id="DistributionalResult-167"><a href="#DistributionalResult-167"><span class="linenos">167</span></a><span class="sd">        pct_unchanged: Percent of filers with no change (0-100)</span>
</span><span id="DistributionalResult-168"><a href="#DistributionalResult-168"><span class="linenos">168</span></a><span class="sd">        baseline_etr: Baseline effective tax rate (0-1)</span>
</span><span id="DistributionalResult-169"><a href="#DistributionalResult-169"><span class="linenos">169</span></a><span class="sd">        new_etr: New effective tax rate after policy (0-1)</span>
</span><span id="DistributionalResult-170"><a href="#DistributionalResult-170"><span class="linenos">170</span></a><span class="sd">        etr_change: Change in effective tax rate (ppts)</span>
</span><span id="DistributionalResult-171"><a href="#DistributionalResult-171"><span class="linenos">171</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DistributionalResult-172"><a href="#DistributionalResult-172"><span class="linenos">172</span></a>    <span class="n">income_group</span><span class="p">:</span> <span class="n">IncomeGroup</span>
</span><span id="DistributionalResult-173"><a href="#DistributionalResult-173"><span class="linenos">173</span></a>    <span class="n">tax_change_total</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalResult-174"><a href="#DistributionalResult-174"><span class="linenos">174</span></a>    <span class="n">tax_change_avg</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalResult-175"><a href="#DistributionalResult-175"><span class="linenos">175</span></a>    <span class="n">tax_change_pct_income</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalResult-176"><a href="#DistributionalResult-176"><span class="linenos">176</span></a>    <span class="n">share_of_total_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalResult-177"><a href="#DistributionalResult-177"><span class="linenos">177</span></a>    <span class="n">pct_with_increase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalResult-178"><a href="#DistributionalResult-178"><span class="linenos">178</span></a>    <span class="n">pct_with_decrease</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalResult-179"><a href="#DistributionalResult-179"><span class="linenos">179</span></a>    <span class="n">pct_unchanged</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">100.0</span>
</span><span id="DistributionalResult-180"><a href="#DistributionalResult-180"><span class="linenos">180</span></a>    <span class="n">baseline_etr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalResult-181"><a href="#DistributionalResult-181"><span class="linenos">181</span></a>    <span class="n">new_etr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DistributionalResult-182"><a href="#DistributionalResult-182"><span class="linenos">182</span></a>    <span class="n">etr_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span></pre></div>


            <div class="docstring"><p>Result of distributional analysis for one income group.</p>

<p>Attributes:
    income_group: The income group analyzed
    tax_change_total: Total tax change for this group (billions)
    tax_change_avg: Average tax change per return (dollars)
    tax_change_pct_income: Tax change as % of after-tax income
    share_of_total_change: This group's share of total tax change (0-1)
    pct_with_increase: Percent of filers with tax increase (0-100)
    pct_with_decrease: Percent of filers with tax decrease (0-100)
    pct_unchanged: Percent of filers with no change (0-100)
    baseline_etr: Baseline effective tax rate (0-1)
    new_etr: New effective tax rate after policy (0-1)
    etr_change: Change in effective tax rate (ppts)</p>
</div>


                            <div id="DistributionalResult.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">DistributionalResult</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">income_group</span><span class="p">:</span> <span class="n"><a href="#IncomeGroup">IncomeGroup</a></span>,</span><span class="param">	<span class="n">tax_change_total</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">tax_change_avg</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">tax_change_pct_income</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">share_of_total_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">pct_with_increase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">pct_with_decrease</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">pct_unchanged</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">100.0</span>,</span><span class="param">	<span class="n">baseline_etr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">new_etr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">etr_change</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.__init__"></a>
    
    

                            </div>
                            <div id="DistributionalResult.income_group" class="classattr">
                                <div class="attr variable">
            <span class="name">income_group</span><span class="annotation">: <a href="#IncomeGroup">IncomeGroup</a></span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.income_group"></a>
    
    

                            </div>
                            <div id="DistributionalResult.tax_change_total" class="classattr">
                                <div class="attr variable">
            <span class="name">tax_change_total</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.tax_change_total"></a>
    
    

                            </div>
                            <div id="DistributionalResult.tax_change_avg" class="classattr">
                                <div class="attr variable">
            <span class="name">tax_change_avg</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.tax_change_avg"></a>
    
    

                            </div>
                            <div id="DistributionalResult.tax_change_pct_income" class="classattr">
                                <div class="attr variable">
            <span class="name">tax_change_pct_income</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.tax_change_pct_income"></a>
    
    

                            </div>
                            <div id="DistributionalResult.share_of_total_change" class="classattr">
                                <div class="attr variable">
            <span class="name">share_of_total_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.share_of_total_change"></a>
    
    

                            </div>
                            <div id="DistributionalResult.pct_with_increase" class="classattr">
                                <div class="attr variable">
            <span class="name">pct_with_increase</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.pct_with_increase"></a>
    
    

                            </div>
                            <div id="DistributionalResult.pct_with_decrease" class="classattr">
                                <div class="attr variable">
            <span class="name">pct_with_decrease</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.pct_with_decrease"></a>
    
    

                            </div>
                            <div id="DistributionalResult.pct_unchanged" class="classattr">
                                <div class="attr variable">
            <span class="name">pct_unchanged</span><span class="annotation">: float</span>        =
<span class="default_value">100.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.pct_unchanged"></a>
    
    

                            </div>
                            <div id="DistributionalResult.baseline_etr" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_etr</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.baseline_etr"></a>
    
    

                            </div>
                            <div id="DistributionalResult.new_etr" class="classattr">
                                <div class="attr variable">
            <span class="name">new_etr</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.new_etr"></a>
    
    

                            </div>
                            <div id="DistributionalResult.etr_change" class="classattr">
                                <div class="attr variable">
            <span class="name">etr_change</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#DistributionalResult.etr_change"></a>
    
    

                            </div>
                </section>
                <section id="IncomeGroup">
                            <input id="IncomeGroup-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">IncomeGroup</span>:

                <label class="view-source-button" for="IncomeGroup-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IncomeGroup"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IncomeGroup-104"><a href="#IncomeGroup-104"><span class="linenos">104</span></a><span class="nd">@dataclass</span>
</span><span id="IncomeGroup-105"><a href="#IncomeGroup-105"><span class="linenos">105</span></a><span class="k">class</span><span class="w"> </span><span class="nc">IncomeGroup</span><span class="p">:</span>
</span><span id="IncomeGroup-106"><a href="#IncomeGroup-106"><span class="linenos">106</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IncomeGroup-107"><a href="#IncomeGroup-107"><span class="linenos">107</span></a><span class="sd">    Represents one income group in distributional analysis.</span>
</span><span id="IncomeGroup-108"><a href="#IncomeGroup-108"><span class="linenos">108</span></a>
</span><span id="IncomeGroup-109"><a href="#IncomeGroup-109"><span class="linenos">109</span></a><span class="sd">    Attributes:</span>
</span><span id="IncomeGroup-110"><a href="#IncomeGroup-110"><span class="linenos">110</span></a><span class="sd">        name: Human-readable name (e.g., &quot;Middle Quintile&quot;, &quot;$50K-$75K&quot;)</span>
</span><span id="IncomeGroup-111"><a href="#IncomeGroup-111"><span class="linenos">111</span></a><span class="sd">        floor: Lower bound of income (dollars)</span>
</span><span id="IncomeGroup-112"><a href="#IncomeGroup-112"><span class="linenos">112</span></a><span class="sd">        ceiling: Upper bound of income (None for top bracket)</span>
</span><span id="IncomeGroup-113"><a href="#IncomeGroup-113"><span class="linenos">113</span></a><span class="sd">        num_returns: Number of tax returns in this group</span>
</span><span id="IncomeGroup-114"><a href="#IncomeGroup-114"><span class="linenos">114</span></a><span class="sd">        total_agi: Total AGI in group (billions)</span>
</span><span id="IncomeGroup-115"><a href="#IncomeGroup-115"><span class="linenos">115</span></a><span class="sd">        total_taxable_income: Total taxable income (billions)</span>
</span><span id="IncomeGroup-116"><a href="#IncomeGroup-116"><span class="linenos">116</span></a><span class="sd">        baseline_tax: Baseline tax liability (billions)</span>
</span><span id="IncomeGroup-117"><a href="#IncomeGroup-117"><span class="linenos">117</span></a><span class="sd">        population_share: Share of total tax filers (0-1)</span>
</span><span id="IncomeGroup-118"><a href="#IncomeGroup-118"><span class="linenos">118</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="IncomeGroup-119"><a href="#IncomeGroup-119"><span class="linenos">119</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="IncomeGroup-120"><a href="#IncomeGroup-120"><span class="linenos">120</span></a>    <span class="n">floor</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="IncomeGroup-121"><a href="#IncomeGroup-121"><span class="linenos">121</span></a>    <span class="n">ceiling</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</span><span id="IncomeGroup-122"><a href="#IncomeGroup-122"><span class="linenos">122</span></a>    <span class="n">num_returns</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="IncomeGroup-123"><a href="#IncomeGroup-123"><span class="linenos">123</span></a>    <span class="n">total_agi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup-124"><a href="#IncomeGroup-124"><span class="linenos">124</span></a>    <span class="n">total_taxable_income</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup-125"><a href="#IncomeGroup-125"><span class="linenos">125</span></a>    <span class="n">baseline_tax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup-126"><a href="#IncomeGroup-126"><span class="linenos">126</span></a>    <span class="n">population_share</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup-127"><a href="#IncomeGroup-127"><span class="linenos">127</span></a>
</span><span id="IncomeGroup-128"><a href="#IncomeGroup-128"><span class="linenos">128</span></a>    <span class="nd">@property</span>
</span><span id="IncomeGroup-129"><a href="#IncomeGroup-129"><span class="linenos">129</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">avg_agi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="IncomeGroup-130"><a href="#IncomeGroup-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Average AGI per return in dollars.&quot;&quot;&quot;</span>
</span><span id="IncomeGroup-131"><a href="#IncomeGroup-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="IncomeGroup-132"><a href="#IncomeGroup-132"><span class="linenos">132</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup-133"><a href="#IncomeGroup-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="IncomeGroup-134"><a href="#IncomeGroup-134"><span class="linenos">134</span></a>
</span><span id="IncomeGroup-135"><a href="#IncomeGroup-135"><span class="linenos">135</span></a>    <span class="nd">@property</span>
</span><span id="IncomeGroup-136"><a href="#IncomeGroup-136"><span class="linenos">136</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">avg_tax</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="IncomeGroup-137"><a href="#IncomeGroup-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Average tax per return in dollars.&quot;&quot;&quot;</span>
</span><span id="IncomeGroup-138"><a href="#IncomeGroup-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="IncomeGroup-139"><a href="#IncomeGroup-139"><span class="linenos">139</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup-140"><a href="#IncomeGroup-140"><span class="linenos">140</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="IncomeGroup-141"><a href="#IncomeGroup-141"><span class="linenos">141</span></a>
</span><span id="IncomeGroup-142"><a href="#IncomeGroup-142"><span class="linenos">142</span></a>    <span class="nd">@property</span>
</span><span id="IncomeGroup-143"><a href="#IncomeGroup-143"><span class="linenos">143</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">effective_tax_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="IncomeGroup-144"><a href="#IncomeGroup-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Baseline effective tax rate (tax/AGI).&quot;&quot;&quot;</span>
</span><span id="IncomeGroup-145"><a href="#IncomeGroup-145"><span class="linenos">145</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="IncomeGroup-146"><a href="#IncomeGroup-146"><span class="linenos">146</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup-147"><a href="#IncomeGroup-147"><span class="linenos">147</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_agi</span>
</span><span id="IncomeGroup-148"><a href="#IncomeGroup-148"><span class="linenos">148</span></a>
</span><span id="IncomeGroup-149"><a href="#IncomeGroup-149"><span class="linenos">149</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="IncomeGroup-150"><a href="#IncomeGroup-150"><span class="linenos">150</span></a>        <span class="n">ceiling_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span>
</span><span id="IncomeGroup-151"><a href="#IncomeGroup-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> ($</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">floor</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">ceiling_str</span><span class="si">}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Represents one income group in distributional analysis.</p>

<p>Attributes:
    name: Human-readable name (e.g., "Middle Quintile", "$50K-$75K")
    floor: Lower bound of income (dollars)
    ceiling: Upper bound of income (None for top bracket)
    num_returns: Number of tax returns in this group
    total_agi: Total AGI in group (billions)
    total_taxable_income: Total taxable income (billions)
    baseline_tax: Baseline tax liability (billions)
    population_share: Share of total tax filers (0-1)</p>
</div>


                            <div id="IncomeGroup.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">IncomeGroup</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">floor</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">ceiling</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">num_returns</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">total_agi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">total_taxable_income</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">baseline_tax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">population_share</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.__init__"></a>
    
    

                            </div>
                            <div id="IncomeGroup.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.name"></a>
    
    

                            </div>
                            <div id="IncomeGroup.floor" class="classattr">
                                <div class="attr variable">
            <span class="name">floor</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.floor"></a>
    
    

                            </div>
                            <div id="IncomeGroup.ceiling" class="classattr">
                                <div class="attr variable">
            <span class="name">ceiling</span><span class="annotation">: float | None</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.ceiling"></a>
    
    

                            </div>
                            <div id="IncomeGroup.num_returns" class="classattr">
                                <div class="attr variable">
            <span class="name">num_returns</span><span class="annotation">: int</span>        =
<span class="default_value">0</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.num_returns"></a>
    
    

                            </div>
                            <div id="IncomeGroup.total_agi" class="classattr">
                                <div class="attr variable">
            <span class="name">total_agi</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.total_agi"></a>
    
    

                            </div>
                            <div id="IncomeGroup.total_taxable_income" class="classattr">
                                <div class="attr variable">
            <span class="name">total_taxable_income</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.total_taxable_income"></a>
    
    

                            </div>
                            <div id="IncomeGroup.baseline_tax" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_tax</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.baseline_tax"></a>
    
    

                            </div>
                            <div id="IncomeGroup.population_share" class="classattr">
                                <div class="attr variable">
            <span class="name">population_share</span><span class="annotation">: float</span>        =
<span class="default_value">0.0</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroup.population_share"></a>
    
    

                            </div>
                            <div id="IncomeGroup.avg_agi" class="classattr">
                                        <input id="IncomeGroup.avg_agi-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">avg_agi</span><span class="annotation">: float</span>

                <label class="view-source-button" for="IncomeGroup.avg_agi-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IncomeGroup.avg_agi"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IncomeGroup.avg_agi-128"><a href="#IncomeGroup.avg_agi-128"><span class="linenos">128</span></a>    <span class="nd">@property</span>
</span><span id="IncomeGroup.avg_agi-129"><a href="#IncomeGroup.avg_agi-129"><span class="linenos">129</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">avg_agi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="IncomeGroup.avg_agi-130"><a href="#IncomeGroup.avg_agi-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Average AGI per return in dollars.&quot;&quot;&quot;</span>
</span><span id="IncomeGroup.avg_agi-131"><a href="#IncomeGroup.avg_agi-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="IncomeGroup.avg_agi-132"><a href="#IncomeGroup.avg_agi-132"><span class="linenos">132</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup.avg_agi-133"><a href="#IncomeGroup.avg_agi-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_returns</span>
</span></pre></div>


            <div class="docstring"><p>Average AGI per return in dollars.</p>
</div>


                            </div>
                            <div id="IncomeGroup.avg_tax" class="classattr">
                                        <input id="IncomeGroup.avg_tax-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">avg_tax</span><span class="annotation">: float</span>

                <label class="view-source-button" for="IncomeGroup.avg_tax-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IncomeGroup.avg_tax"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IncomeGroup.avg_tax-135"><a href="#IncomeGroup.avg_tax-135"><span class="linenos">135</span></a>    <span class="nd">@property</span>
</span><span id="IncomeGroup.avg_tax-136"><a href="#IncomeGroup.avg_tax-136"><span class="linenos">136</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">avg_tax</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="IncomeGroup.avg_tax-137"><a href="#IncomeGroup.avg_tax-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Average tax per return in dollars.&quot;&quot;&quot;</span>
</span><span id="IncomeGroup.avg_tax-138"><a href="#IncomeGroup.avg_tax-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_returns</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="IncomeGroup.avg_tax-139"><a href="#IncomeGroup.avg_tax-139"><span class="linenos">139</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup.avg_tax-140"><a href="#IncomeGroup.avg_tax-140"><span class="linenos">140</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_returns</span>
</span></pre></div>


            <div class="docstring"><p>Average tax per return in dollars.</p>
</div>


                            </div>
                            <div id="IncomeGroup.effective_tax_rate" class="classattr">
                                        <input id="IncomeGroup.effective_tax_rate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">effective_tax_rate</span><span class="annotation">: float</span>

                <label class="view-source-button" for="IncomeGroup.effective_tax_rate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IncomeGroup.effective_tax_rate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IncomeGroup.effective_tax_rate-142"><a href="#IncomeGroup.effective_tax_rate-142"><span class="linenos">142</span></a>    <span class="nd">@property</span>
</span><span id="IncomeGroup.effective_tax_rate-143"><a href="#IncomeGroup.effective_tax_rate-143"><span class="linenos">143</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">effective_tax_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="IncomeGroup.effective_tax_rate-144"><a href="#IncomeGroup.effective_tax_rate-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Baseline effective tax rate (tax/AGI).&quot;&quot;&quot;</span>
</span><span id="IncomeGroup.effective_tax_rate-145"><a href="#IncomeGroup.effective_tax_rate-145"><span class="linenos">145</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_agi</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="IncomeGroup.effective_tax_rate-146"><a href="#IncomeGroup.effective_tax_rate-146"><span class="linenos">146</span></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="IncomeGroup.effective_tax_rate-147"><a href="#IncomeGroup.effective_tax_rate-147"><span class="linenos">147</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_tax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_agi</span>
</span></pre></div>


            <div class="docstring"><p>Baseline effective tax rate (tax/AGI).</p>
</div>


                            </div>
                </section>
                <section id="IncomeGroupType">
                            <input id="IncomeGroupType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">IncomeGroupType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="IncomeGroupType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IncomeGroupType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IncomeGroupType-44"><a href="#IncomeGroupType-44"><span class="linenos">44</span></a><span class="k">class</span><span class="w"> </span><span class="nc">IncomeGroupType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="IncomeGroupType-45"><a href="#IncomeGroupType-45"><span class="linenos">45</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Type of income grouping for distributional analysis.&quot;&quot;&quot;</span>
</span><span id="IncomeGroupType-46"><a href="#IncomeGroupType-46"><span class="linenos">46</span></a>    <span class="n">QUINTILE</span> <span class="o">=</span> <span class="s2">&quot;quintile&quot;</span>           <span class="c1"># 5 equal-population groups</span>
</span><span id="IncomeGroupType-47"><a href="#IncomeGroupType-47"><span class="linenos">47</span></a>    <span class="n">DECILE</span> <span class="o">=</span> <span class="s2">&quot;decile&quot;</span>               <span class="c1"># 10 equal-population groups</span>
</span><span id="IncomeGroupType-48"><a href="#IncomeGroupType-48"><span class="linenos">48</span></a>    <span class="n">JCT_DOLLAR</span> <span class="o">=</span> <span class="s2">&quot;jct_dollar&quot;</span>       <span class="c1"># JCT-style dollar brackets</span>
</span><span id="IncomeGroupType-49"><a href="#IncomeGroupType-49"><span class="linenos">49</span></a>    <span class="n">CUSTOM</span> <span class="o">=</span> <span class="s2">&quot;custom&quot;</span>               <span class="c1"># User-defined brackets</span>
</span></pre></div>


            <div class="docstring"><p>Type of income grouping for distributional analysis.</p>
</div>


                            <div id="IncomeGroupType.QUINTILE" class="classattr">
                                <div class="attr variable">
            <span class="name">QUINTILE</span>        =
<span class="default_value">&lt;<a href="#IncomeGroupType.QUINTILE">IncomeGroupType.QUINTILE</a>: &#39;quintile&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroupType.QUINTILE"></a>
    
    

                            </div>
                            <div id="IncomeGroupType.DECILE" class="classattr">
                                <div class="attr variable">
            <span class="name">DECILE</span>        =
<span class="default_value">&lt;<a href="#IncomeGroupType.DECILE">IncomeGroupType.DECILE</a>: &#39;decile&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroupType.DECILE"></a>
    
    

                            </div>
                            <div id="IncomeGroupType.JCT_DOLLAR" class="classattr">
                                <div class="attr variable">
            <span class="name">JCT_DOLLAR</span>        =
<span class="default_value">&lt;<a href="#IncomeGroupType.JCT_DOLLAR">IncomeGroupType.JCT_DOLLAR</a>: &#39;jct_dollar&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroupType.JCT_DOLLAR"></a>
    
    

                            </div>
                            <div id="IncomeGroupType.CUSTOM" class="classattr">
                                <div class="attr variable">
            <span class="name">CUSTOM</span>        =
<span class="default_value">&lt;<a href="#IncomeGroupType.CUSTOM">IncomeGroupType.CUSTOM</a>: &#39;custom&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#IncomeGroupType.CUSTOM"></a>
    
    

                            </div>
                </section>
                <section id="format_distribution_table">
                            <input id="format_distribution_table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">format_distribution_table</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">analysis</span><span class="p">:</span> <span class="n"><a href="#DistributionalAnalysis">DistributionalAnalysis</a></span>,</span><span class="param">	<span class="n">style</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;tpc&#39;</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="format_distribution_table-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#format_distribution_table"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="format_distribution_table-1181"><a href="#format_distribution_table-1181"><span class="linenos">1181</span></a><span class="k">def</span><span class="w"> </span><span class="nf">format_distribution_table</span><span class="p">(</span>
</span><span id="format_distribution_table-1182"><a href="#format_distribution_table-1182"><span class="linenos">1182</span></a>    <span class="n">analysis</span><span class="p">:</span> <span class="n">DistributionalAnalysis</span><span class="p">,</span>
</span><span id="format_distribution_table-1183"><a href="#format_distribution_table-1183"><span class="linenos">1183</span></a>    <span class="n">style</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tpc&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1184"><a href="#format_distribution_table-1184"><span class="linenos">1184</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="format_distribution_table-1185"><a href="#format_distribution_table-1185"><span class="linenos">1185</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="format_distribution_table-1186"><a href="#format_distribution_table-1186"><span class="linenos">1186</span></a><span class="sd">    Format distributional analysis as a styled table.</span>
</span><span id="format_distribution_table-1187"><a href="#format_distribution_table-1187"><span class="linenos">1187</span></a>
</span><span id="format_distribution_table-1188"><a href="#format_distribution_table-1188"><span class="linenos">1188</span></a><span class="sd">    Args:</span>
</span><span id="format_distribution_table-1189"><a href="#format_distribution_table-1189"><span class="linenos">1189</span></a><span class="sd">        analysis: DistributionalAnalysis to format</span>
</span><span id="format_distribution_table-1190"><a href="#format_distribution_table-1190"><span class="linenos">1190</span></a><span class="sd">        style: &quot;tpc&quot; for Tax Policy Center style, &quot;jct&quot; for JCT style</span>
</span><span id="format_distribution_table-1191"><a href="#format_distribution_table-1191"><span class="linenos">1191</span></a>
</span><span id="format_distribution_table-1192"><a href="#format_distribution_table-1192"><span class="linenos">1192</span></a><span class="sd">    Returns:</span>
</span><span id="format_distribution_table-1193"><a href="#format_distribution_table-1193"><span class="linenos">1193</span></a><span class="sd">        Formatted DataFrame</span>
</span><span id="format_distribution_table-1194"><a href="#format_distribution_table-1194"><span class="linenos">1194</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="format_distribution_table-1195"><a href="#format_distribution_table-1195"><span class="linenos">1195</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span><span id="format_distribution_table-1196"><a href="#format_distribution_table-1196"><span class="linenos">1196</span></a>
</span><span id="format_distribution_table-1197"><a href="#format_distribution_table-1197"><span class="linenos">1197</span></a>    <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;tpc&quot;</span><span class="p">:</span>
</span><span id="format_distribution_table-1198"><a href="#format_distribution_table-1198"><span class="linenos">1198</span></a>        <span class="c1"># TPC style: focus on tax change as % of income</span>
</span><span id="format_distribution_table-1199"><a href="#format_distribution_table-1199"><span class="linenos">1199</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="format_distribution_table-1200"><a href="#format_distribution_table-1200"><span class="linenos">1200</span></a>            <span class="s2">&quot;Income Group&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1201"><a href="#format_distribution_table-1201"><span class="linenos">1201</span></a>            <span class="s2">&quot;Returns (M)&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1202"><a href="#format_distribution_table-1202"><span class="linenos">1202</span></a>            <span class="s2">&quot;Avg Tax Change ($)&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1203"><a href="#format_distribution_table-1203"><span class="linenos">1203</span></a>            <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f Income&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1204"><a href="#format_distribution_table-1204"><span class="linenos">1204</span></a>            <span class="s2">&quot;Share of Total&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1205"><a href="#format_distribution_table-1205"><span class="linenos">1205</span></a>            <span class="s2">&quot;% Tax Increase&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1206"><a href="#format_distribution_table-1206"><span class="linenos">1206</span></a>            <span class="s2">&quot;% Tax Decrease&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1207"><a href="#format_distribution_table-1207"><span class="linenos">1207</span></a>            <span class="s2">&quot;ETR Change (ppts)&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1208"><a href="#format_distribution_table-1208"><span class="linenos">1208</span></a>        <span class="p">]</span>
</span><span id="format_distribution_table-1209"><a href="#format_distribution_table-1209"><span class="linenos">1209</span></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># JCT style</span>
</span><span id="format_distribution_table-1210"><a href="#format_distribution_table-1210"><span class="linenos">1210</span></a>        <span class="c1"># JCT style: focus on dollar amounts</span>
</span><span id="format_distribution_table-1211"><a href="#format_distribution_table-1211"><span class="linenos">1211</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="format_distribution_table-1212"><a href="#format_distribution_table-1212"><span class="linenos">1212</span></a>            <span class="s2">&quot;Income Group&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1213"><a href="#format_distribution_table-1213"><span class="linenos">1213</span></a>            <span class="s2">&quot;AGI Range&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1214"><a href="#format_distribution_table-1214"><span class="linenos">1214</span></a>            <span class="s2">&quot;Returns (M)&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1215"><a href="#format_distribution_table-1215"><span class="linenos">1215</span></a>            <span class="s2">&quot;Tax Change ($B)&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1216"><a href="#format_distribution_table-1216"><span class="linenos">1216</span></a>            <span class="s2">&quot;Avg Tax Change ($)&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1217"><a href="#format_distribution_table-1217"><span class="linenos">1217</span></a>            <span class="s2">&quot;% Tax Increase&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1218"><a href="#format_distribution_table-1218"><span class="linenos">1218</span></a>            <span class="s2">&quot;% Tax Decrease&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1219"><a href="#format_distribution_table-1219"><span class="linenos">1219</span></a>            <span class="s2">&quot;Baseline ETR&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1220"><a href="#format_distribution_table-1220"><span class="linenos">1220</span></a>            <span class="s2">&quot;New ETR&quot;</span><span class="p">,</span>
</span><span id="format_distribution_table-1221"><a href="#format_distribution_table-1221"><span class="linenos">1221</span></a>        <span class="p">]</span>
</span><span id="format_distribution_table-1222"><a href="#format_distribution_table-1222"><span class="linenos">1222</span></a>
</span><span id="format_distribution_table-1223"><a href="#format_distribution_table-1223"><span class="linenos">1223</span></a>    <span class="c1"># Select available columns</span>
</span><span id="format_distribution_table-1224"><a href="#format_distribution_table-1224"><span class="linenos">1224</span></a>    <span class="n">available_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</span><span id="format_distribution_table-1225"><a href="#format_distribution_table-1225"><span class="linenos">1225</span></a>    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">available_cols</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Format distributional analysis as a styled table.</p>

<p>Args:
    analysis: DistributionalAnalysis to format
    style: "tpc" for Tax Policy Center style, "jct" for JCT style</p>

<p>Returns:
    Formatted DataFrame</p>
</div>


                </section>
                <section id="generate_winners_losers_summary">
                            <input id="generate_winners_losers_summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_winners_losers_summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">analysis</span><span class="p">:</span> <span class="n"><a href="#DistributionalAnalysis">DistributionalAnalysis</a></span></span><span class="return-annotation">) -> <span class="n">Dict</span>:</span></span>

                <label class="view-source-button" for="generate_winners_losers_summary-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_winners_losers_summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_winners_losers_summary-1228"><a href="#generate_winners_losers_summary-1228"><span class="linenos">1228</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_winners_losers_summary</span><span class="p">(</span><span class="n">analysis</span><span class="p">:</span> <span class="n">DistributionalAnalysis</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="generate_winners_losers_summary-1229"><a href="#generate_winners_losers_summary-1229"><span class="linenos">1229</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="generate_winners_losers_summary-1230"><a href="#generate_winners_losers_summary-1230"><span class="linenos">1230</span></a><span class="sd">    Generate summary of winners and losers from policy change.</span>
</span><span id="generate_winners_losers_summary-1231"><a href="#generate_winners_losers_summary-1231"><span class="linenos">1231</span></a>
</span><span id="generate_winners_losers_summary-1232"><a href="#generate_winners_losers_summary-1232"><span class="linenos">1232</span></a><span class="sd">    Returns:</span>
</span><span id="generate_winners_losers_summary-1233"><a href="#generate_winners_losers_summary-1233"><span class="linenos">1233</span></a><span class="sd">        Dictionary with winner/loser statistics</span>
</span><span id="generate_winners_losers_summary-1234"><a href="#generate_winners_losers_summary-1234"><span class="linenos">1234</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_winners_losers_summary-1235"><a href="#generate_winners_losers_summary-1235"><span class="linenos">1235</span></a>    <span class="n">total_returns</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">num_returns</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">analysis</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
</span><span id="generate_winners_losers_summary-1236"><a href="#generate_winners_losers_summary-1236"><span class="linenos">1236</span></a>
</span><span id="generate_winners_losers_summary-1237"><a href="#generate_winners_losers_summary-1237"><span class="linenos">1237</span></a>    <span class="c1"># Calculate weighted averages</span>
</span><span id="generate_winners_losers_summary-1238"><a href="#generate_winners_losers_summary-1238"><span class="linenos">1238</span></a>    <span class="n">total_with_increase</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="generate_winners_losers_summary-1239"><a href="#generate_winners_losers_summary-1239"><span class="linenos">1239</span></a>    <span class="n">total_with_decrease</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="generate_winners_losers_summary-1240"><a href="#generate_winners_losers_summary-1240"><span class="linenos">1240</span></a>    <span class="n">increase_amount</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="generate_winners_losers_summary-1241"><a href="#generate_winners_losers_summary-1241"><span class="linenos">1241</span></a>    <span class="n">decrease_amount</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="generate_winners_losers_summary-1242"><a href="#generate_winners_losers_summary-1242"><span class="linenos">1242</span></a>
</span><span id="generate_winners_losers_summary-1243"><a href="#generate_winners_losers_summary-1243"><span class="linenos">1243</span></a>    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">analysis</span><span class="o">.</span><span class="n">results</span><span class="p">:</span>
</span><span id="generate_winners_losers_summary-1244"><a href="#generate_winners_losers_summary-1244"><span class="linenos">1244</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">num_returns</span>
</span><span id="generate_winners_losers_summary-1245"><a href="#generate_winners_losers_summary-1245"><span class="linenos">1245</span></a>        <span class="n">total_with_increase</span> <span class="o">+=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">pct_with_increase</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="generate_winners_losers_summary-1246"><a href="#generate_winners_losers_summary-1246"><span class="linenos">1246</span></a>        <span class="n">total_with_decrease</span> <span class="o">+=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">pct_with_decrease</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="generate_winners_losers_summary-1247"><a href="#generate_winners_losers_summary-1247"><span class="linenos">1247</span></a>
</span><span id="generate_winners_losers_summary-1248"><a href="#generate_winners_losers_summary-1248"><span class="linenos">1248</span></a>        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="generate_winners_losers_summary-1249"><a href="#generate_winners_losers_summary-1249"><span class="linenos">1249</span></a>            <span class="n">increase_amount</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_total</span>
</span><span id="generate_winners_losers_summary-1250"><a href="#generate_winners_losers_summary-1250"><span class="linenos">1250</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="generate_winners_losers_summary-1251"><a href="#generate_winners_losers_summary-1251"><span class="linenos">1251</span></a>            <span class="n">decrease_amount</span> <span class="o">+=</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_total</span>
</span><span id="generate_winners_losers_summary-1252"><a href="#generate_winners_losers_summary-1252"><span class="linenos">1252</span></a>
</span><span id="generate_winners_losers_summary-1253"><a href="#generate_winners_losers_summary-1253"><span class="linenos">1253</span></a>    <span class="c1"># Find which groups benefit/lose most</span>
</span><span id="generate_winners_losers_summary-1254"><a href="#generate_winners_losers_summary-1254"><span class="linenos">1254</span></a>    <span class="n">sorted_by_avg</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span><span class="p">)</span>
</span><span id="generate_winners_losers_summary-1255"><a href="#generate_winners_losers_summary-1255"><span class="linenos">1255</span></a>    <span class="n">biggest_winners</span> <span class="o">=</span> <span class="n">sorted_by_avg</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Largest tax cuts</span>
</span><span id="generate_winners_losers_summary-1256"><a href="#generate_winners_losers_summary-1256"><span class="linenos">1256</span></a>    <span class="n">biggest_losers</span> <span class="o">=</span> <span class="n">sorted_by_avg</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Largest tax increases</span>
</span><span id="generate_winners_losers_summary-1257"><a href="#generate_winners_losers_summary-1257"><span class="linenos">1257</span></a>
</span><span id="generate_winners_losers_summary-1258"><a href="#generate_winners_losers_summary-1258"><span class="linenos">1258</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="generate_winners_losers_summary-1259"><a href="#generate_winners_losers_summary-1259"><span class="linenos">1259</span></a>        <span class="s2">&quot;total_returns&quot;</span><span class="p">:</span> <span class="n">total_returns</span><span class="p">,</span>
</span><span id="generate_winners_losers_summary-1260"><a href="#generate_winners_losers_summary-1260"><span class="linenos">1260</span></a>        <span class="s2">&quot;pct_with_increase&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">total_with_increase</span> <span class="o">/</span> <span class="n">total_returns</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_returns</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="generate_winners_losers_summary-1261"><a href="#generate_winners_losers_summary-1261"><span class="linenos">1261</span></a>        <span class="s2">&quot;pct_with_decrease&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">total_with_decrease</span> <span class="o">/</span> <span class="n">total_returns</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_returns</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="generate_winners_losers_summary-1262"><a href="#generate_winners_losers_summary-1262"><span class="linenos">1262</span></a>        <span class="s2">&quot;total_increase_billions&quot;</span><span class="p">:</span> <span class="n">increase_amount</span><span class="p">,</span>
</span><span id="generate_winners_losers_summary-1263"><a href="#generate_winners_losers_summary-1263"><span class="linenos">1263</span></a>        <span class="s2">&quot;total_decrease_billions&quot;</span><span class="p">:</span> <span class="n">decrease_amount</span><span class="p">,</span>
</span><span id="generate_winners_losers_summary-1264"><a href="#generate_winners_losers_summary-1264"><span class="linenos">1264</span></a>        <span class="s2">&quot;biggest_winners&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="generate_winners_losers_summary-1265"><a href="#generate_winners_losers_summary-1265"><span class="linenos">1265</span></a>            <span class="p">{</span><span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;avg_change&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span><span class="p">}</span>
</span><span id="generate_winners_losers_summary-1266"><a href="#generate_winners_losers_summary-1266"><span class="linenos">1266</span></a>            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">biggest_winners</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&lt;</span> <span class="mi">0</span>
</span><span id="generate_winners_losers_summary-1267"><a href="#generate_winners_losers_summary-1267"><span class="linenos">1267</span></a>        <span class="p">],</span>
</span><span id="generate_winners_losers_summary-1268"><a href="#generate_winners_losers_summary-1268"><span class="linenos">1268</span></a>        <span class="s2">&quot;biggest_losers&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="generate_winners_losers_summary-1269"><a href="#generate_winners_losers_summary-1269"><span class="linenos">1269</span></a>            <span class="p">{</span><span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">income_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;avg_change&quot;</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span><span class="p">}</span>
</span><span id="generate_winners_losers_summary-1270"><a href="#generate_winners_losers_summary-1270"><span class="linenos">1270</span></a>            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">biggest_losers</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">tax_change_avg</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="generate_winners_losers_summary-1271"><a href="#generate_winners_losers_summary-1271"><span class="linenos">1271</span></a>        <span class="p">],</span>
</span><span id="generate_winners_losers_summary-1272"><a href="#generate_winners_losers_summary-1272"><span class="linenos">1272</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Generate summary of winners and losers from policy change.</p>

<p>Returns:
    Dictionary with winner/loser statistics</p>
</div>


                </section>
                <section id="QUINTILE_THRESHOLDS_2024">
                    <div class="attr variable">
            <span class="name">QUINTILE_THRESHOLDS_2024</span>        =
<input id="QUINTILE_THRESHOLDS_2024-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="QUINTILE_THRESHOLDS_2024-view-value"></label><span class="default_value">{&#39;lowest&#39;: (0, 35000), &#39;second&#39;: (35000, 65000), &#39;middle&#39;: (65000, 105000), &#39;fourth&#39;: (105000, 170000), &#39;top&#39;: (170000, None)}</span>

        
    </div>
    <a class="headerlink" href="#QUINTILE_THRESHOLDS_2024"></a>
    
    

                </section>
                <section id="DECILE_THRESHOLDS_2024">
                    <div class="attr variable">
            <span class="name">DECILE_THRESHOLDS_2024</span>        =
<input id="DECILE_THRESHOLDS_2024-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="DECILE_THRESHOLDS_2024-view-value"></label><span class="default_value">{&#39;1st&#39;: (0, 15000), &#39;2nd&#39;: (15000, 28000), &#39;3rd&#39;: (28000, 42000), &#39;4th&#39;: (42000, 55000), &#39;5th&#39;: (55000, 72000), &#39;6th&#39;: (72000, 92000), &#39;7th&#39;: (92000, 118000), &#39;8th&#39;: (118000, 155000), &#39;9th&#39;: (155000, 220000), &#39;10th&#39;: (220000, None)}</span>

        
    </div>
    <a class="headerlink" href="#DECILE_THRESHOLDS_2024"></a>
    
    

                </section>
                <section id="TOP_INCOME_THRESHOLDS_2024">
                    <div class="attr variable">
            <span class="name">TOP_INCOME_THRESHOLDS_2024</span>        =
<span class="default_value">{&#39;top_10&#39;: 215000, &#39;top_5&#39;: 335000, &#39;top_1&#39;: 800000, &#39;top_0_1&#39;: 3500000}</span>

        
    </div>
    <a class="headerlink" href="#TOP_INCOME_THRESHOLDS_2024"></a>
    
    

                </section>
                <section id="JCT_DOLLAR_BRACKETS">
                    <div class="attr variable">
            <span class="name">JCT_DOLLAR_BRACKETS</span>        =
<input id="JCT_DOLLAR_BRACKETS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="JCT_DOLLAR_BRACKETS-view-value"></label><span class="default_value">[(0, 10000), (10000, 20000), (20000, 30000), (30000, 40000), (40000, 50000), (50000, 75000), (75000, 100000), (100000, 200000), (200000, 500000), (500000, 1000000), (1000000, None)]</span>

        
    </div>
    <a class="headerlink" href="#JCT_DOLLAR_BRACKETS"></a>
    
    

                </section>
    </main>
</body>
</html>